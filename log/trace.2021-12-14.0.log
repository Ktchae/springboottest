2021-12-14 15:18:54.377 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-14 15:18:54.377 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 8316 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 15:18:54.404 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 15:18:54.717 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-14 15:18:54.720 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-14 15:18:59.972 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 15:18:59.975 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 15:19:00.674 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 666 ms. Found 0 Redis repository interfaces.
2021-12-14 15:19:02.800 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 15:19:02.840 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 15:19:02.847 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 15:19:02.847 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 15:19:03.025 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 15:19:03.025 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 8302 ms
2021-12-14 15:19:06.573 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-14 15:19:06.653 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-14 15:19:06.703 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-14 15:19:06.767 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 14.323 seconds (JVM running for 18.052)
2021-12-14 15:19:10.006 INFO  com.job.EbookSnapshotJob                          :32   [32m125859109298900992[0;39m 生成今日电子书快照开始
2021-12-14 15:19:10.123 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125859109298900992[0;39m HikariPool-1 - Starting...
2021-12-14 15:19:11.241 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125859109298900992[0;39m HikariPool-1 - Start completed.
2021-12-14 15:19:11.293 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859109298900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:11.349 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859109298900992[0;39m ==> Parameters: 
2021-12-14 15:19:11.547 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859109298900992[0;39m <==    Updates: 0
2021-12-14 15:19:11.549 INFO  com.job.EbookSnapshotJob                          :35   [32m125859109298900992[0;39m 生成今日电子书快照结束，耗时：1542毫秒
2021-12-14 15:19:15.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125859130249449472[0;39m 生成今日电子书快照开始
2021-12-14 15:19:15.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859130249449472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:15.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859130249449472[0;39m ==> Parameters: 
2021-12-14 15:19:15.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859130249449472[0;39m <==    Updates: 0
2021-12-14 15:19:15.251 INFO  com.job.EbookSnapshotJob                          :35   [32m125859130249449472[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-14 15:19:20.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125859151250329600[0;39m 生成今日电子书快照开始
2021-12-14 15:19:20.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859151250329600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:20.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859151250329600[0;39m ==> Parameters: 
2021-12-14 15:19:20.273 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859151250329600[0;39m <==    Updates: 0
2021-12-14 15:19:20.273 INFO  com.job.EbookSnapshotJob                          :35   [32m125859151250329600[0;39m 生成今日电子书快照结束，耗时：264毫秒
2021-12-14 15:19:24.549 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-14 15:19:24.549 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-14 15:19:24.555 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 6 ms
2021-12-14 15:19:24.751 INFO  com.aspect.LogAspect                              :54   [32m125859171131330560[0;39m ------------- 开始 -------------
2021-12-14 15:19:24.751 INFO  com.aspect.LogAspect                              :54   [32m125859171131330562[0;39m ------------- 开始 -------------
2021-12-14 15:19:24.751 INFO  com.aspect.LogAspect                              :54   [32m125859171131330561[0;39m ------------- 开始 -------------
2021-12-14 15:19:24.753 INFO  com.aspect.LogAspect                              :55   [32m125859171131330562[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:19:24.754 INFO  com.aspect.LogAspect                              :56   [32m125859171131330562[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:19:24.754 INFO  com.aspect.LogAspect                              :55   [32m125859171131330560[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:19:24.755 INFO  com.aspect.LogAspect                              :57   [32m125859171131330562[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:24.759 INFO  com.aspect.LogAspect                              :55   [32m125859171131330561[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:19:24.760 INFO  com.aspect.LogAspect                              :56   [32m125859171131330561[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:19:24.761 INFO  com.aspect.LogAspect                              :57   [32m125859171131330561[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:24.755 INFO  com.aspect.LogAspect                              :56   [32m125859171131330560[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:19:24.762 INFO  com.aspect.LogAspect                              :57   [32m125859171131330560[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:24.819 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：w0OLY3auBl，session id：0，当前连接数：1
2021-12-14 15:19:24.850 INFO  com.aspect.LogAspect                              :80   [32m125859171131330560[0;39m 请求参数: []
2021-12-14 15:19:24.850 INFO  com.aspect.LogAspect                              :80   [32m125859171131330562[0;39m 请求参数: []
2021-12-14 15:19:24.850 INFO  com.aspect.LogAspect                              :80   [32m125859171131330561[0;39m 请求参数: []
2021-12-14 15:19:24.927 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859171131330561[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:19:24.929 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859171131330561[0;39m ==> Parameters: 
2021-12-14 15:19:24.941 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859171131330562[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:19:24.943 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859171131330562[0;39m ==> Parameters: 
2021-12-14 15:19:24.961 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859171131330560[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:19:24.961 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859171131330560[0;39m ==> Parameters: 
2021-12-14 15:19:25.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125859172238626816[0;39m 生成今日电子书快照开始
2021-12-14 15:19:25.045 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:19:25.045 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859171131330562[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:19:25.046 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859171131330561[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:19:25.047 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:19:25.047 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859171131330562[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:19:25.047 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859171131330561[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:19:25.073 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:19:25.075 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:19:25.075 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859171131330562[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:19:25.075 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859171131330561[0;39m <==        Row: 2021-12-14, 483, 160, 0, 0
2021-12-14 15:19:25.077 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:19:25.078 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859171131330561[0;39m <==      Total: 2
2021-12-14 15:19:25.078 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859171131330562[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:19:25.078 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:19:25.078 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859171131330562[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:19:25.078 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:19:25.078 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859171131330562[0;39m <==      Total: 4
2021-12-14 15:19:25.078 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:19:25.083 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:19:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859172238626816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:25.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859172238626816[0;39m ==> Parameters: 
2021-12-14 15:19:25.086 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:19:25.089 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:19:25.091 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:19:25.093 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:19:25.095 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:19:25.097 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:19:25.097 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:19:25.097 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:19:25.105 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:19:25.106 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:19:25.107 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859171131330560[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:19:25.109 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859171131330560[0;39m <==      Total: 19
2021-12-14 15:19:25.167 INFO  com.aspect.LogAspect                              :92   [32m125859171131330560[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:19:25.169 INFO  com.aspect.LogAspect                              :93   [32m125859171131330560[0;39m ------------- 结束 耗时：421 ms -------------
2021-12-14 15:19:25.169 INFO  com.aspect.LogAspect                              :92   [32m125859171131330562[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:19:25.169 INFO  com.aspect.LogAspect                              :92   [32m125859171131330561[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":483,"viewIncrease":0,"voteCount":160,"voteIncrease":0}],"success":true}
2021-12-14 15:19:25.169 INFO  com.aspect.LogAspect                              :93   [32m125859171131330562[0;39m ------------- 结束 耗时：421 ms -------------
2021-12-14 15:19:25.169 INFO  com.aspect.LogAspect                              :93   [32m125859171131330561[0;39m ------------- 结束 耗时：421 ms -------------
2021-12-14 15:19:25.275 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859172238626816[0;39m <==    Updates: 0
2021-12-14 15:19:25.275 INFO  com.job.EbookSnapshotJob                          :35   [32m125859172238626816[0;39m 生成今日电子书快照结束，耗时：262毫秒
2021-12-14 15:19:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125859193201758208[0;39m 生成今日电子书快照开始
2021-12-14 15:19:30.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859193201758208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:30.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859193201758208[0;39m ==> Parameters: 
2021-12-14 15:19:30.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859193201758208[0;39m <==    Updates: 0
2021-12-14 15:19:30.271 INFO  com.job.EbookSnapshotJob                          :35   [32m125859193201758208[0;39m 生成今日电子书快照结束，耗时：260毫秒
2021-12-14 15:19:33.335 INFO  com.aspect.LogAspect                              :54   [32m125859207147819008[0;39m ------------- 开始 -------------
2021-12-14 15:19:33.335 INFO  com.aspect.LogAspect                              :55   [32m125859207147819008[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:19:33.335 INFO  com.aspect.LogAspect                              :56   [32m125859207147819008[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:19:33.335 INFO  com.aspect.LogAspect                              :57   [32m125859207147819008[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:33.344 INFO  com.aspect.LogAspect                              :80   [32m125859207147819008[0;39m 请求参数: [{"categoryId2":101,"page":1,"size":1000}]
2021-12-14 15:19:33.530 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859207147819008[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:19:33.536 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859207147819008[0;39m ==> Parameters: 101(Long)
2021-12-14 15:19:33.654 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859207147819008[0;39m <==    Columns: count(0)
2021-12-14 15:19:33.656 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859207147819008[0;39m <==        Row: 1
2021-12-14 15:19:33.658 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859207147819008[0;39m <==      Total: 1
2021-12-14 15:19:33.668 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859207147819008[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-14 15:19:33.668 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859207147819008[0;39m ==> Parameters: 101(Long), 1000(Integer)
2021-12-14 15:19:33.746 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125859207147819008[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:19:33.746 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125859207147819008[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 69, 24
2021-12-14 15:19:33.748 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859207147819008[0;39m <==      Total: 1
2021-12-14 15:19:33.753 INFO  com.servicess.EbookService                        :48   [32m125859207147819008[0;39m 总行数：1
2021-12-14 15:19:33.754 INFO  com.servicess.EbookService                        :49   [32m125859207147819008[0;39m 总页数：1
2021-12-14 15:19:33.788 INFO  com.aspect.LogAspect                              :92   [32m125859207147819008[0;39m 返回结果: {"content":{"list":[{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":69,"voteCount":24}],"total":1},"success":true}
2021-12-14 15:19:33.789 INFO  com.aspect.LogAspect                              :93   [32m125859207147819008[0;39m ------------- 结束 耗时：454 ms -------------
2021-12-14 15:19:35.003 INFO  com.job.DocJob                                    :32   [32m125859214143918080[0;39m 更新电子书下的文档数据开始
2021-12-14 15:19:35.112 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859214143918080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 15:19:35.114 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859214143918080[0;39m ==> Parameters: 
2021-12-14 15:19:35.272 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859214143918080[0;39m <==    Updates: 3
2021-12-14 15:19:35.272 INFO  com.job.DocJob                                    :35   [32m125859214143918080[0;39m 更新电子书下的文档数据结束，耗时：268毫秒
2021-12-14 15:19:35.272 INFO  com.job.EbookSnapshotJob                          :32   [32m125859215272185856[0;39m 生成今日电子书快照开始
2021-12-14 15:19:35.281 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859215272185856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:35.285 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859215272185856[0;39m ==> Parameters: 
2021-12-14 15:19:35.442 INFO  com.aspect.LogAspect                              :54   [32m125859215985217536[0;39m ------------- 开始 -------------
2021-12-14 15:19:35.442 INFO  com.aspect.LogAspect                              :55   [32m125859215985217536[0;39m 请求地址: http://localhost:8081/doc/all/2 GET
2021-12-14 15:19:35.442 INFO  com.aspect.LogAspect                              :56   [32m125859215985217536[0;39m 类名方法: com.controller.DocController.all
2021-12-14 15:19:35.442 INFO  com.aspect.LogAspect                              :57   [32m125859215985217536[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:35.442 INFO  com.aspect.LogAspect                              :80   [32m125859215985217536[0;39m 请求参数: [2]
2021-12-14 15:19:35.461 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859215272185856[0;39m <==    Updates: 0
2021-12-14 15:19:35.461 INFO  com.job.EbookSnapshotJob                          :35   [32m125859215272185856[0;39m 生成今日电子书快照结束，耗时：181毫秒
2021-12-14 15:19:35.584 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859215985217536[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-14 15:19:35.585 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859215985217536[0;39m ==> Parameters: 2(Long)
2021-12-14 15:19:35.700 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:19:35.708 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 9, 2, 0, 文档1, 1, 28, 3
2021-12-14 15:19:35.709 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 122746345772683264, 2, 0, 文档2, 1, 12, 2
2021-12-14 15:19:35.709 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 123355131981991936, 2, 9, 文档1.1, 1, 9, 4
2021-12-14 15:19:35.709 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 123355236525019136, 2, 122746345772683264, 文档2.1, 1, 7, 5
2021-12-14 15:19:35.709 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 124191156778176512, 2, 0, 文档3, 1, 2, 2
2021-12-14 15:19:35.713 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 123355187095146496, 2, 9, 文档1.2, 2, 7, 4
2021-12-14 15:19:35.714 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 124191201023889408, 2, 124191156778176512, 文档3.1, 2, 3, 3
2021-12-14 15:19:35.714 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859215985217536[0;39m <==        Row: 124191230128164864, 2, 124191156778176512, 文档3.2, 3, 1, 1
2021-12-14 15:19:35.714 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859215985217536[0;39m <==      Total: 8
2021-12-14 15:19:35.732 INFO  com.aspect.LogAspect                              :92   [32m125859215985217536[0;39m 返回结果: {"content":[{"ebookId":2,"id":9,"name":"文档1","parent":0,"sort":1,"viewCount":28,"voteCount":3},{"ebookId":2,"id":122746345772683264,"name":"文档2","parent":0,"sort":1,"viewCount":12,"voteCount":2},{"ebookId":2,"id":123355131981991936,"name":"文档1.1","parent":9,"sort":1,"viewCount":9,"voteCount":4},{"ebookId":2,"id":123355236525019136,"name":"文档2.1","parent":122746345772683264,"sort":1,"viewCount":7,"voteCount":5},{"ebookId":2,"id":124191156778176512,"name":"文档3","parent":0,"sort":1,"viewCount":2,"voteCount":2},{"ebookId":2,"id":123355187095146496,"name":"文档1.2","parent":9,"sort":2,"viewCount":7,"voteCount":4},{"ebookId":2,"id":124191201023889408,"name":"文档3.1","parent":124191156778176512,"sort":2,"viewCount":3,"voteCount":3},{"ebookId":2,"id":124191230128164864,"name":"文档3.2","parent":124191156778176512,"sort":3,"viewCount":1,"voteCount":1}],"success":true}
2021-12-14 15:19:35.733 INFO  com.aspect.LogAspect                              :93   [32m125859215985217536[0;39m ------------- 结束 耗时：291 ms -------------
2021-12-14 15:19:35.773 INFO  com.aspect.LogAspect                              :54   [32m125859217373532160[0;39m ------------- 开始 -------------
2021-12-14 15:19:35.774 INFO  com.aspect.LogAspect                              :55   [32m125859217373532160[0;39m 请求地址: http://localhost:8081/doc/find-content/9 GET
2021-12-14 15:19:35.775 INFO  com.aspect.LogAspect                              :56   [32m125859217373532160[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:35.775 INFO  com.aspect.LogAspect                              :57   [32m125859217373532160[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:35.775 INFO  com.aspect.LogAspect                              :80   [32m125859217373532160[0;39m 请求参数: [9]
2021-12-14 15:19:35.776 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859217373532160[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:35.776 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859217373532160[0;39m ==> Parameters: 9(Long)
2021-12-14 15:19:35.869 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859217373532160[0;39m <==      Total: 0
2021-12-14 15:19:35.873 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859217373532160[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:35.874 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859217373532160[0;39m ==> Parameters: 9(Long)
2021-12-14 15:19:36.036 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859217373532160[0;39m <==    Updates: 1
2021-12-14 15:19:36.036 INFO  com.aspect.LogAspect                              :92   [32m125859217373532160[0;39m 返回结果: {"content":"","success":true}
2021-12-14 15:19:36.037 INFO  com.aspect.LogAspect                              :93   [32m125859217373532160[0;39m ------------- 结束 耗时：264 ms -------------
2021-12-14 15:19:36.634 INFO  com.aspect.LogAspect                              :54   [32m125859220984827904[0;39m ------------- 开始 -------------
2021-12-14 15:19:36.636 INFO  com.aspect.LogAspect                              :55   [32m125859220984827904[0;39m 请求地址: http://localhost:8081/doc/find-content/123355131981991936 GET
2021-12-14 15:19:36.636 INFO  com.aspect.LogAspect                              :56   [32m125859220984827904[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:36.637 INFO  com.aspect.LogAspect                              :57   [32m125859220984827904[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:36.637 INFO  com.aspect.LogAspect                              :80   [32m125859220984827904[0;39m 请求参数: [123355131981991936]
2021-12-14 15:19:36.721 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859220984827904[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:36.721 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859220984827904[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-14 15:19:36.806 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859220984827904[0;39m <==    Columns: id, content
2021-12-14 15:19:36.806 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859220984827904[0;39m <==        Row: 123355131981991936, <<BLOB>>
2021-12-14 15:19:36.813 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859220984827904[0;39m <==      Total: 1
2021-12-14 15:19:36.820 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859220984827904[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:36.822 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859220984827904[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-14 15:19:36.985 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859220984827904[0;39m <==    Updates: 1
2021-12-14 15:19:36.989 INFO  com.aspect.LogAspect                              :92   [32m125859220984827904[0;39m 返回结果: {"content":"","success":true}
2021-12-14 15:19:36.990 INFO  com.aspect.LogAspect                              :93   [32m125859220984827904[0;39m ------------- 结束 耗时：356 ms -------------
2021-12-14 15:19:38.409 INFO  com.aspect.LogAspect                              :54   [32m125859228429717504[0;39m ------------- 开始 -------------
2021-12-14 15:19:38.409 INFO  com.aspect.LogAspect                              :55   [32m125859228429717504[0;39m 请求地址: http://localhost:8081/doc/find-content/124191201023889408 GET
2021-12-14 15:19:38.409 INFO  com.aspect.LogAspect                              :56   [32m125859228429717504[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:38.409 INFO  com.aspect.LogAspect                              :57   [32m125859228429717504[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:38.409 INFO  com.aspect.LogAspect                              :80   [32m125859228429717504[0;39m 请求参数: [124191201023889408]
2021-12-14 15:19:38.499 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859228429717504[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:38.502 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859228429717504[0;39m ==> Parameters: 124191201023889408(Long)
2021-12-14 15:19:38.583 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859228429717504[0;39m <==    Columns: id, content
2021-12-14 15:19:38.585 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859228429717504[0;39m <==        Row: 124191201023889408, <<BLOB>>
2021-12-14 15:19:38.588 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859228429717504[0;39m <==      Total: 1
2021-12-14 15:19:38.591 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859228429717504[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:38.591 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859228429717504[0;39m ==> Parameters: 124191201023889408(Long)
2021-12-14 15:19:38.768 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859228429717504[0;39m <==    Updates: 1
2021-12-14 15:19:38.772 INFO  com.aspect.LogAspect                              :92   [32m125859228429717504[0;39m 返回结果: {"content":"","success":true}
2021-12-14 15:19:38.774 INFO  com.aspect.LogAspect                              :93   [32m125859228429717504[0;39m ------------- 结束 耗时：365 ms -------------
2021-12-14 15:19:39.228 INFO  com.aspect.LogAspect                              :54   [32m125859231864852480[0;39m ------------- 开始 -------------
2021-12-14 15:19:39.228 INFO  com.aspect.LogAspect                              :55   [32m125859231864852480[0;39m 请求地址: http://localhost:8081/doc/vote/124191201023889408 GET
2021-12-14 15:19:39.228 INFO  com.aspect.LogAspect                              :56   [32m125859231864852480[0;39m 类名方法: com.controller.DocController.vote
2021-12-14 15:19:39.229 INFO  com.aspect.LogAspect                              :57   [32m125859231864852480[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:39.229 INFO  com.aspect.LogAspect                              :80   [32m125859231864852480[0;39m 请求参数: [124191201023889408]
2021-12-14 15:19:40.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125859235119632384[0;39m 生成今日电子书快照开始
2021-12-14 15:19:40.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859235119632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:40.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859235119632384[0;39m ==> Parameters: 
2021-12-14 15:19:40.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859235119632384[0;39m <==    Updates: 0
2021-12-14 15:19:40.273 INFO  com.job.EbookSnapshotJob                          :35   [32m125859235119632384[0;39m 生成今日电子书快照结束，耗时：269毫秒
2021-12-14 15:19:40.941 INFO  com.Util.RedisUtil                                :31   [32m125859231864852480[0;39m key不存在，放入：DOC_VOTE_124191201023889408_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-14 15:19:41.092 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859231864852480[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-14 15:19:41.094 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859231864852480[0;39m ==> Parameters: 124191201023889408(Long)
2021-12-14 15:19:41.229 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859231864852480[0;39m <==    Updates: 1
2021-12-14 15:19:41.231 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859231864852480[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-14 15:19:41.232 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859231864852480[0;39m ==> Parameters: 124191201023889408(Long)
2021-12-14 15:19:41.304 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859231864852480[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:19:41.304 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859231864852480[0;39m <==        Row: 124191201023889408, 2, 124191156778176512, 文档3.1, 2, 4, 4
2021-12-14 15:19:41.304 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859231864852480[0;39m <==      Total: 1
2021-12-14 15:19:41.311 INFO  com.aspect.LogAspect                              :92   [32m125859231864852480[0;39m 返回结果: {"success":true}
2021-12-14 15:19:41.311 INFO  com.aspect.LogAspect                              :93   [32m125859231864852480[0;39m ------------- 结束 耗时：2083 ms -------------
2021-12-14 15:19:41.364 INFO  com.websocket.WebSocketServer                     :71   [32m125859231864852480[0;39m 推送消息：w0OLY3auBl，内容：【文档3.1】被点赞！
2021-12-14 15:19:43.648 INFO  com.aspect.LogAspect                              :54   [32m125859250403676160[0;39m ------------- 开始 -------------
2021-12-14 15:19:43.649 INFO  com.aspect.LogAspect                              :55   [32m125859250403676160[0;39m 请求地址: http://localhost:8081/doc/find-content/124191230128164864 GET
2021-12-14 15:19:43.649 INFO  com.aspect.LogAspect                              :56   [32m125859250403676160[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:43.650 INFO  com.aspect.LogAspect                              :57   [32m125859250403676160[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:43.650 INFO  com.aspect.LogAspect                              :80   [32m125859250403676160[0;39m 请求参数: [124191230128164864]
2021-12-14 15:19:43.749 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859250403676160[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:43.749 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859250403676160[0;39m ==> Parameters: 124191230128164864(Long)
2021-12-14 15:19:43.829 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859250403676160[0;39m <==    Columns: id, content
2021-12-14 15:19:43.831 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859250403676160[0;39m <==        Row: 124191230128164864, <<BLOB>>
2021-12-14 15:19:43.833 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859250403676160[0;39m <==      Total: 1
2021-12-14 15:19:43.836 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859250403676160[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:43.838 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859250403676160[0;39m ==> Parameters: 124191230128164864(Long)
2021-12-14 15:19:44.009 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859250403676160[0;39m <==    Updates: 1
2021-12-14 15:19:44.014 INFO  com.aspect.LogAspect                              :92   [32m125859250403676160[0;39m 返回结果: {"content":"","success":true}
2021-12-14 15:19:44.014 INFO  com.aspect.LogAspect                              :93   [32m125859250403676160[0;39m ------------- 结束 耗时：366 ms -------------
2021-12-14 15:19:44.833 INFO  com.aspect.LogAspect                              :54   [32m125859255373926400[0;39m ------------- 开始 -------------
2021-12-14 15:19:44.833 INFO  com.aspect.LogAspect                              :55   [32m125859255373926400[0;39m 请求地址: http://localhost:8081/doc/vote/124191230128164864 GET
2021-12-14 15:19:44.833 INFO  com.aspect.LogAspect                              :56   [32m125859255373926400[0;39m 类名方法: com.controller.DocController.vote
2021-12-14 15:19:44.833 INFO  com.aspect.LogAspect                              :57   [32m125859255373926400[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:44.833 INFO  com.aspect.LogAspect                              :80   [32m125859255373926400[0;39m 请求参数: [124191230128164864]
2021-12-14 15:19:44.887 INFO  com.Util.RedisUtil                                :31   [32m125859255373926400[0;39m key不存在，放入：DOC_VOTE_124191230128164864_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-14 15:19:45.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125859256103735296[0;39m 生成今日电子书快照开始
2021-12-14 15:19:45.049 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859255373926400[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-14 15:19:45.049 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859255373926400[0;39m ==> Parameters: 124191230128164864(Long)
2021-12-14 15:19:45.126 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859256103735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:45.130 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859256103735296[0;39m ==> Parameters: 
2021-12-14 15:19:45.198 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859255373926400[0;39m <==    Updates: 1
2021-12-14 15:19:45.199 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859255373926400[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-14 15:19:45.199 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859255373926400[0;39m ==> Parameters: 124191230128164864(Long)
2021-12-14 15:19:45.271 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859255373926400[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:19:45.272 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859255373926400[0;39m <==        Row: 124191230128164864, 2, 124191156778176512, 文档3.2, 3, 2, 2
2021-12-14 15:19:45.276 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859255373926400[0;39m <==      Total: 1
2021-12-14 15:19:45.277 INFO  com.aspect.LogAspect                              :92   [32m125859255373926400[0;39m 返回结果: {"success":true}
2021-12-14 15:19:45.277 INFO  com.aspect.LogAspect                              :93   [32m125859255373926400[0;39m ------------- 结束 耗时：444 ms -------------
2021-12-14 15:19:45.282 INFO  com.websocket.WebSocketServer                     :71   [32m125859255373926400[0;39m 推送消息：w0OLY3auBl，内容：【文档3.2】被点赞！
2021-12-14 15:19:45.303 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859256103735296[0;39m <==    Updates: 0
2021-12-14 15:19:45.304 INFO  com.job.EbookSnapshotJob                          :35   [32m125859256103735296[0;39m 生成今日电子书快照结束，耗时：296毫秒
2021-12-14 15:19:46.952 INFO  com.aspect.LogAspect                              :54   [32m125859264261656576[0;39m ------------- 开始 -------------
2021-12-14 15:19:46.954 INFO  com.aspect.LogAspect                              :55   [32m125859264261656576[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:19:46.954 INFO  com.aspect.LogAspect                              :56   [32m125859264261656576[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:19:46.954 INFO  com.aspect.LogAspect                              :57   [32m125859264261656576[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:46.954 INFO  com.aspect.LogAspect                              :54   [32m125859264270045184[0;39m ------------- 开始 -------------
2021-12-14 15:19:46.955 INFO  com.aspect.LogAspect                              :80   [32m125859264261656576[0;39m 请求参数: []
2021-12-14 15:19:46.955 INFO  com.aspect.LogAspect                              :55   [32m125859264270045184[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:19:46.955 INFO  com.aspect.LogAspect                              :56   [32m125859264270045184[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:19:46.955 INFO  com.aspect.LogAspect                              :57   [32m125859264270045184[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:46.955 INFO  com.aspect.LogAspect                              :80   [32m125859264270045184[0;39m 请求参数: []
2021-12-14 15:19:46.958 INFO  com.aspect.LogAspect                              :54   [32m125859264286822400[0;39m ------------- 开始 -------------
2021-12-14 15:19:46.959 INFO  com.aspect.LogAspect                              :55   [32m125859264286822400[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:19:46.959 INFO  com.aspect.LogAspect                              :56   [32m125859264286822400[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:19:46.959 INFO  com.aspect.LogAspect                              :57   [32m125859264286822400[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:46.959 INFO  com.aspect.LogAspect                              :80   [32m125859264286822400[0;39m 请求参数: []
2021-12-14 15:19:47.033 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859264270045184[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:19:47.033 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859264286822400[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:19:47.033 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859264261656576[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:19:47.034 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859264286822400[0;39m ==> Parameters: 
2021-12-14 15:19:47.035 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859264261656576[0;39m ==> Parameters: 
2021-12-14 15:19:47.035 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859264270045184[0;39m ==> Parameters: 
2021-12-14 15:19:47.119 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:19:47.119 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:19:47.121 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:19:47.123 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:19:47.124 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859264270045184[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:19:47.124 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859264261656576[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:19:47.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:19:47.124 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859264270045184[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:19:47.124 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859264261656576[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:19:47.133 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:19:47.133 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:19:47.133 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859264270045184[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:19:47.133 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859264261656576[0;39m <==        Row: 2021-12-14, 483, 160, 0, 0
2021-12-14 15:19:47.133 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:19:47.133 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859264270045184[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:19:47.133 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859264261656576[0;39m <==      Total: 2
2021-12-14 15:19:47.133 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:19:47.139 INFO  com.aspect.LogAspect                              :92   [32m125859264261656576[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":483,"viewIncrease":0,"voteCount":160,"voteIncrease":0}],"success":true}
2021-12-14 15:19:47.141 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:19:47.142 INFO  com.aspect.LogAspect                              :93   [32m125859264261656576[0;39m ------------- 结束 耗时：190 ms -------------
2021-12-14 15:19:47.142 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859264270045184[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:19:47.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:19:47.143 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859264270045184[0;39m <==      Total: 4
2021-12-14 15:19:47.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:19:47.143 INFO  com.aspect.LogAspect                              :92   [32m125859264270045184[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:19:47.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:19:47.143 INFO  com.aspect.LogAspect                              :93   [32m125859264270045184[0;39m ------------- 结束 耗时：189 ms -------------
2021-12-14 15:19:47.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:19:47.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859264286822400[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:19:47.143 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859264286822400[0;39m <==      Total: 19
2021-12-14 15:19:47.159 INFO  com.aspect.LogAspect                              :92   [32m125859264286822400[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:19:47.161 INFO  com.aspect.LogAspect                              :93   [32m125859264286822400[0;39m ------------- 结束 耗时：203 ms -------------
2021-12-14 15:19:50.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125859277100421120[0;39m 生成今日电子书快照开始
2021-12-14 15:19:50.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859277100421120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:50.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859277100421120[0;39m ==> Parameters: 
2021-12-14 15:19:50.283 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859277100421120[0;39m <==    Updates: 0
2021-12-14 15:19:50.284 INFO  com.job.EbookSnapshotJob                          :35   [32m125859277100421120[0;39m 生成今日电子书快照结束，耗时：270毫秒
2021-12-14 15:19:52.088 INFO  com.aspect.LogAspect                              :54   [32m125859285803601920[0;39m ------------- 开始 -------------
2021-12-14 15:19:52.088 INFO  com.aspect.LogAspect                              :55   [32m125859285803601920[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:19:52.088 INFO  com.aspect.LogAspect                              :56   [32m125859285803601920[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:19:52.088 INFO  com.aspect.LogAspect                              :57   [32m125859285803601920[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:52.088 INFO  com.aspect.LogAspect                              :80   [32m125859285803601920[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2021-12-14 15:19:52.170 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859285803601920[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:19:52.173 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859285803601920[0;39m ==> Parameters: 201(Long)
2021-12-14 15:19:52.343 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859285803601920[0;39m <==    Columns: count(0)
2021-12-14 15:19:52.344 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859285803601920[0;39m <==        Row: 0
2021-12-14 15:19:52.345 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859285803601920[0;39m <==      Total: 1
2021-12-14 15:19:52.345 INFO  com.servicess.EbookService                        :48   [32m125859285803601920[0;39m 总行数：0
2021-12-14 15:19:52.345 INFO  com.servicess.EbookService                        :49   [32m125859285803601920[0;39m 总页数：0
2021-12-14 15:19:52.350 INFO  com.aspect.LogAspect                              :92   [32m125859285803601920[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-12-14 15:19:52.351 INFO  com.aspect.LogAspect                              :93   [32m125859285803601920[0;39m ------------- 结束 耗时：263 ms -------------
2021-12-14 15:19:53.920 INFO  com.aspect.LogAspect                              :54   [32m125859293487566848[0;39m ------------- 开始 -------------
2021-12-14 15:19:53.921 INFO  com.aspect.LogAspect                              :55   [32m125859293487566848[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:19:53.922 INFO  com.aspect.LogAspect                              :56   [32m125859293487566848[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:19:53.923 INFO  com.aspect.LogAspect                              :57   [32m125859293487566848[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:53.924 INFO  com.aspect.LogAspect                              :80   [32m125859293487566848[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2021-12-14 15:19:54.054 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859293487566848[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:19:54.056 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859293487566848[0;39m ==> Parameters: 202(Long)
2021-12-14 15:19:54.126 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859293487566848[0;39m <==    Columns: count(0)
2021-12-14 15:19:54.127 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125859293487566848[0;39m <==        Row: 1
2021-12-14 15:19:54.127 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125859293487566848[0;39m <==      Total: 1
2021-12-14 15:19:54.127 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859293487566848[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-14 15:19:54.133 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859293487566848[0;39m ==> Parameters: 202(Long), 1000(Integer)
2021-12-14 15:19:54.279 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125859293487566848[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:19:54.280 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125859293487566848[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 89, 13
2021-12-14 15:19:54.282 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125859293487566848[0;39m <==      Total: 1
2021-12-14 15:19:54.284 INFO  com.servicess.EbookService                        :48   [32m125859293487566848[0;39m 总行数：1
2021-12-14 15:19:54.285 INFO  com.servicess.EbookService                        :49   [32m125859293487566848[0;39m 总页数：1
2021-12-14 15:19:54.288 INFO  com.aspect.LogAspect                              :92   [32m125859293487566848[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":89,"voteCount":13}],"total":1},"success":true}
2021-12-14 15:19:54.288 INFO  com.aspect.LogAspect                              :93   [32m125859293487566848[0;39m ------------- 结束 耗时：368 ms -------------
2021-12-14 15:19:55.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125859298071941120[0;39m 生成今日电子书快照开始
2021-12-14 15:19:55.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859298071941120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:19:55.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859298071941120[0;39m ==> Parameters: 
2021-12-14 15:19:55.271 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859298071941120[0;39m <==    Updates: 0
2021-12-14 15:19:55.272 INFO  com.job.EbookSnapshotJob                          :35   [32m125859298071941120[0;39m 生成今日电子书快照结束，耗时：259毫秒
2021-12-14 15:19:55.565 INFO  com.aspect.LogAspect                              :54   [32m125859300387196928[0;39m ------------- 开始 -------------
2021-12-14 15:19:55.565 INFO  com.aspect.LogAspect                              :55   [32m125859300387196928[0;39m 请求地址: http://localhost:8081/doc/all/1 GET
2021-12-14 15:19:55.566 INFO  com.aspect.LogAspect                              :56   [32m125859300387196928[0;39m 类名方法: com.controller.DocController.all
2021-12-14 15:19:55.566 INFO  com.aspect.LogAspect                              :57   [32m125859300387196928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:55.566 INFO  com.aspect.LogAspect                              :80   [32m125859300387196928[0;39m 请求参数: [1]
2021-12-14 15:19:55.644 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859300387196928[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-14 15:19:55.644 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859300387196928[0;39m ==> Parameters: 1(Long)
2021-12-14 15:19:55.753 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 1, 1, 119304585604108288, 文档1, 1, 14, 2
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 12, 3
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 8, 2
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 118617791401168896, 1, 5, 文档2.2.1, 1, 14, 2
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 18, 2
2021-12-14 15:19:55.755 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 3, 1, 0, 文档2, 2, 10, 1
2021-12-14 15:19:55.769 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125859300387196928[0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 13, 1
2021-12-14 15:19:55.769 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125859300387196928[0;39m <==      Total: 7
2021-12-14 15:19:55.777 INFO  com.aspect.LogAspect                              :92   [32m125859300387196928[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"文档1","parent":119304585604108288,"sort":1,"viewCount":14,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":12,"voteCount":3},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":8,"voteCount":2},{"ebookId":1,"id":118617791401168896,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":14,"voteCount":2},{"ebookId":1,"id":119304585604108288,"name":"Ant Design of Vue","parent":0,"sort":1,"viewCount":18,"voteCount":2},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":10,"voteCount":1},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":13,"voteCount":1}],"success":true}
2021-12-14 15:19:55.777 INFO  com.aspect.LogAspect                              :93   [32m125859300387196928[0;39m ------------- 结束 耗时：212 ms -------------
2021-12-14 15:19:55.854 INFO  com.aspect.LogAspect                              :54   [32m125859301599350784[0;39m ------------- 开始 -------------
2021-12-14 15:19:55.854 INFO  com.aspect.LogAspect                              :55   [32m125859301599350784[0;39m 请求地址: http://localhost:8081/doc/find-content/119304585604108288 GET
2021-12-14 15:19:55.854 INFO  com.aspect.LogAspect                              :56   [32m125859301599350784[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:55.854 INFO  com.aspect.LogAspect                              :57   [32m125859301599350784[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:55.854 INFO  com.aspect.LogAspect                              :80   [32m125859301599350784[0;39m 请求参数: [119304585604108288]
2021-12-14 15:19:55.862 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859301599350784[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:55.864 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859301599350784[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:19:55.949 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859301599350784[0;39m <==    Columns: id, content
2021-12-14 15:19:55.957 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859301599350784[0;39m <==        Row: 119304585604108288, <<BLOB>>
2021-12-14 15:19:55.959 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859301599350784[0;39m <==      Total: 1
2021-12-14 15:19:55.960 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859301599350784[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:55.960 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859301599350784[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:19:56.136 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859301599350784[0;39m <==    Updates: 1
2021-12-14 15:19:56.137 INFO  com.aspect.LogAspect                              :92   [32m125859301599350784[0;39m 返回结果: {"content":"<blockquote><h1><b id=\"9lkez\"><font face=\"微软雅黑\">Ant Design of Vue</font></b></h1><p>这里是 Ant Design 的 Vue 实现，开发和服务于企业级后台<font face=\"标楷体\"></font>产品。</p></blockquote>","success":true}
2021-12-14 15:19:56.137 INFO  com.aspect.LogAspect                              :93   [32m125859301599350784[0;39m ------------- 结束 耗时：283 ms -------------
2021-12-14 15:19:58.054 INFO  com.aspect.LogAspect                              :54   [32m125859310826819584[0;39m ------------- 开始 -------------
2021-12-14 15:19:58.055 INFO  com.aspect.LogAspect                              :55   [32m125859310826819584[0;39m 请求地址: http://localhost:8081/doc/vote/119304585604108288 GET
2021-12-14 15:19:58.055 INFO  com.aspect.LogAspect                              :56   [32m125859310826819584[0;39m 类名方法: com.controller.DocController.vote
2021-12-14 15:19:58.055 INFO  com.aspect.LogAspect                              :57   [32m125859310826819584[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:58.055 INFO  com.aspect.LogAspect                              :80   [32m125859310826819584[0;39m 请求参数: [119304585604108288]
2021-12-14 15:19:58.105 INFO  com.Util.RedisUtil                                :31   [32m125859310826819584[0;39m key不存在，放入：DOC_VOTE_119304585604108288_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-14 15:19:58.228 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859310826819584[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-14 15:19:58.230 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859310826819584[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:19:58.376 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859310826819584[0;39m <==    Updates: 1
2021-12-14 15:19:58.377 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859310826819584[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-14 15:19:58.379 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859310826819584[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:19:58.456 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859310826819584[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:19:58.457 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859310826819584[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 19, 3
2021-12-14 15:19:58.457 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859310826819584[0;39m <==      Total: 1
2021-12-14 15:19:58.461 INFO  com.aspect.LogAspect                              :92   [32m125859310826819584[0;39m 返回结果: {"success":true}
2021-12-14 15:19:58.463 INFO  com.aspect.LogAspect                              :93   [32m125859310826819584[0;39m ------------- 结束 耗时：409 ms -------------
2021-12-14 15:19:58.470 INFO  com.websocket.WebSocketServer                     :71   [32m125859310826819584[0;39m 推送消息：w0OLY3auBl，内容：【Ant Design of Vue】被点赞！
2021-12-14 15:19:59.251 INFO  com.aspect.LogAspect                              :54   [32m125859315847401472[0;39m ------------- 开始 -------------
2021-12-14 15:19:59.251 INFO  com.aspect.LogAspect                              :55   [32m125859315847401472[0;39m 请求地址: http://localhost:8081/doc/find-content/2 GET
2021-12-14 15:19:59.251 INFO  com.aspect.LogAspect                              :56   [32m125859315847401472[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:19:59.251 INFO  com.aspect.LogAspect                              :57   [32m125859315847401472[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:19:59.251 INFO  com.aspect.LogAspect                              :80   [32m125859315847401472[0;39m 请求参数: [2]
2021-12-14 15:19:59.331 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859315847401472[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:19:59.333 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859315847401472[0;39m ==> Parameters: 2(Long)
2021-12-14 15:19:59.417 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859315847401472[0;39m <==    Columns: id, content
2021-12-14 15:19:59.418 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125859315847401472[0;39m <==        Row: 2, <<BLOB>>
2021-12-14 15:19:59.419 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125859315847401472[0;39m <==      Total: 1
2021-12-14 15:19:59.422 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859315847401472[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:19:59.423 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859315847401472[0;39m ==> Parameters: 2(Long)
2021-12-14 15:19:59.599 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125859315847401472[0;39m <==    Updates: 1
2021-12-14 15:19:59.599 INFO  com.aspect.LogAspect                              :92   [32m125859315847401472[0;39m 返回结果: {"content":"<p>123456</p>","success":true}
2021-12-14 15:19:59.604 INFO  com.aspect.LogAspect                              :93   [32m125859315847401472[0;39m ------------- 结束 耗时：348 ms -------------
2021-12-14 15:20:00.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125859319043461120[0;39m 生成今日电子书快照开始
2021-12-14 15:20:00.115 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859319043461120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:00.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859319043461120[0;39m ==> Parameters: 
2021-12-14 15:20:00.293 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859319043461120[0;39m <==    Updates: 0
2021-12-14 15:20:00.295 INFO  com.job.EbookSnapshotJob                          :35   [32m125859319043461120[0;39m 生成今日电子书快照结束，耗时：280毫秒
2021-12-14 15:20:00.440 INFO  com.aspect.LogAspect                              :54   [32m125859320834428928[0;39m ------------- 开始 -------------
2021-12-14 15:20:00.440 INFO  com.aspect.LogAspect                              :55   [32m125859320834428928[0;39m 请求地址: http://localhost:8081/doc/vote/2 GET
2021-12-14 15:20:00.440 INFO  com.aspect.LogAspect                              :56   [32m125859320834428928[0;39m 类名方法: com.controller.DocController.vote
2021-12-14 15:20:00.440 INFO  com.aspect.LogAspect                              :57   [32m125859320834428928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:00.440 INFO  com.aspect.LogAspect                              :80   [32m125859320834428928[0;39m 请求参数: [2]
2021-12-14 15:20:00.497 INFO  com.Util.RedisUtil                                :31   [32m125859320834428928[0;39m key不存在，放入：DOC_VOTE_2_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-14 15:20:00.629 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859320834428928[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-14 15:20:00.632 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859320834428928[0;39m ==> Parameters: 2(Long)
2021-12-14 15:20:00.778 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125859320834428928[0;39m <==    Updates: 1
2021-12-14 15:20:00.781 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859320834428928[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-14 15:20:00.783 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859320834428928[0;39m ==> Parameters: 2(Long)
2021-12-14 15:20:00.897 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859320834428928[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:20:00.898 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125859320834428928[0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 13, 4
2021-12-14 15:20:00.898 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125859320834428928[0;39m <==      Total: 1
2021-12-14 15:20:00.898 INFO  com.aspect.LogAspect                              :92   [32m125859320834428928[0;39m 返回结果: {"success":true}
2021-12-14 15:20:00.898 INFO  com.aspect.LogAspect                              :93   [32m125859320834428928[0;39m ------------- 结束 耗时：458 ms -------------
2021-12-14 15:20:00.898 INFO  com.websocket.WebSocketServer                     :71   [32m125859320834428928[0;39m 推送消息：w0OLY3auBl，内容：【文档1.1】被点赞！
2021-12-14 15:20:05.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125859339973038080[0;39m 生成今日电子书快照开始
2021-12-14 15:20:05.107 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859339973038080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:05.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859339973038080[0;39m ==> Parameters: 
2021-12-14 15:20:05.281 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859339973038080[0;39m <==    Updates: 0
2021-12-14 15:20:05.283 INFO  com.job.EbookSnapshotJob                          :35   [32m125859339973038080[0;39m 生成今日电子书快照结束，耗时：278毫秒
2021-12-14 15:20:05.286 INFO  com.job.DocJob                                    :32   [32m125859341155831808[0;39m 更新电子书下的文档数据开始
2021-12-14 15:20:05.287 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859341155831808[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 15:20:05.289 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859341155831808[0;39m ==> Parameters: 
2021-12-14 15:20:05.453 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859341155831808[0;39m <==    Updates: 3
2021-12-14 15:20:05.454 INFO  com.job.DocJob                                    :35   [32m125859341155831808[0;39m 更新电子书下的文档数据结束，耗时：167毫秒
2021-12-14 15:20:06.852 INFO  com.aspect.LogAspect                              :54   [32m125859347728306176[0;39m ------------- 开始 -------------
2021-12-14 15:20:06.852 INFO  com.aspect.LogAspect                              :55   [32m125859347728306176[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:20:06.852 INFO  com.aspect.LogAspect                              :54   [32m125859347728306177[0;39m ------------- 开始 -------------
2021-12-14 15:20:06.852 INFO  com.aspect.LogAspect                              :56   [32m125859347728306176[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :55   [32m125859347728306177[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :57   [32m125859347728306176[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :56   [32m125859347728306177[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :80   [32m125859347728306176[0;39m 请求参数: []
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :57   [32m125859347728306177[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:06.853 INFO  com.aspect.LogAspect                              :80   [32m125859347728306177[0;39m 请求参数: []
2021-12-14 15:20:06.855 INFO  com.aspect.LogAspect                              :54   [32m125859347740889088[0;39m ------------- 开始 -------------
2021-12-14 15:20:06.856 INFO  com.aspect.LogAspect                              :55   [32m125859347740889088[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:20:06.856 INFO  com.aspect.LogAspect                              :56   [32m125859347740889088[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:20:06.856 INFO  com.aspect.LogAspect                              :57   [32m125859347740889088[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:06.856 INFO  com.aspect.LogAspect                              :80   [32m125859347740889088[0;39m 请求参数: []
2021-12-14 15:20:06.917 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859347728306176[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:20:06.918 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859347728306176[0;39m ==> Parameters: 
2021-12-14 15:20:06.938 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859347740889088[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:20:06.938 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859347728306177[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:20:06.938 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859347740889088[0;39m ==> Parameters: 
2021-12-14 15:20:06.939 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859347728306177[0;39m ==> Parameters: 
2021-12-14 15:20:06.999 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859347728306176[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:20:07.009 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859347728306176[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:20:07.012 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859347728306176[0;39m <==        Row: 2021-12-14, 483, 160, 0, 0
2021-12-14 15:20:07.015 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859347728306176[0;39m <==      Total: 2
2021-12-14 15:20:07.017 INFO  com.aspect.LogAspect                              :92   [32m125859347728306176[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":483,"viewIncrease":0,"voteCount":160,"voteIncrease":0}],"success":true}
2021-12-14 15:20:07.018 INFO  com.aspect.LogAspect                              :93   [32m125859347728306176[0;39m ------------- 结束 耗时：166 ms -------------
2021-12-14 15:20:07.025 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859347728306177[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:20:07.025 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:20:07.026 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:20:07.027 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859347728306177[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:20:07.028 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:20:07.029 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:20:07.029 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859347728306177[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:20:07.030 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:20:07.031 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:20:07.032 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:20:07.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:20:07.033 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859347728306177[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:20:07.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:20:07.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:20:07.037 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:20:07.038 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:20:07.038 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859347728306177[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:20:07.038 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:20:07.038 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859347728306177[0;39m <==      Total: 4
2021-12-14 15:20:07.038 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:20:07.038 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:20:07.038 INFO  com.aspect.LogAspect                              :92   [32m125859347728306177[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:20:07.038 INFO  com.aspect.LogAspect                              :93   [32m125859347728306177[0;39m ------------- 结束 耗时：186 ms -------------
2021-12-14 15:20:07.038 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:20:07.049 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:20:07.053 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:20:07.055 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:20:07.056 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859347740889088[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:20:07.057 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859347740889088[0;39m <==      Total: 19
2021-12-14 15:20:07.100 INFO  com.aspect.LogAspect                              :92   [32m125859347740889088[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:20:07.100 INFO  com.aspect.LogAspect                              :93   [32m125859347740889088[0;39m ------------- 结束 耗时：245 ms -------------
2021-12-14 15:20:10.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125859360944558080[0;39m 生成今日电子书快照开始
2021-12-14 15:20:10.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859360944558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:10.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859360944558080[0;39m ==> Parameters: 
2021-12-14 15:20:10.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859360944558080[0;39m <==    Updates: 0
2021-12-14 15:20:10.234 INFO  com.job.EbookSnapshotJob                          :35   [32m125859360944558080[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-14 15:20:12.647 INFO  com.websocket.WebSocketServer                     :41   [32m125859285803601920[0;39m 连接关闭，token：w0OLY3auBl，session id：0！当前连接数：0
2021-12-14 15:20:15.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125859381941243904[0;39m 生成今日电子书快照开始
2021-12-14 15:20:15.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859381941243904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:15.118 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859381941243904[0;39m ==> Parameters: 
2021-12-14 15:20:15.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859381941243904[0;39m <==    Updates: 0
2021-12-14 15:20:15.265 INFO  com.job.EbookSnapshotJob                          :35   [32m125859381941243904[0;39m 生成今日电子书快照结束，耗时：256毫秒
2021-12-14 15:20:20.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125859402891792384[0;39m 生成今日电子书快照开始
2021-12-14 15:20:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859402891792384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:20.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859402891792384[0;39m ==> Parameters: 
2021-12-14 15:20:20.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859402891792384[0;39m <==    Updates: 0
2021-12-14 15:20:20.250 INFO  com.job.EbookSnapshotJob                          :35   [32m125859402891792384[0;39m 生成今日电子书快照结束，耗时：246毫秒
2021-12-14 15:20:24.505 INFO  com.websocket.WebSocketServer                     :32   [32m125859293487566848[0;39m 有新连接：token：Lkx5mxxX76，session id：1，当前连接数：1
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :54   [32m125859422936371200[0;39m ------------- 开始 -------------
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :55   [32m125859422936371200[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :56   [32m125859422936371200[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :57   [32m125859422936371200[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :80   [32m125859422936371200[0;39m 请求参数: []
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :54   [32m125859422936371201[0;39m ------------- 开始 -------------
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :55   [32m125859422936371201[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :56   [32m125859422936371201[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :57   [32m125859422936371201[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :80   [32m125859422936371201[0;39m 请求参数: []
2021-12-14 15:20:24.783 INFO  com.aspect.LogAspect                              :54   [32m125859422936371202[0;39m ------------- 开始 -------------
2021-12-14 15:20:24.791 INFO  com.aspect.LogAspect                              :55   [32m125859422936371202[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:20:24.791 INFO  com.aspect.LogAspect                              :56   [32m125859422936371202[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:20:24.791 INFO  com.aspect.LogAspect                              :57   [32m125859422936371202[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:20:24.791 INFO  com.aspect.LogAspect                              :80   [32m125859422936371202[0;39m 请求参数: []
2021-12-14 15:20:24.877 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859422936371202[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:20:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859422936371200[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:20:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859422936371201[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:20:24.877 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859422936371202[0;39m ==> Parameters: 
2021-12-14 15:20:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859422936371201[0;39m ==> Parameters: 
2021-12-14 15:20:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859422936371200[0;39m ==> Parameters: 
2021-12-14 15:20:24.978 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859422936371201[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:20:24.978 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859422936371200[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:20:24.979 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:20:24.979 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859422936371200[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859422936371201[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125859422936371200[0;39m <==        Row: 2021-12-14, 489, 164, 6, 4
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859422936371201[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:20:24.980 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125859422936371200[0;39m <==      Total: 2
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859422936371201[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:20:24.980 INFO  com.aspect.LogAspect                              :92   [32m125859422936371200[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":489,"viewIncrease":6,"voteCount":164,"voteIncrease":4}],"success":true}
2021-12-14 15:20:24.980 INFO  com.aspect.LogAspect                              :93   [32m125859422936371200[0;39m ------------- 结束 耗时：197 ms -------------
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:20:24.980 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125859422936371201[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:20:24.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:20:24.980 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125859422936371201[0;39m <==      Total: 4
2021-12-14 15:20:24.988 INFO  com.aspect.LogAspect                              :92   [32m125859422936371201[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:20:24.988 INFO  com.aspect.LogAspect                              :93   [32m125859422936371201[0;39m ------------- 结束 耗时：205 ms -------------
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:20:24.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:20:24.996 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:20:24.996 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:20:24.996 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:20:24.996 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125859422936371202[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:20:24.996 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125859422936371202[0;39m <==      Total: 19
2021-12-14 15:20:25.004 INFO  com.aspect.LogAspect                              :92   [32m125859422936371202[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:20:25.004 INFO  com.aspect.LogAspect                              :93   [32m125859422936371202[0;39m ------------- 结束 耗时：221 ms -------------
2021-12-14 15:20:25.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125859423896866816[0;39m 生成今日电子书快照开始
2021-12-14 15:20:25.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859423896866816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:25.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859423896866816[0;39m ==> Parameters: 
2021-12-14 15:20:25.284 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859423896866816[0;39m <==    Updates: 0
2021-12-14 15:20:25.284 INFO  com.job.EbookSnapshotJob                          :35   [32m125859423896866816[0;39m 生成今日电子书快照结束，耗时：272毫秒
2021-12-14 15:20:30.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125859444847415296[0;39m 生成今日电子书快照开始
2021-12-14 15:20:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859444847415296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:30.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859444847415296[0;39m ==> Parameters: 
2021-12-14 15:20:30.242 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859444847415296[0;39m <==    Updates: 0
2021-12-14 15:20:30.243 INFO  com.job.EbookSnapshotJob                          :35   [32m125859444847415296[0;39m 生成今日电子书快照结束，耗时：236毫秒
2021-12-14 15:20:32.174 INFO  com.websocket.WebSocketServer                     :41   [32m125859315847401472[0;39m 连接关闭，token：Lkx5mxxX76，session id：1！当前连接数：0
2021-12-14 15:20:35.006 INFO  com.job.DocJob                                    :32   [32m125859465814740992[0;39m 更新电子书下的文档数据开始
2021-12-14 15:20:35.083 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859465814740992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 15:20:35.084 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859465814740992[0;39m ==> Parameters: 
2021-12-14 15:20:35.268 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125859465814740992[0;39m <==    Updates: 3
2021-12-14 15:20:35.269 INFO  com.job.DocJob                                    :35   [32m125859465814740992[0;39m 更新电子书下的文档数据结束，耗时：263毫秒
2021-12-14 15:20:35.270 INFO  com.job.EbookSnapshotJob                          :32   [32m125859466922037248[0;39m 生成今日电子书快照开始
2021-12-14 15:20:35.271 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859466922037248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:35.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859466922037248[0;39m ==> Parameters: 
2021-12-14 15:20:35.467 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859466922037248[0;39m <==    Updates: 0
2021-12-14 15:20:35.467 INFO  com.job.EbookSnapshotJob                          :35   [32m125859466922037248[0;39m 生成今日电子书快照结束，耗时：197毫秒
2021-12-14 15:20:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125859486798843904[0;39m 生成今日电子书快照开始
2021-12-14 15:20:40.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859486798843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:40.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859486798843904[0;39m ==> Parameters: 
2021-12-14 15:20:40.412 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859486798843904[0;39m <==    Updates: 0
2021-12-14 15:20:40.414 INFO  com.job.EbookSnapshotJob                          :35   [32m125859486798843904[0;39m 生成今日电子书快照结束，耗时：405毫秒
2021-12-14 15:20:45.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125859507753586688[0;39m 生成今日电子书快照开始
2021-12-14 15:20:45.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859507753586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:20:45.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859507753586688[0;39m ==> Parameters: 
2021-12-14 15:20:45.296 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125859507753586688[0;39m <==    Updates: 0
2021-12-14 15:20:45.296 INFO  com.job.EbookSnapshotJob                          :35   [32m125859507753586688[0;39m 生成今日电子书快照结束，耗时：291毫秒
2021-12-14 15:30:33.658 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-14 15:30:33.673 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 8392 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 15:30:33.673 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 15:30:33.747 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-14 15:30:33.747 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-14 15:30:35.329 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 15:30:35.331 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 15:30:35.912 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 573 ms. Found 0 Redis repository interfaces.
2021-12-14 15:30:36.693 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 15:30:36.696 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 15:30:36.703 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 15:30:36.703 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 15:30:36.778 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 15:30:36.778 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 3031 ms
2021-12-14 15:30:38.431 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-14 15:30:38.462 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-14 15:30:38.491 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-14 15:30:38.504 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 5.609 seconds (JVM running for 6.882)
2021-12-14 15:30:40.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125862003343495168[0;39m 生成今日电子书快照开始
2021-12-14 15:30:40.021 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125862003343495168[0;39m HikariPool-1 - Starting...
2021-12-14 15:30:41.504 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125862003343495168[0;39m HikariPool-1 - Start completed.
2021-12-14 15:30:41.512 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862003343495168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:30:41.540 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862003343495168[0;39m ==> Parameters: 
2021-12-14 15:30:41.804 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862003343495168[0;39m <==    Updates: 0
2021-12-14 15:30:41.807 INFO  com.job.EbookSnapshotJob                          :35   [32m125862003343495168[0;39m 生成今日电子书快照结束，耗时：1806毫秒
2021-12-14 15:30:45.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125862024323403776[0;39m 生成今日电子书快照开始
2021-12-14 15:30:45.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862024323403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:30:45.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862024323403776[0;39m ==> Parameters: 
2021-12-14 15:30:45.371 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862024323403776[0;39m <==    Updates: 0
2021-12-14 15:30:45.371 INFO  com.job.EbookSnapshotJob                          :35   [32m125862024323403776[0;39m 生成今日电子书快照结束，耗时：369毫秒
2021-12-14 15:30:50.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125862045299118080[0;39m 生成今日电子书快照开始
2021-12-14 15:30:50.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862045299118080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:30:50.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862045299118080[0;39m ==> Parameters: 
2021-12-14 15:30:50.312 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862045299118080[0;39m <==    Updates: 0
2021-12-14 15:30:50.312 INFO  com.job.EbookSnapshotJob                          :35   [32m125862045299118080[0;39m 生成今日电子书快照结束，耗时：309毫秒
2021-12-14 15:30:55.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125862066270638080[0;39m 生成今日电子书快照开始
2021-12-14 15:30:55.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862066270638080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:30:55.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862066270638080[0;39m ==> Parameters: 
2021-12-14 15:30:55.391 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862066270638080[0;39m <==    Updates: 0
2021-12-14 15:30:55.391 INFO  com.job.EbookSnapshotJob                          :35   [32m125862066270638080[0;39m 生成今日电子书快照结束，耗时：388毫秒
2021-12-14 15:31:00.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125862087284101120[0;39m 生成今日电子书快照开始
2021-12-14 15:31:00.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862087284101120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:00.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862087284101120[0;39m ==> Parameters: 
2021-12-14 15:31:00.109 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-14 15:31:00.109 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-14 15:31:00.110 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-14 15:31:00.146 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：tDuZALCES6，session id：0，当前连接数：1
2021-12-14 15:31:00.313 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862087284101120[0;39m <==    Updates: 0
2021-12-14 15:31:00.314 INFO  com.job.EbookSnapshotJob                          :35   [32m125862087284101120[0;39m 生成今日电子书快照结束，耗时：301毫秒
2021-12-14 15:31:00.408 INFO  com.aspect.LogAspect                              :54   [32m125862088932462594[0;39m ------------- 开始 -------------
2021-12-14 15:31:00.408 INFO  com.aspect.LogAspect                              :54   [32m125862088932462593[0;39m ------------- 开始 -------------
2021-12-14 15:31:00.408 INFO  com.aspect.LogAspect                              :54   [32m125862088932462592[0;39m ------------- 开始 -------------
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :55   [32m125862088932462594[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :55   [32m125862088932462592[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :55   [32m125862088932462593[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :56   [32m125862088932462592[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :56   [32m125862088932462594[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :56   [32m125862088932462593[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :57   [32m125862088932462594[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :57   [32m125862088932462593[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:00.409 INFO  com.aspect.LogAspect                              :57   [32m125862088932462592[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:00.444 INFO  com.aspect.LogAspect                              :80   [32m125862088932462594[0;39m 请求参数: []
2021-12-14 15:31:00.444 INFO  com.aspect.LogAspect                              :80   [32m125862088932462593[0;39m 请求参数: []
2021-12-14 15:31:00.444 INFO  com.aspect.LogAspect                              :80   [32m125862088932462592[0;39m 请求参数: []
2021-12-14 15:31:00.452 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862088932462593[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:00.453 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862088932462593[0;39m ==> Parameters: 
2021-12-14 15:31:00.533 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862088932462592[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:00.534 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862088932462592[0;39m ==> Parameters: 
2021-12-14 15:31:00.567 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862088932462594[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:00.568 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862088932462594[0;39m ==> Parameters: 
2021-12-14 15:31:00.575 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862088932462593[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:31:00.584 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862088932462593[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:31:00.588 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862088932462593[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:31:00.589 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862088932462593[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:31:00.590 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862088932462593[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:31:00.590 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862088932462593[0;39m <==      Total: 4
2021-12-14 15:31:00.607 INFO  com.aspect.LogAspect                              :92   [32m125862088932462593[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:31:00.607 INFO  com.aspect.LogAspect                              :93   [32m125862088932462593[0;39m ------------- 结束 耗时：201 ms -------------
2021-12-14 15:31:00.619 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862088932462592[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:31:00.619 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862088932462592[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:31:00.621 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862088932462592[0;39m <==        Row: 2021-12-14, 489, 164, 6, 4
2021-12-14 15:31:00.622 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862088932462592[0;39m <==      Total: 2
2021-12-14 15:31:00.622 INFO  com.aspect.LogAspect                              :92   [32m125862088932462592[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":489,"viewIncrease":6,"voteCount":164,"voteIncrease":4}],"success":true}
2021-12-14 15:31:00.622 INFO  com.aspect.LogAspect                              :93   [32m125862088932462592[0;39m ------------- 结束 耗时：216 ms -------------
2021-12-14 15:31:00.672 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:00.672 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:00.673 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:00.675 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:00.675 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:00.676 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:00.676 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:00.676 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:00.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:00.688 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:00.689 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:00.690 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862088932462594[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:00.690 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862088932462594[0;39m <==      Total: 19
2021-12-14 15:31:00.705 INFO  com.aspect.LogAspect                              :92   [32m125862088932462594[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:00.705 INFO  com.aspect.LogAspect                              :93   [32m125862088932462594[0;39m ------------- 结束 耗时：299 ms -------------
2021-12-14 15:31:05.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125862108255621120[0;39m 生成今日电子书快照开始
2021-12-14 15:31:05.166 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862108255621120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:05.167 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862108255621120[0;39m ==> Parameters: 
2021-12-14 15:31:05.443 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862108255621120[0;39m <==    Updates: 0
2021-12-14 15:31:05.444 INFO  com.job.EbookSnapshotJob                          :35   [32m125862108255621120[0;39m 生成今日电子书快照结束，耗时：428毫秒
2021-12-14 15:31:05.444 INFO  com.job.DocJob                                    :32   [32m125862110063366144[0;39m 更新电子书下的文档数据开始
2021-12-14 15:31:05.454 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862110063366144[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 15:31:05.454 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862110063366144[0;39m ==> Parameters: 
2021-12-14 15:31:05.686 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862110063366144[0;39m <==    Updates: 3
2021-12-14 15:31:05.686 INFO  com.job.DocJob                                    :35   [32m125862110063366144[0;39m 更新电子书下的文档数据结束，耗时：242毫秒
2021-12-14 15:31:06.517 INFO  com.aspect.LogAspect                              :54   [32m125862114563854336[0;39m ------------- 开始 -------------
2021-12-14 15:31:06.517 INFO  com.aspect.LogAspect                              :55   [32m125862114563854336[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:31:06.517 INFO  com.aspect.LogAspect                              :56   [32m125862114563854336[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:31:06.517 INFO  com.aspect.LogAspect                              :57   [32m125862114563854336[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:06.529 INFO  com.aspect.LogAspect                              :80   [32m125862114563854336[0;39m 请求参数: [{"categoryId2":101,"page":1,"size":1000}]
2021-12-14 15:31:06.780 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862114563854336[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:31:06.782 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862114563854336[0;39m ==> Parameters: 101(Long)
2021-12-14 15:31:06.888 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862114563854336[0;39m <==    Columns: count(0)
2021-12-14 15:31:06.889 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862114563854336[0;39m <==        Row: 1
2021-12-14 15:31:06.889 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862114563854336[0;39m <==      Total: 1
2021-12-14 15:31:06.895 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862114563854336[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-14 15:31:06.897 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862114563854336[0;39m ==> Parameters: 101(Long), 1000(Integer)
2021-12-14 15:31:07.037 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862114563854336[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:31:07.038 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862114563854336[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 15:31:07.038 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862114563854336[0;39m <==      Total: 1
2021-12-14 15:31:07.038 INFO  com.servicess.EbookService                        :48   [32m125862114563854336[0;39m 总行数：1
2021-12-14 15:31:07.038 INFO  com.servicess.EbookService                        :49   [32m125862114563854336[0;39m 总页数：1
2021-12-14 15:31:07.069 INFO  com.aspect.LogAspect                              :92   [32m125862114563854336[0;39m 返回结果: {"content":{"list":[{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26}],"total":1},"success":true}
2021-12-14 15:31:07.070 INFO  com.aspect.LogAspect                              :93   [32m125862114563854336[0;39m ------------- 结束 耗时：553 ms -------------
2021-12-14 15:31:08.345 INFO  com.aspect.LogAspect                              :54   [32m125862122231042048[0;39m ------------- 开始 -------------
2021-12-14 15:31:08.346 INFO  com.aspect.LogAspect                              :55   [32m125862122231042048[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:31:08.346 INFO  com.aspect.LogAspect                              :56   [32m125862122231042048[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:31:08.347 INFO  com.aspect.LogAspect                              :57   [32m125862122231042048[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:08.347 INFO  com.aspect.LogAspect                              :80   [32m125862122231042048[0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2021-12-14 15:31:08.487 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862122231042048[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:31:08.487 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862122231042048[0;39m ==> Parameters: 201(Long)
2021-12-14 15:31:08.614 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862122231042048[0;39m <==    Columns: count(0)
2021-12-14 15:31:08.616 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862122231042048[0;39m <==        Row: 0
2021-12-14 15:31:08.617 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862122231042048[0;39m <==      Total: 1
2021-12-14 15:31:08.617 INFO  com.servicess.EbookService                        :48   [32m125862122231042048[0;39m 总行数：0
2021-12-14 15:31:08.617 INFO  com.servicess.EbookService                        :49   [32m125862122231042048[0;39m 总页数：0
2021-12-14 15:31:08.617 INFO  com.aspect.LogAspect                              :92   [32m125862122231042048[0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-12-14 15:31:08.617 INFO  com.aspect.LogAspect                              :93   [32m125862122231042048[0;39m ------------- 结束 耗时：272 ms -------------
2021-12-14 15:31:08.848 INFO  com.aspect.LogAspect                              :54   [32m125862124340776960[0;39m ------------- 开始 -------------
2021-12-14 15:31:08.848 INFO  com.aspect.LogAspect                              :55   [32m125862124340776960[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:31:08.848 INFO  com.aspect.LogAspect                              :56   [32m125862124340776960[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:31:08.849 INFO  com.aspect.LogAspect                              :57   [32m125862124340776960[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:08.849 INFO  com.aspect.LogAspect                              :80   [32m125862124340776960[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2021-12-14 15:31:08.851 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862124340776960[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-14 15:31:08.855 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862124340776960[0;39m ==> Parameters: 202(Long)
2021-12-14 15:31:08.974 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862124340776960[0;39m <==    Columns: count(0)
2021-12-14 15:31:08.977 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862124340776960[0;39m <==        Row: 1
2021-12-14 15:31:08.979 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862124340776960[0;39m <==      Total: 1
2021-12-14 15:31:08.983 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862124340776960[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-14 15:31:08.986 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862124340776960[0;39m ==> Parameters: 202(Long), 1000(Integer)
2021-12-14 15:31:09.153 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862124340776960[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:31:09.153 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862124340776960[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 91, 15
2021-12-14 15:31:09.153 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862124340776960[0;39m <==      Total: 1
2021-12-14 15:31:09.153 INFO  com.servicess.EbookService                        :48   [32m125862124340776960[0;39m 总行数：1
2021-12-14 15:31:09.153 INFO  com.servicess.EbookService                        :49   [32m125862124340776960[0;39m 总页数：1
2021-12-14 15:31:09.153 INFO  com.aspect.LogAspect                              :92   [32m125862124340776960[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":91,"voteCount":15}],"total":1},"success":true}
2021-12-14 15:31:09.161 INFO  com.aspect.LogAspect                              :93   [32m125862124340776960[0;39m ------------- 结束 耗时：313 ms -------------
2021-12-14 15:31:10.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125862129210363904[0;39m 生成今日电子书快照开始
2021-12-14 15:31:10.130 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862129210363904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:10.134 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862129210363904[0;39m ==> Parameters: 
2021-12-14 15:31:10.354 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862129210363904[0;39m <==    Updates: 0
2021-12-14 15:31:10.354 INFO  com.job.EbookSnapshotJob                          :35   [32m125862129210363904[0;39m 生成今日电子书快照结束，耗时：344毫秒
2021-12-14 15:31:10.997 INFO  com.aspect.LogAspect                              :54   [32m125862133354336256[0;39m ------------- 开始 -------------
2021-12-14 15:31:10.997 INFO  com.aspect.LogAspect                              :55   [32m125862133354336256[0;39m 请求地址: http://localhost:8081/doc/all/1 GET
2021-12-14 15:31:10.997 INFO  com.aspect.LogAspect                              :56   [32m125862133354336256[0;39m 类名方法: com.controller.DocController.all
2021-12-14 15:31:10.997 INFO  com.aspect.LogAspect                              :57   [32m125862133354336256[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:10.997 INFO  com.aspect.LogAspect                              :80   [32m125862133354336256[0;39m 请求参数: [1]
2021-12-14 15:31:11.115 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125862133354336256[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-14 15:31:11.116 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125862133354336256[0;39m ==> Parameters: 1(Long)
2021-12-14 15:31:11.198 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:31:11.206 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 1, 1, 119304585604108288, 文档1, 1, 14, 2
2021-12-14 15:31:11.208 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 13, 4
2021-12-14 15:31:11.211 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 8, 2
2021-12-14 15:31:11.213 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 118617791401168896, 1, 5, 文档2.2.1, 1, 14, 2
2021-12-14 15:31:11.214 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 19, 3
2021-12-14 15:31:11.218 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 3, 1, 0, 文档2, 2, 10, 1
2021-12-14 15:31:11.218 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125862133354336256[0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 13, 1
2021-12-14 15:31:11.218 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125862133354336256[0;39m <==      Total: 7
2021-12-14 15:31:11.245 INFO  com.aspect.LogAspect                              :92   [32m125862133354336256[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"文档1","parent":119304585604108288,"sort":1,"viewCount":14,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":13,"voteCount":4},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":8,"voteCount":2},{"ebookId":1,"id":118617791401168896,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":14,"voteCount":2},{"ebookId":1,"id":119304585604108288,"name":"Ant Design of Vue","parent":0,"sort":1,"viewCount":19,"voteCount":3},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":10,"voteCount":1},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":13,"voteCount":1}],"success":true}
2021-12-14 15:31:11.245 INFO  com.aspect.LogAspect                              :93   [32m125862133354336256[0;39m ------------- 结束 耗时：248 ms -------------
2021-12-14 15:31:11.326 INFO  com.aspect.LogAspect                              :54   [32m125862134734262272[0;39m ------------- 开始 -------------
2021-12-14 15:31:11.334 INFO  com.aspect.LogAspect                              :55   [32m125862134734262272[0;39m 请求地址: http://localhost:8081/doc/find-content/119304585604108288 GET
2021-12-14 15:31:11.336 INFO  com.aspect.LogAspect                              :56   [32m125862134734262272[0;39m 类名方法: com.controller.DocController.findContent
2021-12-14 15:31:11.336 INFO  com.aspect.LogAspect                              :57   [32m125862134734262272[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:11.336 INFO  com.aspect.LogAspect                              :80   [32m125862134734262272[0;39m 请求参数: [119304585604108288]
2021-12-14 15:31:11.434 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125862134734262272[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-14 15:31:11.434 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125862134734262272[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:31:11.571 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125862134734262272[0;39m <==    Columns: id, content
2021-12-14 15:31:11.571 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125862134734262272[0;39m <==        Row: 119304585604108288, <<BLOB>>
2021-12-14 15:31:11.575 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125862134734262272[0;39m <==      Total: 1
2021-12-14 15:31:11.578 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125862134734262272[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-14 15:31:11.578 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125862134734262272[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:31:11.779 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125862134734262272[0;39m <==    Updates: 1
2021-12-14 15:31:11.786 INFO  com.aspect.LogAspect                              :92   [32m125862134734262272[0;39m 返回结果: {"content":"<blockquote><h1><b id=\"9lkez\"><font face=\"微软雅黑\">Ant Design of Vue</font></b></h1><p>这里是 Ant Design 的 Vue 实现，开发和服务于企业级后台<font face=\"标楷体\"></font>产品。</p></blockquote>","success":true}
2021-12-14 15:31:11.786 INFO  com.aspect.LogAspect                              :93   [32m125862134734262272[0;39m ------------- 结束 耗时：460 ms -------------
2021-12-14 15:31:12.690 INFO  com.aspect.LogAspect                              :54   [32m125862140455292928[0;39m ------------- 开始 -------------
2021-12-14 15:31:12.691 INFO  com.aspect.LogAspect                              :55   [32m125862140455292928[0;39m 请求地址: http://localhost:8081/doc/vote/119304585604108288 GET
2021-12-14 15:31:12.691 INFO  com.aspect.LogAspect                              :56   [32m125862140455292928[0;39m 类名方法: com.controller.DocController.vote
2021-12-14 15:31:12.691 INFO  com.aspect.LogAspect                              :57   [32m125862140455292928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:12.692 INFO  com.aspect.LogAspect                              :80   [32m125862140455292928[0;39m 请求参数: [119304585604108288]
2021-12-14 15:31:13.705 INFO  com.Util.RedisUtil                                :31   [32m125862140455292928[0;39m key不存在，放入：DOC_VOTE_119304585604108288_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-14 15:31:13.871 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125862140455292928[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-14 15:31:13.872 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125862140455292928[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:31:14.076 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125862140455292928[0;39m <==    Updates: 1
2021-12-14 15:31:14.077 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125862140455292928[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-14 15:31:14.077 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125862140455292928[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-14 15:31:14.183 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125862140455292928[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-14 15:31:14.184 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125862140455292928[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 20, 4
2021-12-14 15:31:14.186 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125862140455292928[0;39m <==      Total: 1
2021-12-14 15:31:14.198 INFO  com.aspect.LogAspect                              :92   [32m125862140455292928[0;39m 返回结果: {"success":true}
2021-12-14 15:31:14.199 INFO  com.aspect.LogAspect                              :93   [32m125862140455292928[0;39m ------------- 结束 耗时：1509 ms -------------
2021-12-14 15:31:14.237 INFO  com.websocket.WebSocketServer                     :71   [32m125862140455292928[0;39m 推送消息：tDuZALCES6，内容：【Ant Design of Vue】被点赞！
2021-12-14 15:31:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125862150207049728[0;39m 生成今日电子书快照开始
2021-12-14 15:31:15.122 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862150207049728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:15.125 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862150207049728[0;39m ==> Parameters: 
2021-12-14 15:31:15.373 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862150207049728[0;39m <==    Updates: 0
2021-12-14 15:31:15.374 INFO  com.job.EbookSnapshotJob                          :35   [32m125862150207049728[0;39m 生成今日电子书快照结束，耗时：358毫秒
2021-12-14 15:31:16.218 INFO  com.aspect.LogAspect                              :54   [32m125862155252797440[0;39m ------------- 开始 -------------
2021-12-14 15:31:16.218 INFO  com.aspect.LogAspect                              :55   [32m125862155252797440[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:31:16.219 INFO  com.aspect.LogAspect                              :56   [32m125862155252797440[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:31:16.219 INFO  com.aspect.LogAspect                              :57   [32m125862155252797440[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:16.219 INFO  com.aspect.LogAspect                              :80   [32m125862155252797440[0;39m 请求参数: []
2021-12-14 15:31:16.220 INFO  com.aspect.LogAspect                              :54   [32m125862155261186048[0;39m ------------- 开始 -------------
2021-12-14 15:31:16.221 INFO  com.aspect.LogAspect                              :55   [32m125862155261186048[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:31:16.221 INFO  com.aspect.LogAspect                              :56   [32m125862155261186048[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:31:16.222 INFO  com.aspect.LogAspect                              :57   [32m125862155261186048[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:16.222 INFO  com.aspect.LogAspect                              :80   [32m125862155261186048[0;39m 请求参数: []
2021-12-14 15:31:16.224 INFO  com.aspect.LogAspect                              :54   [32m125862155277963264[0;39m ------------- 开始 -------------
2021-12-14 15:31:16.224 INFO  com.aspect.LogAspect                              :55   [32m125862155277963264[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:16.224 INFO  com.aspect.LogAspect                              :56   [32m125862155277963264[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:16.224 INFO  com.aspect.LogAspect                              :57   [32m125862155277963264[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:16.225 INFO  com.aspect.LogAspect                              :80   [32m125862155277963264[0;39m 请求参数: []
2021-12-14 15:31:16.320 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862155261186048[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:16.320 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862155252797440[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:16.320 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862155277963264[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:16.322 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862155252797440[0;39m ==> Parameters: 
2021-12-14 15:31:16.322 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862155261186048[0;39m ==> Parameters: 
2021-12-14 15:31:16.322 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862155277963264[0;39m ==> Parameters: 
2021-12-14 15:31:16.450 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862155261186048[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:31:16.452 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:16.452 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862155261186048[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:31:16.453 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:16.455 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:16.455 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862155261186048[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:31:16.456 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:16.456 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862155261186048[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:31:16.457 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:16.458 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862155261186048[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:31:16.458 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:16.450 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862155252797440[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:31:16.459 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:16.459 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862155261186048[0;39m <==      Total: 4
2021-12-14 15:31:16.460 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862155252797440[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:31:16.460 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:16.460 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:16.460 INFO  com.aspect.LogAspect                              :92   [32m125862155261186048[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:31:16.461 INFO  com.aspect.LogAspect                              :93   [32m125862155261186048[0;39m ------------- 结束 耗时：241 ms -------------
2021-12-14 15:31:16.461 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862155252797440[0;39m <==        Row: 2021-12-14, 489, 164, 6, 4
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:16.461 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862155252797440[0;39m <==      Total: 2
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:16.461 INFO  com.aspect.LogAspect                              :92   [32m125862155252797440[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":489,"viewIncrease":6,"voteCount":164,"voteIncrease":4}],"success":true}
2021-12-14 15:31:16.461 INFO  com.aspect.LogAspect                              :93   [32m125862155252797440[0;39m ------------- 结束 耗时：243 ms -------------
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:16.461 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:16.466 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:16.467 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:16.468 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:16.469 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:16.470 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862155277963264[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:16.471 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862155277963264[0;39m <==      Total: 19
2021-12-14 15:31:16.472 INFO  com.aspect.LogAspect                              :92   [32m125862155277963264[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:16.472 INFO  com.aspect.LogAspect                              :93   [32m125862155277963264[0;39m ------------- 结束 耗时：248 ms -------------
2021-12-14 15:31:20.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125862171165986816[0;39m 生成今日电子书快照开始
2021-12-14 15:31:20.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862171165986816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:20.153 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862171165986816[0;39m ==> Parameters: 
2021-12-14 15:31:20.377 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862171165986816[0;39m <==    Updates: 0
2021-12-14 15:31:20.380 INFO  com.job.EbookSnapshotJob                          :35   [32m125862171165986816[0;39m 生成今日电子书快照结束，耗时：368毫秒
2021-12-14 15:31:21.936 INFO  com.aspect.LogAspect                              :54   [32m125862179235827712[0;39m ------------- 开始 -------------
2021-12-14 15:31:21.936 INFO  com.aspect.LogAspect                              :55   [32m125862179235827712[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-14 15:31:21.937 INFO  com.aspect.LogAspect                              :56   [32m125862179235827712[0;39m 类名方法: com.controller.UserController.login
2021-12-14 15:31:21.937 INFO  com.aspect.LogAspect                              :57   [32m125862179235827712[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:21.941 INFO  com.aspect.LogAspect                              :80   [32m125862179235827712[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-14 15:31:22.065 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862179235827712[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-14 15:31:22.066 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862179235827712[0;39m ==> Parameters: test123(String)
2021-12-14 15:31:22.173 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862179235827712[0;39m <==    Columns: id, login_name, name, password
2021-12-14 15:31:22.173 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862179235827712[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 15:31:22.173 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862179235827712[0;39m <==      Total: 1
2021-12-14 15:31:22.198 INFO  com.controller.UserController                     :77   [32m125862179235827712[0;39m 生成单点登录token:125862180334735360,并放入redis中
2021-12-14 15:31:22.288 INFO  com.aspect.LogAspect                              :92   [32m125862179235827712[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125862180334735360"},"success":true}
2021-12-14 15:31:22.288 INFO  com.aspect.LogAspect                              :93   [32m125862179235827712[0;39m ------------- 结束 耗时：352 ms -------------
2021-12-14 15:31:22.518 INFO  com.websocket.WebSocketServer                     :41   [32m125862122231042048[0;39m 连接关闭，token：tDuZALCES6，session id：0！当前连接数：0
2021-12-14 15:31:23.351 INFO  com.websocket.WebSocketServer                     :32   [32m125862124340776960[0;39m 有新连接：token：TucQg4A7IS，session id：1，当前连接数：1
2021-12-14 15:31:23.445 INFO  com.aspect.LogAspect                              :54   [32m125862185565032448[0;39m ------------- 开始 -------------
2021-12-14 15:31:23.445 INFO  com.aspect.LogAspect                              :55   [32m125862185565032448[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:31:23.446 INFO  com.aspect.LogAspect                              :56   [32m125862185565032448[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:31:23.446 INFO  com.aspect.LogAspect                              :57   [32m125862185565032448[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:23.446 INFO  com.aspect.LogAspect                              :80   [32m125862185565032448[0;39m 请求参数: []
2021-12-14 15:31:23.453 INFO  com.aspect.LogAspect                              :54   [32m125862185598586880[0;39m ------------- 开始 -------------
2021-12-14 15:31:23.453 INFO  com.aspect.LogAspect                              :55   [32m125862185598586880[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:31:23.453 INFO  com.aspect.LogAspect                              :56   [32m125862185598586880[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:31:23.454 INFO  com.aspect.LogAspect                              :57   [32m125862185598586880[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:23.454 INFO  com.aspect.LogAspect                              :80   [32m125862185598586880[0;39m 请求参数: []
2021-12-14 15:31:23.456 INFO  com.aspect.LogAspect                              :54   [32m125862185611169792[0;39m ------------- 开始 -------------
2021-12-14 15:31:23.456 INFO  com.aspect.LogAspect                              :55   [32m125862185611169792[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:23.457 INFO  com.aspect.LogAspect                              :56   [32m125862185611169792[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:23.457 INFO  com.aspect.LogAspect                              :57   [32m125862185611169792[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:23.457 INFO  com.aspect.LogAspect                              :80   [32m125862185611169792[0;39m 请求参数: []
2021-12-14 15:31:23.571 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862185598586880[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:23.571 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862185565032448[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:23.571 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862185611169792[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:23.572 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862185611169792[0;39m ==> Parameters: 
2021-12-14 15:31:23.572 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862185565032448[0;39m ==> Parameters: 
2021-12-14 15:31:23.572 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862185598586880[0;39m ==> Parameters: 
2021-12-14 15:31:23.699 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:23.699 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862185598586880[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:31:23.700 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:23.701 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862185598586880[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:31:23.702 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:23.704 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:23.705 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862185598586880[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:31:23.705 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:23.706 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:23.707 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862185598586880[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:31:23.707 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:23.708 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:23.709 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862185598586880[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:31:23.710 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:23.711 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862185565032448[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:31:23.711 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:23.711 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:23.711 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862185565032448[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:31:23.715 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862185598586880[0;39m <==      Total: 4
2021-12-14 15:31:23.711 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:23.719 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:23.719 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862185565032448[0;39m <==        Row: 2021-12-14, 489, 164, 6, 4
2021-12-14 15:31:23.721 INFO  com.aspect.LogAspect                              :92   [32m125862185598586880[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:31:23.722 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862185565032448[0;39m <==      Total: 2
2021-12-14 15:31:23.722 INFO  com.aspect.LogAspect                              :93   [32m125862185598586880[0;39m ------------- 结束 耗时：269 ms -------------
2021-12-14 15:31:23.721 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:23.722 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:23.722 INFO  com.aspect.LogAspect                              :92   [32m125862185565032448[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":489,"viewIncrease":6,"voteCount":164,"voteIncrease":4}],"success":true}
2021-12-14 15:31:23.723 INFO  com.aspect.LogAspect                              :93   [32m125862185565032448[0;39m ------------- 结束 耗时：278 ms -------------
2021-12-14 15:31:23.723 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:23.726 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:23.728 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:23.730 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:23.734 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862185611169792[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:23.735 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862185611169792[0;39m <==      Total: 19
2021-12-14 15:31:23.747 INFO  com.aspect.LogAspect                              :92   [32m125862185611169792[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:23.751 INFO  com.aspect.LogAspect                              :93   [32m125862185611169792[0;39m ------------- 结束 耗时：295 ms -------------
2021-12-14 15:31:24.657 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 15:31:24.658 INFO  com.interceptor.LoginInterceptor                  :65   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-12-14 15:31:24.663 INFO  com.interceptor.LoginInterceptor                  :29   [32m125862179235827712[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 15:31:24.664 INFO  com.interceptor.LoginInterceptor                  :40   [32m125862179235827712[0;39m 接口登录拦截：，path：http://localhost:8081/user/list
2021-12-14 15:31:24.664 INFO  com.interceptor.LoginInterceptor                  :44   [32m125862179235827712[0;39m 登录校验开始，token：125862180334735360
2021-12-14 15:31:24.725 INFO  com.interceptor.LoginInterceptor                  :56   [32m125862179235827712[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125862180334735360"}
2021-12-14 15:31:24.746 INFO  com.aspect.LogAspect                              :54   [32m125862191021821952[0;39m ------------- 开始 -------------
2021-12-14 15:31:24.747 INFO  com.aspect.LogAspect                              :55   [32m125862191021821952[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-14 15:31:24.747 INFO  com.aspect.LogAspect                              :56   [32m125862191021821952[0;39m 类名方法: com.controller.UserController.list
2021-12-14 15:31:24.747 INFO  com.aspect.LogAspect                              :57   [32m125862191021821952[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:24.751 INFO  com.aspect.LogAspect                              :80   [32m125862191021821952[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 15:31:24.887 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862191021821952[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-14 15:31:24.888 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862191021821952[0;39m ==> Parameters: 
2021-12-14 15:31:25.009 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125862191021821952[0;39m <==    Columns: count(0)
2021-12-14 15:31:25.009 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125862191021821952[0;39m <==        Row: 7
2021-12-14 15:31:25.009 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862191021821952[0;39m <==      Total: 1
2021-12-14 15:31:25.009 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862191021821952[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-14 15:31:25.009 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862191021821952[0;39m ==> Parameters: 10(Integer)
2021-12-14 15:31:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125862192150089728[0;39m 生成今日电子书快照开始
2021-12-14 15:31:25.135 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862192150089728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:25.136 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==    Columns: id, login_name, name, password
2021-12-14 15:31:25.137 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:25.137 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862192150089728[0;39m ==> Parameters: 
2021-12-14 15:31:25.137 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:25.137 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:25.137 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:25.137 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-14 15:31:25.143 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 15:31:25.144 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862191021821952[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 15:31:25.144 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862191021821952[0;39m <==      Total: 7
2021-12-14 15:31:25.147 INFO  com.servicess.UserService                         :52   [32m125862191021821952[0;39m 总行数：7
2021-12-14 15:31:25.148 INFO  com.servicess.UserService                         :53   [32m125862191021821952[0;39m 总页数：1
2021-12-14 15:31:25.164 INFO  com.aspect.LogAspect                              :92   [32m125862191021821952[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"}],"total":7},"success":true}
2021-12-14 15:31:25.166 INFO  com.aspect.LogAspect                              :93   [32m125862191021821952[0;39m ------------- 结束 耗时：420 ms -------------
2021-12-14 15:31:25.176 INFO  com.interceptor.LoginInterceptor                  :65   [32m125862191021821952[0;39m ------------- LoginInterceptor 结束 耗时：512 ms -------------
2021-12-14 15:31:25.368 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862192150089728[0;39m <==    Updates: 0
2021-12-14 15:31:25.368 INFO  com.job.EbookSnapshotJob                          :35   [32m125862192150089728[0;39m 生成今日电子书快照结束，耗时：352毫秒
2021-12-14 15:31:26.036 INFO  com.aspect.LogAspect                              :54   [32m125862196432474112[0;39m ------------- 开始 -------------
2021-12-14 15:31:26.036 INFO  com.aspect.LogAspect                              :55   [32m125862196432474112[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:26.036 INFO  com.aspect.LogAspect                              :56   [32m125862196432474112[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:26.036 INFO  com.aspect.LogAspect                              :57   [32m125862196432474112[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:26.036 INFO  com.aspect.LogAspect                              :80   [32m125862196432474112[0;39m 请求参数: []
2021-12-14 15:31:26.143 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862196432474112[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:26.144 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862196432474112[0;39m ==> Parameters: 
2021-12-14 15:31:26.251 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:26.254 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:26.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:26.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:26.264 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:26.265 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:26.267 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:26.269 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:26.270 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:26.273 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:26.273 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:26.274 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:26.275 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862196432474112[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:26.275 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862196432474112[0;39m <==      Total: 19
2021-12-14 15:31:26.282 INFO  com.aspect.LogAspect                              :92   [32m125862196432474112[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:26.282 INFO  com.aspect.LogAspect                              :93   [32m125862196432474112[0;39m ------------- 结束 耗时：246 ms -------------
2021-12-14 15:31:26.351 INFO  com.aspect.LogAspect                              :54   [32m125862197753679872[0;39m ------------- 开始 -------------
2021-12-14 15:31:26.352 INFO  com.aspect.LogAspect                              :55   [32m125862197753679872[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:31:26.352 INFO  com.aspect.LogAspect                              :56   [32m125862197753679872[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:31:26.353 INFO  com.aspect.LogAspect                              :57   [32m125862197753679872[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:26.353 INFO  com.aspect.LogAspect                              :80   [32m125862197753679872[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 15:31:26.359 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862197753679872[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 15:31:26.365 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862197753679872[0;39m ==> Parameters: 
2021-12-14 15:31:26.504 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862197753679872[0;39m <==    Columns: count(0)
2021-12-14 15:31:26.504 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862197753679872[0;39m <==        Row: 6
2021-12-14 15:31:26.504 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862197753679872[0;39m <==      Total: 1
2021-12-14 15:31:26.504 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862197753679872[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 15:31:26.513 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862197753679872[0;39m ==> Parameters: 10(Integer)
2021-12-14 15:31:26.619 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:31:26.619 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 91, 15
2021-12-14 15:31:26.619 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 15:31:26.619 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 15:31:26.630 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 15:31:26.632 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 15:31:26.635 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862197753679872[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 15:31:26.636 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862197753679872[0;39m <==      Total: 6
2021-12-14 15:31:26.637 INFO  com.servicess.EbookService                        :48   [32m125862197753679872[0;39m 总行数：6
2021-12-14 15:31:26.637 INFO  com.servicess.EbookService                        :49   [32m125862197753679872[0;39m 总页数：1
2021-12-14 15:31:26.637 INFO  com.aspect.LogAspect                              :92   [32m125862197753679872[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":91,"voteCount":15},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 15:31:26.637 INFO  com.aspect.LogAspect                              :93   [32m125862197753679872[0;39m ------------- 结束 耗时：286 ms -------------
2021-12-14 15:31:27.607 INFO  com.aspect.LogAspect                              :54   [32m125862203021725696[0;39m ------------- 开始 -------------
2021-12-14 15:31:27.607 INFO  com.aspect.LogAspect                              :55   [32m125862203021725696[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:27.607 INFO  com.aspect.LogAspect                              :56   [32m125862203021725696[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:27.608 INFO  com.aspect.LogAspect                              :57   [32m125862203021725696[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:27.608 INFO  com.aspect.LogAspect                              :80   [32m125862203021725696[0;39m 请求参数: []
2021-12-14 15:31:27.738 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862203021725696[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:27.739 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862203021725696[0;39m ==> Parameters: 
2021-12-14 15:31:27.844 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:27.847 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:27.848 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:27.849 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:27.850 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:27.851 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:27.851 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:27.851 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:27.852 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:27.852 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:27.853 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:27.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862203021725696[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:27.854 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862203021725696[0;39m <==      Total: 19
2021-12-14 15:31:27.854 INFO  com.aspect.LogAspect                              :92   [32m125862203021725696[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:27.854 INFO  com.aspect.LogAspect                              :93   [32m125862203021725696[0;39m ------------- 结束 耗时：247 ms -------------
2021-12-14 15:31:29.450 INFO  com.aspect.LogAspect                              :54   [32m125862210751827968[0;39m ------------- 开始 -------------
2021-12-14 15:31:29.451 INFO  com.aspect.LogAspect                              :55   [32m125862210751827968[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:29.451 INFO  com.aspect.LogAspect                              :56   [32m125862210751827968[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:29.451 INFO  com.aspect.LogAspect                              :57   [32m125862210751827968[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:29.451 INFO  com.aspect.LogAspect                              :80   [32m125862210751827968[0;39m 请求参数: []
2021-12-14 15:31:29.575 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862210751827968[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:29.577 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862210751827968[0;39m ==> Parameters: 
2021-12-14 15:31:29.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:29.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:29.681 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:29.682 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:29.682 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:29.686 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:29.687 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:29.687 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:29.687 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:29.693 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:29.694 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:29.695 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:29.699 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:29.702 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:29.704 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:29.705 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:29.705 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:29.705 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:29.710 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:29.710 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862210751827968[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:29.714 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862210751827968[0;39m <==      Total: 19
2021-12-14 15:31:29.720 INFO  com.aspect.LogAspect                              :92   [32m125862210751827968[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:29.720 INFO  com.aspect.LogAspect                              :93   [32m125862210751827968[0;39m ------------- 结束 耗时：270 ms -------------
2021-12-14 15:31:29.903 INFO  com.aspect.LogAspect                              :54   [32m125862212651847680[0;39m ------------- 开始 -------------
2021-12-14 15:31:29.903 INFO  com.aspect.LogAspect                              :55   [32m125862212651847680[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:29.903 INFO  com.aspect.LogAspect                              :56   [32m125862212651847680[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:29.904 INFO  com.aspect.LogAspect                              :57   [32m125862212651847680[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:29.904 INFO  com.aspect.LogAspect                              :80   [32m125862212651847680[0;39m 请求参数: []
2021-12-14 15:31:29.974 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862212651847680[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:29.975 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862212651847680[0;39m ==> Parameters: 
2021-12-14 15:31:30.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125862213088055296[0;39m 生成今日电子书快照开始
2021-12-14 15:31:30.075 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:30.083 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:30.084 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:30.086 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:30.087 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:30.088 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:30.089 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:30.089 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:30.091 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:30.096 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:30.099 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:30.100 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:30.102 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:30.103 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:30.105 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:30.106 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:30.107 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:30.109 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:30.113 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:30.114 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862212651847680[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:30.115 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862212651847680[0;39m <==      Total: 19
2021-12-14 15:31:30.121 INFO  com.aspect.LogAspect                              :92   [32m125862212651847680[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:30.121 INFO  com.aspect.LogAspect                              :93   [32m125862212651847680[0;39m ------------- 结束 耗时：218 ms -------------
2021-12-14 15:31:30.131 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862213088055296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:30.135 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862213088055296[0;39m ==> Parameters: 
2021-12-14 15:31:30.172 INFO  com.aspect.LogAspect                              :54   [32m125862213780115456[0;39m ------------- 开始 -------------
2021-12-14 15:31:30.172 INFO  com.aspect.LogAspect                              :55   [32m125862213780115456[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 15:31:30.172 INFO  com.aspect.LogAspect                              :56   [32m125862213780115456[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 15:31:30.172 INFO  com.aspect.LogAspect                              :57   [32m125862213780115456[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:30.172 INFO  com.aspect.LogAspect                              :80   [32m125862213780115456[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 15:31:30.177 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862213780115456[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 15:31:30.177 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862213780115456[0;39m ==> Parameters: 
2021-12-14 15:31:30.294 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862213780115456[0;39m <==    Columns: count(0)
2021-12-14 15:31:30.294 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125862213780115456[0;39m <==        Row: 6
2021-12-14 15:31:30.296 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125862213780115456[0;39m <==      Total: 1
2021-12-14 15:31:30.296 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862213780115456[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 15:31:30.296 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862213780115456[0;39m ==> Parameters: 10(Integer)
2021-12-14 15:31:30.332 INFO  com.interceptor.LoginInterceptor                  :29   [32m125862185611169792[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 15:31:30.333 INFO  com.interceptor.LoginInterceptor                  :40   [32m125862185611169792[0;39m 接口登录拦截：，path：http://localhost:8081/user/list
2021-12-14 15:31:30.333 INFO  com.interceptor.LoginInterceptor                  :44   [32m125862185611169792[0;39m 登录校验开始，token：125862180334735360
2021-12-14 15:31:30.349 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862213088055296[0;39m <==    Updates: 0
2021-12-14 15:31:30.350 INFO  com.job.EbookSnapshotJob                          :35   [32m125862213088055296[0;39m 生成今日电子书快照结束，耗时：343毫秒
2021-12-14 15:31:30.379 INFO  com.interceptor.LoginInterceptor                  :56   [32m125862185611169792[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125862180334735360"}
2021-12-14 15:31:30.381 INFO  com.aspect.LogAspect                              :54   [32m125862214656724992[0;39m ------------- 开始 -------------
2021-12-14 15:31:30.382 INFO  com.aspect.LogAspect                              :55   [32m125862214656724992[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-14 15:31:30.382 INFO  com.aspect.LogAspect                              :56   [32m125862214656724992[0;39m 类名方法: com.controller.UserController.list
2021-12-14 15:31:30.383 INFO  com.aspect.LogAspect                              :57   [32m125862214656724992[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:30.383 INFO  com.aspect.LogAspect                              :80   [32m125862214656724992[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 15:31:30.384 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862214656724992[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-14 15:31:30.384 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862214656724992[0;39m ==> Parameters: 
2021-12-14 15:31:30.413 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 15:31:30.413 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 91, 15
2021-12-14 15:31:30.415 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 15:31:30.416 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 15:31:30.417 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 15:31:30.418 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 15:31:30.418 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125862213780115456[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 15:31:30.419 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125862213780115456[0;39m <==      Total: 6
2021-12-14 15:31:30.419 INFO  com.servicess.EbookService                        :48   [32m125862213780115456[0;39m 总行数：6
2021-12-14 15:31:30.419 INFO  com.servicess.EbookService                        :49   [32m125862213780115456[0;39m 总页数：1
2021-12-14 15:31:30.421 INFO  com.aspect.LogAspect                              :92   [32m125862213780115456[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":91,"voteCount":15},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 15:31:30.422 INFO  com.aspect.LogAspect                              :93   [32m125862213780115456[0;39m ------------- 结束 耗时：250 ms -------------
2021-12-14 15:31:30.501 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125862214656724992[0;39m <==    Columns: count(0)
2021-12-14 15:31:30.501 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125862214656724992[0;39m <==        Row: 7
2021-12-14 15:31:30.501 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125862214656724992[0;39m <==      Total: 1
2021-12-14 15:31:30.501 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862214656724992[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-14 15:31:30.501 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862214656724992[0;39m ==> Parameters: 10(Integer)
2021-12-14 15:31:30.615 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==    Columns: id, login_name, name, password
2021-12-14 15:31:30.616 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:30.616 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:30.616 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:30.616 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-14 15:31:30.616 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-14 15:31:30.621 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 15:31:30.624 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125862214656724992[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 15:31:30.627 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125862214656724992[0;39m <==      Total: 7
2021-12-14 15:31:30.629 INFO  com.servicess.UserService                         :52   [32m125862214656724992[0;39m 总行数：7
2021-12-14 15:31:30.631 INFO  com.servicess.UserService                         :53   [32m125862214656724992[0;39m 总页数：1
2021-12-14 15:31:30.633 INFO  com.aspect.LogAspect                              :92   [32m125862214656724992[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"}],"total":7},"success":true}
2021-12-14 15:31:30.633 INFO  com.aspect.LogAspect                              :93   [32m125862214656724992[0;39m ------------- 结束 耗时：252 ms -------------
2021-12-14 15:31:30.638 INFO  com.interceptor.LoginInterceptor                  :65   [32m125862214656724992[0;39m ------------- LoginInterceptor 结束 耗时：305 ms -------------
2021-12-14 15:31:30.811 INFO  com.aspect.LogAspect                              :54   [32m125862216460275712[0;39m ------------- 开始 -------------
2021-12-14 15:31:30.812 INFO  com.aspect.LogAspect                              :55   [32m125862216460275712[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 15:31:30.812 INFO  com.aspect.LogAspect                              :56   [32m125862216460275712[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 15:31:30.812 INFO  com.aspect.LogAspect                              :57   [32m125862216460275712[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:30.812 INFO  com.aspect.LogAspect                              :80   [32m125862216460275712[0;39m 请求参数: []
2021-12-14 15:31:30.813 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862216460275712[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:30.814 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862216460275712[0;39m ==> Parameters: 
2021-12-14 15:31:30.815 INFO  com.aspect.LogAspect                              :54   [32m125862216477052928[0;39m ------------- 开始 -------------
2021-12-14 15:31:30.815 INFO  com.aspect.LogAspect                              :55   [32m125862216477052928[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 15:31:30.815 INFO  com.aspect.LogAspect                              :56   [32m125862216477052928[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 15:31:30.815 INFO  com.aspect.LogAspect                              :57   [32m125862216477052928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:30.816 INFO  com.aspect.LogAspect                              :80   [32m125862216477052928[0;39m 请求参数: []
2021-12-14 15:31:30.816 INFO  com.aspect.LogAspect                              :54   [32m125862216481247232[0;39m ------------- 开始 -------------
2021-12-14 15:31:30.816 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862216477052928[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 15:31:30.817 INFO  com.aspect.LogAspect                              :55   [32m125862216481247232[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 15:31:30.817 INFO  com.aspect.LogAspect                              :56   [32m125862216481247232[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 15:31:30.817 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862216477052928[0;39m ==> Parameters: 
2021-12-14 15:31:30.817 INFO  com.aspect.LogAspect                              :57   [32m125862216481247232[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 15:31:30.817 INFO  com.aspect.LogAspect                              :80   [32m125862216481247232[0;39m 请求参数: []
2021-12-14 15:31:30.942 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862216460275712[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 15:31:30.943 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862216481247232[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 15:31:30.943 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862216481247232[0;39m ==> Parameters: 
2021-12-14 15:31:30.943 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862216460275712[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862216477052928[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125862216460275712[0;39m <==        Row: 2021-12-14, 489, 164, 6, 4
2021-12-14 15:31:30.944 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125862216460275712[0;39m <==      Total: 2
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862216477052928[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 15:31:30.944 INFO  com.aspect.LogAspect                              :92   [32m125862216460275712[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":489,"viewIncrease":6,"voteCount":164,"voteIncrease":4}],"success":true}
2021-12-14 15:31:30.944 INFO  com.aspect.LogAspect                              :93   [32m125862216460275712[0;39m ------------- 结束 耗时：133 ms -------------
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862216477052928[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862216477052928[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 15:31:30.944 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125862216477052928[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 15:31:30.949 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125862216477052928[0;39m <==      Total: 4
2021-12-14 15:31:30.951 INFO  com.aspect.LogAspect                              :92   [32m125862216477052928[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 15:31:30.951 INFO  com.aspect.LogAspect                              :93   [32m125862216477052928[0;39m ------------- 结束 耗时：137 ms -------------
2021-12-14 15:31:31.057 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==    Columns: id, parent, name, sort
2021-12-14 15:31:31.057 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 15:31:31.059 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 15:31:31.060 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 15:31:31.061 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 15:31:31.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 15:31:31.067 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 15:31:31.067 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 15:31:31.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 15:31:31.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 15:31:31.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 15:31:31.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125862216481247232[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 15:31:31.068 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125862216481247232[0;39m <==      Total: 19
2021-12-14 15:31:31.068 INFO  com.aspect.LogAspect                              :92   [32m125862216481247232[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 15:31:31.068 INFO  com.aspect.LogAspect                              :93   [32m125862216481247232[0;39m ------------- 结束 耗时：252 ms -------------
2021-12-14 15:31:33.970 INFO  com.websocket.WebSocketServer                     :41   [32m125862124340776960[0;39m 连接关闭，token：TucQg4A7IS，session id：1！当前连接数：0
2021-12-14 15:31:35.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125862234046992384[0;39m 生成今日电子书快照开始
2021-12-14 15:31:35.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862234046992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 15:31:35.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862234046992384[0;39m ==> Parameters: 
2021-12-14 15:31:35.282 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125862234046992384[0;39m <==    Updates: 0
2021-12-14 15:31:35.282 INFO  com.job.EbookSnapshotJob                          :35   [32m125862234046992384[0;39m 生成今日电子书快照结束，耗时：277毫秒
2021-12-14 15:31:35.283 INFO  com.job.DocJob                                    :32   [32m125862235217203200[0;39m 更新电子书下的文档数据开始
2021-12-14 15:31:35.283 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862235217203200[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 15:31:35.283 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862235217203200[0;39m ==> Parameters: 
2021-12-14 15:31:35.490 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125862235217203200[0;39m <==    Updates: 3
2021-12-14 15:31:35.491 INFO  com.job.DocJob                                    :35   [32m125862235217203200[0;39m 更新电子书下的文档数据结束，耗时：208毫秒
2021-12-14 20:46:01.702 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-14 20:46:01.824 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 7548 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 20:46:01.824 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 20:46:02.202 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-14 20:46:02.202 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-14 20:46:13.005 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 20:46:13.005 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 20:46:13.673 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 621 ms. Found 0 Redis repository interfaces.
2021-12-14 20:46:17.937 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 20:46:18.031 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 20:46:18.031 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 20:46:18.031 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 20:46:18.609 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 20:46:18.609 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 16407 ms
2021-12-14 20:46:28.639 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-14 20:46:28.702 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-14 20:46:28.830 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-14 20:46:28.893 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 30.376 seconds (JVM running for 33.779)
2021-12-14 20:46:30.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125941485437849600[0;39m 生成今日电子书快照开始
2021-12-14 20:46:30.118 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125941485437849600[0;39m HikariPool-1 - Starting...
2021-12-14 20:46:31.565 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125941485437849600[0;39m HikariPool-1 - Start completed.
2021-12-14 20:46:31.615 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941485437849600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:31.631 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941485437849600[0;39m ==> Parameters: 
2021-12-14 20:46:31.787 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941485437849600[0;39m <==    Updates: 0
2021-12-14 20:46:31.802 INFO  com.job.EbookSnapshotJob                          :35   [32m125941485437849600[0;39m 生成今日电子书快照结束，耗时：1794毫秒
2021-12-14 20:46:35.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125941506451312640[0;39m 生成今日电子书快照开始
2021-12-14 20:46:35.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941506451312640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:35.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941506451312640[0;39m ==> Parameters: 
2021-12-14 20:46:35.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941506451312640[0;39m <==    Updates: 0
2021-12-14 20:46:35.255 INFO  com.job.EbookSnapshotJob                          :35   [32m125941506451312640[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-14 20:46:35.255 INFO  com.job.DocJob                                    :32   [32m125941507445362688[0;39m 更新电子书下的文档数据开始
2021-12-14 20:46:35.255 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941507445362688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:46:35.255 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941507445362688[0;39m ==> Parameters: 
2021-12-14 20:46:35.431 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941507445362688[0;39m <==    Updates: 3
2021-12-14 20:46:35.431 INFO  com.job.DocJob                                    :35   [32m125941507445362688[0;39m 更新电子书下的文档数据结束，耗时：176毫秒
2021-12-14 20:46:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125941527385083904[0;39m 生成今日电子书快照开始
2021-12-14 20:46:40.060 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941527385083904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:40.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941527385083904[0;39m ==> Parameters: 
2021-12-14 20:46:40.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941527385083904[0;39m <==    Updates: 0
2021-12-14 20:46:40.232 INFO  com.job.EbookSnapshotJob                          :35   [32m125941527385083904[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-14 20:46:45.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125941548419518464[0;39m 生成今日电子书快照开始
2021-12-14 20:46:45.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941548419518464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:45.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941548419518464[0;39m ==> Parameters: 
2021-12-14 20:46:45.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941548419518464[0;39m <==    Updates: 0
2021-12-14 20:46:45.247 INFO  com.job.EbookSnapshotJob                          :35   [32m125941548419518464[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-14 20:46:50.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125941569328123904[0;39m 生成今日电子书快照开始
2021-12-14 20:46:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941569328123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:50.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941569328123904[0;39m ==> Parameters: 
2021-12-14 20:46:50.212 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941569328123904[0;39m <==    Updates: 0
2021-12-14 20:46:50.212 INFO  com.job.EbookSnapshotJob                          :35   [32m125941569328123904[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:46:55.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125941590329004032[0;39m 生成今日电子书快照开始
2021-12-14 20:46:55.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941590329004032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:46:55.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941590329004032[0;39m ==> Parameters: 
2021-12-14 20:46:55.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941590329004032[0;39m <==    Updates: 0
2021-12-14 20:46:55.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125941590329004032[0;39m 生成今日电子书快照结束，耗时：199毫秒
2021-12-14 20:47:00.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125941611308912640[0;39m 生成今日电子书快照开始
2021-12-14 20:47:00.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941611308912640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:00.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941611308912640[0;39m ==> Parameters: 
2021-12-14 20:47:00.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941611308912640[0;39m <==    Updates: 0
2021-12-14 20:47:00.240 INFO  com.job.EbookSnapshotJob                          :35   [32m125941611308912640[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:47:05.008 INFO  com.job.DocJob                                    :32   [32m125941632238489600[0;39m 更新电子书下的文档数据开始
2021-12-14 20:47:05.086 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941632238489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:47:05.086 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941632238489600[0;39m ==> Parameters: 
2021-12-14 20:47:05.214 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941632238489600[0;39m <==    Updates: 3
2021-12-14 20:47:05.214 INFO  com.job.DocJob                                    :35   [32m125941632238489600[0;39m 更新电子书下的文档数据结束，耗时：206毫秒
2021-12-14 20:47:05.214 INFO  com.job.EbookSnapshotJob                          :32   [32m125941633102516224[0;39m 生成今日电子书快照开始
2021-12-14 20:47:05.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941633102516224[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:05.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941633102516224[0;39m ==> Parameters: 
2021-12-14 20:47:05.371 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941633102516224[0;39m <==    Updates: 0
2021-12-14 20:47:05.371 INFO  com.job.EbookSnapshotJob                          :35   [32m125941633102516224[0;39m 生成今日电子书快照结束，耗时：157毫秒
2021-12-14 20:47:10.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125941653239369728[0;39m 生成今日电子书快照开始
2021-12-14 20:47:10.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941653239369728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:10.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941653239369728[0;39m ==> Parameters: 
2021-12-14 20:47:10.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941653239369728[0;39m <==    Updates: 0
2021-12-14 20:47:10.234 INFO  com.job.EbookSnapshotJob                          :35   [32m125941653239369728[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:47:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125941674210889728[0;39m 生成今日电子书快照开始
2021-12-14 20:47:15.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941674210889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:15.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941674210889728[0;39m ==> Parameters: 
2021-12-14 20:47:15.346 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941674210889728[0;39m <==    Updates: 0
2021-12-14 20:47:15.362 INFO  com.job.EbookSnapshotJob                          :35   [32m125941674210889728[0;39m 生成今日电子书快照结束，耗时：347毫秒
2021-12-14 20:47:20.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125941695127883776[0;39m 生成今日电子书快照开始
2021-12-14 20:47:20.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941695127883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:20.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941695127883776[0;39m ==> Parameters: 
2021-12-14 20:47:20.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941695127883776[0;39m <==    Updates: 0
2021-12-14 20:47:20.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125941695127883776[0;39m 生成今日电子书快照结束，耗时：213毫秒
2021-12-14 20:47:25.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125941716128763904[0;39m 生成今日电子书快照开始
2021-12-14 20:47:25.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941716128763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:25.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941716128763904[0;39m ==> Parameters: 
2021-12-14 20:47:25.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941716128763904[0;39m <==    Updates: 0
2021-12-14 20:47:25.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125941716128763904[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-14 20:47:30.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125941737138032640[0;39m 生成今日电子书快照开始
2021-12-14 20:47:30.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941737138032640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:30.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941737138032640[0;39m ==> Parameters: 
2021-12-14 20:47:30.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941737138032640[0;39m <==    Updates: 0
2021-12-14 20:47:30.209 INFO  com.job.EbookSnapshotJob                          :35   [32m125941737138032640[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:47:35.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125941758096969728[0;39m 生成今日电子书快照开始
2021-12-14 20:47:35.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941758096969728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:35.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941758096969728[0;39m ==> Parameters: 
2021-12-14 20:47:35.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941758096969728[0;39m <==    Updates: 0
2021-12-14 20:47:35.234 INFO  com.job.EbookSnapshotJob                          :35   [32m125941758096969728[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:47:35.234 INFO  com.job.DocJob                                    :32   [32m125941759015522304[0;39m 更新电子书下的文档数据开始
2021-12-14 20:47:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941759015522304[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:47:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941759015522304[0;39m ==> Parameters: 
2021-12-14 20:47:35.377 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941759015522304[0;39m <==    Updates: 3
2021-12-14 20:47:35.377 INFO  com.job.DocJob                                    :35   [32m125941759015522304[0;39m 更新电子书下的文档数据结束，耗时：143毫秒
2021-12-14 20:47:40.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125941779106238464[0;39m 生成今日电子书快照开始
2021-12-14 20:47:40.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941779106238464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:40.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941779106238464[0;39m ==> Parameters: 
2021-12-14 20:47:40.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941779106238464[0;39m <==    Updates: 0
2021-12-14 20:47:40.262 INFO  com.job.EbookSnapshotJob                          :35   [32m125941779106238464[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-14 20:47:45.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125941800040009728[0;39m 生成今日电子书快照开始
2021-12-14 20:47:45.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941800040009728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:45.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941800040009728[0;39m ==> Parameters: 
2021-12-14 20:47:45.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941800040009728[0;39m <==    Updates: 0
2021-12-14 20:47:45.236 INFO  com.job.EbookSnapshotJob                          :35   [32m125941800040009728[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-14 20:47:50.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125941821011529728[0;39m 生成今日电子书快照开始
2021-12-14 20:47:50.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941821011529728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:50.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941821011529728[0;39m ==> Parameters: 
2021-12-14 20:47:50.298 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941821011529728[0;39m <==    Updates: 0
2021-12-14 20:47:50.298 INFO  com.job.EbookSnapshotJob                          :35   [32m125941821011529728[0;39m 生成今日电子书快照结束，耗时：283毫秒
2021-12-14 20:47:55.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125941841957883904[0;39m 生成今日电子书快照开始
2021-12-14 20:47:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941841957883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:47:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941841957883904[0;39m ==> Parameters: 
2021-12-14 20:47:55.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941841957883904[0;39m <==    Updates: 0
2021-12-14 20:47:55.231 INFO  com.job.EbookSnapshotJob                          :35   [32m125941841957883904[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:48:00.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125941862929403904[0;39m 生成今日电子书快照开始
2021-12-14 20:48:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941862929403904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941862929403904[0;39m ==> Parameters: 
2021-12-14 20:48:00.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941862929403904[0;39m <==    Updates: 0
2021-12-14 20:48:00.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125941862929403904[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-14 20:48:05.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125941883930284032[0;39m 生成今日电子书快照开始
2021-12-14 20:48:05.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941883930284032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:05.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941883930284032[0;39m ==> Parameters: 
2021-12-14 20:48:05.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941883930284032[0;39m <==    Updates: 0
2021-12-14 20:48:05.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125941883930284032[0;39m 生成今日电子书快照结束，耗时：199毫秒
2021-12-14 20:48:05.215 INFO  com.job.DocJob                                    :32   [32m125941884764950528[0;39m 更新电子书下的文档数据开始
2021-12-14 20:48:05.215 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941884764950528[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:48:05.215 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941884764950528[0;39m ==> Parameters: 
2021-12-14 20:48:05.356 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125941884764950528[0;39m <==    Updates: 3
2021-12-14 20:48:05.356 INFO  com.job.DocJob                                    :35   [32m125941884764950528[0;39m 更新电子书下的文档数据结束，耗时：141毫秒
2021-12-14 20:48:10.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125941904901804032[0;39m 生成今日电子书快照开始
2021-12-14 20:48:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941904901804032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941904901804032[0;39m ==> Parameters: 
2021-12-14 20:48:10.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941904901804032[0;39m <==    Updates: 0
2021-12-14 20:48:10.256 INFO  com.job.EbookSnapshotJob                          :35   [32m125941904901804032[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-14 20:48:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125941925881712640[0;39m 生成今日电子书快照开始
2021-12-14 20:48:15.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941925881712640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:15.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941925881712640[0;39m ==> Parameters: 
2021-12-14 20:48:15.224 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941925881712640[0;39m <==    Updates: 0
2021-12-14 20:48:15.224 INFO  com.job.EbookSnapshotJob                          :35   [32m125941925881712640[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-14 20:48:20.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125941946807095296[0;39m 生成今日电子书快照开始
2021-12-14 20:48:20.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941946807095296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:20.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941946807095296[0;39m ==> Parameters: 
2021-12-14 20:48:20.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941946807095296[0;39m <==    Updates: 0
2021-12-14 20:48:20.228 INFO  com.job.EbookSnapshotJob                          :35   [32m125941946807095296[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-14 20:48:21.213 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-14 20:48:21.213 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-14 20:48:21.215 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-14 20:48:21.445 INFO  com.aspect.LogAspect                              :54   [32m125941952817532928[0;39m ------------- 开始 -------------
2021-12-14 20:48:21.445 INFO  com.aspect.LogAspect                              :54   [32m125941952817532930[0;39m ------------- 开始 -------------
2021-12-14 20:48:21.445 INFO  com.aspect.LogAspect                              :54   [32m125941952817532929[0;39m ------------- 开始 -------------
2021-12-14 20:48:21.448 INFO  com.aspect.LogAspect                              :55   [32m125941952817532928[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:48:21.448 INFO  com.aspect.LogAspect                              :55   [32m125941952817532929[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:48:21.449 INFO  com.aspect.LogAspect                              :56   [32m125941952817532928[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:48:21.449 INFO  com.aspect.LogAspect                              :55   [32m125941952817532930[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:48:21.450 INFO  com.aspect.LogAspect                              :57   [32m125941952817532928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:21.450 INFO  com.aspect.LogAspect                              :56   [32m125941952817532930[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:48:21.450 INFO  com.aspect.LogAspect                              :57   [32m125941952817532930[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:21.449 INFO  com.aspect.LogAspect                              :56   [32m125941952817532929[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:48:21.455 INFO  com.aspect.LogAspect                              :57   [32m125941952817532929[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:21.539 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：4omGVpFWhT，session id：0，当前连接数：1
2021-12-14 20:48:21.548 INFO  com.aspect.LogAspect                              :80   [32m125941952817532930[0;39m 请求参数: []
2021-12-14 20:48:21.548 INFO  com.aspect.LogAspect                              :80   [32m125941952817532928[0;39m 请求参数: []
2021-12-14 20:48:21.548 INFO  com.aspect.LogAspect                              :80   [32m125941952817532929[0;39m 请求参数: []
2021-12-14 20:48:21.637 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941952817532928[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:48:21.637 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941952817532929[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:48:21.637 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941952817532929[0;39m ==> Parameters: 
2021-12-14 20:48:21.637 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941952817532928[0;39m ==> Parameters: 
2021-12-14 20:48:21.637 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941952817532930[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:48:21.637 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941952817532930[0;39m ==> Parameters: 
2021-12-14 20:48:21.815 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941952817532929[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:48:21.815 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941952817532929[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:48:21.847 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941952817532929[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:48:21.847 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941952817532929[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:48:21.847 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941952817532929[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:48:21.847 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941952817532929[0;39m <==      Total: 4
2021-12-14 20:48:21.893 INFO  com.aspect.LogAspect                              :92   [32m125941952817532929[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:48:21.893 INFO  com.aspect.LogAspect                              :93   [32m125941952817532929[0;39m ------------- 结束 耗时：454 ms -------------
2021-12-14 20:48:21.909 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:48:21.909 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941952817532928[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:48:21.924 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941952817532928[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:48:21.924 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941952817532928[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:48:21.924 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941952817532928[0;39m <==      Total: 2
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:48:21.924 INFO  com.aspect.LogAspect                              :92   [32m125941952817532928[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:48:21.924 INFO  com.aspect.LogAspect                              :93   [32m125941952817532928[0;39m ------------- 结束 耗时：484 ms -------------
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:48:21.924 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:48:21.928 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:48:21.929 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:48:21.929 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:48:21.930 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:48:21.931 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:48:21.931 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:48:21.932 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:48:21.933 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:48:21.933 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:48:21.935 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:48:21.936 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:48:21.936 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941952817532930[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:48:21.936 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941952817532930[0;39m <==      Total: 19
2021-12-14 20:48:21.949 INFO  com.aspect.LogAspect                              :92   [32m125941952817532930[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:48:21.949 INFO  com.aspect.LogAspect                              :93   [32m125941952817532930[0;39m ------------- 结束 耗时：509 ms -------------
2021-12-14 20:48:25.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125941967757643776[0;39m 生成今日电子书快照开始
2021-12-14 20:48:25.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941967757643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:25.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941967757643776[0;39m ==> Parameters: 
2021-12-14 20:48:25.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941967757643776[0;39m <==    Updates: 0
2021-12-14 20:48:25.209 INFO  com.job.EbookSnapshotJob                          :35   [32m125941967757643776[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 20:48:28.736 INFO  com.aspect.LogAspect                              :54   [32m125941983419174912[0;39m ------------- 开始 -------------
2021-12-14 20:48:28.736 INFO  com.aspect.LogAspect                              :55   [32m125941983419174912[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-14 20:48:28.737 INFO  com.aspect.LogAspect                              :56   [32m125941983419174912[0;39m 类名方法: com.controller.UserController.login
2021-12-14 20:48:28.737 INFO  com.aspect.LogAspect                              :57   [32m125941983419174912[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:28.738 INFO  com.aspect.LogAspect                              :80   [32m125941983419174912[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-14 20:48:28.820 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125941983419174912[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-14 20:48:28.821 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125941983419174912[0;39m ==> Parameters: test123(String)
2021-12-14 20:48:28.890 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125941983419174912[0;39m <==    Columns: id, login_name, name, password
2021-12-14 20:48:28.891 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125941983419174912[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 20:48:28.892 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125941983419174912[0;39m <==      Total: 1
2021-12-14 20:48:28.913 INFO  com.controller.UserController                     :77   [32m125941983419174912[0;39m 生成单点登录token:125941984161566720,并放入redis中
2021-12-14 20:48:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125941988762718208[0;39m 生成今日电子书快照开始
2021-12-14 20:48:30.130 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941988762718208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:30.133 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941988762718208[0;39m ==> Parameters: 
2021-12-14 20:48:30.303 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125941988762718208[0;39m <==    Updates: 0
2021-12-14 20:48:30.303 INFO  com.job.EbookSnapshotJob                          :35   [32m125941988762718208[0;39m 生成今日电子书快照结束，耗时：292毫秒
2021-12-14 20:48:31.352 INFO  com.aspect.LogAspect                              :92   [32m125941983419174912[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125941984161566720"},"success":true}
2021-12-14 20:48:31.352 INFO  com.aspect.LogAspect                              :93   [32m125941983419174912[0;39m ------------- 结束 耗时：2616 ms -------------
2021-12-14 20:48:31.506 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：4omGVpFWhT，session id：0！当前连接数：0
2021-12-14 20:48:32.299 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：gJhSwkGKQU，session id：1，当前连接数：1
2021-12-14 20:48:32.381 INFO  com.aspect.LogAspect                              :54   [32m125941998707412992[0;39m ------------- 开始 -------------
2021-12-14 20:48:32.381 INFO  com.aspect.LogAspect                              :55   [32m125941998707412992[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:48:32.381 INFO  com.aspect.LogAspect                              :56   [32m125941998707412992[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:48:32.381 INFO  com.aspect.LogAspect                              :57   [32m125941998707412992[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:32.381 INFO  com.aspect.LogAspect                              :80   [32m125941998707412992[0;39m 请求参数: []
2021-12-14 20:48:32.383 INFO  com.aspect.LogAspect                              :54   [32m125941998715801600[0;39m ------------- 开始 -------------
2021-12-14 20:48:32.384 INFO  com.aspect.LogAspect                              :55   [32m125941998715801600[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:48:32.384 INFO  com.aspect.LogAspect                              :56   [32m125941998715801600[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:48:32.384 INFO  com.aspect.LogAspect                              :57   [32m125941998715801600[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:32.385 INFO  com.aspect.LogAspect                              :80   [32m125941998715801600[0;39m 请求参数: []
2021-12-14 20:48:32.385 INFO  com.aspect.LogAspect                              :54   [32m125941998724190208[0;39m ------------- 开始 -------------
2021-12-14 20:48:32.386 INFO  com.aspect.LogAspect                              :55   [32m125941998724190208[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:48:32.386 INFO  com.aspect.LogAspect                              :56   [32m125941998724190208[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:48:32.387 INFO  com.aspect.LogAspect                              :57   [32m125941998724190208[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:32.387 INFO  com.aspect.LogAspect                              :80   [32m125941998724190208[0;39m 请求参数: []
2021-12-14 20:48:32.452 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941998715801600[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:48:32.453 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941998715801600[0;39m ==> Parameters: 
2021-12-14 20:48:32.454 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941998707412992[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:48:32.455 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941998707412992[0;39m ==> Parameters: 
2021-12-14 20:48:32.460 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941998724190208[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:48:32.461 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941998724190208[0;39m ==> Parameters: 
2021-12-14 20:48:32.522 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941998715801600[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:48:32.523 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941998715801600[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:48:32.524 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941998715801600[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:48:32.525 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941998715801600[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:48:32.525 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125941998715801600[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:48:32.526 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125941998715801600[0;39m <==      Total: 4
2021-12-14 20:48:32.527 INFO  com.aspect.LogAspect                              :92   [32m125941998715801600[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:48:32.527 INFO  com.aspect.LogAspect                              :93   [32m125941998715801600[0;39m ------------- 结束 耗时：144 ms -------------
2021-12-14 20:48:32.531 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:48:32.532 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:48:32.532 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:48:32.533 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:48:32.534 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:48:32.534 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:48:32.535 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:48:32.535 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:48:32.536 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:48:32.536 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:48:32.537 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:48:32.537 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:48:32.537 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:48:32.538 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:48:32.538 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:48:32.539 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:48:32.539 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:48:32.540 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:48:32.541 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:48:32.541 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125941998707412992[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:48:32.542 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125941998707412992[0;39m <==      Total: 19
2021-12-14 20:48:32.544 INFO  com.aspect.LogAspect                              :92   [32m125941998707412992[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:48:32.545 INFO  com.aspect.LogAspect                              :93   [32m125941998707412992[0;39m ------------- 结束 耗时：164 ms -------------
2021-12-14 20:48:32.559 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941998724190208[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:48:32.559 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941998724190208[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:48:32.561 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125941998724190208[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:48:32.562 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125941998724190208[0;39m <==      Total: 2
2021-12-14 20:48:32.563 INFO  com.aspect.LogAspect                              :92   [32m125941998724190208[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:48:32.563 INFO  com.aspect.LogAspect                              :93   [32m125941998724190208[0;39m ------------- 结束 耗时：179 ms -------------
2021-12-14 20:48:34.023 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:48:34.024 INFO  com.interceptor.LoginInterceptor                  :65   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-12-14 20:48:34.029 INFO  com.interceptor.LoginInterceptor                  :29   [32m125941983419174912[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:48:34.030 INFO  com.interceptor.LoginInterceptor                  :40   [32m125941983419174912[0;39m 接口登录拦截：，path：http://localhost:8081/user/list
2021-12-14 20:48:34.030 INFO  com.interceptor.LoginInterceptor                  :44   [32m125941983419174912[0;39m 登录校验开始，token：125941984161566720
2021-12-14 20:48:34.074 INFO  com.interceptor.LoginInterceptor                  :56   [32m125941983419174912[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125941984161566720"}
2021-12-14 20:48:34.123 INFO  com.aspect.LogAspect                              :54   [32m125942006013890560[0;39m ------------- 开始 -------------
2021-12-14 20:48:34.123 INFO  com.aspect.LogAspect                              :55   [32m125942006013890560[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-14 20:48:34.123 INFO  com.aspect.LogAspect                              :56   [32m125942006013890560[0;39m 类名方法: com.controller.UserController.list
2021-12-14 20:48:34.123 INFO  com.aspect.LogAspect                              :57   [32m125942006013890560[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:34.124 INFO  com.aspect.LogAspect                              :80   [32m125942006013890560[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:48:34.349 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125942006013890560[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-14 20:48:34.350 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125942006013890560[0;39m ==> Parameters: 
2021-12-14 20:48:34.416 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125942006013890560[0;39m <==    Columns: count(0)
2021-12-14 20:48:34.416 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125942006013890560[0;39m <==        Row: 7
2021-12-14 20:48:34.418 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125942006013890560[0;39m <==      Total: 1
2021-12-14 20:48:34.423 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125942006013890560[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-14 20:48:34.424 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125942006013890560[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:48:34.477 INFO  com.aspect.LogAspect                              :54   [32m125942007498674176[0;39m ------------- 开始 -------------
2021-12-14 20:48:34.477 INFO  com.aspect.LogAspect                              :55   [32m125942007498674176[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:48:34.477 INFO  com.aspect.LogAspect                              :56   [32m125942007498674176[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:48:34.478 INFO  com.aspect.LogAspect                              :57   [32m125942007498674176[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:34.478 INFO  com.aspect.LogAspect                              :80   [32m125942007498674176[0;39m 请求参数: []
2021-12-14 20:48:34.503 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==    Columns: id, login_name, name, password
2021-12-14 20:48:34.503 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-14 20:48:34.503 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-14 20:48:34.504 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-14 20:48:34.504 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-14 20:48:34.504 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-14 20:48:34.505 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 20:48:34.505 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125942006013890560[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 20:48:34.505 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125942006013890560[0;39m <==      Total: 7
2021-12-14 20:48:34.507 INFO  com.servicess.UserService                         :52   [32m125942006013890560[0;39m 总行数：7
2021-12-14 20:48:34.507 INFO  com.servicess.UserService                         :53   [32m125942006013890560[0;39m 总页数：1
2021-12-14 20:48:34.514 INFO  com.aspect.LogAspect                              :92   [32m125942006013890560[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"}],"total":7},"success":true}
2021-12-14 20:48:34.515 INFO  com.aspect.LogAspect                              :93   [32m125942006013890560[0;39m ------------- 结束 耗时：392 ms -------------
2021-12-14 20:48:34.517 INFO  com.interceptor.LoginInterceptor                  :65   [32m125942006013890560[0;39m ------------- LoginInterceptor 结束 耗时：487 ms -------------
2021-12-14 20:48:34.539 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125942007498674176[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:48:34.540 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125942007498674176[0;39m ==> Parameters: 
2021-12-14 20:48:34.611 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:48:34.612 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:48:34.613 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:48:34.614 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:48:34.615 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:48:34.615 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:48:34.616 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:48:34.617 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:48:34.617 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:48:34.618 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:48:34.618 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:48:34.619 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:48:34.619 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:48:34.621 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:48:34.622 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:48:34.622 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:48:34.623 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:48:34.624 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:48:34.624 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:48:34.627 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125942007498674176[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:48:34.628 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125942007498674176[0;39m <==      Total: 19
2021-12-14 20:48:34.631 INFO  com.aspect.LogAspect                              :92   [32m125942007498674176[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:48:34.631 INFO  com.aspect.LogAspect                              :93   [32m125942007498674176[0;39m ------------- 结束 耗时：154 ms -------------
2021-12-14 20:48:34.657 INFO  com.aspect.LogAspect                              :54   [32m125942008253648896[0;39m ------------- 开始 -------------
2021-12-14 20:48:34.657 INFO  com.aspect.LogAspect                              :55   [32m125942008253648896[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:48:34.660 INFO  com.aspect.LogAspect                              :56   [32m125942008253648896[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:48:34.660 INFO  com.aspect.LogAspect                              :57   [32m125942008253648896[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:48:34.664 INFO  com.aspect.LogAspect                              :80   [32m125942008253648896[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:48:34.669 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942008253648896[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:48:34.670 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942008253648896[0;39m ==> Parameters: 
2021-12-14 20:48:34.734 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942008253648896[0;39m <==    Columns: count(0)
2021-12-14 20:48:34.734 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942008253648896[0;39m <==        Row: 6
2021-12-14 20:48:34.735 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942008253648896[0;39m <==      Total: 1
2021-12-14 20:48:34.737 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942008253648896[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:48:34.738 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942008253648896[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:48:34.804 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:48:34.805 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:48:34.806 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:48:34.808 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:48:34.810 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:48:34.813 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:48:34.813 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942008253648896[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:48:34.815 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942008253648896[0;39m <==      Total: 6
2021-12-14 20:48:34.816 INFO  com.servicess.EbookService                        :48   [32m125942008253648896[0;39m 总行数：6
2021-12-14 20:48:34.817 INFO  com.servicess.EbookService                        :49   [32m125942008253648896[0;39m 总页数：1
2021-12-14 20:48:34.853 INFO  com.aspect.LogAspect                              :92   [32m125942008253648896[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:48:34.853 INFO  com.aspect.LogAspect                              :93   [32m125942008253648896[0;39m ------------- 结束 耗时：196 ms -------------
2021-12-14 20:48:35.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125942009738432512[0;39m 生成今日电子书快照开始
2021-12-14 20:48:35.011 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942009738432512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:35.012 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942009738432512[0;39m ==> Parameters: 
2021-12-14 20:48:35.156 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942009738432512[0;39m <==    Updates: 0
2021-12-14 20:48:35.156 INFO  com.job.EbookSnapshotJob                          :35   [32m125942009738432512[0;39m 生成今日电子书快照结束，耗时：145毫秒
2021-12-14 20:48:35.157 INFO  com.job.DocJob                                    :32   [32m125942010350800896[0;39m 更新电子书下的文档数据开始
2021-12-14 20:48:35.157 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942010350800896[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:48:35.157 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942010350800896[0;39m ==> Parameters: 
2021-12-14 20:48:35.303 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942010350800896[0;39m <==    Updates: 3
2021-12-14 20:48:35.303 INFO  com.job.DocJob                                    :35   [32m125942010350800896[0;39m 更新电子书下的文档数据结束，耗时：146毫秒
2021-12-14 20:48:40.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125942030668009472[0;39m 生成今日电子书快照开始
2021-12-14 20:48:40.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942030668009472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:40.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942030668009472[0;39m ==> Parameters: 
2021-12-14 20:48:40.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942030668009472[0;39m <==    Updates: 0
2021-12-14 20:48:40.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125942030668009472[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-14 20:48:45.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125942051647918080[0;39m 生成今日电子书快照开始
2021-12-14 20:48:45.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942051647918080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:45.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942051647918080[0;39m ==> Parameters: 
2021-12-14 20:48:45.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942051647918080[0;39m <==    Updates: 0
2021-12-14 20:48:45.222 INFO  com.job.EbookSnapshotJob                          :35   [32m125942051647918080[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:48:50.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125942072669769728[0;39m 生成今日电子书快照开始
2021-12-14 20:48:50.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942072669769728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:50.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942072669769728[0;39m ==> Parameters: 
2021-12-14 20:48:50.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942072669769728[0;39m <==    Updates: 0
2021-12-14 20:48:50.218 INFO  com.job.EbookSnapshotJob                          :35   [32m125942072669769728[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:48:55.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125942093653872640[0;39m 生成今日电子书快照开始
2021-12-14 20:48:55.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942093653872640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:48:55.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942093653872640[0;39m ==> Parameters: 
2021-12-14 20:48:55.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942093653872640[0;39m <==    Updates: 0
2021-12-14 20:48:55.228 INFO  com.job.EbookSnapshotJob                          :35   [32m125942093653872640[0;39m 生成今日电子书快照结束，耗时：209毫秒
2021-12-14 20:49:00.020 INFO  com.job.EbookSnapshotJob                          :32   [32m125942114633781248[0;39m 生成今日电子书快照开始
2021-12-14 20:49:00.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942114633781248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:00.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942114633781248[0;39m ==> Parameters: 
2021-12-14 20:49:00.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942114633781248[0;39m <==    Updates: 0
2021-12-14 20:49:00.254 INFO  com.job.EbookSnapshotJob                          :35   [32m125942114633781248[0;39m 生成今日电子书快照结束，耗时：234毫秒
2021-12-14 20:49:05.002 INFO  com.job.DocJob                                    :32   [32m125942135529803776[0;39m 更新电子书下的文档数据开始
2021-12-14 20:49:05.131 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942135529803776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:49:05.131 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942135529803776[0;39m ==> Parameters: 
2021-12-14 20:49:05.256 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942135529803776[0;39m <==    Updates: 3
2021-12-14 20:49:05.256 INFO  com.job.DocJob                                    :35   [32m125942135529803776[0;39m 更新电子书下的文档数据结束，耗时：254毫秒
2021-12-14 20:49:05.256 INFO  com.job.EbookSnapshotJob                          :32   [32m125942136595156992[0;39m 生成今日电子书快照开始
2021-12-14 20:49:05.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942136595156992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:05.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942136595156992[0;39m ==> Parameters: 
2021-12-14 20:49:05.603 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942136595156992[0;39m <==    Updates: 0
2021-12-14 20:49:05.603 INFO  com.job.EbookSnapshotJob                          :35   [32m125942136595156992[0;39m 生成今日电子书快照结束，耗时：347毫秒
2021-12-14 20:49:10.025 INFO  com.job.EbookSnapshotJob                          :32   [32m125942156597792768[0;39m 生成今日电子书快照开始
2021-12-14 20:49:10.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942156597792768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:10.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942156597792768[0;39m ==> Parameters: 
2021-12-14 20:49:10.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942156597792768[0;39m <==    Updates: 0
2021-12-14 20:49:10.247 INFO  com.job.EbookSnapshotJob                          :35   [32m125942156597792768[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:49:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125942177531564032[0;39m 生成今日电子书快照开始
2021-12-14 20:49:15.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942177531564032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:15.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942177531564032[0;39m ==> Parameters: 
2021-12-14 20:49:15.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942177531564032[0;39m <==    Updates: 0
2021-12-14 20:49:15.231 INFO  com.job.EbookSnapshotJob                          :35   [32m125942177531564032[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-14 20:49:20.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125942198498889728[0;39m 生成今日电子书快照开始
2021-12-14 20:49:20.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942198498889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:20.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942198498889728[0;39m ==> Parameters: 
2021-12-14 20:49:20.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942198498889728[0;39m <==    Updates: 0
2021-12-14 20:49:20.219 INFO  com.job.EbookSnapshotJob                          :35   [32m125942198498889728[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:49:25.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125942219428466688[0;39m 生成今日电子书快照开始
2021-12-14 20:49:25.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942219428466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:25.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942219428466688[0;39m ==> Parameters: 
2021-12-14 20:49:25.196 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942219428466688[0;39m <==    Updates: 0
2021-12-14 20:49:25.197 INFO  com.job.EbookSnapshotJob                          :35   [32m125942219428466688[0;39m 生成今日电子书快照结束，耗时：192毫秒
2021-12-14 20:49:30.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125942240416763904[0;39m 生成今日电子书快照开始
2021-12-14 20:49:30.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942240416763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:30.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942240416763904[0;39m ==> Parameters: 
2021-12-14 20:49:30.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942240416763904[0;39m <==    Updates: 0
2021-12-14 20:49:30.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125942240416763904[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-14 20:49:35.020 INFO  com.job.EbookSnapshotJob                          :32   [32m125942261434421248[0;39m 生成今日电子书快照开始
2021-12-14 20:49:35.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942261434421248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:35.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942261434421248[0;39m ==> Parameters: 
2021-12-14 20:49:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942261434421248[0;39m <==    Updates: 0
2021-12-14 20:49:35.223 INFO  com.job.EbookSnapshotJob                          :35   [32m125942261434421248[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:49:35.224 INFO  com.job.DocJob                                    :32   [32m125942262290059264[0;39m 更新电子书下的文档数据开始
2021-12-14 20:49:35.225 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942262290059264[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:49:35.227 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942262290059264[0;39m ==> Parameters: 
2021-12-14 20:49:35.376 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942262290059264[0;39m <==    Updates: 3
2021-12-14 20:49:35.377 INFO  com.job.DocJob                                    :35   [32m125942262290059264[0;39m 更新电子书下的文档数据结束，耗时：153毫秒
2021-12-14 20:49:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125942282359803904[0;39m 生成今日电子书快照开始
2021-12-14 20:49:40.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942282359803904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:40.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942282359803904[0;39m ==> Parameters: 
2021-12-14 20:49:40.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942282359803904[0;39m <==    Updates: 0
2021-12-14 20:49:40.247 INFO  com.job.EbookSnapshotJob                          :35   [32m125942282359803904[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-14 20:49:45.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125942303360684032[0;39m 生成今日电子书快照开始
2021-12-14 20:49:45.120 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942303360684032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:45.126 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942303360684032[0;39m ==> Parameters: 
2021-12-14 20:49:45.274 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942303360684032[0;39m <==    Updates: 0
2021-12-14 20:49:45.274 INFO  com.job.EbookSnapshotJob                          :35   [32m125942303360684032[0;39m 生成今日电子书快照结束，耗时：258毫秒
2021-12-14 20:49:50.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125942324281872384[0;39m 生成今日电子书快照开始
2021-12-14 20:49:50.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942324281872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:50.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942324281872384[0;39m ==> Parameters: 
2021-12-14 20:49:50.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942324281872384[0;39m <==    Updates: 0
2021-12-14 20:49:50.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125942324281872384[0;39m 生成今日电子书快照结束，耗时：211毫秒
2021-12-14 20:49:55.017 INFO  com.job.EbookSnapshotJob                          :32   [32m125942345307918336[0;39m 生成今日电子书快照开始
2021-12-14 20:49:55.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942345307918336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:49:55.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942345307918336[0;39m ==> Parameters: 
2021-12-14 20:49:55.239 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942345307918336[0;39m <==    Updates: 0
2021-12-14 20:49:55.239 INFO  com.job.EbookSnapshotJob                          :35   [32m125942345307918336[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:50:00.017 INFO  com.job.EbookSnapshotJob                          :32   [32m125942366279438336[0;39m 生成今日电子书快照开始
2021-12-14 20:50:00.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942366279438336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:00.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942366279438336[0;39m ==> Parameters: 
2021-12-14 20:50:00.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942366279438336[0;39m <==    Updates: 0
2021-12-14 20:50:00.244 INFO  com.job.EbookSnapshotJob                          :35   [32m125942366279438336[0;39m 生成今日电子书快照结束，耗时：227毫秒
2021-12-14 20:50:03.783 INFO  com.interceptor.LoginInterceptor                  :29   [32m125941998707412992[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:50:03.784 INFO  com.interceptor.LoginInterceptor                  :65   [32m125941998707412992[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2021-12-14 20:50:03.787 INFO  com.interceptor.LoginInterceptor                  :29   [32m125941998724190208[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:50:03.787 INFO  com.interceptor.LoginInterceptor                  :40   [32m125941998724190208[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/save
2021-12-14 20:50:03.788 INFO  com.interceptor.LoginInterceptor                  :44   [32m125941998724190208[0;39m 登录校验开始，token：125941984161566720
2021-12-14 20:50:03.834 INFO  com.interceptor.LoginInterceptor                  :56   [32m125941998724190208[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125941984161566720"}
2021-12-14 20:50:03.841 INFO  com.aspect.LogAspect                              :54   [32m125942382318456832[0;39m ------------- 开始 -------------
2021-12-14 20:50:03.841 INFO  com.aspect.LogAspect                              :55   [32m125942382318456832[0;39m 请求地址: http://localhost:8081/ebook/save POST
2021-12-14 20:50:03.841 INFO  com.aspect.LogAspect                              :56   [32m125942382318456832[0;39m 类名方法: com.controller.EbookController.save
2021-12-14 20:50:03.841 INFO  com.aspect.LogAspect                              :57   [32m125942382318456832[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:50:03.843 INFO  com.aspect.LogAspect                              :80   [32m125942382318456832[0;39m 请求参数: [{"category1Id":500,"category2Id":502,"cover":"/image/cover1.png","description":"Android","name":"Android开发"}]
2021-12-14 20:50:03.923 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125942382318456832[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2021-12-14 20:50:03.924 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125942382318456832[0;39m ==> Parameters: 125942382339428352(Long), Android开发(String), 500(Long), 502(Long), Android(String), /image/cover1.png(String), null, null, null
2021-12-14 20:50:04.069 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125942382318456832[0;39m <==    Updates: 1
2021-12-14 20:50:04.069 INFO  com.aspect.LogAspect                              :92   [32m125942382318456832[0;39m 返回结果: {"success":true}
2021-12-14 20:50:04.069 INFO  com.aspect.LogAspect                              :93   [32m125942382318456832[0;39m ------------- 结束 耗时：228 ms -------------
2021-12-14 20:50:04.070 INFO  com.interceptor.LoginInterceptor                  :65   [32m125942382318456832[0;39m ------------- LoginInterceptor 结束 耗时：283 ms -------------
2021-12-14 20:50:04.113 INFO  com.aspect.LogAspect                              :54   [32m125942383459307520[0;39m ------------- 开始 -------------
2021-12-14 20:50:04.113 INFO  com.aspect.LogAspect                              :55   [32m125942383459307520[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:50:04.113 INFO  com.aspect.LogAspect                              :56   [32m125942383459307520[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:50:04.114 INFO  com.aspect.LogAspect                              :57   [32m125942383459307520[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:50:04.115 INFO  com.aspect.LogAspect                              :80   [32m125942383459307520[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:50:04.177 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942383459307520[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:50:04.178 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942383459307520[0;39m ==> Parameters: 
2021-12-14 20:50:04.237 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942383459307520[0;39m <==    Columns: count(0)
2021-12-14 20:50:04.237 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942383459307520[0;39m <==        Row: 7
2021-12-14 20:50:04.237 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942383459307520[0;39m <==      Total: 1
2021-12-14 20:50:04.238 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942383459307520[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:50:04.238 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942383459307520[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:50:04.310 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:50:04.310 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:50:04.311 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:50:04.311 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:50:04.311 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:50:04.312 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:50:04.312 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:50:04.313 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942383459307520[0;39m <==        Row: 125942382339428352, Android开发, 500, 502, Android, /image/cover1.png, null, null, null
2021-12-14 20:50:04.314 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942383459307520[0;39m <==      Total: 7
2021-12-14 20:50:04.315 INFO  com.servicess.EbookService                        :48   [32m125942383459307520[0;39m 总行数：7
2021-12-14 20:50:04.316 INFO  com.servicess.EbookService                        :49   [32m125942383459307520[0;39m 总页数：1
2021-12-14 20:50:04.319 INFO  com.aspect.LogAspect                              :92   [32m125942383459307520[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45},{"category1Id":500,"category2Id":502,"cover":"/image/cover1.png","description":"Android","id":125942382339428352,"name":"Android开发"}],"total":7},"success":true}
2021-12-14 20:50:04.319 INFO  com.aspect.LogAspect                              :93   [32m125942383459307520[0;39m ------------- 结束 耗时：206 ms -------------
2021-12-14 20:50:05.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125942387200626688[0;39m 生成今日电子书快照开始
2021-12-14 20:50:05.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942387200626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:05.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942387200626688[0;39m ==> Parameters: 
2021-12-14 20:50:05.395 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942387200626688[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:05.398 INFO  com.job.DocJob                                    :32   [32m125942388848988160[0;39m 更新电子书下的文档数据开始
2021-12-14 20:50:05.399 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942388848988160[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:50:05.400 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942388848988160[0;39m ==> Parameters: 
2021-12-14 20:50:05.593 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942388848988160[0;39m <==    Updates: 3
2021-12-14 20:50:05.594 INFO  com.job.DocJob                                    :35   [32m125942388848988160[0;39m 更新电子书下的文档数据结束，耗时：195毫秒
2021-12-14 20:50:10.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125942408167952384[0;39m 生成今日电子书快照开始
2021-12-14 20:50:10.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942408167952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:10.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942408167952384[0;39m ==> Parameters: 
2021-12-14 20:50:10.224 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942408167952384[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125942429189804032[0;39m 生成今日电子书快照开始
2021-12-14 20:50:15.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942429189804032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:15.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942429189804032[0;39m ==> Parameters: 
2021-12-14 20:50:15.323 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942429189804032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:20.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125942450123575296[0;39m 生成今日电子书快照开始
2021-12-14 20:50:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942450123575296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942450123575296[0;39m ==> Parameters: 
2021-12-14 20:50:20.278 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942450123575296[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:25.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125942471141232640[0;39m 生成今日电子书快照开始
2021-12-14 20:50:25.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942471141232640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:25.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942471141232640[0;39m ==> Parameters: 
2021-12-14 20:50:25.287 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942471141232640[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:30.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125942492137918464[0;39m 生成今日电子书快照开始
2021-12-14 20:50:30.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942492137918464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:30.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942492137918464[0;39m ==> Parameters: 
2021-12-14 20:50:30.309 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942492137918464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:35.004 INFO  com.job.DocJob                                    :32   [32m125942513025552384[0;39m 更新电子书下的文档数据开始
2021-12-14 20:50:35.082 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942513025552384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:50:35.082 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942513025552384[0;39m ==> Parameters: 
2021-12-14 20:50:35.287 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942513025552384[0;39m <==    Updates: 3
2021-12-14 20:50:35.287 INFO  com.job.DocJob                                    :35   [32m125942513025552384[0;39m 更新电子书下的文档数据结束，耗时：283毫秒
2021-12-14 20:50:35.287 INFO  com.job.EbookSnapshotJob                          :32   [32m125942514212540416[0;39m 生成今日电子书快照开始
2021-12-14 20:50:35.287 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942514212540416[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:35.287 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942514212540416[0;39m ==> Parameters: 
2021-12-14 20:50:35.415 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942514212540416[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:40.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125942534080958464[0;39m 生成今日电子书快照开始
2021-12-14 20:50:40.118 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942534080958464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:40.118 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942534080958464[0;39m ==> Parameters: 
2021-12-14 20:50:40.371 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942534080958464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:45.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125942554985369600[0;39m 生成今日电子书快照开始
2021-12-14 20:50:45.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942554985369600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:45.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942554985369600[0;39m ==> Parameters: 
2021-12-14 20:50:45.293 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942554985369600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:50.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125942575982055424[0;39m 生成今日电子书快照开始
2021-12-14 20:50:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942575982055424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942575982055424[0;39m ==> Parameters: 
2021-12-14 20:50:50.299 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125942575982055424[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor68.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor65.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:50:53.827 INFO  com.interceptor.LoginInterceptor                  :29   [32m125942006013890560[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:50:53.828 INFO  com.interceptor.LoginInterceptor                  :65   [32m125942006013890560[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2021-12-14 20:50:53.830 INFO  com.interceptor.LoginInterceptor                  :29   [32m125942007498674176[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:50:53.831 INFO  com.interceptor.LoginInterceptor                  :40   [32m125942007498674176[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/delete/125942382339428352
2021-12-14 20:50:53.831 INFO  com.interceptor.LoginInterceptor                  :44   [32m125942007498674176[0;39m 登录校验开始，token：125941984161566720
2021-12-14 20:50:53.888 INFO  com.interceptor.LoginInterceptor                  :56   [32m125942007498674176[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125941984161566720"}
2021-12-14 20:50:53.892 INFO  com.aspect.LogAspect                              :54   [32m125942592247566336[0;39m ------------- 开始 -------------
2021-12-14 20:50:53.893 INFO  com.aspect.LogAspect                              :55   [32m125942592247566336[0;39m 请求地址: http://localhost:8081/ebook/delete/125942382339428352 DELETE
2021-12-14 20:50:53.893 INFO  com.aspect.LogAspect                              :56   [32m125942592247566336[0;39m 类名方法: com.controller.EbookController.delete
2021-12-14 20:50:53.893 INFO  com.aspect.LogAspect                              :57   [32m125942592247566336[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:50:53.893 INFO  com.aspect.LogAspect                              :80   [32m125942592247566336[0;39m 请求参数: [125942382339428352]
2021-12-14 20:50:53.956 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125942592247566336[0;39m ==>  Preparing: delete from ebook where id = ?
2021-12-14 20:50:53.957 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125942592247566336[0;39m ==> Parameters: 125942382339428352(Long)
2021-12-14 20:50:54.079 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125942592247566336[0;39m <==    Updates: 1
2021-12-14 20:50:54.079 INFO  com.aspect.LogAspect                              :92   [32m125942592247566336[0;39m 返回结果: {"success":true}
2021-12-14 20:50:54.080 INFO  com.aspect.LogAspect                              :93   [32m125942592247566336[0;39m ------------- 结束 耗时：188 ms -------------
2021-12-14 20:50:54.081 INFO  com.interceptor.LoginInterceptor                  :65   [32m125942592247566336[0;39m ------------- LoginInterceptor 结束 耗时：250 ms -------------
2021-12-14 20:50:54.103 INFO  com.aspect.LogAspect                              :54   [32m125942593132564480[0;39m ------------- 开始 -------------
2021-12-14 20:50:54.103 INFO  com.aspect.LogAspect                              :55   [32m125942593132564480[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:50:54.103 INFO  com.aspect.LogAspect                              :56   [32m125942593132564480[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:50:54.104 INFO  com.aspect.LogAspect                              :57   [32m125942593132564480[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:50:54.104 INFO  com.aspect.LogAspect                              :80   [32m125942593132564480[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:50:54.180 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942593132564480[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:50:54.180 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942593132564480[0;39m ==> Parameters: 
2021-12-14 20:50:54.329 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942593132564480[0;39m <==    Columns: count(0)
2021-12-14 20:50:54.329 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125942593132564480[0;39m <==        Row: 6
2021-12-14 20:50:54.330 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125942593132564480[0;39m <==      Total: 1
2021-12-14 20:50:54.330 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942593132564480[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:50:54.330 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942593132564480[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:50:54.437 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:50:54.438 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:50:54.438 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:50:54.439 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:50:54.445 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:50:54.446 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:50:54.447 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125942593132564480[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:50:54.447 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125942593132564480[0;39m <==      Total: 6
2021-12-14 20:50:54.449 INFO  com.servicess.EbookService                        :48   [32m125942593132564480[0;39m 总行数：6
2021-12-14 20:50:54.449 INFO  com.servicess.EbookService                        :49   [32m125942593132564480[0;39m 总页数：1
2021-12-14 20:50:54.452 INFO  com.aspect.LogAspect                              :92   [32m125942593132564480[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:50:54.452 INFO  com.aspect.LogAspect                              :93   [32m125942593132564480[0;39m ------------- 结束 耗时：349 ms -------------
2021-12-14 20:50:55.000 INFO  com.job.EbookSnapshotJob                          :32   [32m125942596894855168[0;39m 生成今日电子书快照开始
2021-12-14 20:50:55.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942596894855168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:50:55.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942596894855168[0;39m ==> Parameters: 
2021-12-14 20:50:55.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942596894855168[0;39m <==    Updates: 0
2021-12-14 20:50:55.268 INFO  com.job.EbookSnapshotJob                          :35   [32m125942596894855168[0;39m 生成今日电子书快照结束，耗时：267毫秒
2021-12-14 20:51:00.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125942617929289728[0;39m 生成今日电子书快照开始
2021-12-14 20:51:00.186 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942617929289728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:00.186 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942617929289728[0;39m ==> Parameters: 
2021-12-14 20:51:00.331 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942617929289728[0;39m <==    Updates: 0
2021-12-14 20:51:00.331 INFO  com.job.EbookSnapshotJob                          :35   [32m125942617929289728[0;39m 生成今日电子书快照结束，耗时：316毫秒
2021-12-14 20:51:05.015 INFO  com.job.DocJob                                    :32   [32m125942638900809728[0;39m 更新电子书下的文档数据开始
2021-12-14 20:51:05.078 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942638900809728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:51:05.078 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942638900809728[0;39m ==> Parameters: 
2021-12-14 20:51:05.218 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942638900809728[0;39m <==    Updates: 3
2021-12-14 20:51:05.218 INFO  com.job.DocJob                                    :35   [32m125942638900809728[0;39m 更新电子书下的文档数据结束，耗时：203毫秒
2021-12-14 20:51:05.218 INFO  com.job.EbookSnapshotJob                          :32   [32m125942639752253440[0;39m 生成今日电子书快照开始
2021-12-14 20:51:05.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942639752253440[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:05.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942639752253440[0;39m ==> Parameters: 
2021-12-14 20:51:05.477 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942639752253440[0;39m <==    Updates: 0
2021-12-14 20:51:05.477 INFO  com.job.EbookSnapshotJob                          :35   [32m125942639752253440[0;39m 生成今日电子书快照结束，耗时：259毫秒
2021-12-14 20:51:10.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125942659847163904[0;39m 生成今日电子书快照开始
2021-12-14 20:51:10.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942659847163904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:10.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942659847163904[0;39m ==> Parameters: 
2021-12-14 20:51:10.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942659847163904[0;39m <==    Updates: 0
2021-12-14 20:51:10.230 INFO  com.job.EbookSnapshotJob                          :35   [32m125942659847163904[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-14 20:51:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125942680848044032[0;39m 生成今日电子书快照开始
2021-12-14 20:51:15.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942680848044032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:15.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942680848044032[0;39m ==> Parameters: 
2021-12-14 20:51:15.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942680848044032[0;39m <==    Updates: 0
2021-12-14 20:51:15.219 INFO  com.job.EbookSnapshotJob                          :35   [32m125942680848044032[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:51:20.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125942701786009600[0;39m 生成今日电子书快照开始
2021-12-14 20:51:20.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942701786009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:20.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942701786009600[0;39m ==> Parameters: 
2021-12-14 20:51:20.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942701786009600[0;39m <==    Updates: 0
2021-12-14 20:51:20.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125942701786009600[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 20:51:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125942722786889728[0;39m 生成今日电子书快照开始
2021-12-14 20:51:25.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942722786889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:25.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942722786889728[0;39m ==> Parameters: 
2021-12-14 20:51:25.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942722786889728[0;39m <==    Updates: 0
2021-12-14 20:51:25.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125942722786889728[0;39m 生成今日电子书快照结束，耗时：218毫秒
2021-12-14 20:51:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125942743758409728[0;39m 生成今日电子书快照开始
2021-12-14 20:51:30.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942743758409728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:30.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942743758409728[0;39m ==> Parameters: 
2021-12-14 20:51:30.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942743758409728[0;39m <==    Updates: 0
2021-12-14 20:51:30.265 INFO  com.job.EbookSnapshotJob                          :35   [32m125942743758409728[0;39m 生成今日电子书快照结束，耗时：250毫秒
2021-12-14 20:51:35.016 INFO  com.job.DocJob                                    :32   [32m125942764734124032[0;39m 更新电子书下的文档数据开始
2021-12-14 20:51:35.078 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942764734124032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:51:35.078 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942764734124032[0;39m ==> Parameters: 
2021-12-14 20:51:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125942764734124032[0;39m <==    Updates: 3
2021-12-14 20:51:35.234 INFO  com.job.DocJob                                    :35   [32m125942764734124032[0;39m 更新电子书下的文档数据结束，耗时：218毫秒
2021-12-14 20:51:35.234 INFO  com.job.EbookSnapshotJob                          :32   [32m125942765648482304[0;39m 生成今日电子书快照开始
2021-12-14 20:51:35.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942765648482304[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:35.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942765648482304[0;39m ==> Parameters: 
2021-12-14 20:51:35.394 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942765648482304[0;39m <==    Updates: 0
2021-12-14 20:51:35.394 INFO  com.job.EbookSnapshotJob                          :35   [32m125942765648482304[0;39m 生成今日电子书快照结束，耗时：160毫秒
2021-12-14 20:51:40.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125942785646923776[0;39m 生成今日电子书快照开始
2021-12-14 20:51:40.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942785646923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:40.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942785646923776[0;39m ==> Parameters: 
2021-12-14 20:51:40.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942785646923776[0;39m <==    Updates: 0
2021-12-14 20:51:40.240 INFO  com.job.EbookSnapshotJob                          :35   [32m125942785646923776[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-14 20:51:45.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125942806685552640[0;39m 生成今日电子书快照开始
2021-12-14 20:51:45.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942806685552640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:51:45.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942806685552640[0;39m ==> Parameters: 
2021-12-14 20:52:24.793 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 5952 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 20:52:24.793 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 20:52:24.801 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-14 20:52:24.853 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-14 20:52:24.853 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-14 20:52:26.069 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 20:52:26.069 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 20:52:26.516 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 432 ms. Found 0 Redis repository interfaces.
2021-12-14 20:52:27.094 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 20:52:27.094 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 20:52:27.094 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 20:52:27.094 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 20:52:27.156 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 20:52:27.156 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2303 ms
2021-12-14 20:52:28.499 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-14 20:52:28.530 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-14 20:52:28.546 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-14 20:52:28.562 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 4.515 seconds (JVM running for 5.793)
2021-12-14 20:52:30.030 INFO  com.job.EbookSnapshotJob                          :32   [32m125942995479564288[0;39m 生成今日电子书快照开始
2021-12-14 20:52:30.030 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125942995479564288[0;39m HikariPool-1 - Starting...
2021-12-14 20:52:30.815 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125942995479564288[0;39m HikariPool-1 - Start completed.
2021-12-14 20:52:30.831 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942995479564288[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:30.847 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942995479564288[0;39m ==> Parameters: 
2021-12-14 20:52:30.992 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125942995479564288[0;39m <==    Updates: 0
2021-12-14 20:52:30.992 INFO  com.job.EbookSnapshotJob                          :35   [32m125942995479564288[0;39m 生成今日电子书快照结束，耗时：962毫秒
2021-12-14 20:52:35.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125943016383975424[0;39m 生成今日电子书快照开始
2021-12-14 20:52:35.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943016383975424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:35.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943016383975424[0;39m ==> Parameters: 
2021-12-14 20:52:35.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943016383975424[0;39m <==    Updates: 0
2021-12-14 20:52:35.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125943016383975424[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:52:35.233 INFO  com.job.DocJob                                    :32   [32m125943017302528000[0;39m 更新电子书下的文档数据开始
2021-12-14 20:52:35.248 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943017302528000[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:52:35.248 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943017302528000[0;39m ==> Parameters: 
2021-12-14 20:52:35.377 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943017302528000[0;39m <==    Updates: 3
2021-12-14 20:52:35.377 INFO  com.job.DocJob                                    :35   [32m125943017302528000[0;39m 更新电子书下的文档数据结束，耗时：144毫秒
2021-12-14 20:52:40.017 INFO  com.job.EbookSnapshotJob                          :32   [32m125943037368078336[0;39m 生成今日电子书快照开始
2021-12-14 20:52:40.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943037368078336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:40.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943037368078336[0;39m ==> Parameters: 
2021-12-14 20:52:40.393 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943037368078336[0;39m <==    Updates: 0
2021-12-14 20:52:40.393 INFO  com.job.EbookSnapshotJob                          :35   [32m125943037368078336[0;39m 生成今日电子书快照结束，耗时：376毫秒
2021-12-14 20:52:45.019 INFO  com.job.EbookSnapshotJob                          :32   [32m125943058347986944[0;39m 生成今日电子书快照开始
2021-12-14 20:52:45.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943058347986944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:45.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943058347986944[0;39m ==> Parameters: 
2021-12-14 20:52:45.203 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943058347986944[0;39m <==    Updates: 0
2021-12-14 20:52:45.203 INFO  com.job.EbookSnapshotJob                          :35   [32m125943058347986944[0;39m 生成今日电子书快照结束，耗时：184毫秒
2021-12-14 20:52:50.023 INFO  com.job.EbookSnapshotJob                          :32   [32m125943079336284160[0;39m 生成今日电子书快照开始
2021-12-14 20:52:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943079336284160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943079336284160[0;39m ==> Parameters: 
2021-12-14 20:52:50.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943079336284160[0;39m <==    Updates: 0
2021-12-14 20:52:50.214 INFO  com.job.EbookSnapshotJob                          :35   [32m125943079336284160[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:52:55.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943100286832640[0;39m 生成今日电子书快照开始
2021-12-14 20:52:55.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943100286832640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:52:55.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943100286832640[0;39m ==> Parameters: 
2021-12-14 20:52:55.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943100286832640[0;39m <==    Updates: 0
2021-12-14 20:52:55.255 INFO  com.job.EbookSnapshotJob                          :35   [32m125943100286832640[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-14 20:53:00.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943121245769728[0;39m 生成今日电子书快照开始
2021-12-14 20:53:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943121245769728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943121245769728[0;39m ==> Parameters: 
2021-12-14 20:53:00.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943121245769728[0;39m <==    Updates: 0
2021-12-14 20:53:00.249 INFO  com.job.EbookSnapshotJob                          :35   [32m125943121245769728[0;39m 生成今日电子书快照结束，耗时：234毫秒
2021-12-14 20:53:05.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125943142192123904[0;39m 生成今日电子书快照开始
2021-12-14 20:53:05.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943142192123904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:05.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943142192123904[0;39m ==> Parameters: 
2021-12-14 20:53:05.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943142192123904[0;39m <==    Updates: 0
2021-12-14 20:53:05.231 INFO  com.job.EbookSnapshotJob                          :35   [32m125943142192123904[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:53:05.231 INFO  com.job.DocJob                                    :32   [32m125943143123259392[0;39m 更新电子书下的文档数据开始
2021-12-14 20:53:05.231 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943143123259392[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:53:05.231 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943143123259392[0;39m ==> Parameters: 
2021-12-14 20:53:05.403 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943143123259392[0;39m <==    Updates: 3
2021-12-14 20:53:05.403 INFO  com.job.DocJob                                    :35   [32m125943143123259392[0;39m 更新电子书下的文档数据结束，耗时：172毫秒
2021-12-14 20:53:10.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125943163193004032[0;39m 生成今日电子书快照开始
2021-12-14 20:53:10.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943163193004032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:10.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943163193004032[0;39m ==> Parameters: 
2021-12-14 20:53:10.277 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943163193004032[0;39m <==    Updates: 0
2021-12-14 20:53:10.277 INFO  com.job.EbookSnapshotJob                          :35   [32m125943163193004032[0;39m 生成今日电子书快照结束，耗时：261毫秒
2021-12-14 20:53:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943184160329728[0;39m 生成今日电子书快照开始
2021-12-14 20:53:15.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943184160329728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:15.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943184160329728[0;39m ==> Parameters: 
2021-12-14 20:53:15.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943184160329728[0;39m <==    Updates: 0
2021-12-14 20:53:15.218 INFO  com.job.EbookSnapshotJob                          :35   [32m125943184160329728[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-14 20:53:20.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943205144432640[0;39m 生成今日电子书快照开始
2021-12-14 20:53:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943205144432640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943205144432640[0;39m ==> Parameters: 
2021-12-14 20:53:20.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943205144432640[0;39m <==    Updates: 0
2021-12-14 20:53:20.209 INFO  com.job.EbookSnapshotJob                          :35   [32m125943205144432640[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:53:25.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125943226107564032[0;39m 生成今日电子书快照开始
2021-12-14 20:53:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943226107564032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943226107564032[0;39m ==> Parameters: 
2021-12-14 20:53:25.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943226107564032[0;39m <==    Updates: 0
2021-12-14 20:53:25.231 INFO  com.job.EbookSnapshotJob                          :35   [32m125943226107564032[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-14 20:53:30.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943247087472640[0;39m 生成今日电子书快照开始
2021-12-14 20:53:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943247087472640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943247087472640[0;39m ==> Parameters: 
2021-12-14 20:53:30.224 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943247087472640[0;39m <==    Updates: 0
2021-12-14 20:53:30.240 INFO  com.job.EbookSnapshotJob                          :35   [32m125943247087472640[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 20:53:35.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125943268021243904[0;39m 生成今日电子书快照开始
2021-12-14 20:53:35.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943268021243904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:35.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943268021243904[0;39m ==> Parameters: 
2021-12-14 20:53:35.200 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943268021243904[0;39m <==    Updates: 0
2021-12-14 20:53:35.200 INFO  com.job.EbookSnapshotJob                          :35   [32m125943268021243904[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:53:35.215 INFO  com.job.DocJob                                    :32   [32m125943268885270528[0;39m 更新电子书下的文档数据开始
2021-12-14 20:53:35.215 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943268885270528[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:53:35.215 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943268885270528[0;39m ==> Parameters: 
2021-12-14 20:53:35.346 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943268885270528[0;39m <==    Updates: 3
2021-12-14 20:53:35.346 INFO  com.job.DocJob                                    :35   [32m125943268885270528[0;39m 更新电子书下的文档数据结束，耗时：131毫秒
2021-12-14 20:53:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943289017929728[0;39m 生成今日电子书快照开始
2021-12-14 20:53:40.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943289017929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:40.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943289017929728[0;39m ==> Parameters: 
2021-12-14 20:53:40.239 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943289017929728[0;39m <==    Updates: 0
2021-12-14 20:53:40.239 INFO  com.job.EbookSnapshotJob                          :35   [32m125943289017929728[0;39m 生成今日电子书快照结束，耗时：224毫秒
2021-12-14 20:53:45.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943310002032640[0;39m 生成今日电子书快照开始
2021-12-14 20:53:45.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943310002032640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:45.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943310002032640[0;39m ==> Parameters: 
2021-12-14 20:53:45.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943310002032640[0;39m <==    Updates: 0
2021-12-14 20:53:45.246 INFO  com.job.EbookSnapshotJob                          :35   [32m125943310002032640[0;39m 生成今日电子书快照结束，耗时：228毫秒
2021-12-14 20:53:50.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943330960969728[0;39m 生成今日电子书快照开始
2021-12-14 20:53:50.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943330960969728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:50.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943330960969728[0;39m ==> Parameters: 
2021-12-14 20:53:50.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943330960969728[0;39m <==    Updates: 0
2021-12-14 20:53:50.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125943330960969728[0;39m 生成今日电子书快照结束，耗时：218毫秒
2021-12-14 20:53:55.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943351932489728[0;39m 生成今日电子书快照开始
2021-12-14 20:53:55.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943351932489728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:53:55.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943351932489728[0;39m ==> Parameters: 
2021-12-14 20:53:55.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943351932489728[0;39m <==    Updates: 0
2021-12-14 20:53:55.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125943351932489728[0;39m 生成今日电子书快照结束，耗时：218毫秒
2021-12-14 20:54:00.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943372904009728[0;39m 生成今日电子书快照开始
2021-12-14 20:54:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943372904009728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943372904009728[0;39m ==> Parameters: 
2021-12-14 20:54:00.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943372904009728[0;39m <==    Updates: 0
2021-12-14 20:54:00.234 INFO  com.job.EbookSnapshotJob                          :35   [32m125943372904009728[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:54:05.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125943393913278464[0;39m 生成今日电子书快照开始
2021-12-14 20:54:05.549 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943393913278464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:05.565 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943393913278464[0;39m ==> Parameters: 
2021-12-14 20:54:05.756 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943393913278464[0;39m <==    Updates: 0
2021-12-14 20:54:05.756 INFO  com.job.EbookSnapshotJob                          :35   [32m125943393913278464[0;39m 生成今日电子书快照结束，耗时：732毫秒
2021-12-14 20:54:05.756 INFO  com.job.DocJob                                    :32   [32m125943396983508992[0;39m 更新电子书下的文档数据开始
2021-12-14 20:54:05.756 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943396983508992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:54:05.756 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943396983508992[0;39m ==> Parameters: 
2021-12-14 20:54:05.930 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943396983508992[0;39m <==    Updates: 3
2021-12-14 20:54:05.930 INFO  com.job.DocJob                                    :35   [32m125943396983508992[0;39m 更新电子书下的文档数据结束，耗时：174毫秒
2021-12-14 20:54:10.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943414847049728[0;39m 生成今日电子书快照开始
2021-12-14 20:54:10.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943414847049728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:10.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943414847049728[0;39m ==> Parameters: 
2021-12-14 20:54:10.299 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943414847049728[0;39m <==    Updates: 0
2021-12-14 20:54:10.299 INFO  com.job.EbookSnapshotJob                          :35   [32m125943414847049728[0;39m 生成今日电子书快照结束，耗时：284毫秒
2021-12-14 20:54:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943435831152640[0;39m 生成今日电子书快照开始
2021-12-14 20:54:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943435831152640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943435831152640[0;39m ==> Parameters: 
2021-12-14 20:54:15.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943435831152640[0;39m <==    Updates: 0
2021-12-14 20:54:15.209 INFO  com.job.EbookSnapshotJob                          :35   [32m125943435831152640[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:54:20.019 INFO  com.job.EbookSnapshotJob                          :32   [32m125943456806866944[0;39m 生成今日电子书快照开始
2021-12-14 20:54:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943456806866944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943456806866944[0;39m ==> Parameters: 
2021-12-14 20:54:20.224 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943456806866944[0;39m <==    Updates: 0
2021-12-14 20:54:20.224 INFO  com.job.EbookSnapshotJob                          :35   [32m125943456806866944[0;39m 生成今日电子书快照结束，耗时：205毫秒
2021-12-14 20:54:25.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125943477799358464[0;39m 生成今日电子书快照开始
2021-12-14 20:54:25.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943477799358464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:25.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943477799358464[0;39m ==> Parameters: 
2021-12-14 20:54:25.278 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943477799358464[0;39m <==    Updates: 0
2021-12-14 20:54:25.278 INFO  com.job.EbookSnapshotJob                          :35   [32m125943477799358464[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-14 20:54:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125943498728935424[0;39m 生成今日电子书快照开始
2021-12-14 20:54:30.038 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-14 20:54:30.038 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-14 20:54:30.039 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-14 20:54:30.081 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：ivaUeYN7Jm，session id：0，当前连接数：1
2021-12-14 20:54:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943498728935424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943498728935424[0;39m ==> Parameters: 
2021-12-14 20:54:30.228 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943498728935424[0;39m <==    Updates: 0
2021-12-14 20:54:30.228 INFO  com.job.EbookSnapshotJob                          :35   [32m125943498728935424[0;39m 生成今日电子书快照结束，耗时：214毫秒
2021-12-14 20:54:30.253 INFO  com.aspect.LogAspect                              :54   [32m125943499727179776[0;39m ------------- 开始 -------------
2021-12-14 20:54:30.253 INFO  com.aspect.LogAspect                              :54   [32m125943499722985473[0;39m ------------- 开始 -------------
2021-12-14 20:54:30.253 INFO  com.aspect.LogAspect                              :54   [32m125943499722985472[0;39m ------------- 开始 -------------
2021-12-14 20:54:30.254 INFO  com.aspect.LogAspect                              :55   [32m125943499722985472[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:54:30.254 INFO  com.aspect.LogAspect                              :55   [32m125943499722985473[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:54:30.254 INFO  com.aspect.LogAspect                              :55   [32m125943499727179776[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :56   [32m125943499722985472[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :56   [32m125943499727179776[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :56   [32m125943499722985473[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :57   [32m125943499727179776[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :57   [32m125943499722985472[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:30.255 INFO  com.aspect.LogAspect                              :57   [32m125943499722985473[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:30.307 INFO  com.aspect.LogAspect                              :80   [32m125943499722985472[0;39m 请求参数: []
2021-12-14 20:54:30.307 INFO  com.aspect.LogAspect                              :80   [32m125943499727179776[0;39m 请求参数: []
2021-12-14 20:54:30.307 INFO  com.aspect.LogAspect                              :80   [32m125943499722985473[0;39m 请求参数: []
2021-12-14 20:54:30.314 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943499722985472[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:54:30.315 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943499722985472[0;39m ==> Parameters: 
2021-12-14 20:54:30.384 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943499722985473[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:54:30.386 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943499722985473[0;39m ==> Parameters: 
2021-12-14 20:54:30.403 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943499727179776[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:54:30.404 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943499722985472[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:54:30.404 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943499727179776[0;39m ==> Parameters: 
2021-12-14 20:54:30.405 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943499722985472[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:54:30.408 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943499722985472[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:54:30.409 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943499722985472[0;39m <==      Total: 2
2021-12-14 20:54:30.432 INFO  com.aspect.LogAspect                              :92   [32m125943499722985472[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:54:30.433 INFO  com.aspect.LogAspect                              :93   [32m125943499722985472[0;39m ------------- 结束 耗时：181 ms -------------
2021-12-14 20:54:30.461 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943499722985473[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:54:30.461 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943499722985473[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:54:30.463 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943499722985473[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:54:30.465 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943499722985473[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:54:30.467 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943499722985473[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:54:30.469 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943499722985473[0;39m <==      Total: 4
2021-12-14 20:54:30.469 INFO  com.aspect.LogAspect                              :92   [32m125943499722985473[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:54:30.470 INFO  com.aspect.LogAspect                              :93   [32m125943499722985473[0;39m ------------- 结束 耗时：219 ms -------------
2021-12-14 20:54:30.473 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:54:30.473 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:54:30.474 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:54:30.475 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:54:30.476 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:54:30.476 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:54:30.477 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:54:30.478 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:54:30.479 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:54:30.483 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:54:30.484 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:54:30.485 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:54:30.486 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:54:30.486 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:54:30.487 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:54:30.488 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:54:30.489 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:54:30.491 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:54:30.492 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:54:30.493 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943499727179776[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:54:30.493 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943499727179776[0;39m <==      Total: 19
2021-12-14 20:54:30.511 INFO  com.aspect.LogAspect                              :92   [32m125943499727179776[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:54:30.511 INFO  com.aspect.LogAspect                              :93   [32m125943499727179776[0;39m ------------- 结束 耗时：259 ms -------------
2021-12-14 20:54:35.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943519704649728[0;39m 生成今日电子书快照开始
2021-12-14 20:54:35.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943519704649728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:35.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943519704649728[0;39m ==> Parameters: 
2021-12-14 20:54:35.202 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943519704649728[0;39m <==    Updates: 0
2021-12-14 20:54:35.202 INFO  com.job.EbookSnapshotJob                          :35   [32m125943519704649728[0;39m 生成今日电子书快照结束，耗时：187毫秒
2021-12-14 20:54:35.202 INFO  com.job.DocJob                                    :32   [32m125943520488984576[0;39m 更新电子书下的文档数据开始
2021-12-14 20:54:35.202 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943520488984576[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:54:35.202 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943520488984576[0;39m ==> Parameters: 
2021-12-14 20:54:35.331 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943520488984576[0;39m <==    Updates: 3
2021-12-14 20:54:35.347 INFO  com.job.DocJob                                    :35   [32m125943520488984576[0;39m 更新电子书下的文档数据结束，耗时：145毫秒
2021-12-14 20:54:38.568 INFO  com.aspect.LogAspect                              :54   [32m125943534607011840[0;39m ------------- 开始 -------------
2021-12-14 20:54:38.568 INFO  com.aspect.LogAspect                              :55   [32m125943534607011840[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-14 20:54:38.569 INFO  com.aspect.LogAspect                              :56   [32m125943534607011840[0;39m 类名方法: com.controller.UserController.login
2021-12-14 20:54:38.569 INFO  com.aspect.LogAspect                              :57   [32m125943534607011840[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:38.570 INFO  com.aspect.LogAspect                              :80   [32m125943534607011840[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-14 20:54:38.652 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125943534607011840[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-14 20:54:38.652 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125943534607011840[0;39m ==> Parameters: test123(String)
2021-12-14 20:54:38.717 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125943534607011840[0;39m <==    Columns: id, login_name, name, password
2021-12-14 20:54:38.718 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125943534607011840[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 20:54:38.719 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125943534607011840[0;39m <==      Total: 1
2021-12-14 20:54:38.731 INFO  com.controller.UserController                     :77   [32m125943534607011840[0;39m 生成单点登录token:125943535290683392,并放入redis中
2021-12-14 20:54:39.324 INFO  com.aspect.LogAspect                              :92   [32m125943534607011840[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125943535290683392"},"success":true}
2021-12-14 20:54:39.324 INFO  com.aspect.LogAspect                              :93   [32m125943534607011840[0;39m ------------- 结束 耗时：756 ms -------------
2021-12-14 20:54:39.397 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：ivaUeYN7Jm，session id：0！当前连接数：0
2021-12-14 20:54:40.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125943540667781120[0;39m 生成今日电子书快照开始
2021-12-14 20:54:40.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943540667781120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:40.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943540667781120[0;39m ==> Parameters: 
2021-12-14 20:54:40.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943540667781120[0;39m <==    Updates: 0
2021-12-14 20:54:40.218 INFO  com.job.EbookSnapshotJob                          :35   [32m125943540667781120[0;39m 生成今日电子书快照结束，耗时：205毫秒
2021-12-14 20:54:40.492 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：ZBrtvQbkd6，session id：1，当前连接数：1
2021-12-14 20:54:40.578 INFO  com.aspect.LogAspect                              :54   [32m125943543037562880[0;39m ------------- 开始 -------------
2021-12-14 20:54:40.578 INFO  com.aspect.LogAspect                              :55   [32m125943543037562880[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:54:40.578 INFO  com.aspect.LogAspect                              :56   [32m125943543037562880[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:54:40.579 INFO  com.aspect.LogAspect                              :57   [32m125943543037562880[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:40.579 INFO  com.aspect.LogAspect                              :80   [32m125943543037562880[0;39m 请求参数: []
2021-12-14 20:54:40.582 INFO  com.aspect.LogAspect                              :54   [32m125943543054340096[0;39m ------------- 开始 -------------
2021-12-14 20:54:40.582 INFO  com.aspect.LogAspect                              :55   [32m125943543054340096[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:54:40.582 INFO  com.aspect.LogAspect                              :56   [32m125943543054340096[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:54:40.582 INFO  com.aspect.LogAspect                              :57   [32m125943543054340096[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:40.583 INFO  com.aspect.LogAspect                              :80   [32m125943543054340096[0;39m 请求参数: []
2021-12-14 20:54:40.597 INFO  com.aspect.LogAspect                              :54   [32m125943543117254656[0;39m ------------- 开始 -------------
2021-12-14 20:54:40.597 INFO  com.aspect.LogAspect                              :55   [32m125943543117254656[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:54:40.598 INFO  com.aspect.LogAspect                              :56   [32m125943543117254656[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:54:40.598 INFO  com.aspect.LogAspect                              :57   [32m125943543117254656[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:40.599 INFO  com.aspect.LogAspect                              :80   [32m125943543117254656[0;39m 请求参数: []
2021-12-14 20:54:40.643 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943543037562880[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:54:40.643 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943543037562880[0;39m ==> Parameters: 
2021-12-14 20:54:40.658 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943543054340096[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:54:40.659 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943543054340096[0;39m ==> Parameters: 
2021-12-14 20:54:40.687 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943543117254656[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:54:40.688 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943543117254656[0;39m ==> Parameters: 
2021-12-14 20:54:40.729 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943543037562880[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:54:40.731 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943543037562880[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:54:40.732 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125943543037562880[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:54:40.733 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125943543037562880[0;39m <==      Total: 2
2021-12-14 20:54:40.734 INFO  com.aspect.LogAspect                              :92   [32m125943543037562880[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:54:40.735 INFO  com.aspect.LogAspect                              :93   [32m125943543037562880[0;39m ------------- 结束 耗时：157 ms -------------
2021-12-14 20:54:40.738 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:54:40.739 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:54:40.740 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:54:40.742 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:54:40.743 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:54:40.744 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:54:40.746 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:54:40.747 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:54:40.747 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:54:40.748 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:54:40.749 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:54:40.749 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:54:40.750 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:54:40.751 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:54:40.752 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:54:40.752 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:54:40.753 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:54:40.753 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:54:40.754 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:54:40.754 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943543054340096[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:54:40.755 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943543054340096[0;39m <==      Total: 19
2021-12-14 20:54:40.758 INFO  com.aspect.LogAspect                              :92   [32m125943543054340096[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:54:40.759 INFO  com.aspect.LogAspect                              :93   [32m125943543054340096[0;39m ------------- 结束 耗时：177 ms -------------
2021-12-14 20:54:40.763 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943543117254656[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:54:40.763 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943543117254656[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:54:40.764 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943543117254656[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:54:40.765 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943543117254656[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:54:40.766 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125943543117254656[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:54:40.767 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125943543117254656[0;39m <==      Total: 4
2021-12-14 20:54:40.768 INFO  com.aspect.LogAspect                              :92   [32m125943543117254656[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:54:40.768 INFO  com.aspect.LogAspect                              :93   [32m125943543117254656[0;39m ------------- 结束 耗时：171 ms -------------
2021-12-14 20:54:43.744 INFO  com.aspect.LogAspect                              :54   [32m125943556316729344[0;39m ------------- 开始 -------------
2021-12-14 20:54:43.744 INFO  com.aspect.LogAspect                              :55   [32m125943556316729344[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:54:43.745 INFO  com.aspect.LogAspect                              :56   [32m125943556316729344[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:54:43.745 INFO  com.aspect.LogAspect                              :57   [32m125943556316729344[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:43.745 INFO  com.aspect.LogAspect                              :80   [32m125943556316729344[0;39m 请求参数: []
2021-12-14 20:54:43.862 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943556316729344[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:54:43.863 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943556316729344[0;39m ==> Parameters: 
2021-12-14 20:54:43.927 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:54:43.928 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:54:43.928 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:54:43.929 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:54:43.930 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:54:43.931 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:54:43.932 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:54:43.933 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:54:43.935 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:54:43.936 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:54:43.937 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:54:43.940 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:54:43.942 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:54:43.944 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:54:43.945 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:54:43.945 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:54:43.946 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:54:43.947 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:54:43.948 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:54:43.948 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125943556316729344[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:54:43.949 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125943556316729344[0;39m <==      Total: 19
2021-12-14 20:54:43.956 INFO  com.aspect.LogAspect                              :92   [32m125943556316729344[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:54:43.958 INFO  com.aspect.LogAspect                              :93   [32m125943556316729344[0;39m ------------- 结束 耗时：214 ms -------------
2021-12-14 20:54:44.032 INFO  com.aspect.LogAspect                              :54   [32m125943557524688896[0;39m ------------- 开始 -------------
2021-12-14 20:54:44.032 INFO  com.aspect.LogAspect                              :55   [32m125943557524688896[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:54:44.032 INFO  com.aspect.LogAspect                              :56   [32m125943557524688896[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:54:44.032 INFO  com.aspect.LogAspect                              :57   [32m125943557524688896[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:54:44.035 INFO  com.aspect.LogAspect                              :80   [32m125943557524688896[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:54:44.233 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943557524688896[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:54:44.234 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943557524688896[0;39m ==> Parameters: 
2021-12-14 20:54:44.305 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125943557524688896[0;39m <==    Columns: count(0)
2021-12-14 20:54:44.306 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125943557524688896[0;39m <==        Row: 6
2021-12-14 20:54:44.309 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943557524688896[0;39m <==      Total: 1
2021-12-14 20:54:44.316 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943557524688896[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:54:44.317 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943557524688896[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:54:44.389 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:54:44.390 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:54:44.392 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:54:44.394 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:54:44.396 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:54:44.398 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:54:44.399 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943557524688896[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:54:44.400 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943557524688896[0;39m <==      Total: 6
2021-12-14 20:54:44.403 INFO  com.servicess.EbookService                        :48   [32m125943557524688896[0;39m 总行数：6
2021-12-14 20:54:44.403 INFO  com.servicess.EbookService                        :49   [32m125943557524688896[0;39m 总页数：1
2021-12-14 20:54:44.428 INFO  com.aspect.LogAspect                              :92   [32m125943557524688896[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:54:44.428 INFO  com.aspect.LogAspect                              :93   [32m125943557524688896[0;39m ------------- 结束 耗时：396 ms -------------
2021-12-14 20:54:45.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125943561635106816[0;39m 生成今日电子书快照开始
2021-12-14 20:54:45.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943561635106816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:45.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943561635106816[0;39m ==> Parameters: 
2021-12-14 20:54:45.226 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943561635106816[0;39m <==    Updates: 0
2021-12-14 20:54:45.227 INFO  com.job.EbookSnapshotJob                          :35   [32m125943561635106816[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-14 20:54:50.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125943582564683776[0;39m 生成今日电子书快照开始
2021-12-14 20:54:50.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943582564683776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943582564683776[0;39m ==> Parameters: 
2021-12-14 20:54:50.204 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943582564683776[0;39m <==    Updates: 0
2021-12-14 20:54:50.205 INFO  com.job.EbookSnapshotJob                          :35   [32m125943582564683776[0;39m 生成今日电子书快照结束，耗时：202毫秒
2021-12-14 20:54:55.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125943603548786688[0;39m 生成今日电子书快照开始
2021-12-14 20:54:55.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943603548786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:54:55.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943603548786688[0;39m ==> Parameters: 
2021-12-14 20:54:55.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943603548786688[0;39m <==    Updates: 0
2021-12-14 20:54:55.220 INFO  com.job.EbookSnapshotJob                          :35   [32m125943603548786688[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-14 20:55:00.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125943624545472512[0;39m 生成今日电子书快照开始
2021-12-14 20:55:00.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943624545472512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:00.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943624545472512[0;39m ==> Parameters: 
2021-12-14 20:55:00.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943624545472512[0;39m <==    Updates: 0
2021-12-14 20:55:00.232 INFO  com.job.EbookSnapshotJob                          :35   [32m125943624545472512[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-14 20:55:05.010 INFO  com.job.DocJob                                    :32   [32m125943645512798208[0;39m 更新电子书下的文档数据开始
2021-12-14 20:55:05.071 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943645512798208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:55:05.073 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943645512798208[0;39m ==> Parameters: 
2021-12-14 20:55:05.198 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943645512798208[0;39m <==    Updates: 3
2021-12-14 20:55:05.198 INFO  com.job.DocJob                                    :35   [32m125943645512798208[0;39m 更新电子书下的文档数据结束，耗时：187毫秒
2021-12-14 20:55:05.198 INFO  com.job.EbookSnapshotJob                          :32   [32m125943646301327360[0;39m 生成今日电子书快照开始
2021-12-14 20:55:05.199 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943646301327360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:05.199 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943646301327360[0;39m ==> Parameters: 
2021-12-14 20:55:05.334 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943646301327360[0;39m <==    Updates: 0
2021-12-14 20:55:05.334 INFO  com.job.EbookSnapshotJob                          :35   [32m125943646301327360[0;39m 生成今日电子书快照结束，耗时：136毫秒
2021-12-14 20:55:10.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125943666471735296[0;39m 生成今日电子书快照开始
2021-12-14 20:55:10.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943666471735296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:10.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943666471735296[0;39m ==> Parameters: 
2021-12-14 20:55:10.261 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943666471735296[0;39m <==    Updates: 0
2021-12-14 20:55:10.261 INFO  com.job.EbookSnapshotJob                          :35   [32m125943666471735296[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-14 20:55:15.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125943687514558464[0;39m 生成今日电子书快照开始
2021-12-14 20:55:15.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943687514558464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:15.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943687514558464[0;39m ==> Parameters: 
2021-12-14 20:55:15.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943687514558464[0;39m <==    Updates: 0
2021-12-14 20:55:15.264 INFO  com.job.EbookSnapshotJob                          :35   [32m125943687514558464[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-14 20:55:20.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125943708414775296[0;39m 生成今日电子书快照开始
2021-12-14 20:55:20.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943708414775296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:20.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943708414775296[0;39m ==> Parameters: 
2021-12-14 20:55:20.205 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943708414775296[0;39m <==    Updates: 0
2021-12-14 20:55:20.206 INFO  com.job.EbookSnapshotJob                          :35   [32m125943708414775296[0;39m 生成今日电子书快照结束，耗时：198毫秒
2021-12-14 20:55:25.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125943729373712384[0;39m 生成今日电子书快照开始
2021-12-14 20:55:25.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943729373712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:25.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943729373712384[0;39m ==> Parameters: 
2021-12-14 20:55:25.295 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943729373712384[0;39m <==    Updates: 0
2021-12-14 20:55:25.295 INFO  com.job.EbookSnapshotJob                          :35   [32m125943729373712384[0;39m 生成今日电子书快照结束，耗时：291毫秒
2021-12-14 20:55:30.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125943750362009600[0;39m 生成今日电子书快照开始
2021-12-14 20:55:30.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943750362009600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:30.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943750362009600[0;39m ==> Parameters: 
2021-12-14 20:55:30.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943750362009600[0;39m <==    Updates: 0
2021-12-14 20:55:30.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125943750362009600[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 20:55:32.280 INFO  com.interceptor.LoginInterceptor                  :29   [32m125943499727179776[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:55:32.280 INFO  com.interceptor.LoginInterceptor                  :40   [32m125943499727179776[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/save
2021-12-14 20:55:32.280 INFO  com.interceptor.LoginInterceptor                  :44   [32m125943499727179776[0;39m 登录校验开始，token：125943535290683392
2021-12-14 20:55:32.330 INFO  com.interceptor.LoginInterceptor                  :56   [32m125943499727179776[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125943535290683392"}
2021-12-14 20:55:32.340 INFO  com.aspect.LogAspect                              :54   [32m125943760143126528[0;39m ------------- 开始 -------------
2021-12-14 20:55:32.340 INFO  com.aspect.LogAspect                              :55   [32m125943760143126528[0;39m 请求地址: http://localhost:8081/ebook/save POST
2021-12-14 20:55:32.341 INFO  com.aspect.LogAspect                              :56   [32m125943760143126528[0;39m 类名方法: com.controller.EbookController.save
2021-12-14 20:55:32.341 INFO  com.aspect.LogAspect                              :57   [32m125943760143126528[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:55:32.343 INFO  com.aspect.LogAspect                              :80   [32m125943760143126528[0;39m 请求参数: [{"category1Id":500,"category2Id":502,"cover":"/image/cover1.png","description":"零基础入门Android开发","name":"Android开发"}]
2021-12-14 20:55:32.416 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125943760143126528[0;39m ==>  Preparing: insert into ebook ( id, `name`, category1_id, category2_id, description, cover ) values ( ?, ?, ?, ?, ?, ? )
2021-12-14 20:55:32.419 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125943760143126528[0;39m ==> Parameters: 125943760172486656(Long), Android开发(String), 500(Long), 502(Long), 零基础入门Android开发(String), /image/cover1.png(String)
2021-12-14 20:55:32.558 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125943760143126528[0;39m <==    Updates: 1
2021-12-14 20:55:32.558 INFO  com.aspect.LogAspect                              :92   [32m125943760143126528[0;39m 返回结果: {"success":true}
2021-12-14 20:55:32.558 INFO  com.aspect.LogAspect                              :93   [32m125943760143126528[0;39m ------------- 结束 耗时：218 ms -------------
2021-12-14 20:55:32.560 INFO  com.interceptor.LoginInterceptor                  :65   [32m125943760143126528[0;39m ------------- LoginInterceptor 结束 耗时：280 ms -------------
2021-12-14 20:55:32.599 INFO  com.aspect.LogAspect                              :54   [32m125943761229451264[0;39m ------------- 开始 -------------
2021-12-14 20:55:32.599 INFO  com.aspect.LogAspect                              :55   [32m125943761229451264[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:55:32.599 INFO  com.aspect.LogAspect                              :56   [32m125943761229451264[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:55:32.599 INFO  com.aspect.LogAspect                              :57   [32m125943761229451264[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:55:32.599 INFO  com.aspect.LogAspect                              :80   [32m125943761229451264[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:55:32.670 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943761229451264[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:55:32.670 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943761229451264[0;39m ==> Parameters: 
2021-12-14 20:55:32.758 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125943761229451264[0;39m <==    Columns: count(0)
2021-12-14 20:55:32.758 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125943761229451264[0;39m <==        Row: 7
2021-12-14 20:55:32.758 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125943761229451264[0;39m <==      Total: 1
2021-12-14 20:55:32.759 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943761229451264[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:55:32.759 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943761229451264[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:55:32.833 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:55:32.834 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:55:32.834 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:55:32.835 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:55:32.836 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:55:32.836 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:55:32.837 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:55:32.837 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125943761229451264[0;39m <==        Row: 125943760172486656, Android开发, 500, 502, 零基础入门Android开发, /image/cover1.png, null, null, null
2021-12-14 20:55:32.838 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125943761229451264[0;39m <==      Total: 7
2021-12-14 20:55:32.838 INFO  com.servicess.EbookService                        :48   [32m125943761229451264[0;39m 总行数：7
2021-12-14 20:55:32.839 INFO  com.servicess.EbookService                        :49   [32m125943761229451264[0;39m 总页数：1
2021-12-14 20:55:32.841 INFO  com.aspect.LogAspect                              :92   [32m125943761229451264[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45},{"category1Id":500,"category2Id":502,"cover":"/image/cover1.png","description":"零基础入门Android开发","id":125943760172486656,"name":"Android开发"}],"total":7},"success":true}
2021-12-14 20:55:32.841 INFO  com.aspect.LogAspect                              :93   [32m125943761229451264[0;39m ------------- 结束 耗时：242 ms -------------
2021-12-14 20:55:35.003 INFO  com.job.DocJob                                    :32   [32m125943771312558080[0;39m 更新电子书下的文档数据开始
2021-12-14 20:55:35.049 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943771312558080[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:55:35.066 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943771312558080[0;39m ==> Parameters: 
2021-12-14 20:55:35.256 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943771312558080[0;39m <==    Updates: 3
2021-12-14 20:55:35.256 INFO  com.job.DocJob                                    :35   [32m125943771312558080[0;39m 更新电子书下的文档数据结束，耗时：253毫秒
2021-12-14 20:55:35.256 INFO  com.job.EbookSnapshotJob                          :32   [32m125943772373716992[0;39m 生成今日电子书快照开始
2021-12-14 20:55:35.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943772373716992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:35.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943772373716992[0;39m ==> Parameters: 
2021-12-14 20:55:35.430 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943772373716992[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:55:40.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125943792372158464[0;39m 生成今日电子书快照开始
2021-12-14 20:55:40.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943792372158464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:40.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943792372158464[0;39m ==> Parameters: 
2021-12-14 20:55:40.293 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943792372158464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:55:45.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943813305929728[0;39m 生成今日电子书快照开始
2021-12-14 20:55:45.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943813305929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:45.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943813305929728[0;39m ==> Parameters: 
2021-12-14 20:55:45.284 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943813305929728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:55:50.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125943834281644032[0;39m 生成今日电子书快照开始
2021-12-14 20:55:50.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943834281644032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:50.115 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943834281644032[0;39m ==> Parameters: 
2021-12-14 20:55:50.303 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943834281644032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:55:55.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125943855194443776[0;39m 生成今日电子书快照开始
2021-12-14 20:55:55.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943855194443776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:55:55.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943855194443776[0;39m ==> Parameters: 
2021-12-14 20:55:55.302 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943855194443776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:00.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125943876195323904[0;39m 生成今日电子书快照开始
2021-12-14 20:56:00.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943876195323904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:00.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943876195323904[0;39m ==> Parameters: 
2021-12-14 20:56:00.262 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943876195323904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:05.015 INFO  com.job.DocJob                                    :32   [32m125943897192009728[0;39m 更新电子书下的文档数据开始
2021-12-14 20:56:05.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943897192009728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:56:05.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943897192009728[0;39m ==> Parameters: 
2021-12-14 20:56:05.250 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125943897192009728[0;39m <==    Updates: 3
2021-12-14 20:56:05.250 INFO  com.job.DocJob                                    :35   [32m125943897192009728[0;39m 更新电子书下的文档数据结束，耗时：235毫秒
2021-12-14 20:56:05.250 INFO  com.job.EbookSnapshotJob                          :32   [32m125943898177671168[0;39m 生成今日电子书快照开始
2021-12-14 20:56:05.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943898177671168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:05.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943898177671168[0;39m ==> Parameters: 
2021-12-14 20:56:05.375 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943898177671168[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:10.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125943918176112640[0;39m 生成今日电子书快照开始
2021-12-14 20:56:10.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943918176112640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:10.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943918176112640[0;39m ==> Parameters: 
2021-12-14 20:56:10.319 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943918176112640[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:15.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125943939172798464[0;39m 生成今日电子书快照开始
2021-12-14 20:56:15.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943939172798464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:15.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943939172798464[0;39m ==> Parameters: 
2021-12-14 20:56:15.296 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943939172798464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:20.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125943960052043776[0;39m 生成今日电子书快照开始
2021-12-14 20:56:20.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943960052043776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:20.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943960052043776[0;39m ==> Parameters: 
2021-12-14 20:56:20.246 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943960052043776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125943981078089728[0;39m 生成今日电子书快照开始
2021-12-14 20:56:25.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943981078089728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:25.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125943981078089728[0;39m ==> Parameters: 
2021-12-14 20:56:25.249 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125943981078089728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:30.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125944002087358464[0;39m 生成今日电子书快照开始
2021-12-14 20:56:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944002087358464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944002087358464[0;39m ==> Parameters: 
2021-12-14 20:56:30.487 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944002087358464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:35.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125944023025324032[0;39m 生成今日电子书快照开始
2021-12-14 20:56:35.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944023025324032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:35.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944023025324032[0;39m ==> Parameters: 
2021-12-14 20:56:35.318 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944023025324032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:35.318 INFO  com.job.DocJob                                    :32   [32m125944024292003840[0;39m 更新电子书下的文档数据开始
2021-12-14 20:56:35.318 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944024292003840[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:56:35.318 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944024292003840[0;39m ==> Parameters: 
2021-12-14 20:56:35.524 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944024292003840[0;39m <==    Updates: 3
2021-12-14 20:56:35.524 INFO  com.job.DocJob                                    :35   [32m125944024292003840[0;39m 更新电子书下的文档数据结束，耗时：206毫秒
2021-12-14 20:56:40.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125944043963289600[0;39m 生成今日电子书快照开始
2021-12-14 20:56:40.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944043963289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:40.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944043963289600[0;39m ==> Parameters: 
2021-12-14 20:56:40.200 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944043963289600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:45.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944064964169728[0;39m 生成今日电子书快照开始
2021-12-14 20:56:45.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944064964169728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:45.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944064964169728[0;39m ==> Parameters: 
2021-12-14 20:56:45.283 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944064964169728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:50.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125944085939884032[0;39m 生成今日电子书快照开始
2021-12-14 20:56:50.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944085939884032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:50.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944085939884032[0;39m ==> Parameters: 
2021-12-14 20:56:50.281 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944085939884032[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:56:55.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125944106944958464[0;39m 生成今日电子书快照开始
2021-12-14 20:56:55.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944106944958464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:56:55.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944106944958464[0;39m ==> Parameters: 
2021-12-14 20:56:55.324 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944106944958464[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:57:00.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125944127849369600[0;39m 生成今日电子书快照开始
2021-12-14 20:57:00.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944127849369600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944127849369600[0;39m ==> Parameters: 
2021-12-14 20:57:00.262 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944127849369600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:57:05.015 INFO  com.job.DocJob                                    :32   [32m125944148850249728[0;39m 更新电子书下的文档数据开始
2021-12-14 20:57:05.062 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944148850249728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:57:05.062 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944148850249728[0;39m ==> Parameters: 
2021-12-14 20:57:05.268 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944148850249728[0;39m <==    Updates: 3
2021-12-14 20:57:05.268 INFO  com.job.DocJob                                    :35   [32m125944148850249728[0;39m 更新电子书下的文档数据结束，耗时：253毫秒
2021-12-14 20:57:05.268 INFO  com.job.EbookSnapshotJob                          :32   [32m125944149911408640[0;39m 生成今日电子书快照开始
2021-12-14 20:57:05.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944149911408640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:05.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944149911408640[0;39m ==> Parameters: 
2021-12-14 20:57:05.424 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944149911408640[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:57:10.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944169821769728[0;39m 生成今日电子书快照开始
2021-12-14 20:57:10.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944169821769728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:10.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944169821769728[0;39m ==> Parameters: 
2021-12-14 20:57:10.347 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944169821769728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:57:15.023 INFO  com.job.EbookSnapshotJob                          :32   [32m125944190826844160[0;39m 生成今日电子书快照开始
2021-12-14 20:57:15.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944190826844160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:15.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944190826844160[0;39m ==> Parameters: 
2021-12-14 20:57:15.343 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944190826844160[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:57:16.877 INFO  com.interceptor.LoginInterceptor                  :29   [32m125943543037562880[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:57:16.878 INFO  com.interceptor.LoginInterceptor                  :65   [32m125943543037562880[0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2021-12-14 20:57:16.884 INFO  com.interceptor.LoginInterceptor                  :29   [32m125943543054340096[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:57:16.884 INFO  com.interceptor.LoginInterceptor                  :40   [32m125943543054340096[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/delete/125943760172486656
2021-12-14 20:57:16.885 INFO  com.interceptor.LoginInterceptor                  :44   [32m125943543054340096[0;39m 登录校验开始，token：125943535290683392
2021-12-14 20:57:17.001 INFO  com.interceptor.LoginInterceptor                  :56   [32m125943543054340096[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125943535290683392"}
2021-12-14 20:57:17.007 INFO  com.aspect.LogAspect                              :54   [32m125944199148343296[0;39m ------------- 开始 -------------
2021-12-14 20:57:17.007 INFO  com.aspect.LogAspect                              :55   [32m125944199148343296[0;39m 请求地址: http://localhost:8081/ebook/delete/125943760172486656 DELETE
2021-12-14 20:57:17.007 INFO  com.aspect.LogAspect                              :56   [32m125944199148343296[0;39m 类名方法: com.controller.EbookController.delete
2021-12-14 20:57:17.008 INFO  com.aspect.LogAspect                              :57   [32m125944199148343296[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:17.008 INFO  com.aspect.LogAspect                              :80   [32m125944199148343296[0;39m 请求参数: [125943760172486656]
2021-12-14 20:57:17.093 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944199148343296[0;39m ==>  Preparing: delete from ebook where id = ?
2021-12-14 20:57:17.093 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944199148343296[0;39m ==> Parameters: 125943760172486656(Long)
2021-12-14 20:57:17.268 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944199148343296[0;39m <==    Updates: 1
2021-12-14 20:57:17.268 INFO  com.aspect.LogAspect                              :92   [32m125944199148343296[0;39m 返回结果: {"success":true}
2021-12-14 20:57:17.268 INFO  com.aspect.LogAspect                              :93   [32m125944199148343296[0;39m ------------- 结束 耗时：261 ms -------------
2021-12-14 20:57:17.268 INFO  com.interceptor.LoginInterceptor                  :65   [32m125944199148343296[0;39m ------------- LoginInterceptor 结束 耗时：384 ms -------------
2021-12-14 20:57:17.350 INFO  com.aspect.LogAspect                              :54   [32m125944200586989568[0;39m ------------- 开始 -------------
2021-12-14 20:57:17.350 INFO  com.aspect.LogAspect                              :55   [32m125944200586989568[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:57:17.350 INFO  com.aspect.LogAspect                              :56   [32m125944200586989568[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:57:17.350 INFO  com.aspect.LogAspect                              :57   [32m125944200586989568[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:17.351 INFO  com.aspect.LogAspect                              :80   [32m125944200586989568[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:57:17.449 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944200586989568[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:57:17.450 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944200586989568[0;39m ==> Parameters: 
2021-12-14 20:57:17.533 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944200586989568[0;39m <==    Columns: count(0)
2021-12-14 20:57:17.534 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944200586989568[0;39m <==        Row: 6
2021-12-14 20:57:17.534 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944200586989568[0;39m <==      Total: 1
2021-12-14 20:57:17.536 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944200586989568[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:57:17.537 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944200586989568[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:57:17.624 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:57:17.625 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:57:17.627 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:57:17.629 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:57:17.634 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:57:17.639 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:57:17.641 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944200586989568[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:57:17.643 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944200586989568[0;39m <==      Total: 6
2021-12-14 20:57:17.645 INFO  com.servicess.EbookService                        :48   [32m125944200586989568[0;39m 总行数：6
2021-12-14 20:57:17.646 INFO  com.servicess.EbookService                        :49   [32m125944200586989568[0;39m 总页数：1
2021-12-14 20:57:17.658 INFO  com.aspect.LogAspect                              :92   [32m125944200586989568[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:57:17.659 INFO  com.aspect.LogAspect                              :93   [32m125944200586989568[0;39m ------------- 结束 耗时：309 ms -------------
2021-12-14 20:57:20.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125944211769004032[0;39m 生成今日电子书快照开始
2021-12-14 20:57:21.130 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944211769004032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:21.130 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944211769004032[0;39m ==> Parameters: 
2021-12-14 20:57:21.799 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944211769004032[0;39m <==    Updates: 0
2021-12-14 20:57:21.799 INFO  com.job.EbookSnapshotJob                          :35   [32m125944211769004032[0;39m 生成今日电子书快照结束，耗时：1782毫秒
2021-12-14 20:57:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944232736329728[0;39m 生成今日电子书快照开始
2021-12-14 20:57:25.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944232736329728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:25.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944232736329728[0;39m ==> Parameters: 
2021-12-14 20:57:25.902 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944232736329728[0;39m <==    Updates: 0
2021-12-14 20:57:25.902 INFO  com.job.EbookSnapshotJob                          :35   [32m125944232736329728[0;39m 生成今日电子书快照结束，耗时：887毫秒
2021-12-14 20:57:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944253707849728[0;39m 生成今日电子书快照开始
2021-12-14 20:57:30.809 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944253707849728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:30.809 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944253707849728[0;39m ==> Parameters: 
2021-12-14 20:57:32.893 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944253707849728[0;39m <==    Updates: 0
2021-12-14 20:57:32.893 INFO  com.job.EbookSnapshotJob                          :35   [32m125944253707849728[0;39m 生成今日电子书快照结束，耗时：2878毫秒
2021-12-14 20:57:35.015 INFO  com.job.DocJob                                    :32   [32m125944274679369728[0;39m 更新电子书下的文档数据开始
2021-12-14 20:57:35.977 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944274679369728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:57:35.977 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944274679369728[0;39m ==> Parameters: 
2021-12-14 20:57:37.671 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944274679369728[0;39m <==    Updates: 3
2021-12-14 20:57:37.671 INFO  com.job.DocJob                                    :35   [32m125944274679369728[0;39m 更新电子书下的文档数据结束，耗时：2656毫秒
2021-12-14 20:57:37.671 INFO  com.job.EbookSnapshotJob                          :32   [32m125944285819441152[0;39m 生成今日电子书快照开始
2021-12-14 20:57:38.016 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944285819441152[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:38.016 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944285819441152[0;39m ==> Parameters: 
2021-12-14 20:57:39.203 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944285819441152[0;39m <==    Updates: 0
2021-12-14 20:57:39.203 INFO  com.job.EbookSnapshotJob                          :35   [32m125944285819441152[0;39m 生成今日电子书快照结束，耗时：1532毫秒
2021-12-14 20:57:40.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125944295663472640[0;39m 生成今日电子书快照开始
2021-12-14 20:57:40.116 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944295663472640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:40.116 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944295663472640[0;39m ==> Parameters: 
2021-12-14 20:57:40.309 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944295663472640[0;39m <==    Updates: 0
2021-12-14 20:57:40.309 INFO  com.job.EbookSnapshotJob                          :35   [32m125944295663472640[0;39m 生成今日电子书快照结束，耗时：291毫秒
2021-12-14 20:57:45.020 INFO  com.job.EbookSnapshotJob                          :32   [32m125944316643381248[0;39m 生成今日电子书快照开始
2021-12-14 20:57:45.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944316643381248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:45.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944316643381248[0;39m ==> Parameters: 
2021-12-14 20:57:45.259 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944316643381248[0;39m <==    Updates: 0
2021-12-14 20:57:45.259 INFO  com.job.EbookSnapshotJob                          :35   [32m125944316643381248[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-14 20:57:45.378 INFO  com.websocket.WebSocketServer                     :32   [32m125943556316729344[0;39m 有新连接：token：zNzemXd19c，session id：2，当前连接数：2
2021-12-14 20:57:45.559 INFO  com.aspect.LogAspect                              :54   [32m125944318904111104[0;39m ------------- 开始 -------------
2021-12-14 20:57:45.560 INFO  com.aspect.LogAspect                              :55   [32m125944318904111104[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:57:45.560 INFO  com.aspect.LogAspect                              :56   [32m125944318904111104[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:57:45.561 INFO  com.aspect.LogAspect                              :57   [32m125944318904111104[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:45.561 INFO  com.aspect.LogAspect                              :80   [32m125944318904111104[0;39m 请求参数: []
2021-12-14 20:57:45.561 INFO  com.aspect.LogAspect                              :54   [32m125944318912499712[0;39m ------------- 开始 -------------
2021-12-14 20:57:45.561 INFO  com.aspect.LogAspect                              :55   [32m125944318912499712[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:57:45.561 INFO  com.aspect.LogAspect                              :56   [32m125944318912499712[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:57:45.562 INFO  com.aspect.LogAspect                              :57   [32m125944318912499712[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:45.562 INFO  com.aspect.LogAspect                              :80   [32m125944318912499712[0;39m 请求参数: []
2021-12-14 20:57:45.565 INFO  com.aspect.LogAspect                              :54   [32m125944318929276928[0;39m ------------- 开始 -------------
2021-12-14 20:57:45.565 INFO  com.aspect.LogAspect                              :55   [32m125944318929276928[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:57:45.565 INFO  com.aspect.LogAspect                              :56   [32m125944318929276928[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:57:45.566 INFO  com.aspect.LogAspect                              :57   [32m125944318929276928[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:45.566 INFO  com.aspect.LogAspect                              :80   [32m125944318929276928[0;39m 请求参数: []
2021-12-14 20:57:45.566 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944318929276928[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:57:45.567 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944318929276928[0;39m ==> Parameters: 
2021-12-14 20:57:45.644 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944318912499712[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:57:45.645 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944318912499712[0;39m ==> Parameters: 
2021-12-14 20:57:45.644 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944318904111104[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:57:45.646 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944318904111104[0;39m ==> Parameters: 
2021-12-14 20:57:45.674 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:57:45.675 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:57:45.676 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:57:45.676 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:57:45.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:57:45.677 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:57:45.678 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:57:45.678 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:57:45.679 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:57:45.681 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:57:45.682 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:57:45.683 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:57:45.684 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:57:45.685 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:57:45.686 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:57:45.687 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:57:45.687 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:57:45.688 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:57:45.689 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:57:45.689 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944318929276928[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:57:45.690 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944318929276928[0;39m <==      Total: 19
2021-12-14 20:57:45.693 INFO  com.aspect.LogAspect                              :92   [32m125944318929276928[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:57:45.693 INFO  com.aspect.LogAspect                              :93   [32m125944318929276928[0;39m ------------- 结束 耗时：128 ms -------------
2021-12-14 20:57:45.724 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944318904111104[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:57:45.725 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944318904111104[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:57:45.726 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944318904111104[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:57:45.726 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944318904111104[0;39m <==      Total: 2
2021-12-14 20:57:45.727 INFO  com.aspect.LogAspect                              :92   [32m125944318904111104[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:57:45.728 INFO  com.aspect.LogAspect                              :93   [32m125944318904111104[0;39m ------------- 结束 耗时：169 ms -------------
2021-12-14 20:57:45.743 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944318912499712[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:57:45.744 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944318912499712[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:57:45.745 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944318912499712[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:57:45.746 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944318912499712[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:57:45.748 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944318912499712[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:57:45.748 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944318912499712[0;39m <==      Total: 4
2021-12-14 20:57:45.749 INFO  com.aspect.LogAspect                              :92   [32m125944318912499712[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:57:45.749 INFO  com.aspect.LogAspect                              :93   [32m125944318912499712[0;39m ------------- 结束 耗时：188 ms -------------
2021-12-14 20:57:46.686 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：ZBrtvQbkd6，session id：1！当前连接数：1
2021-12-14 20:57:48.909 INFO  com.aspect.LogAspect                              :54   [32m125944332955029504[0;39m ------------- 开始 -------------
2021-12-14 20:57:48.909 INFO  com.aspect.LogAspect                              :55   [32m125944332955029504[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-14 20:57:48.909 INFO  com.aspect.LogAspect                              :56   [32m125944332955029504[0;39m 类名方法: com.controller.UserController.login
2021-12-14 20:57:48.910 INFO  com.aspect.LogAspect                              :57   [32m125944332955029504[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:48.910 INFO  com.aspect.LogAspect                              :80   [32m125944332955029504[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-14 20:57:48.989 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125944332955029504[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-14 20:57:48.989 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125944332955029504[0;39m ==> Parameters: test123(String)
2021-12-14 20:57:49.082 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125944332955029504[0;39m <==    Columns: id, login_name, name, password
2021-12-14 20:57:49.082 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125944332955029504[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 20:57:49.083 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125944332955029504[0;39m <==      Total: 1
2021-12-14 20:57:49.083 INFO  com.controller.UserController                     :77   [32m125944332955029504[0;39m 生成单点登录token:125944333684838400,并放入redis中
2021-12-14 20:57:49.161 INFO  com.aspect.LogAspect                              :92   [32m125944332955029504[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125944333684838400"},"success":true}
2021-12-14 20:57:49.161 INFO  com.aspect.LogAspect                              :93   [32m125944332955029504[0;39m ------------- 结束 耗时：252 ms -------------
2021-12-14 20:57:49.292 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：zNzemXd19c，session id：2！当前连接数：0
2021-12-14 20:57:50.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125944337539403776[0;39m 生成今日电子书快照开始
2021-12-14 20:57:50.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944337539403776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:50.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944337539403776[0;39m ==> Parameters: 
2021-12-14 20:57:50.094 INFO  com.websocket.WebSocketServer                     :32   [32m125943543037562880[0;39m 有新连接：token：qZxWjJfmkW，session id：3，当前连接数：1
2021-12-14 20:57:50.163 INFO  com.aspect.LogAspect                              :54   [32m125944338214686720[0;39m ------------- 开始 -------------
2021-12-14 20:57:50.163 INFO  com.aspect.LogAspect                              :55   [32m125944338214686720[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :56   [32m125944338214686720[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :54   [32m125944338218881024[0;39m ------------- 开始 -------------
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :57   [32m125944338214686720[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :80   [32m125944338214686720[0;39m 请求参数: []
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :55   [32m125944338218881024[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :56   [32m125944338218881024[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 20:57:50.164 INFO  com.aspect.LogAspect                              :57   [32m125944338218881024[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:50.165 INFO  com.aspect.LogAspect                              :80   [32m125944338218881024[0;39m 请求参数: []
2021-12-14 20:57:50.165 INFO  com.aspect.LogAspect                              :54   [32m125944338223075328[0;39m ------------- 开始 -------------
2021-12-14 20:57:50.166 INFO  com.aspect.LogAspect                              :55   [32m125944338223075328[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:57:50.166 INFO  com.aspect.LogAspect                              :56   [32m125944338223075328[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:57:50.166 INFO  com.aspect.LogAspect                              :57   [32m125944338223075328[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:57:50.166 INFO  com.aspect.LogAspect                              :80   [32m125944338223075328[0;39m 请求参数: []
2021-12-14 20:57:50.220 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944337539403776[0;39m <==    Updates: 0
2021-12-14 20:57:50.221 INFO  com.job.EbookSnapshotJob                          :35   [32m125944337539403776[0;39m 生成今日电子书快照结束，耗时：219毫秒
2021-12-14 20:57:50.239 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944338214686720[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:57:50.239 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944338214686720[0;39m ==> Parameters: 
2021-12-14 20:57:50.247 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944338223075328[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:57:50.247 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944338218881024[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 20:57:50.247 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944338218881024[0;39m ==> Parameters: 
2021-12-14 20:57:50.247 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944338223075328[0;39m ==> Parameters: 
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:57:50.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:57:50.392 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944338218881024[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 20:57:50.392 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:57:50.392 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944338214686720[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 20:57:50.393 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:57:50.393 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944338218881024[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 20:57:50.393 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944338214686720[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 20:57:50.394 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:57:50.395 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:57:50.395 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944338218881024[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 20:57:50.396 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125944338214686720[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 20:57:50.396 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:57:50.397 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125944338214686720[0;39m <==      Total: 2
2021-12-14 20:57:50.397 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:57:50.397 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944338218881024[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 20:57:50.398 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:57:50.398 INFO  com.aspect.LogAspect                              :92   [32m125944338214686720[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 20:57:50.399 INFO  com.aspect.LogAspect                              :93   [32m125944338214686720[0;39m ------------- 结束 耗时：236 ms -------------
2021-12-14 20:57:50.399 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:57:50.399 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125944338218881024[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 20:57:50.400 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:57:50.400 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125944338218881024[0;39m <==      Total: 4
2021-12-14 20:57:50.401 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:57:50.401 INFO  com.aspect.LogAspect                              :92   [32m125944338218881024[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 20:57:50.402 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:57:50.402 INFO  com.aspect.LogAspect                              :93   [32m125944338218881024[0;39m ------------- 结束 耗时：238 ms -------------
2021-12-14 20:57:50.403 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:57:50.404 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944338223075328[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:57:50.405 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944338223075328[0;39m <==      Total: 19
2021-12-14 20:57:50.413 INFO  com.aspect.LogAspect                              :92   [32m125944338223075328[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:57:50.414 INFO  com.aspect.LogAspect                              :93   [32m125944338223075328[0;39m ------------- 结束 耗时：249 ms -------------
2021-12-14 20:57:55.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125944358510923776[0;39m 生成今日电子书快照开始
2021-12-14 20:57:56.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944358510923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:57:56.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944358510923776[0;39m ==> Parameters: 
2021-12-14 20:57:58.164 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944358510923776[0;39m <==    Updates: 0
2021-12-14 20:57:58.164 INFO  com.job.EbookSnapshotJob                          :35   [32m125944358510923776[0;39m 生成今日电子书快照结束，耗时：3162毫秒
2021-12-14 20:58:00.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125944379549552640[0;39m 生成今日电子书快照开始
2021-12-14 20:58:00.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944379549552640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:00.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944379549552640[0;39m ==> Parameters: 
2021-12-14 20:58:00.333 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944379549552640[0;39m <==    Updates: 0
2021-12-14 20:58:00.333 INFO  com.job.EbookSnapshotJob                          :35   [32m125944379549552640[0;39m 生成今日电子书快照结束，耗时：315毫秒
2021-12-14 20:58:05.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944400508489728[0;39m 生成今日电子书快照开始
2021-12-14 20:58:05.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944400508489728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:05.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944400508489728[0;39m ==> Parameters: 
2021-12-14 20:58:05.202 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944400508489728[0;39m <==    Updates: 0
2021-12-14 20:58:05.202 INFO  com.job.EbookSnapshotJob                          :35   [32m125944400508489728[0;39m 生成今日电子书快照结束，耗时：187毫秒
2021-12-14 20:58:05.202 INFO  com.job.DocJob                                    :32   [32m125944401292824576[0;39m 更新电子书下的文档数据开始
2021-12-14 20:58:05.202 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944401292824576[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:58:05.202 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944401292824576[0;39m ==> Parameters: 
2021-12-14 20:58:05.378 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944401292824576[0;39m <==    Updates: 3
2021-12-14 20:58:05.378 INFO  com.job.DocJob                                    :35   [32m125944401292824576[0;39m 更新电子书下的文档数据结束，耗时：176毫秒
2021-12-14 20:58:10.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944421480009728[0;39m 生成今日电子书快照开始
2021-12-14 20:58:10.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944421480009728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:10.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944421480009728[0;39m ==> Parameters: 
2021-12-14 20:58:10.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944421480009728[0;39m <==    Updates: 0
2021-12-14 20:58:10.233 INFO  com.job.EbookSnapshotJob                          :35   [32m125944421480009728[0;39m 生成今日电子书快照结束，耗时：218毫秒
2021-12-14 20:58:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125944442464112640[0;39m 生成今日电子书快照开始
2021-12-14 20:58:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944442464112640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944442464112640[0;39m ==> Parameters: 
2021-12-14 20:58:15.225 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944442464112640[0;39m <==    Updates: 0
2021-12-14 20:58:15.225 INFO  com.job.EbookSnapshotJob                          :35   [32m125944442464112640[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 20:58:20.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125944463418855424[0;39m 生成今日电子书快照开始
2021-12-14 20:58:20.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944463418855424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:20.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944463418855424[0;39m ==> Parameters: 
2021-12-14 20:58:20.213 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944463418855424[0;39m <==    Updates: 0
2021-12-14 20:58:20.214 INFO  com.job.EbookSnapshotJob                          :35   [32m125944463418855424[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-14 20:58:21.114 INFO  com.aspect.LogAspect                              :54   [32m125944468032589824[0;39m ------------- 开始 -------------
2021-12-14 20:58:21.114 INFO  com.aspect.LogAspect                              :55   [32m125944468032589824[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 20:58:21.114 INFO  com.aspect.LogAspect                              :56   [32m125944468032589824[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 20:58:21.114 INFO  com.aspect.LogAspect                              :57   [32m125944468032589824[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:58:21.115 INFO  com.aspect.LogAspect                              :80   [32m125944468032589824[0;39m 请求参数: []
2021-12-14 20:58:21.179 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944468032589824[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 20:58:21.179 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944468032589824[0;39m ==> Parameters: 
2021-12-14 20:58:21.243 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==    Columns: id, parent, name, sort
2021-12-14 20:58:21.245 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 20:58:21.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 20:58:21.247 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 20:58:21.249 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 20:58:21.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 20:58:21.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 20:58:21.253 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 20:58:21.254 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 20:58:21.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 20:58:21.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 20:58:21.257 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 20:58:21.258 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 20:58:21.258 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 20:58:21.259 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 20:58:21.259 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 20:58:21.260 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 20:58:21.261 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 20:58:21.261 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 20:58:21.262 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125944468032589824[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 20:58:21.262 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125944468032589824[0;39m <==      Total: 19
2021-12-14 20:58:21.268 INFO  com.aspect.LogAspect                              :92   [32m125944468032589824[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 20:58:21.269 INFO  com.aspect.LogAspect                              :93   [32m125944468032589824[0;39m ------------- 结束 耗时：155 ms -------------
2021-12-14 20:58:21.307 INFO  com.aspect.LogAspect                              :54   [32m125944468842090496[0;39m ------------- 开始 -------------
2021-12-14 20:58:21.308 INFO  com.aspect.LogAspect                              :55   [32m125944468842090496[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:58:21.308 INFO  com.aspect.LogAspect                              :56   [32m125944468842090496[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:58:21.308 INFO  com.aspect.LogAspect                              :57   [32m125944468842090496[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:58:21.308 INFO  com.aspect.LogAspect                              :80   [32m125944468842090496[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:58:21.367 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944468842090496[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:58:21.368 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944468842090496[0;39m ==> Parameters: 
2021-12-14 20:58:21.436 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944468842090496[0;39m <==    Columns: count(0)
2021-12-14 20:58:21.437 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944468842090496[0;39m <==        Row: 6
2021-12-14 20:58:21.438 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944468842090496[0;39m <==      Total: 1
2021-12-14 20:58:21.440 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944468842090496[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:58:21.442 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944468842090496[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:58:21.516 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:58:21.517 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:58:21.519 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:58:21.521 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:58:21.522 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:58:21.523 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:58:21.525 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944468842090496[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:58:21.526 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944468842090496[0;39m <==      Total: 6
2021-12-14 20:58:21.527 INFO  com.servicess.EbookService                        :48   [32m125944468842090496[0;39m 总行数：6
2021-12-14 20:58:21.527 INFO  com.servicess.EbookService                        :49   [32m125944468842090496[0;39m 总页数：1
2021-12-14 20:58:21.530 INFO  com.aspect.LogAspect                              :92   [32m125944468842090496[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:58:21.531 INFO  com.aspect.LogAspect                              :93   [32m125944468842090496[0;39m ------------- 结束 耗时：224 ms -------------
2021-12-14 20:58:25.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125944484398764032[0;39m 生成今日电子书快照开始
2021-12-14 20:58:25.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944484398764032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:25.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944484398764032[0;39m ==> Parameters: 
2021-12-14 20:58:25.226 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944484398764032[0;39m <==    Updates: 0
2021-12-14 20:58:25.227 INFO  com.job.EbookSnapshotJob                          :35   [32m125944484398764032[0;39m 生成今日电子书快照结束，耗时：211毫秒
2021-12-14 20:58:30.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125944505319952384[0;39m 生成今日电子书快照开始
2021-12-14 20:58:30.115 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944505319952384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:30.115 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944505319952384[0;39m ==> Parameters: 
2021-12-14 20:58:30.271 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944505319952384[0;39m <==    Updates: 0
2021-12-14 20:58:30.271 INFO  com.job.EbookSnapshotJob                          :35   [32m125944505319952384[0;39m 生成今日电子书快照结束，耗时：267毫秒
2021-12-14 20:58:35.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125944526283083776[0;39m 生成今日电子书快照开始
2021-12-14 20:58:35.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944526283083776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:35.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944526283083776[0;39m ==> Parameters: 
2021-12-14 20:58:35.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944526283083776[0;39m <==    Updates: 0
2021-12-14 20:58:35.232 INFO  com.job.EbookSnapshotJob                          :35   [32m125944526283083776[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-14 20:58:35.233 INFO  com.job.DocJob                                    :32   [32m125944527251968000[0;39m 更新电子书下的文档数据开始
2021-12-14 20:58:35.235 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944527251968000[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:58:35.236 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944527251968000[0;39m ==> Parameters: 
2021-12-14 20:58:35.471 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944527251968000[0;39m <==    Updates: 3
2021-12-14 20:58:35.471 INFO  com.job.DocJob                                    :35   [32m125944527251968000[0;39m 更新电子书下的文档数据结束，耗时：237毫秒
2021-12-14 20:58:38.677 INFO  com.interceptor.LoginInterceptor                  :29   [32m125944318912499712[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:58:38.677 INFO  com.interceptor.LoginInterceptor                  :40   [32m125944318912499712[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/save
2021-12-14 20:58:38.678 INFO  com.interceptor.LoginInterceptor                  :44   [32m125944318912499712[0;39m 登录校验开始，token：125944333684838400
2021-12-14 20:58:38.725 INFO  com.interceptor.LoginInterceptor                  :56   [32m125944318912499712[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125944333684838400"}
2021-12-14 20:58:38.726 INFO  com.aspect.LogAspect                              :54   [32m125944541902671872[0;39m ------------- 开始 -------------
2021-12-14 20:58:38.726 INFO  com.aspect.LogAspect                              :55   [32m125944541902671872[0;39m 请求地址: http://localhost:8081/ebook/save POST
2021-12-14 20:58:38.726 INFO  com.aspect.LogAspect                              :56   [32m125944541902671872[0;39m 类名方法: com.controller.EbookController.save
2021-12-14 20:58:38.726 INFO  com.aspect.LogAspect                              :57   [32m125944541902671872[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:58:38.726 INFO  com.aspect.LogAspect                              :80   [32m125944541902671872[0;39m 请求参数: [{"category1Id":500,"category2Id":502,"description":"11","name":"Android"}]
2021-12-14 20:58:38.795 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125944541902671872[0;39m ==>  Preparing: insert into ebook ( id, `name`, category1_id, category2_id, description ) values ( ?, ?, ?, ?, ? )
2021-12-14 20:58:38.796 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125944541902671872[0;39m ==> Parameters: 125944541906866176(Long), Android(String), 500(Long), 502(Long), 11(String)
2021-12-14 20:58:38.933 DEBUG com.mapper.EbookMapper.insertSelective            :137  [32m125944541902671872[0;39m <==    Updates: 1
2021-12-14 20:58:38.934 INFO  com.aspect.LogAspect                              :92   [32m125944541902671872[0;39m 返回结果: {"success":true}
2021-12-14 20:58:38.935 INFO  com.aspect.LogAspect                              :93   [32m125944541902671872[0;39m ------------- 结束 耗时：209 ms -------------
2021-12-14 20:58:38.936 INFO  com.interceptor.LoginInterceptor                  :65   [32m125944541902671872[0;39m ------------- LoginInterceptor 结束 耗时：259 ms -------------
2021-12-14 20:58:38.984 INFO  com.aspect.LogAspect                              :54   [32m125944542984802304[0;39m ------------- 开始 -------------
2021-12-14 20:58:38.984 INFO  com.aspect.LogAspect                              :55   [32m125944542984802304[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:58:38.985 INFO  com.aspect.LogAspect                              :56   [32m125944542984802304[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:58:38.985 INFO  com.aspect.LogAspect                              :57   [32m125944542984802304[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:58:38.985 INFO  com.aspect.LogAspect                              :80   [32m125944542984802304[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:58:39.044 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944542984802304[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:58:39.044 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944542984802304[0;39m ==> Parameters: 
2021-12-14 20:58:39.106 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944542984802304[0;39m <==    Columns: count(0)
2021-12-14 20:58:39.106 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944542984802304[0;39m <==        Row: 7
2021-12-14 20:58:39.106 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944542984802304[0;39m <==      Total: 1
2021-12-14 20:58:39.107 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944542984802304[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:58:39.107 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944542984802304[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:58:39.196 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:58:39.196 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:58:39.197 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:58:39.197 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:58:39.198 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:58:39.198 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:58:39.198 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:58:39.198 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944542984802304[0;39m <==        Row: 125944541906866176, Android, 500, 502, 11, null, null, null, null
2021-12-14 20:58:39.198 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944542984802304[0;39m <==      Total: 7
2021-12-14 20:58:39.198 INFO  com.servicess.EbookService                        :48   [32m125944542984802304[0;39m 总行数：7
2021-12-14 20:58:39.201 INFO  com.servicess.EbookService                        :49   [32m125944542984802304[0;39m 总页数：1
2021-12-14 20:58:39.204 INFO  com.aspect.LogAspect                              :92   [32m125944542984802304[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45},{"category1Id":500,"category2Id":502,"description":"11","id":125944541906866176,"name":"Android"}],"total":7},"success":true}
2021-12-14 20:58:39.204 INFO  com.aspect.LogAspect                              :93   [32m125944542984802304[0;39m ------------- 结束 耗时：220 ms -------------
2021-12-14 20:58:40.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125944547267186688[0;39m 生成今日电子书快照开始
2021-12-14 20:58:40.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944547267186688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:40.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944547267186688[0;39m ==> Parameters: 
2021-12-14 20:58:40.236 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944547267186688[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:58:45.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125944568255483904[0;39m 生成今日电子书快照开始
2021-12-14 20:58:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944568255483904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944568255483904[0;39m ==> Parameters: 
2021-12-14 20:58:45.308 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944568255483904[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:58:50.019 INFO  com.job.EbookSnapshotJob                          :32   [32m125944589268946944[0;39m 生成今日电子书快照开始
2021-12-14 20:58:50.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944589268946944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:50.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944589268946944[0;39m ==> Parameters: 
2021-12-14 20:58:50.347 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944589268946944[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:58:55.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125944610236272640[0;39m 生成今日电子书快照开始
2021-12-14 20:58:55.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944610236272640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:58:55.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944610236272640[0;39m ==> Parameters: 
2021-12-14 20:58:55.362 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944610236272640[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:00.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944631195209728[0;39m 生成今日电子书快照开始
2021-12-14 20:59:00.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944631195209728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:00.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944631195209728[0;39m ==> Parameters: 
2021-12-14 20:59:00.377 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944631195209728[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:05.002 INFO  com.job.DocJob                                    :32   [32m125944652112203776[0;39m 更新电子书下的文档数据开始
2021-12-14 20:59:05.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944652112203776[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:59:05.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944652112203776[0;39m ==> Parameters: 
2021-12-14 20:59:05.284 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944652112203776[0;39m <==    Updates: 3
2021-12-14 20:59:05.284 INFO  com.job.DocJob                                    :35   [32m125944652112203776[0;39m 更新电子书下的文档数据结束，耗时：282毫秒
2021-12-14 20:59:05.284 INFO  com.job.EbookSnapshotJob                          :32   [32m125944653294997504[0;39m 生成今日电子书快照开始
2021-12-14 20:59:05.284 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944653294997504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:05.284 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944653294997504[0;39m ==> Parameters: 
2021-12-14 20:59:05.443 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944653294997504[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:10.008 INFO  com.job.EbookSnapshotJob                          :32   [32m125944673108889600[0;39m 生成今日电子书快照开始
2021-12-14 20:59:10.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944673108889600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:10.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944673108889600[0;39m ==> Parameters: 
2021-12-14 20:59:10.261 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944673108889600[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125944694122352640[0;39m 生成今日电子书快照开始
2021-12-14 20:59:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944694122352640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:15.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944694122352640[0;39m ==> Parameters: 
2021-12-14 20:59:15.271 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944694122352640[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:20.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125944715026763776[0;39m 生成今日电子书快照开始
2021-12-14 20:59:20.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944715026763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:20.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944715026763776[0;39m ==> Parameters: 
2021-12-14 20:59:20.316 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944715026763776[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:25.023 INFO  com.job.EbookSnapshotJob                          :32   [32m125944736086364160[0;39m 生成今日电子书快照开始
2021-12-14 20:59:25.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944736086364160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944736086364160[0;39m ==> Parameters: 
2021-12-14 20:59:25.325 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944736086364160[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125944757003358208[0;39m 生成今日电子书快照开始
2021-12-14 20:59:30.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944757003358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:30.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944757003358208[0;39m ==> Parameters: 
2021-12-14 20:59:30.299 ERROR o.s.s.support.TaskUtils$LoggingErrorHandler       :95   [32m125944757003358208[0;39m Unexpected error occurred in scheduled task
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
### The error may exist in file [E:\market\market\springboot-init\target\classes\mapper\EbookSnapshotMapperCust.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase)         select t1.id, curdate(), 0, 0, 0, 0         from ebook t1         where not exists(select 1                          from ebook_snapshot t2                          where t1.id = t2.ebook_id                            and t2.`date` = curdate());          update ebook_snapshot t1, ebook t2         set t1.view_count = t2.view_count,             t1.vote_count = t2.vote_count         where t1.`date` = curdate()           and t1.ebook_id = t2.id;          update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count                                             from ebook_snapshot                                             where `date` = date_sub(curdate(), interval 1 day)) t2             on t1.ebook_id = t2.ebook_id         set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)),             t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0))         where t1.`date` = curdate();
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
; Column 'view_count' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy87.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:67)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:145)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:86)
	at com.sun.proxy.$Proxy101.genSnapshot(Unknown Source)
	at com.servicess.EbookSnapshotService.genSnapshot(EbookSnapshotService.java:17)
	at com.job.EbookSnapshotJob.doSnapshot(EbookSnapshotJob.java:34)
	at jdk.internal.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'view_count' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at jdk.internal.reflect.GeneratedMethodAccessor62.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy127.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at jdk.internal.reflect.GeneratedMethodAccessor60.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy125.update(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:194)
	at jdk.internal.reflect.GeneratedMethodAccessor59.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:564)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 20 common frames omitted
2021-12-14 20:59:32.300 INFO  com.interceptor.LoginInterceptor                  :29   [32m125943543037562880[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:59:32.300 INFO  com.interceptor.LoginInterceptor                  :65   [32m125943543037562880[0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-12-14 20:59:32.304 INFO  com.interceptor.LoginInterceptor                  :29   [32m125944338214686720[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 20:59:32.304 INFO  com.interceptor.LoginInterceptor                  :40   [32m125944338214686720[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/delete/125944541906866176
2021-12-14 20:59:32.304 INFO  com.interceptor.LoginInterceptor                  :44   [32m125944338214686720[0;39m 登录校验开始，token：125944333684838400
2021-12-14 20:59:32.397 INFO  com.interceptor.LoginInterceptor                  :56   [32m125944338214686720[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125944333684838400"}
2021-12-14 20:59:32.398 INFO  com.aspect.LogAspect                              :54   [32m125944767019356160[0;39m ------------- 开始 -------------
2021-12-14 20:59:32.398 INFO  com.aspect.LogAspect                              :55   [32m125944767019356160[0;39m 请求地址: http://localhost:8081/ebook/delete/125944541906866176 DELETE
2021-12-14 20:59:32.398 INFO  com.aspect.LogAspect                              :56   [32m125944767019356160[0;39m 类名方法: com.controller.EbookController.delete
2021-12-14 20:59:32.398 INFO  com.aspect.LogAspect                              :57   [32m125944767019356160[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:59:32.399 INFO  com.aspect.LogAspect                              :80   [32m125944767019356160[0;39m 请求参数: [125944541906866176]
2021-12-14 20:59:32.479 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944767019356160[0;39m ==>  Preparing: delete from ebook where id = ?
2021-12-14 20:59:32.480 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944767019356160[0;39m ==> Parameters: 125944541906866176(Long)
2021-12-14 20:59:32.614 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125944767019356160[0;39m <==    Updates: 1
2021-12-14 20:59:32.614 INFO  com.aspect.LogAspect                              :92   [32m125944767019356160[0;39m 返回结果: {"success":true}
2021-12-14 20:59:32.615 INFO  com.aspect.LogAspect                              :93   [32m125944767019356160[0;39m ------------- 结束 耗时：217 ms -------------
2021-12-14 20:59:32.616 INFO  com.interceptor.LoginInterceptor                  :65   [32m125944767019356160[0;39m ------------- LoginInterceptor 结束 耗时：312 ms -------------
2021-12-14 20:59:32.641 INFO  com.aspect.LogAspect                              :54   [32m125944768038572032[0;39m ------------- 开始 -------------
2021-12-14 20:59:32.642 INFO  com.aspect.LogAspect                              :55   [32m125944768038572032[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 20:59:32.642 INFO  com.aspect.LogAspect                              :56   [32m125944768038572032[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 20:59:32.642 INFO  com.aspect.LogAspect                              :57   [32m125944768038572032[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 20:59:32.642 INFO  com.aspect.LogAspect                              :80   [32m125944768038572032[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 20:59:32.727 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944768038572032[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 20:59:32.727 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944768038572032[0;39m ==> Parameters: 
2021-12-14 20:59:32.796 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944768038572032[0;39m <==    Columns: count(0)
2021-12-14 20:59:32.797 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125944768038572032[0;39m <==        Row: 6
2021-12-14 20:59:32.797 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125944768038572032[0;39m <==      Total: 1
2021-12-14 20:59:32.797 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944768038572032[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 20:59:32.798 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944768038572032[0;39m ==> Parameters: 10(Integer)
2021-12-14 20:59:32.862 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 20:59:32.862 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 20:59:32.863 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 20:59:32.863 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 20:59:32.863 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 20:59:32.864 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 20:59:32.864 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125944768038572032[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 20:59:32.864 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125944768038572032[0;39m <==      Total: 6
2021-12-14 20:59:32.865 INFO  com.servicess.EbookService                        :48   [32m125944768038572032[0;39m 总行数：6
2021-12-14 20:59:32.865 INFO  com.servicess.EbookService                        :49   [32m125944768038572032[0;39m 总页数：1
2021-12-14 20:59:32.865 INFO  com.aspect.LogAspect                              :92   [32m125944768038572032[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 20:59:32.866 INFO  com.aspect.LogAspect                              :93   [32m125944768038572032[0;39m ------------- 结束 耗时：225 ms -------------
2021-12-14 20:59:34.675 INFO  com.websocket.WebSocketServer                     :41   [32m125944338223075328[0;39m 连接关闭，token：qZxWjJfmkW，session id：3！当前连接数：0
2021-12-14 20:59:35.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125944777941323776[0;39m 生成今日电子书快照开始
2021-12-14 20:59:35.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944777941323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:35.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944777941323776[0;39m ==> Parameters: 
2021-12-14 20:59:35.305 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944777941323776[0;39m <==    Updates: 0
2021-12-14 20:59:35.306 INFO  com.job.EbookSnapshotJob                          :35   [32m125944777941323776[0;39m 生成今日电子书快照结束，耗时：304毫秒
2021-12-14 20:59:35.306 INFO  com.job.DocJob                                    :32   [32m125944779216392192[0;39m 更新电子书下的文档数据开始
2021-12-14 20:59:35.307 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944779216392192[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 20:59:35.308 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944779216392192[0;39m ==> Parameters: 
2021-12-14 20:59:35.454 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944779216392192[0;39m <==    Updates: 3
2021-12-14 20:59:35.455 INFO  com.job.DocJob                                    :35   [32m125944779216392192[0;39m 更新电子书下的文档数据结束，耗时：148毫秒
2021-12-14 20:59:40.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125944798946398208[0;39m 生成今日电子书快照开始
2021-12-14 20:59:40.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944798946398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:40.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944798946398208[0;39m ==> Parameters: 
2021-12-14 20:59:40.277 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944798946398208[0;39m <==    Updates: 0
2021-12-14 20:59:40.277 INFO  com.job.EbookSnapshotJob                          :35   [32m125944798946398208[0;39m 生成今日电子书快照结束，耗时：267毫秒
2021-12-14 20:59:45.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125944819976638464[0;39m 生成今日电子书快照开始
2021-12-14 20:59:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944819976638464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944819976638464[0;39m ==> Parameters: 
2021-12-14 20:59:45.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944819976638464[0;39m <==    Updates: 0
2021-12-14 20:59:45.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125944819976638464[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 20:59:50.025 INFO  com.job.EbookSnapshotJob                          :32   [32m125944840952352768[0;39m 生成今日电子书快照开始
2021-12-14 20:59:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944840952352768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944840952352768[0;39m ==> Parameters: 
2021-12-14 20:59:50.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944840952352768[0;39m <==    Updates: 0
2021-12-14 20:59:50.246 INFO  com.job.EbookSnapshotJob                          :35   [32m125944840952352768[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-14 20:59:55.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944861881929728[0;39m 生成今日电子书快照开始
2021-12-14 20:59:55.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944861881929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 20:59:55.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944861881929728[0;39m ==> Parameters: 
2021-12-14 20:59:55.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944861881929728[0;39m <==    Updates: 0
2021-12-14 20:59:55.249 INFO  com.job.EbookSnapshotJob                          :35   [32m125944861881929728[0;39m 生成今日电子书快照结束，耗时：234毫秒
2021-12-14 21:00:00.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125944882891198464[0;39m 生成今日电子书快照开始
2021-12-14 21:00:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944882891198464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944882891198464[0;39m ==> Parameters: 
2021-12-14 21:00:00.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944882891198464[0;39m <==    Updates: 0
2021-12-14 21:00:00.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125944882891198464[0;39m 生成今日电子书快照结束，耗时：191毫秒
2021-12-14 21:00:05.083 INFO  com.job.DocJob                                    :32   [32m125944904110182400[0;39m 更新电子书下的文档数据开始
2021-12-14 21:00:05.162 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944904110182400[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:00:05.162 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944904110182400[0;39m ==> Parameters: 
2021-12-14 21:00:05.315 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125944904110182400[0;39m <==    Updates: 3
2021-12-14 21:00:05.315 INFO  com.job.DocJob                                    :35   [32m125944904110182400[0;39m 更新电子书下的文档数据结束，耗时：232毫秒
2021-12-14 21:00:05.315 INFO  com.job.EbookSnapshotJob                          :32   [32m125944905083260928[0;39m 生成今日电子书快照开始
2021-12-14 21:00:05.315 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944905083260928[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:05.315 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944905083260928[0;39m ==> Parameters: 
2021-12-14 21:00:05.485 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944905083260928[0;39m <==    Updates: 0
2021-12-14 21:00:05.485 INFO  com.job.EbookSnapshotJob                          :35   [32m125944905083260928[0;39m 生成今日电子书快照结束，耗时：170毫秒
2021-12-14 21:00:10.000 INFO  com.job.EbookSnapshotJob                          :32   [32m125944924733575168[0;39m 生成今日电子书快照开始
2021-12-14 21:00:10.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944924733575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:10.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944924733575168[0;39m ==> Parameters: 
2021-12-14 21:00:10.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944924733575168[0;39m <==    Updates: 0
2021-12-14 21:00:10.230 INFO  com.job.EbookSnapshotJob                          :35   [32m125944924733575168[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-14 21:00:15.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125944945742843904[0;39m 生成今日电子书快照开始
2021-12-14 21:00:15.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944945742843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:15.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944945742843904[0;39m ==> Parameters: 
2021-12-14 21:00:15.201 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944945742843904[0;39m <==    Updates: 0
2021-12-14 21:00:15.201 INFO  com.job.EbookSnapshotJob                          :35   [32m125944945742843904[0;39m 生成今日电子书快照结束，耗时：192毫秒
2021-12-14 21:00:20.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125944966735335424[0;39m 生成今日电子书快照开始
2021-12-14 21:00:20.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944966735335424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:20.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944966735335424[0;39m ==> Parameters: 
2021-12-14 21:00:20.225 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944966735335424[0;39m <==    Updates: 0
2021-12-14 21:00:20.226 INFO  com.job.EbookSnapshotJob                          :35   [32m125944966735335424[0;39m 生成今日电子书快照结束，耗时：212毫秒
2021-12-14 21:00:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125944987711049728[0;39m 生成今日电子书快照开始
2021-12-14 21:00:25.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944987711049728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:25.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944987711049728[0;39m ==> Parameters: 
2021-12-14 21:00:25.202 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125944987711049728[0;39m <==    Updates: 0
2021-12-14 21:00:25.202 INFO  com.job.EbookSnapshotJob                          :35   [32m125944987711049728[0;39m 生成今日电子书快照结束，耗时：187毫秒
2021-12-14 21:00:30.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125945008720318464[0;39m 生成今日电子书快照开始
2021-12-14 21:00:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945008720318464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945008720318464[0;39m ==> Parameters: 
2021-12-14 21:00:30.200 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945008720318464[0;39m <==    Updates: 0
2021-12-14 21:00:30.200 INFO  com.job.EbookSnapshotJob                          :35   [32m125945008720318464[0;39m 生成今日电子书快照结束，耗时：176毫秒
2021-12-14 21:00:35.024 INFO  com.job.DocJob                                    :32   [32m125945029691838464[0;39m 更新电子书下的文档数据开始
2021-12-14 21:00:35.087 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945029691838464[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:00:35.087 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945029691838464[0;39m ==> Parameters: 
2021-12-14 21:00:35.231 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945029691838464[0;39m <==    Updates: 3
2021-12-14 21:00:35.231 INFO  com.job.DocJob                                    :35   [32m125945029691838464[0;39m 更新电子书下的文档数据结束，耗时：207毫秒
2021-12-14 21:00:35.231 INFO  com.job.EbookSnapshotJob                          :32   [32m125945030560059392[0;39m 生成今日电子书快照开始
2021-12-14 21:00:35.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945030560059392[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:35.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945030560059392[0;39m ==> Parameters: 
2021-12-14 21:00:35.371 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945030560059392[0;39m <==    Updates: 0
2021-12-14 21:00:35.371 INFO  com.job.EbookSnapshotJob                          :35   [32m125945030560059392[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-14 21:00:39.364 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2021-12-14 21:00:39.386 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2021-12-14 21:00:39.708 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 5952 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 21:00:39.708 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 21:00:41.041 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 21:00:41.041 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 21:00:42.009 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 958 ms. Found 0 Redis repository interfaces.
2021-12-14 21:00:42.416 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 21:00:42.432 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 21:00:42.432 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 21:00:42.432 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 21:00:42.464 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 21:00:42.464 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2756 ms
2021-12-14 21:00:42.852 WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext:591  [32m                  [0;39m Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ebookController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.servicess.EbookService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@javax.annotation.Resource(shareable=true, lookup="", name="", description="", authenticationType=CONTAINER, type=java.lang.Object.class, mappedName="")}
2021-12-14 21:00:42.852 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Stopping service [Tomcat]
2021-12-14 21:00:42.852 INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener:136  [32m                  [0;39m 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2021-12-14 21:00:42.899 ERROR o.s.b.diagnostics.LoggingFailureAnalysisReporter  :40   [32m                  [0;39m 

***************************
APPLICATION FAILED TO START
***************************

Description:

A component required a bean of type 'com.servicess.EbookService' that could not be found.


Action:

Consider defining a bean of type 'com.servicess.EbookService' in your configuration.

2021-12-14 21:00:44.411 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 5952 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-14 21:00:44.411 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-14 21:00:45.060 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-14 21:00:45.060 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-14 21:00:45.442 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 373 ms. Found 0 Redis repository interfaces.
2021-12-14 21:00:45.551 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-14 21:00:45.551 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-14 21:00:45.551 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-14 21:00:45.551 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-14 21:00:45.567 INFO  o.a.c.c.ContainerBase.[Tomcat-1].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-14 21:00:45.567 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1156 ms
2021-12-14 21:00:46.185 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-14 21:00:46.200 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-14 21:00:46.200 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-14 21:00:46.200 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 1.849 seconds (JVM running for 503.437)
2021-12-14 21:00:46.200 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2021-12-14 21:00:50.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125945092572844032[0;39m 生成今日电子书快照开始
2021-12-14 21:00:50.016 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125945092572844032[0;39m HikariPool-2 - Starting...
2021-12-14 21:00:50.694 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125945092572844032[0;39m HikariPool-2 - Start completed.
2021-12-14 21:00:50.694 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945092572844032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:50.694 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945092572844032[0;39m ==> Parameters: 
2021-12-14 21:00:50.839 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945092572844032[0;39m <==    Updates: 0
2021-12-14 21:00:50.839 INFO  com.job.EbookSnapshotJob                          :35   [32m125945092572844032[0;39m 生成今日电子书快照结束，耗时：823毫秒
2021-12-14 21:00:55.024 INFO  com.job.EbookSnapshotJob                          :32   [32m125945113577918464[0;39m 生成今日电子书快照开始
2021-12-14 21:00:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945113577918464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:00:55.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945113577918464[0;39m ==> Parameters: 
2021-12-14 21:00:55.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945113577918464[0;39m <==    Updates: 0
2021-12-14 21:00:55.217 INFO  com.job.EbookSnapshotJob                          :35   [32m125945113577918464[0;39m 生成今日电子书快照结束，耗时：193毫秒
2021-12-14 21:01:00.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125945134478135296[0;39m 生成今日电子书快照开始
2021-12-14 21:01:00.073 INFO  o.a.c.c.ContainerBase.[Tomcat-1].[localhost].[/]  :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-14 21:01:00.073 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-14 21:01:00.074 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-14 21:01:00.076 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：meCgW7PUME，session id：4，当前连接数：1
2021-12-14 21:01:00.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945134478135296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:00.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945134478135296[0;39m ==> Parameters: 
2021-12-14 21:01:00.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945134478135296[0;39m <==    Updates: 0
2021-12-14 21:01:00.229 INFO  com.job.EbookSnapshotJob                          :35   [32m125945134478135296[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-14 21:01:00.240 INFO  com.aspect.LogAspect                              :54   [32m125945135455408128[0;39m ------------- 开始 -------------
2021-12-14 21:01:00.241 INFO  com.aspect.LogAspect                              :54   [32m125945135459602432[0;39m ------------- 开始 -------------
2021-12-14 21:01:00.241 INFO  com.aspect.LogAspect                              :55   [32m125945135459602432[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 21:01:00.242 INFO  com.aspect.LogAspect                              :56   [32m125945135459602432[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 21:01:00.242 INFO  com.aspect.LogAspect                              :57   [32m125945135459602432[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:00.241 INFO  com.aspect.LogAspect                              :55   [32m125945135455408128[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 21:01:00.243 INFO  com.aspect.LogAspect                              :56   [32m125945135455408128[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 21:01:00.243 INFO  com.aspect.LogAspect                              :57   [32m125945135455408128[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:00.244 INFO  com.aspect.LogAspect                              :80   [32m125945135455408128[0;39m 请求参数: []
2021-12-14 21:01:00.245 INFO  com.aspect.LogAspect                              :80   [32m125945135459602432[0;39m 请求参数: []
2021-12-14 21:01:00.245 INFO  com.aspect.LogAspect                              :54   [32m125945135476379648[0;39m ------------- 开始 -------------
2021-12-14 21:01:00.245 INFO  com.aspect.LogAspect                              :55   [32m125945135476379648[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 21:01:00.245 INFO  com.aspect.LogAspect                              :56   [32m125945135476379648[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 21:01:00.245 INFO  com.aspect.LogAspect                              :57   [32m125945135476379648[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:00.246 INFO  com.aspect.LogAspect                              :80   [32m125945135476379648[0;39m 请求参数: []
2021-12-14 21:01:00.248 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945135455408128[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:01:00.249 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945135455408128[0;39m ==> Parameters: 
2021-12-14 21:01:00.385 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945135459602432[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:01:00.386 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945135459602432[0;39m ==> Parameters: 
2021-12-14 21:01:00.397 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945135476379648[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 21:01:00.398 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945135476379648[0;39m ==> Parameters: 
2021-12-14 21:01:00.402 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945135455408128[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 21:01:00.404 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945135455408128[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 21:01:00.406 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945135455408128[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 21:01:00.407 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945135455408128[0;39m <==      Total: 2
2021-12-14 21:01:00.415 INFO  com.aspect.LogAspect                              :92   [32m125945135455408128[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 21:01:00.417 INFO  com.aspect.LogAspect                              :93   [32m125945135455408128[0;39m ------------- 结束 耗时：177 ms -------------
2021-12-14 21:01:00.457 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945135459602432[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 21:01:00.457 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945135459602432[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 21:01:00.458 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945135459602432[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 21:01:00.458 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945135459602432[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 21:01:00.459 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945135459602432[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 21:01:00.460 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945135459602432[0;39m <==      Total: 4
2021-12-14 21:01:00.460 INFO  com.aspect.LogAspect                              :92   [32m125945135459602432[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 21:01:00.460 INFO  com.aspect.LogAspect                              :93   [32m125945135459602432[0;39m ------------- 结束 耗时：219 ms -------------
2021-12-14 21:01:00.462 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==    Columns: id, parent, name, sort
2021-12-14 21:01:00.463 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 21:01:00.463 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 21:01:00.464 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 21:01:00.464 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 21:01:00.464 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 21:01:00.465 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 21:01:00.465 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 21:01:00.465 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 21:01:00.466 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 21:01:00.466 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 21:01:00.466 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 21:01:00.467 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 21:01:00.467 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 21:01:00.467 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 21:01:00.468 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 21:01:00.468 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 21:01:00.469 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 21:01:00.470 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 21:01:00.470 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945135476379648[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 21:01:00.471 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945135476379648[0;39m <==      Total: 19
2021-12-14 21:01:00.480 INFO  com.aspect.LogAspect                              :92   [32m125945135476379648[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 21:01:00.481 INFO  com.aspect.LogAspect                              :93   [32m125945135476379648[0;39m ------------- 结束 耗时：236 ms -------------
2021-12-14 21:01:05.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125945155462238208[0;39m 生成今日电子书快照开始
2021-12-14 21:01:05.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945155462238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:05.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945155462238208[0;39m ==> Parameters: 
2021-12-14 21:01:05.200 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945155462238208[0;39m <==    Updates: 0
2021-12-14 21:01:05.200 INFO  com.job.EbookSnapshotJob                          :35   [32m125945155462238208[0;39m 生成今日电子书快照结束，耗时：190毫秒
2021-12-14 21:01:05.200 INFO  com.job.DocJob                                    :32   [32m125945156259155968[0;39m 更新电子书下的文档数据开始
2021-12-14 21:01:05.216 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945156259155968[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:01:05.216 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945156259155968[0;39m ==> Parameters: 
2021-12-14 21:01:05.341 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945156259155968[0;39m <==    Updates: 3
2021-12-14 21:01:05.341 INFO  com.job.DocJob                                    :35   [32m125945156259155968[0;39m 更新电子书下的文档数据结束，耗时：141毫秒
2021-12-14 21:01:10.025 INFO  com.job.EbookSnapshotJob                          :32   [32m125945176496672768[0;39m 生成今日电子书快照开始
2021-12-14 21:01:10.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945176496672768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:10.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945176496672768[0;39m ==> Parameters: 
2021-12-14 21:01:10.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945176496672768[0;39m <==    Updates: 0
2021-12-14 21:01:10.232 INFO  com.job.EbookSnapshotJob                          :35   [32m125945176496672768[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 21:01:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125945197430444032[0;39m 生成今日电子书快照开始
2021-12-14 21:01:15.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945197430444032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:15.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945197430444032[0;39m ==> Parameters: 
2021-12-14 21:01:15.239 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945197430444032[0;39m <==    Updates: 0
2021-12-14 21:01:15.239 INFO  com.job.EbookSnapshotJob                          :35   [32m125945197430444032[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-14 21:01:20.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125945218401964032[0;39m 生成今日电子书快照开始
2021-12-14 21:01:20.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945218401964032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945218401964032[0;39m ==> Parameters: 
2021-12-14 21:01:20.191 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945218401964032[0;39m <==    Updates: 0
2021-12-14 21:01:20.191 INFO  com.job.EbookSnapshotJob                          :35   [32m125945218401964032[0;39m 生成今日电子书快照结束，耗时：175毫秒
2021-12-14 21:01:25.018 INFO  com.job.EbookSnapshotJob                          :32   [32m125945239381872640[0;39m 生成今日电子书快照开始
2021-12-14 21:01:25.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945239381872640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:25.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945239381872640[0;39m ==> Parameters: 
2021-12-14 21:01:25.385 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945239381872640[0;39m <==    Updates: 0
2021-12-14 21:01:25.385 INFO  com.job.EbookSnapshotJob                          :35   [32m125945239381872640[0;39m 生成今日电子书快照结束，耗时：367毫秒
2021-12-14 21:01:30.026 INFO  com.job.EbookSnapshotJob                          :32   [32m125945260386947072[0;39m 生成今日电子书快照开始
2021-12-14 21:01:30.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945260386947072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:30.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945260386947072[0;39m ==> Parameters: 
2021-12-14 21:01:30.435 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945260386947072[0;39m <==    Updates: 0
2021-12-14 21:01:30.436 INFO  com.job.EbookSnapshotJob                          :35   [32m125945260386947072[0;39m 生成今日电子书快照结束，耗时：409毫秒
2021-12-14 21:01:32.273 INFO  com.aspect.LogAspect                              :54   [32m125945269811548160[0;39m ------------- 开始 -------------
2021-12-14 21:01:32.273 INFO  com.aspect.LogAspect                              :55   [32m125945269811548160[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-14 21:01:32.273 INFO  com.aspect.LogAspect                              :56   [32m125945269811548160[0;39m 类名方法: com.controller.UserController.login
2021-12-14 21:01:32.273 INFO  com.aspect.LogAspect                              :57   [32m125945269811548160[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:32.274 INFO  com.aspect.LogAspect                              :80   [32m125945269811548160[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-14 21:01:32.367 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945269811548160[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-14 21:01:32.368 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945269811548160[0;39m ==> Parameters: test123(String)
2021-12-14 21:01:32.432 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945269811548160[0;39m <==    Columns: id, login_name, name, password
2021-12-14 21:01:32.433 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945269811548160[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 21:01:32.435 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945269811548160[0;39m <==      Total: 1
2021-12-14 21:01:32.452 INFO  com.controller.UserController                     :77   [32m125945269811548160[0;39m 生成单点登录token:125945270562328576,并放入redis中
2021-12-14 21:01:32.867 INFO  com.aspect.LogAspect                              :92   [32m125945269811548160[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125945270562328576"},"success":true}
2021-12-14 21:01:32.868 INFO  com.aspect.LogAspect                              :93   [32m125945269811548160[0;39m ------------- 结束 耗时：595 ms -------------
2021-12-14 21:01:33.050 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：meCgW7PUME，session id：4！当前连接数：0
2021-12-14 21:01:34.139 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：EeMqRdeByl，session id：5，当前连接数：1
2021-12-14 21:01:34.224 INFO  com.aspect.LogAspect                              :54   [32m125945277994635264[0;39m ------------- 开始 -------------
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :55   [32m125945277994635264[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :56   [32m125945277994635264[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :54   [32m125945277998829568[0;39m ------------- 开始 -------------
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :57   [32m125945277994635264[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :55   [32m125945277998829568[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :80   [32m125945277994635264[0;39m 请求参数: []
2021-12-14 21:01:34.225 INFO  com.aspect.LogAspect                              :56   [32m125945277998829568[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 21:01:34.226 INFO  com.aspect.LogAspect                              :57   [32m125945277998829568[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:34.226 INFO  com.aspect.LogAspect                              :80   [32m125945277998829568[0;39m 请求参数: []
2021-12-14 21:01:34.227 INFO  com.aspect.LogAspect                              :54   [32m125945278007218176[0;39m ------------- 开始 -------------
2021-12-14 21:01:34.228 INFO  com.aspect.LogAspect                              :55   [32m125945278007218176[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 21:01:34.228 INFO  com.aspect.LogAspect                              :56   [32m125945278007218176[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 21:01:34.228 INFO  com.aspect.LogAspect                              :57   [32m125945278007218176[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:34.228 INFO  com.aspect.LogAspect                              :80   [32m125945278007218176[0;39m 请求参数: []
2021-12-14 21:01:34.284 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945277994635264[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:01:34.285 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945277994635264[0;39m ==> Parameters: 
2021-12-14 21:01:34.290 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945277998829568[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:01:34.290 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945278007218176[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 21:01:34.291 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945277998829568[0;39m ==> Parameters: 
2021-12-14 21:01:34.291 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945278007218176[0;39m ==> Parameters: 
2021-12-14 21:01:34.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==    Columns: id, parent, name, sort
2021-12-14 21:01:34.354 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945277994635264[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 21:01:34.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 21:01:34.355 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945277994635264[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 21:01:34.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 21:01:34.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 21:01:34.355 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945277994635264[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 21:01:34.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 21:01:34.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 21:01:34.356 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945277994635264[0;39m <==      Total: 2
2021-12-14 21:01:34.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 21:01:34.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 21:01:34.356 INFO  com.aspect.LogAspect                              :92   [32m125945277994635264[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 21:01:34.356 INFO  com.aspect.LogAspect                              :93   [32m125945277994635264[0;39m ------------- 结束 耗时：132 ms -------------
2021-12-14 21:01:34.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 21:01:34.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 21:01:34.357 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 21:01:34.357 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 21:01:34.357 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 21:01:34.358 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 21:01:34.358 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 21:01:34.358 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 21:01:34.359 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 21:01:34.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945277998829568[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 21:01:34.359 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 21:01:34.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945277998829568[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 21:01:34.359 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 21:01:34.359 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945278007218176[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 21:01:34.359 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945278007218176[0;39m <==      Total: 19
2021-12-14 21:01:34.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945277998829568[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 21:01:34.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945277998829568[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 21:01:34.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945277998829568[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 21:01:34.359 INFO  com.aspect.LogAspect                              :92   [32m125945278007218176[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 21:01:34.359 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945277998829568[0;39m <==      Total: 4
2021-12-14 21:01:34.359 INFO  com.aspect.LogAspect                              :93   [32m125945278007218176[0;39m ------------- 结束 耗时：132 ms -------------
2021-12-14 21:01:34.359 INFO  com.aspect.LogAspect                              :92   [32m125945277998829568[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 21:01:34.363 INFO  com.aspect.LogAspect                              :93   [32m125945277998829568[0;39m ------------- 结束 耗时：138 ms -------------
2021-12-14 21:01:34.890 INFO  com.aspect.LogAspect                              :54   [32m125945280788041728[0;39m ------------- 开始 -------------
2021-12-14 21:01:34.890 INFO  com.aspect.LogAspect                              :55   [32m125945280788041728[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 21:01:34.890 INFO  com.aspect.LogAspect                              :56   [32m125945280788041728[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 21:01:34.890 INFO  com.aspect.LogAspect                              :57   [32m125945280788041728[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:34.890 INFO  com.aspect.LogAspect                              :80   [32m125945280788041728[0;39m 请求参数: []
2021-12-14 21:01:34.981 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945280788041728[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 21:01:34.982 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945280788041728[0;39m ==> Parameters: 
2021-12-14 21:01:35.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125945281270386688[0;39m 生成今日电子书快照开始
2021-12-14 21:01:35.064 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==    Columns: id, parent, name, sort
2021-12-14 21:01:35.064 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 21:01:35.065 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 21:01:35.065 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 21:01:35.066 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 21:01:35.067 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 21:01:35.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 21:01:35.068 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 21:01:35.069 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 21:01:35.069 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 21:01:35.069 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 21:01:35.069 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 21:01:35.070 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 21:01:35.071 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 21:01:35.071 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945280788041728[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 21:01:35.071 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945280788041728[0;39m <==      Total: 19
2021-12-14 21:01:35.072 INFO  com.aspect.LogAspect                              :92   [32m125945280788041728[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 21:01:35.072 INFO  com.aspect.LogAspect                              :93   [32m125945280788041728[0;39m ------------- 结束 耗时：182 ms -------------
2021-12-14 21:01:35.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945281270386688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:35.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945281270386688[0;39m ==> Parameters: 
2021-12-14 21:01:35.109 INFO  com.aspect.LogAspect                              :54   [32m125945281702400000[0;39m ------------- 开始 -------------
2021-12-14 21:01:35.109 INFO  com.aspect.LogAspect                              :55   [32m125945281702400000[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 21:01:35.109 INFO  com.aspect.LogAspect                              :56   [32m125945281702400000[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 21:01:35.109 INFO  com.aspect.LogAspect                              :57   [32m125945281702400000[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:35.109 INFO  com.aspect.LogAspect                              :80   [32m125945281702400000[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 21:01:35.115 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945281702400000[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 21:01:35.115 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945281702400000[0;39m ==> Parameters: 
2021-12-14 21:01:35.180 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945281702400000[0;39m <==    Columns: count(0)
2021-12-14 21:01:35.180 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945281702400000[0;39m <==        Row: 6
2021-12-14 21:01:35.181 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945281702400000[0;39m <==      Total: 1
2021-12-14 21:01:35.181 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945281702400000[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 21:01:35.182 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945281702400000[0;39m ==> Parameters: 10(Integer)
2021-12-14 21:01:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945281270386688[0;39m <==    Updates: 0
2021-12-14 21:01:35.221 INFO  com.job.EbookSnapshotJob                          :35   [32m125945281270386688[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-14 21:01:35.221 INFO  com.job.DocJob                                    :32   [32m125945282176356352[0;39m 更新电子书下的文档数据开始
2021-12-14 21:01:35.221 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945282176356352[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:01:35.222 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945282176356352[0;39m ==> Parameters: 
2021-12-14 21:01:35.252 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 21:01:35.252 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 21:01:35.253 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 21:01:35.253 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 21:01:35.253 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 21:01:35.254 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 21:01:35.254 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945281702400000[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 21:01:35.254 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945281702400000[0;39m <==      Total: 6
2021-12-14 21:01:35.255 INFO  com.servicess.EbookService                        :48   [32m125945281702400000[0;39m 总行数：6
2021-12-14 21:01:35.255 INFO  com.servicess.EbookService                        :49   [32m125945281702400000[0;39m 总页数：1
2021-12-14 21:01:35.261 INFO  com.aspect.LogAspect                              :92   [32m125945281702400000[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 21:01:35.261 INFO  com.aspect.LogAspect                              :93   [32m125945281702400000[0;39m ------------- 结束 耗时：153 ms -------------
2021-12-14 21:01:35.478 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945282176356352[0;39m <==    Updates: 3
2021-12-14 21:01:35.481 INFO  com.job.DocJob                                    :35   [32m125945282176356352[0;39m 更新电子书下的文档数据结束，耗时：259毫秒
2021-12-14 21:01:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125945302258683904[0;39m 生成今日电子书快照开始
2021-12-14 21:01:40.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945302258683904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:40.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945302258683904[0;39m ==> Parameters: 
2021-12-14 21:01:40.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945302258683904[0;39m <==    Updates: 0
2021-12-14 21:01:40.216 INFO  com.job.EbookSnapshotJob                          :35   [32m125945302258683904[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-14 21:01:45.006 INFO  com.job.EbookSnapshotJob                          :32   [32m125945323217620992[0;39m 生成今日电子书快照开始
2021-12-14 21:01:45.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945323217620992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:45.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945323217620992[0;39m ==> Parameters: 
2021-12-14 21:01:45.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945323217620992[0;39m <==    Updates: 0
2021-12-14 21:01:45.218 INFO  com.job.EbookSnapshotJob                          :35   [32m125945323217620992[0;39m 生成今日电子书快照结束，耗时：211毫秒
2021-12-14 21:01:50.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125945344176558080[0;39m 生成今日电子书快照开始
2021-12-14 21:01:50.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945344176558080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:50.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945344176558080[0;39m ==> Parameters: 
2021-12-14 21:01:50.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945344176558080[0;39m <==    Updates: 0
2021-12-14 21:01:50.227 INFO  com.job.EbookSnapshotJob                          :35   [32m125945344176558080[0;39m 生成今日电子书快照结束，耗时：224毫秒
2021-12-14 21:01:52.232 INFO  com.interceptor.LoginInterceptor                  :29   [32m125945135459602432[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 21:01:52.233 INFO  com.interceptor.LoginInterceptor                  :40   [32m125945135459602432[0;39m 接口登录拦截：，path：http://localhost:8081/ebook/save
2021-12-14 21:01:52.233 INFO  com.interceptor.LoginInterceptor                  :44   [32m125945135459602432[0;39m 登录校验开始，token：125945270562328576
2021-12-14 21:01:52.270 INFO  com.interceptor.LoginInterceptor                  :56   [32m125945135459602432[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125945270562328576"}
2021-12-14 21:01:52.274 INFO  com.aspect.LogAspect                              :54   [32m125945353701822464[0;39m ------------- 开始 -------------
2021-12-14 21:01:52.274 INFO  com.aspect.LogAspect                              :55   [32m125945353701822464[0;39m 请求地址: http://localhost:8081/ebook/save POST
2021-12-14 21:01:52.274 INFO  com.aspect.LogAspect                              :56   [32m125945353701822464[0;39m 类名方法: com.controller.EbookController.save
2021-12-14 21:01:52.275 INFO  com.aspect.LogAspect                              :57   [32m125945353701822464[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:52.275 INFO  com.aspect.LogAspect                              :80   [32m125945353701822464[0;39m 请求参数: [{"category1Id":500,"category2Id":502,"description":"123","name":"aa"}]
2021-12-14 21:01:52.337 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125945353701822464[0;39m ==>  Preparing: insert into ebook (id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count ) values (?, ?, ?, ?, ?, ?, ?, ?, ? )
2021-12-14 21:01:52.338 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125945353701822464[0;39m ==> Parameters: 125945353718599680(Long), aa(String), 500(Long), 502(Long), 123(String), null, 0(Integer), 0(Integer), 0(Integer)
2021-12-14 21:01:52.466 DEBUG com.mapper.EbookMapper.insert                     :137  [32m125945353701822464[0;39m <==    Updates: 1
2021-12-14 21:01:52.467 INFO  com.aspect.LogAspect                              :92   [32m125945353701822464[0;39m 返回结果: {"success":true}
2021-12-14 21:01:52.468 INFO  com.aspect.LogAspect                              :93   [32m125945353701822464[0;39m ------------- 结束 耗时：194 ms -------------
2021-12-14 21:01:52.472 INFO  com.interceptor.LoginInterceptor                  :65   [32m125945353701822464[0;39m ------------- LoginInterceptor 结束 耗时：239 ms -------------
2021-12-14 21:01:52.531 INFO  com.aspect.LogAspect                              :54   [32m125945354779758592[0;39m ------------- 开始 -------------
2021-12-14 21:01:52.532 INFO  com.aspect.LogAspect                              :55   [32m125945354779758592[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 21:01:52.532 INFO  com.aspect.LogAspect                              :56   [32m125945354779758592[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 21:01:52.532 INFO  com.aspect.LogAspect                              :57   [32m125945354779758592[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:01:52.532 INFO  com.aspect.LogAspect                              :80   [32m125945354779758592[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 21:01:52.602 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945354779758592[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 21:01:52.604 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945354779758592[0;39m ==> Parameters: 
2021-12-14 21:01:52.662 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945354779758592[0;39m <==    Columns: count(0)
2021-12-14 21:01:52.668 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945354779758592[0;39m <==        Row: 7
2021-12-14 21:01:52.670 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945354779758592[0;39m <==      Total: 1
2021-12-14 21:01:52.673 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945354779758592[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 21:01:52.674 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945354779758592[0;39m ==> Parameters: 10(Integer)
2021-12-14 21:01:52.759 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 21:01:52.759 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 21:01:52.760 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 21:01:52.761 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 21:01:52.761 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 21:01:52.762 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 21:01:52.762 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 21:01:52.763 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945354779758592[0;39m <==        Row: 125945353718599680, aa, 500, 502, 123, null, 0, 0, 0
2021-12-14 21:01:52.763 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945354779758592[0;39m <==      Total: 7
2021-12-14 21:01:52.763 INFO  com.servicess.EbookService                        :48   [32m125945354779758592[0;39m 总行数：7
2021-12-14 21:01:52.763 INFO  com.servicess.EbookService                        :49   [32m125945354779758592[0;39m 总页数：1
2021-12-14 21:01:52.770 INFO  com.aspect.LogAspect                              :92   [32m125945354779758592[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45},{"category1Id":500,"category2Id":502,"description":"123","docCount":0,"id":125945353718599680,"name":"aa","viewCount":0,"voteCount":0}],"total":7},"success":true}
2021-12-14 21:01:52.771 INFO  com.aspect.LogAspect                              :93   [32m125945354779758592[0;39m ------------- 结束 耗时：240 ms -------------
2021-12-14 21:01:55.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125945365202604032[0;39m 生成今日电子书快照开始
2021-12-14 21:01:55.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945365202604032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:01:55.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945365202604032[0;39m ==> Parameters: 
2021-12-14 21:01:55.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945365202604032[0;39m <==    Updates: 1
2021-12-14 21:01:55.265 INFO  com.job.EbookSnapshotJob                          :35   [32m125945365202604032[0;39m 生成今日电子书快照结束，耗时：249毫秒
2021-12-14 21:02:00.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125945386153152512[0;39m 生成今日电子书快照开始
2021-12-14 21:02:00.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945386153152512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:00.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945386153152512[0;39m ==> Parameters: 
2021-12-14 21:02:00.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945386153152512[0;39m <==    Updates: 0
2021-12-14 21:02:00.232 INFO  com.job.EbookSnapshotJob                          :35   [32m125945386153152512[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-14 21:02:05.007 INFO  com.job.DocJob                                    :32   [32m125945407107895296[0;39m 更新电子书下的文档数据开始
2021-12-14 21:02:05.070 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945407107895296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:02:05.070 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945407107895296[0;39m ==> Parameters: 
2021-12-14 21:02:05.195 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945407107895296[0;39m <==    Updates: 3
2021-12-14 21:02:05.195 INFO  com.job.DocJob                                    :35   [32m125945407107895296[0;39m 更新电子书下的文档数据结束，耗时：188毫秒
2021-12-14 21:02:05.195 INFO  com.job.EbookSnapshotJob                          :32   [32m125945407896424448[0;39m 生成今日电子书快照开始
2021-12-14 21:02:05.195 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945407896424448[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:05.195 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945407896424448[0;39m ==> Parameters: 
2021-12-14 21:02:05.338 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945407896424448[0;39m <==    Updates: 0
2021-12-14 21:02:05.338 INFO  com.job.EbookSnapshotJob                          :35   [32m125945407896424448[0;39m 生成今日电子书快照结束，耗时：143毫秒
2021-12-14 21:02:10.022 INFO  com.job.EbookSnapshotJob                          :32   [32m125945428142329856[0;39m 生成今日电子书快照开始
2021-12-14 21:02:10.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945428142329856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:10.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945428142329856[0;39m ==> Parameters: 
2021-12-14 21:02:10.273 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945428142329856[0;39m <==    Updates: 0
2021-12-14 21:02:10.273 INFO  com.job.EbookSnapshotJob                          :35   [32m125945428142329856[0;39m 生成今日电子书快照结束，耗时：251毫秒
2021-12-14 21:02:15.019 INFO  com.job.EbookSnapshotJob                          :32   [32m125945449101266944[0;39m 生成今日电子书快照开始
2021-12-14 21:02:15.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945449101266944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:15.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945449101266944[0;39m ==> Parameters: 
2021-12-14 21:02:15.383 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945449101266944[0;39m <==    Updates: 0
2021-12-14 21:02:15.384 INFO  com.job.EbookSnapshotJob                          :35   [32m125945449101266944[0;39m 生成今日电子书快照结束，耗时：365毫秒
2021-12-14 21:02:19.292 INFO  com.interceptor.LoginInterceptor                  :29   [32m125945269811548160[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 21:02:19.292 INFO  com.interceptor.LoginInterceptor                  :65   [32m125945269811548160[0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-12-14 21:02:19.295 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 21:02:19.295 INFO  com.interceptor.LoginInterceptor                  :40   [32m                  [0;39m 接口登录拦截：，path：http://localhost:8081/ebook/delete/125945353718599680
2021-12-14 21:02:19.295 INFO  com.interceptor.LoginInterceptor                  :44   [32m                  [0;39m 登录校验开始，token：125945270562328576
2021-12-14 21:02:19.400 INFO  com.interceptor.LoginInterceptor                  :56   [32m                  [0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125945270562328576"}
2021-12-14 21:02:19.401 INFO  com.aspect.LogAspect                              :54   [32m125945467480707072[0;39m ------------- 开始 -------------
2021-12-14 21:02:19.401 INFO  com.aspect.LogAspect                              :55   [32m125945467480707072[0;39m 请求地址: http://localhost:8081/ebook/delete/125945353718599680 DELETE
2021-12-14 21:02:19.401 INFO  com.aspect.LogAspect                              :56   [32m125945467480707072[0;39m 类名方法: com.controller.EbookController.delete
2021-12-14 21:02:19.401 INFO  com.aspect.LogAspect                              :57   [32m125945467480707072[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:19.401 INFO  com.aspect.LogAspect                              :80   [32m125945467480707072[0;39m 请求参数: [125945353718599680]
2021-12-14 21:02:19.480 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125945467480707072[0;39m ==>  Preparing: delete from ebook where id = ?
2021-12-14 21:02:19.481 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125945467480707072[0;39m ==> Parameters: 125945353718599680(Long)
2021-12-14 21:02:19.705 DEBUG com.mapper.EbookMapper.deleteByPrimaryKey         :137  [32m125945467480707072[0;39m <==    Updates: 1
2021-12-14 21:02:19.705 INFO  com.aspect.LogAspect                              :92   [32m125945467480707072[0;39m 返回结果: {"success":true}
2021-12-14 21:02:19.705 INFO  com.aspect.LogAspect                              :93   [32m125945467480707072[0;39m ------------- 结束 耗时：304 ms -------------
2021-12-14 21:02:19.705 INFO  com.interceptor.LoginInterceptor                  :65   [32m125945467480707072[0;39m ------------- LoginInterceptor 结束 耗时：410 ms -------------
2021-12-14 21:02:19.743 INFO  com.aspect.LogAspect                              :54   [32m125945468915159040[0;39m ------------- 开始 -------------
2021-12-14 21:02:19.743 INFO  com.aspect.LogAspect                              :55   [32m125945468915159040[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-14 21:02:19.744 INFO  com.aspect.LogAspect                              :56   [32m125945468915159040[0;39m 类名方法: com.controller.EbookController.list
2021-12-14 21:02:19.744 INFO  com.aspect.LogAspect                              :57   [32m125945468915159040[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:19.744 INFO  com.aspect.LogAspect                              :80   [32m125945468915159040[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 21:02:19.747 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945468915159040[0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-12-14 21:02:19.748 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945468915159040[0;39m ==> Parameters: 
2021-12-14 21:02:19.805 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945468915159040[0;39m <==    Columns: count(0)
2021-12-14 21:02:19.806 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125945468915159040[0;39m <==        Row: 6
2021-12-14 21:02:19.806 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125945468915159040[0;39m <==      Total: 1
2021-12-14 21:02:19.806 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945468915159040[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-12-14 21:02:19.806 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945468915159040[0;39m ==> Parameters: 10(Integer)
2021-12-14 21:02:19.889 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-14 21:02:19.890 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 92, 16
2021-12-14 21:02:19.891 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 73, 26
2021-12-14 21:02:19.892 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-14 21:02:19.894 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-14 21:02:19.895 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 5, Oracle入门教程, 400, 117509419725623296, 零基础入门Oracle开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 211, 54
2021-12-14 21:02:19.895 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125945468915159040[0;39m <==        Row: 117509669114744832, test, 115484701694758912, 115484763686572032, test, /image/cover2.png, 20, 57, 45
2021-12-14 21:02:19.895 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125945468915159040[0;39m <==      Total: 6
2021-12-14 21:02:19.896 INFO  com.servicess.EbookService                        :48   [32m125945468915159040[0;39m 总行数：6
2021-12-14 21:02:19.896 INFO  com.servicess.EbookService                        :49   [32m125945468915159040[0;39m 总页数：1
2021-12-14 21:02:19.900 INFO  com.aspect.LogAspect                              :92   [32m125945468915159040[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":92,"voteCount":16},{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":73,"voteCount":26},{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1},{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23},{"category1Id":400,"category2Id":117509419725623296,"cover":"/image/cover1.png","description":"零基础入门Oracle开发，企业级应用开发最佳首选框架","docCount":20,"id":5,"name":"Oracle入门教程","viewCount":211,"voteCount":54},{"category1Id":115484701694758912,"category2Id":115484763686572032,"cover":"/image/cover2.png","description":"test","docCount":20,"id":117509669114744832,"name":"test","viewCount":57,"voteCount":45}],"total":6},"success":true}
2021-12-14 21:02:19.900 INFO  com.aspect.LogAspect                              :93   [32m125945468915159040[0;39m ------------- 结束 耗时：157 ms -------------
2021-12-14 21:02:20.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125945469997289472[0;39m 生成今日电子书快照开始
2021-12-14 21:02:20.060 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945469997289472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:20.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945469997289472[0;39m ==> Parameters: 
2021-12-14 21:02:20.193 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945469997289472[0;39m <==    Updates: 0
2021-12-14 21:02:20.195 INFO  com.job.EbookSnapshotJob                          :35   [32m125945469997289472[0;39m 生成今日电子书快照结束，耗时：194毫秒
2021-12-14 21:02:21.592 INFO  com.interceptor.LoginInterceptor                  :29   [32m125945277994635264[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-14 21:02:21.592 INFO  com.interceptor.LoginInterceptor                  :40   [32m125945277994635264[0;39m 接口登录拦截：，path：http://localhost:8081/user/list
2021-12-14 21:02:21.592 INFO  com.interceptor.LoginInterceptor                  :44   [32m125945277994635264[0;39m 登录校验开始，token：125945270562328576
2021-12-14 21:02:21.621 INFO  com.interceptor.LoginInterceptor                  :56   [32m125945277994635264[0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"125945270562328576"}
2021-12-14 21:02:21.630 INFO  com.aspect.LogAspect                              :54   [32m125945476829810688[0;39m ------------- 开始 -------------
2021-12-14 21:02:21.630 INFO  com.aspect.LogAspect                              :55   [32m125945476829810688[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-14 21:02:21.630 INFO  com.aspect.LogAspect                              :56   [32m125945476829810688[0;39m 类名方法: com.controller.UserController.list
2021-12-14 21:02:21.630 INFO  com.aspect.LogAspect                              :57   [32m125945476829810688[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:21.631 INFO  com.aspect.LogAspect                              :80   [32m125945476829810688[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-14 21:02:21.689 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125945476829810688[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-14 21:02:21.691 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125945476829810688[0;39m ==> Parameters: 
2021-12-14 21:02:21.752 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125945476829810688[0;39m <==    Columns: count(0)
2021-12-14 21:02:21.752 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m125945476829810688[0;39m <==        Row: 7
2021-12-14 21:02:21.753 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m125945476829810688[0;39m <==      Total: 1
2021-12-14 21:02:21.754 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945476829810688[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-14 21:02:21.756 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945476829810688[0;39m ==> Parameters: 10(Integer)
2021-12-14 21:02:21.824 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==    Columns: id, login_name, name, password
2021-12-14 21:02:21.825 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-14 21:02:21.827 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-14 21:02:21.828 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-14 21:02:21.830 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-14 21:02:21.832 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-14 21:02:21.834 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 21:02:21.835 TRACE com.mapper.UserMapper.selectByExample             :143  [32m125945476829810688[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-14 21:02:21.836 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m125945476829810688[0;39m <==      Total: 7
2021-12-14 21:02:21.837 INFO  com.servicess.UserService                         :52   [32m125945476829810688[0;39m 总行数：7
2021-12-14 21:02:21.838 INFO  com.servicess.UserService                         :53   [32m125945476829810688[0;39m 总页数：1
2021-12-14 21:02:21.849 INFO  com.aspect.LogAspect                              :92   [32m125945476829810688[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"}],"total":7},"success":true}
2021-12-14 21:02:21.850 INFO  com.aspect.LogAspect                              :93   [32m125945476829810688[0;39m ------------- 结束 耗时：220 ms -------------
2021-12-14 21:02:21.852 INFO  com.interceptor.LoginInterceptor                  :65   [32m125945476829810688[0;39m ------------- LoginInterceptor 结束 耗时：260 ms -------------
2021-12-14 21:02:23.392 INFO  com.aspect.LogAspect                              :54   [32m125945484220174336[0;39m ------------- 开始 -------------
2021-12-14 21:02:23.392 INFO  com.aspect.LogAspect                              :55   [32m125945484220174336[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 21:02:23.392 INFO  com.aspect.LogAspect                              :56   [32m125945484220174336[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 21:02:23.393 INFO  com.aspect.LogAspect                              :57   [32m125945484220174336[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:23.393 INFO  com.aspect.LogAspect                              :80   [32m125945484220174336[0;39m 请求参数: []
2021-12-14 21:02:23.453 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945484220174336[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 21:02:23.457 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945484220174336[0;39m ==> Parameters: 
2021-12-14 21:02:23.515 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==    Columns: id, parent, name, sort
2021-12-14 21:02:23.516 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 21:02:23.517 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 21:02:23.517 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 21:02:23.518 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 21:02:23.518 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 21:02:23.519 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 21:02:23.525 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 21:02:23.526 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 21:02:23.527 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 21:02:23.528 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 21:02:23.529 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 21:02:23.529 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 21:02:23.530 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 21:02:23.530 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945484220174336[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 21:02:23.530 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945484220174336[0;39m <==      Total: 19
2021-12-14 21:02:23.534 INFO  com.aspect.LogAspect                              :92   [32m125945484220174336[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 21:02:23.534 INFO  com.aspect.LogAspect                              :93   [32m125945484220174336[0;39m ------------- 结束 耗时：142 ms -------------
2021-12-14 21:02:25.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125945491023335424[0;39m 生成今日电子书快照开始
2021-12-14 21:02:25.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945491023335424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:25.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945491023335424[0;39m ==> Parameters: 
2021-12-14 21:02:25.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945491023335424[0;39m <==    Updates: 0
2021-12-14 21:02:25.209 INFO  com.job.EbookSnapshotJob                          :35   [32m125945491023335424[0;39m 生成今日电子书快照结束，耗时：194毫秒
2021-12-14 21:02:25.826 INFO  com.aspect.LogAspect                              :54   [32m125945494429110272[0;39m ------------- 开始 -------------
2021-12-14 21:02:25.826 INFO  com.aspect.LogAspect                              :55   [32m125945494429110272[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-14 21:02:25.827 INFO  com.aspect.LogAspect                              :56   [32m125945494429110272[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-14 21:02:25.827 INFO  com.aspect.LogAspect                              :57   [32m125945494429110272[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:25.827 INFO  com.aspect.LogAspect                              :80   [32m125945494429110272[0;39m 请求参数: []
2021-12-14 21:02:25.828 INFO  com.aspect.LogAspect                              :54   [32m125945494437498880[0;39m ------------- 开始 -------------
2021-12-14 21:02:25.828 INFO  com.aspect.LogAspect                              :55   [32m125945494437498880[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-14 21:02:25.829 INFO  com.aspect.LogAspect                              :56   [32m125945494437498880[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-14 21:02:25.829 INFO  com.aspect.LogAspect                              :57   [32m125945494437498880[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:25.829 INFO  com.aspect.LogAspect                              :80   [32m125945494437498880[0;39m 请求参数: []
2021-12-14 21:02:25.830 INFO  com.aspect.LogAspect                              :54   [32m125945494445887488[0;39m ------------- 开始 -------------
2021-12-14 21:02:25.830 INFO  com.aspect.LogAspect                              :55   [32m125945494445887488[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-14 21:02:25.830 INFO  com.aspect.LogAspect                              :56   [32m125945494445887488[0;39m 类名方法: com.controller.CategoryController.all
2021-12-14 21:02:25.831 INFO  com.aspect.LogAspect                              :57   [32m125945494445887488[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-14 21:02:25.831 INFO  com.aspect.LogAspect                              :80   [32m125945494445887488[0;39m 请求参数: []
2021-12-14 21:02:25.914 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945494445887488[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-14 21:02:25.914 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945494445887488[0;39m ==> Parameters: 
2021-12-14 21:02:25.919 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945494429110272[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:02:25.919 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945494437498880[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-14 21:02:25.920 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945494429110272[0;39m ==> Parameters: 
2021-12-14 21:02:25.920 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945494437498880[0;39m ==> Parameters: 
2021-12-14 21:02:25.973 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==    Columns: id, parent, name, sort
2021-12-14 21:02:25.974 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-14 21:02:25.975 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-14 21:02:25.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-14 21:02:25.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-14 21:02:25.977 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 101, 100, Vue, 101
2021-12-14 21:02:25.977 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-14 21:02:25.978 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 200, 0, Java, 200
2021-12-14 21:02:25.978 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-14 21:02:25.979 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-14 21:02:25.979 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 300, 0, Python, 300
2021-12-14 21:02:25.979 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-14 21:02:25.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-14 21:02:25.980 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-14 21:02:25.981 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-14 21:02:25.981 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-14 21:02:25.982 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 500, 0, 其他, 500
2021-12-14 21:02:25.982 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-14 21:02:25.982 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-14 21:02:25.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125945494445887488[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-14 21:02:25.983 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125945494445887488[0;39m <==      Total: 19
2021-12-14 21:02:25.992 INFO  com.aspect.LogAspect                              :92   [32m125945494445887488[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-14 21:02:25.993 INFO  com.aspect.LogAspect                              :93   [32m125945494445887488[0;39m ------------- 结束 耗时：163 ms -------------
2021-12-14 21:02:26.006 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945494429110272[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-14 21:02:26.005 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945494437498880[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-14 21:02:26.007 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945494429110272[0;39m <==        Row: 2021-12-13, 483, 160, -42, -29
2021-12-14 21:02:26.007 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945494437498880[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-14 21:02:26.009 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125945494429110272[0;39m <==        Row: 2021-12-14, 490, 165, 7, 5
2021-12-14 21:02:26.009 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945494437498880[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-14 21:02:26.011 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945494437498880[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-14 21:02:26.012 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125945494429110272[0;39m <==      Total: 2
2021-12-14 21:02:26.014 INFO  com.aspect.LogAspect                              :92   [32m125945494429110272[0;39m 返回结果: {"content":[{"date":1639324800000,"viewCount":483,"viewIncrease":-42,"voteCount":160,"voteIncrease":-29},{"date":1639411200000,"viewCount":490,"viewIncrease":7,"voteCount":165,"voteIncrease":5}],"success":true}
2021-12-14 21:02:26.015 INFO  com.aspect.LogAspect                              :93   [32m125945494429110272[0;39m ------------- 结束 耗时：189 ms -------------
2021-12-14 21:02:26.014 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125945494437498880[0;39m <==        Row: 2021-12-13, -42, -29
2021-12-14 21:02:26.016 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125945494437498880[0;39m <==      Total: 4
2021-12-14 21:02:26.021 INFO  com.aspect.LogAspect                              :92   [32m125945494437498880[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4},{"date":1639324800000,"viewCount":0,"viewIncrease":-42,"voteCount":0,"voteIncrease":-29}],"success":true}
2021-12-14 21:02:26.022 INFO  com.aspect.LogAspect                              :93   [32m125945494437498880[0;39m ------------- 结束 耗时：194 ms -------------
2021-12-14 21:02:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125945511978078208[0;39m 生成今日电子书快照开始
2021-12-14 21:02:30.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945511978078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:30.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945511978078208[0;39m ==> Parameters: 
2021-12-14 21:02:30.238 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945511978078208[0;39m <==    Updates: 0
2021-12-14 21:02:30.238 INFO  com.job.EbookSnapshotJob                          :35   [32m125945511978078208[0;39m 生成今日电子书快照结束，耗时：228毫秒
2021-12-14 21:02:35.007 INFO  com.job.EbookSnapshotJob                          :32   [32m125945532937015296[0;39m 生成今日电子书快照开始
2021-12-14 21:02:35.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945532937015296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-14 21:02:35.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945532937015296[0;39m ==> Parameters: 
2021-12-14 21:02:35.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125945532937015296[0;39m <==    Updates: 0
2021-12-14 21:02:35.257 INFO  com.job.EbookSnapshotJob                          :35   [32m125945532937015296[0;39m 生成今日电子书快照结束，耗时：250毫秒
2021-12-14 21:02:35.257 INFO  com.job.DocJob                                    :32   [32m125945533985591296[0;39m 更新电子书下的文档数据开始
2021-12-14 21:02:35.257 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945533985591296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-14 21:02:35.257 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945533985591296[0;39m ==> Parameters: 
2021-12-14 21:02:35.408 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125945533985591296[0;39m <==    Updates: 3
2021-12-14 21:02:35.408 INFO  com.job.DocJob                                    :35   [32m125945533985591296[0;39m 更新电子书下的文档数据结束，耗时：151毫秒
