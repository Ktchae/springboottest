2021-12-20 10:36:42.084 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-20 10:36:42.129 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 9232 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-20 10:36:42.129 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-20 10:36:42.352 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-20 10:36:42.352 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-20 10:36:46.755 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-20 10:36:46.755 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-20 10:36:47.341 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 554 ms. Found 0 Redis repository interfaces.
2021-12-20 10:36:48.992 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-20 10:36:49.030 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-20 10:36:49.030 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-20 10:36:49.030 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-20 10:36:49.193 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-20 10:36:49.193 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 6841 ms
2021-12-20 10:36:52.541 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-20 10:36:52.602 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-20 10:36:52.649 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-20 10:36:52.702 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 12.936 seconds (JVM running for 15.773)
2021-12-20 10:36:55.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127962405958455296[0;39m 生成今日电子书快照开始
2021-12-20 10:36:55.085 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m127962405958455296[0;39m HikariPool-1 - Starting...
2021-12-20 10:36:56.094 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m127962405958455296[0;39m HikariPool-1 - Start completed.
2021-12-20 10:36:56.142 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962405958455296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:36:56.157 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962405958455296[0;39m ==> Parameters: 
2021-12-20 10:36:56.295 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962405958455296[0;39m <==    Updates: 6
2021-12-20 10:36:56.295 INFO  com.job.EbookSnapshotJob                          :35   [32m127962405958455296[0;39m 生成今日电子书快照结束，耗时：1288毫秒
2021-12-20 10:37:00.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127962426984501248[0;39m 生成今日电子书快照开始
2021-12-20 10:37:00.120 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962426984501248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:00.120 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962426984501248[0;39m ==> Parameters: 
2021-12-20 10:37:00.305 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962426984501248[0;39m <==    Updates: 0
2021-12-20 10:37:00.305 INFO  com.job.EbookSnapshotJob                          :35   [32m127962426984501248[0;39m 生成今日电子书快照结束，耗时：285毫秒
2021-12-20 10:37:05.015 INFO  com.job.DocJob                                    :32   [32m127962447935049728[0;39m 更新电子书下的文档数据开始
2021-12-20 10:37:05.084 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962447935049728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:37:05.084 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962447935049728[0;39m ==> Parameters: 
2021-12-20 10:37:05.262 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962447935049728[0;39m <==    Updates: 3
2021-12-20 10:37:05.262 INFO  com.job.DocJob                                    :35   [32m127962447935049728[0;39m 更新电子书下的文档数据结束，耗时：247毫秒
2021-12-20 10:37:05.262 INFO  com.job.EbookSnapshotJob                          :32   [32m127962448971042816[0;39m 生成今日电子书快照开始
2021-12-20 10:37:05.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962448971042816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:05.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962448971042816[0;39m ==> Parameters: 
2021-12-20 10:37:05.416 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962448971042816[0;39m <==    Updates: 0
2021-12-20 10:37:05.416 INFO  com.job.EbookSnapshotJob                          :35   [32m127962448971042816[0;39m 生成今日电子书快照结束，耗时：154毫秒
2021-12-20 10:37:10.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127962468860432384[0;39m 生成今日电子书快照开始
2021-12-20 10:37:10.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962468860432384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:10.056 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962468860432384[0;39m ==> Parameters: 
2021-12-20 10:37:10.192 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962468860432384[0;39m <==    Updates: 0
2021-12-20 10:37:10.192 INFO  com.job.EbookSnapshotJob                          :35   [32m127962468860432384[0;39m 生成今日电子书快照结束，耗时：188毫秒
2021-12-20 10:37:15.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127962489886478336[0;39m 生成今日电子书快照开始
2021-12-20 10:37:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962489886478336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962489886478336[0;39m ==> Parameters: 
2021-12-20 10:37:15.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962489886478336[0;39m <==    Updates: 0
2021-12-20 10:37:15.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127962489886478336[0;39m 生成今日电子书快照结束，耗时：199毫秒
2021-12-20 10:37:20.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127962510883164160[0;39m 生成今日电子书快照开始
2021-12-20 10:37:20.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962510883164160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:20.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962510883164160[0;39m ==> Parameters: 
2021-12-20 10:37:20.292 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962510883164160[0;39m <==    Updates: 0
2021-12-20 10:37:20.292 INFO  com.job.EbookSnapshotJob                          :35   [32m127962510883164160[0;39m 生成今日电子书快照结束，耗时：269毫秒
2021-12-20 10:37:25.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127962531783380992[0;39m 生成今日电子书快照开始
2021-12-20 10:37:25.057 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962531783380992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:25.057 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962531783380992[0;39m ==> Parameters: 
2021-12-20 10:37:25.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962531783380992[0;39m <==    Updates: 0
2021-12-20 10:37:25.241 INFO  com.job.EbookSnapshotJob                          :35   [32m127962531783380992[0;39m 生成今日电子书快照结束，耗时：235毫秒
2021-12-20 10:37:30.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127962552750706688[0;39m 生成今日电子书快照开始
2021-12-20 10:37:30.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962552750706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:30.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962552750706688[0;39m ==> Parameters: 
2021-12-20 10:37:30.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962552750706688[0;39m <==    Updates: 0
2021-12-20 10:37:30.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127962552750706688[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 10:37:35.022 INFO  com.job.DocJob                                    :32   [32m127962573793529856[0;39m 更新电子书下的文档数据开始
2021-12-20 10:37:35.106 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962573793529856[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:37:35.122 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962573793529856[0;39m ==> Parameters: 
2021-12-20 10:37:35.323 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962573793529856[0;39m <==    Updates: 3
2021-12-20 10:37:35.323 INFO  com.job.DocJob                                    :35   [32m127962573793529856[0;39m 更新电子书下的文档数据结束，耗时：301毫秒
2021-12-20 10:37:35.323 INFO  com.job.EbookSnapshotJob                          :32   [32m127962575056015360[0;39m 生成今日电子书快照开始
2021-12-20 10:37:35.338 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962575056015360[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:35.338 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962575056015360[0;39m ==> Parameters: 
2021-12-20 10:37:35.555 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962575056015360[0;39m <==    Updates: 0
2021-12-20 10:37:35.555 INFO  com.job.EbookSnapshotJob                          :35   [32m127962575056015360[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 10:37:40.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127962594693746688[0;39m 生成今日电子书快照开始
2021-12-20 10:37:40.371 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962594693746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:40.371 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962594693746688[0;39m ==> Parameters: 
2021-12-20 10:37:40.873 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962594693746688[0;39m <==    Updates: 0
2021-12-20 10:37:40.873 INFO  com.job.EbookSnapshotJob                          :35   [32m127962594693746688[0;39m 生成今日电子书快照结束，耗时：868毫秒
2021-12-20 10:37:45.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127962615703015424[0;39m 生成今日电子书快照开始
2021-12-20 10:37:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962615703015424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962615703015424[0;39m ==> Parameters: 
2021-12-20 10:37:45.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962615703015424[0;39m <==    Updates: 0
2021-12-20 10:37:45.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127962615703015424[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:37:50.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127962636708089856[0;39m 生成今日电子书快照开始
2021-12-20 10:37:50.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962636708089856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:50.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962636708089856[0;39m ==> Parameters: 
2021-12-20 10:37:50.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962636708089856[0;39m <==    Updates: 0
2021-12-20 10:37:50.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127962636708089856[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-20 10:37:55.029 INFO  com.job.EbookSnapshotJob                          :32   [32m127962657708969984[0;39m 生成今日电子书快照开始
2021-12-20 10:37:55.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962657708969984[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:37:55.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962657708969984[0;39m ==> Parameters: 
2021-12-20 10:37:55.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962657708969984[0;39m <==    Updates: 0
2021-12-20 10:37:55.229 INFO  com.job.EbookSnapshotJob                          :35   [32m127962657708969984[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 10:38:00.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127962678672101376[0;39m 生成今日电子书快照开始
2021-12-20 10:38:00.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962678672101376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:00.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962678672101376[0;39m ==> Parameters: 
2021-12-20 10:38:00.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962678672101376[0;39m <==    Updates: 0
2021-12-20 10:38:00.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127962678672101376[0;39m 生成今日电子书快照结束，耗时：226毫秒
2021-12-20 10:38:05.026 INFO  com.job.EbookSnapshotJob                          :32   [32m127962699639427072[0;39m 生成今日电子书快照开始
2021-12-20 10:38:05.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962699639427072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:05.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962699639427072[0;39m ==> Parameters: 
2021-12-20 10:38:05.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962699639427072[0;39m <==    Updates: 0
2021-12-20 10:38:05.243 INFO  com.job.EbookSnapshotJob                          :35   [32m127962699639427072[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 10:38:05.243 INFO  com.job.DocJob                                    :32   [32m127962700549591040[0;39m 更新电子书下的文档数据开始
2021-12-20 10:38:05.243 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962700549591040[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:38:05.243 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962700549591040[0;39m ==> Parameters: 
2021-12-20 10:38:05.400 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962700549591040[0;39m <==    Updates: 3
2021-12-20 10:38:05.400 INFO  com.job.DocJob                                    :35   [32m127962700549591040[0;39m 更新电子书下的文档数据结束，耗时：157毫秒
2021-12-20 10:38:10.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127962720522866688[0;39m 生成今日电子书快照开始
2021-12-20 10:38:10.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962720522866688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:10.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962720522866688[0;39m ==> Parameters: 
2021-12-20 10:38:10.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962720522866688[0;39m <==    Updates: 0
2021-12-20 10:38:10.227 INFO  com.job.EbookSnapshotJob                          :35   [32m127962720522866688[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-20 10:38:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127962741548912640[0;39m 生成今日电子书快照开始
2021-12-20 10:38:15.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962741548912640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:15.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962741548912640[0;39m ==> Parameters: 
2021-12-20 10:38:15.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962741548912640[0;39m <==    Updates: 0
2021-12-20 10:38:15.219 INFO  com.job.EbookSnapshotJob                          :35   [32m127962741548912640[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:38:20.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127962762516238336[0;39m 生成今日电子书快照开始
2021-12-20 10:38:20.149 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962762516238336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:20.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962762516238336[0;39m ==> Parameters: 
2021-12-20 10:38:20.303 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962762516238336[0;39m <==    Updates: 0
2021-12-20 10:38:20.303 INFO  com.job.EbookSnapshotJob                          :35   [32m127962762516238336[0;39m 生成今日电子书快照结束，耗时：286毫秒
2021-12-20 10:38:25.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127962783483564032[0;39m 生成今日电子书快照开始
2021-12-20 10:38:25.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962783483564032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:25.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962783483564032[0;39m ==> Parameters: 
2021-12-20 10:38:25.285 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962783483564032[0;39m <==    Updates: 0
2021-12-20 10:38:25.285 INFO  com.job.EbookSnapshotJob                          :35   [32m127962783483564032[0;39m 生成今日电子书快照结束，耗时：269毫秒
2021-12-20 10:38:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127962804450889728[0;39m 生成今日电子书快照开始
2021-12-20 10:38:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962804450889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962804450889728[0;39m ==> Parameters: 
2021-12-20 10:38:30.300 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962804450889728[0;39m <==    Updates: 0
2021-12-20 10:38:30.300 INFO  com.job.EbookSnapshotJob                          :35   [32m127962804450889728[0;39m 生成今日电子书快照结束，耗时：285毫秒
2021-12-20 10:38:35.010 INFO  com.job.DocJob                                    :32   [32m127962825401438208[0;39m 更新电子书下的文档数据开始
2021-12-20 10:38:35.088 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962825401438208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:38:35.090 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962825401438208[0;39m ==> Parameters: 
2021-12-20 10:38:35.320 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962825401438208[0;39m <==    Updates: 3
2021-12-20 10:38:35.321 INFO  com.job.DocJob                                    :35   [32m127962825401438208[0;39m 更新电子书下的文档数据结束，耗时：310毫秒
2021-12-20 10:38:35.322 INFO  com.job.EbookSnapshotJob                          :32   [32m127962826710061056[0;39m 生成今日电子书快照开始
2021-12-20 10:38:35.322 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962826710061056[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:35.323 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962826710061056[0;39m ==> Parameters: 
2021-12-20 10:38:35.463 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962826710061056[0;39m <==    Updates: 0
2021-12-20 10:38:35.464 INFO  com.job.EbookSnapshotJob                          :35   [32m127962826710061056[0;39m 生成今日电子书快照结束，耗时：142毫秒
2021-12-20 10:38:36.472 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-20 10:38:36.472 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-20 10:38:36.473 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-20 10:38:36.621 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：y5qCHXbtha，session id：0，当前连接数：1
2021-12-20 10:38:36.752 INFO  com.aspect.LogAspect                              :54   [32m127962832691138561[0;39m ------------- 开始 -------------
2021-12-20 10:38:36.752 INFO  com.aspect.LogAspect                              :54   [32m127962832691138562[0;39m ------------- 开始 -------------
2021-12-20 10:38:36.752 INFO  com.aspect.LogAspect                              :54   [32m127962832691138560[0;39m ------------- 开始 -------------
2021-12-20 10:38:36.754 INFO  com.aspect.LogAspect                              :55   [32m127962832691138560[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:38:36.754 INFO  com.aspect.LogAspect                              :55   [32m127962832691138562[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:38:36.754 INFO  com.aspect.LogAspect                              :55   [32m127962832691138561[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:38:36.755 INFO  com.aspect.LogAspect                              :56   [32m127962832691138562[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:38:36.755 INFO  com.aspect.LogAspect                              :56   [32m127962832691138561[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:38:36.755 INFO  com.aspect.LogAspect                              :56   [32m127962832691138560[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:38:36.756 INFO  com.aspect.LogAspect                              :57   [32m127962832691138562[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:38:36.756 INFO  com.aspect.LogAspect                              :57   [32m127962832691138561[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:38:36.756 INFO  com.aspect.LogAspect                              :57   [32m127962832691138560[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:38:36.791 INFO  com.aspect.LogAspect                              :80   [32m127962832691138560[0;39m 请求参数: []
2021-12-20 10:38:36.791 INFO  com.aspect.LogAspect                              :80   [32m127962832691138562[0;39m 请求参数: []
2021-12-20 10:38:36.791 INFO  com.aspect.LogAspect                              :80   [32m127962832691138561[0;39m 请求参数: []
2021-12-20 10:38:36.879 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127962832691138562[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:38:36.880 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127962832691138562[0;39m ==> Parameters: 
2021-12-20 10:38:36.923 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127962832691138560[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:38:36.923 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127962832691138561[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:38:36.924 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127962832691138560[0;39m ==> Parameters: 
2021-12-20 10:38:36.925 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127962832691138561[0;39m ==> Parameters: 
2021-12-20 10:38:37.007 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127962832691138562[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:38:37.008 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127962832691138562[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:38:37.011 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127962832691138561[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:38:37.012 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127962832691138561[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:38:37.012 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:38:37.012 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:38:37.047 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:38:37.048 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:38:37.049 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127962832691138562[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:38:37.049 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127962832691138561[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:38:37.050 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127962832691138562[0;39m <==      Total: 2
2021-12-20 10:38:37.050 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127962832691138561[0;39m <==      Total: 2
2021-12-20 10:38:37.051 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:38:37.051 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:38:37.052 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:38:37.053 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:38:37.053 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:38:37.054 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:38:37.055 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:38:37.055 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:38:37.056 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:38:37.056 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:38:37.058 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:38:37.058 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:38:37.059 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:38:37.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:38:37.062 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:38:37.063 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127962832691138560[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:38:37.063 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127962832691138560[0;39m <==      Total: 19
2021-12-20 10:38:37.082 INFO  com.aspect.LogAspect                              :92   [32m127962832691138562[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:38:37.082 INFO  com.aspect.LogAspect                              :93   [32m127962832691138562[0;39m ------------- 结束 耗时：334 ms -------------
2021-12-20 10:38:37.083 INFO  com.aspect.LogAspect                              :92   [32m127962832691138560[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:38:37.083 INFO  com.aspect.LogAspect                              :92   [32m127962832691138561[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:38:37.083 INFO  com.aspect.LogAspect                              :93   [32m127962832691138560[0;39m ------------- 结束 耗时：335 ms -------------
2021-12-20 10:38:37.083 INFO  com.aspect.LogAspect                              :93   [32m127962832691138561[0;39m ------------- 结束 耗时：335 ms -------------
2021-12-20 10:38:40.001 INFO  com.job.EbookSnapshotJob                          :32   [32m127962846335209472[0;39m 生成今日电子书快照开始
2021-12-20 10:38:40.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962846335209472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:40.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962846335209472[0;39m ==> Parameters: 
2021-12-20 10:38:40.220 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962846335209472[0;39m <==    Updates: 0
2021-12-20 10:38:40.221 INFO  com.job.EbookSnapshotJob                          :35   [32m127962846335209472[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-20 10:38:45.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127962867369644032[0;39m 生成今日电子书快照开始
2021-12-20 10:38:45.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962867369644032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:45.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962867369644032[0;39m ==> Parameters: 
2021-12-20 10:38:45.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962867369644032[0;39m <==    Updates: 0
2021-12-20 10:38:45.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127962867369644032[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 10:38:50.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127962888378912768[0;39m 生成今日电子书快照开始
2021-12-20 10:38:50.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962888378912768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:50.107 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962888378912768[0;39m ==> Parameters: 
2021-12-20 10:38:50.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962888378912768[0;39m <==    Updates: 0
2021-12-20 10:38:50.266 INFO  com.job.EbookSnapshotJob                          :35   [32m127962888378912768[0;39m 生成今日电子书快照结束，耗时：241毫秒
2021-12-20 10:38:55.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127962909258158080[0;39m 生成今日电子书快照开始
2021-12-20 10:38:55.420 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962909258158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:38:55.436 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962909258158080[0;39m ==> Parameters: 
2021-12-20 10:38:55.822 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962909258158080[0;39m <==    Updates: 0
2021-12-20 10:38:55.822 INFO  com.job.EbookSnapshotJob                          :35   [32m127962909258158080[0;39m 生成今日电子书快照结束，耗时：819毫秒
2021-12-20 10:39:00.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127962930288398336[0;39m 生成今日电子书快照开始
2021-12-20 10:39:00.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962930288398336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:00.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962930288398336[0;39m ==> Parameters: 
2021-12-20 10:39:00.921 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962930288398336[0;39m <==    Updates: 0
2021-12-20 10:39:00.921 INFO  com.job.EbookSnapshotJob                          :35   [32m127962930288398336[0;39m 生成今日电子书快照结束，耗时：904毫秒
2021-12-20 10:39:05.018 INFO  com.job.DocJob                                    :32   [32m127962951264112640[0;39m 更新电子书下的文档数据开始
2021-12-20 10:39:05.180 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962951264112640[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:39:05.180 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962951264112640[0;39m ==> Parameters: 
2021-12-20 10:39:05.840 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127962951264112640[0;39m <==    Updates: 3
2021-12-20 10:39:05.840 INFO  com.job.DocJob                                    :35   [32m127962951264112640[0;39m 更新电子书下的文档数据结束，耗时：822毫秒
2021-12-20 10:39:05.840 INFO  com.job.EbookSnapshotJob                          :32   [32m127962954711830528[0;39m 生成今日电子书快照开始
2021-12-20 10:39:06.172 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962954711830528[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:06.172 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962954711830528[0;39m ==> Parameters: 
2021-12-20 10:39:07.323 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962954711830528[0;39m <==    Updates: 0
2021-12-20 10:39:07.323 INFO  com.job.EbookSnapshotJob                          :35   [32m127962954711830528[0;39m 生成今日电子书快照结束，耗时：1483毫秒
2021-12-20 10:39:10.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127962972202078208[0;39m 生成今日电子书快照开始
2021-12-20 10:39:10.195 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962972202078208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:10.195 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962972202078208[0;39m ==> Parameters: 
2021-12-20 10:39:11.703 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962972202078208[0;39m <==    Updates: 0
2021-12-20 10:39:11.703 INFO  com.job.EbookSnapshotJob                          :35   [32m127962972202078208[0;39m 生成今日电子书快照结束，耗时：1693毫秒
2021-12-20 10:39:15.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127962993202958336[0;39m 生成今日电子书快照开始
2021-12-20 10:39:15.193 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962993202958336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:15.193 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962993202958336[0;39m ==> Parameters: 
2021-12-20 10:39:36.525 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127962993202958336[0;39m <==    Updates: 0
2021-12-20 10:39:36.525 INFO  com.job.EbookSnapshotJob                          :35   [32m127962993202958336[0;39m 生成今日电子书快照结束，耗时：21508毫秒
2021-12-20 10:39:36.525 INFO  com.job.DocJob                                    :32   [32m127963083414048768[0;39m 更新电子书下的文档数据开始
2021-12-20 10:39:41.021 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963083414048768[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:39:41.021 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963083414048768[0;39m ==> Parameters: 
2021-12-20 10:39:41.206 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963083414048768[0;39m <==    Updates: 3
2021-12-20 10:39:41.206 INFO  com.job.DocJob                                    :35   [32m127963083414048768[0;39m 更新电子书下的文档数据结束，耗时：4681毫秒
2021-12-20 10:39:41.206 INFO  com.job.EbookSnapshotJob                          :32   [32m127963103047585792[0;39m 生成今日电子书快照开始
2021-12-20 10:39:41.206 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963103047585792[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:41.206 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963103047585792[0;39m ==> Parameters: 
2021-12-20 10:39:41.373 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963103047585792[0;39m <==    Updates: 0
2021-12-20 10:39:41.388 INFO  com.job.EbookSnapshotJob                          :35   [32m127963103047585792[0;39m 生成今日电子书快照结束，耗时：182毫秒
2021-12-20 10:39:45.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127963119006912512[0;39m 生成今日电子书快照开始
2021-12-20 10:39:45.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963119006912512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:45.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963119006912512[0;39m ==> Parameters: 
2021-12-20 10:39:45.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963119006912512[0;39m <==    Updates: 0
2021-12-20 10:39:45.217 INFO  com.job.EbookSnapshotJob                          :35   [32m127963119006912512[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-20 10:39:50.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127963139982626816[0;39m 生成今日电子书快照开始
2021-12-20 10:39:50.060 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963139982626816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:50.060 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963139982626816[0;39m ==> Parameters: 
2021-12-20 10:39:50.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963139982626816[0;39m <==    Updates: 0
2021-12-20 10:39:50.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127963139982626816[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:39:53.660 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：y5qCHXbtha，session id：0！当前连接数：0
2021-12-20 10:39:55.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127963160924786688[0;39m 生成今日电子书快照开始
2021-12-20 10:39:55.135 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963160924786688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:39:55.139 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963160924786688[0;39m ==> Parameters: 
2021-12-20 10:39:55.392 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963160924786688[0;39m <==    Updates: 0
2021-12-20 10:39:55.392 INFO  com.job.EbookSnapshotJob                          :35   [32m127963160924786688[0;39m 生成今日电子书快照结束，耗时：387毫秒
2021-12-20 10:40:00.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127963181896306688[0;39m 生成今日电子书快照开始
2021-12-20 10:40:00.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963181896306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:00.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963181896306688[0;39m ==> Parameters: 
2021-12-20 10:40:00.205 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963181896306688[0;39m <==    Updates: 0
2021-12-20 10:40:00.205 INFO  com.job.EbookSnapshotJob                          :35   [32m127963181896306688[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 10:40:05.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127963202855243776[0;39m 生成今日电子书快照开始
2021-12-20 10:40:05.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963202855243776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:05.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963202855243776[0;39m ==> Parameters: 
2021-12-20 10:40:05.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963202855243776[0;39m <==    Updates: 0
2021-12-20 10:40:05.217 INFO  com.job.EbookSnapshotJob                          :35   [32m127963202855243776[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-20 10:40:05.217 INFO  com.job.DocJob                                    :32   [32m127963203757019136[0;39m 更新电子书下的文档数据开始
2021-12-20 10:40:05.217 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963203757019136[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:40:05.217 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963203757019136[0;39m ==> Parameters: 
2021-12-20 10:40:05.402 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963203757019136[0;39m <==    Updates: 3
2021-12-20 10:40:05.402 INFO  com.job.DocJob                                    :35   [32m127963203757019136[0;39m 更新电子书下的文档数据结束，耗时：185毫秒
2021-12-20 10:40:10.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127963223835152384[0;39m 生成今日电子书快照开始
2021-12-20 10:40:10.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963223835152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:10.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963223835152384[0;39m ==> Parameters: 
2021-12-20 10:40:10.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963223835152384[0;39m <==    Updates: 0
2021-12-20 10:40:10.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127963223835152384[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:40:15.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127963244861198336[0;39m 生成今日电子书快照开始
2021-12-20 10:40:15.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963244861198336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:15.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963244861198336[0;39m ==> Parameters: 
2021-12-20 10:40:15.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963244861198336[0;39m <==    Updates: 0
2021-12-20 10:40:15.264 INFO  com.job.EbookSnapshotJob                          :35   [32m127963244861198336[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:40:20.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127963265799163904[0;39m 生成今日电子书快照开始
2021-12-20 10:40:20.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963265799163904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:20.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963265799163904[0;39m ==> Parameters: 
2021-12-20 10:40:20.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963265799163904[0;39m <==    Updates: 0
2021-12-20 10:40:20.263 INFO  com.job.EbookSnapshotJob                          :35   [32m127963265799163904[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 10:40:25.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127963286816821248[0;39m 生成今日电子书快照开始
2021-12-20 10:40:25.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963286816821248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:25.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963286816821248[0;39m ==> Parameters: 
2021-12-20 10:40:25.259 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963286816821248[0;39m <==    Updates: 0
2021-12-20 10:40:25.259 INFO  com.job.EbookSnapshotJob                          :35   [32m127963286816821248[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:40:30.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963307779952640[0;39m 生成今日电子书快照开始
2021-12-20 10:40:30.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963307779952640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:30.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963307779952640[0;39m ==> Parameters: 
2021-12-20 10:40:30.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963307779952640[0;39m <==    Updates: 0
2021-12-20 10:40:30.233 INFO  com.job.EbookSnapshotJob                          :35   [32m127963307779952640[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-20 10:40:35.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127963328747278336[0;39m 生成今日电子书快照开始
2021-12-20 10:40:35.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963328747278336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:35.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963328747278336[0;39m ==> Parameters: 
2021-12-20 10:40:35.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963328747278336[0;39m <==    Updates: 0
2021-12-20 10:40:35.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127963328747278336[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:40:35.255 INFO  com.job.DocJob                                    :32   [32m127963329745522688[0;39m 更新电子书下的文档数据开始
2021-12-20 10:40:35.255 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963329745522688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:40:35.255 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963329745522688[0;39m ==> Parameters: 
2021-12-20 10:40:35.441 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963329745522688[0;39m <==    Updates: 3
2021-12-20 10:40:35.441 INFO  com.job.DocJob                                    :35   [32m127963329745522688[0;39m 更新电子书下的文档数据结束，耗时：186毫秒
2021-12-20 10:40:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127963349710409728[0;39m 生成今日电子书快照开始
2021-12-20 10:40:40.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963349710409728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:40.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963349710409728[0;39m ==> Parameters: 
2021-12-20 10:40:40.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963349710409728[0;39m <==    Updates: 0
2021-12-20 10:40:40.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127963349710409728[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:40:45.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127963370723872768[0;39m 生成今日电子书快照开始
2021-12-20 10:40:45.114 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963370723872768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:45.114 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963370723872768[0;39m ==> Parameters: 
2021-12-20 10:40:45.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963370723872768[0;39m <==    Updates: 0
2021-12-20 10:40:45.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127963370723872768[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:40:50.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963391666032640[0;39m 生成今日电子书快照开始
2021-12-20 10:40:50.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963391666032640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:50.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963391666032640[0;39m ==> Parameters: 
2021-12-20 10:40:50.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963391666032640[0;39m <==    Updates: 0
2021-12-20 10:40:50.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127963391666032640[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:40:55.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127963412641746944[0;39m 生成今日电子书快照开始
2021-12-20 10:40:55.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963412641746944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:40:55.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963412641746944[0;39m ==> Parameters: 
2021-12-20 10:40:55.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963412641746944[0;39m <==    Updates: 0
2021-12-20 10:40:55.219 INFO  com.job.EbookSnapshotJob                          :35   [32m127963412641746944[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 10:41:00.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963433609072640[0;39m 生成今日电子书快照开始
2021-12-20 10:41:00.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963433609072640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:00.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963433609072640[0;39m ==> Parameters: 
2021-12-20 10:41:00.203 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963433609072640[0;39m <==    Updates: 0
2021-12-20 10:41:00.203 INFO  com.job.EbookSnapshotJob                          :35   [32m127963433609072640[0;39m 生成今日电子书快照结束，耗时：185毫秒
2021-12-20 10:41:05.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127963454568009728[0;39m 生成今日电子书快照开始
2021-12-20 10:41:05.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963454568009728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:05.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963454568009728[0;39m ==> Parameters: 
2021-12-20 10:41:05.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963454568009728[0;39m <==    Updates: 0
2021-12-20 10:41:05.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127963454568009728[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:41:05.216 INFO  com.job.DocJob                                    :32   [32m127963455411064832[0;39m 更新电子书下的文档数据开始
2021-12-20 10:41:05.231 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963455411064832[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:41:05.231 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963455411064832[0;39m ==> Parameters: 
2021-12-20 10:41:05.379 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963455411064832[0;39m <==    Updates: 3
2021-12-20 10:41:05.379 INFO  com.job.DocJob                                    :35   [32m127963455411064832[0;39m 更新电子书下的文档数据结束，耗时：163毫秒
2021-12-20 10:41:10.030 INFO  com.job.EbookSnapshotJob                          :32   [32m127963475602444288[0;39m 生成今日电子书快照开始
2021-12-20 10:41:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963475602444288[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963475602444288[0;39m ==> Parameters: 
2021-12-20 10:41:10.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963475602444288[0;39m <==    Updates: 0
2021-12-20 10:41:10.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127963475602444288[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 10:41:15.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127963496561381376[0;39m 生成今日电子书快照开始
2021-12-20 10:41:15.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963496561381376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:15.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963496561381376[0;39m ==> Parameters: 
2021-12-20 10:41:15.228 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963496561381376[0;39m <==    Updates: 0
2021-12-20 10:41:15.228 INFO  com.job.EbookSnapshotJob                          :35   [32m127963496561381376[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:41:20.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127963517503541248[0;39m 生成今日电子书快照开始
2021-12-20 10:41:20.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963517503541248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:20.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963517503541248[0;39m ==> Parameters: 
2021-12-20 10:41:20.338 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963517503541248[0;39m <==    Updates: 0
2021-12-20 10:41:20.338 INFO  com.job.EbookSnapshotJob                          :35   [32m127963517503541248[0;39m 生成今日电子书快照结束，耗时：318毫秒
2021-12-20 10:41:25.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127963538449895424[0;39m 生成今日电子书快照开始
2021-12-20 10:41:25.114 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963538449895424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:25.114 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963538449895424[0;39m ==> Parameters: 
2021-12-20 10:41:25.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963538449895424[0;39m <==    Updates: 0
2021-12-20 10:41:25.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127963538449895424[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:41:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127963559421415424[0;39m 生成今日电子书快照开始
2021-12-20 10:41:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963559421415424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963559421415424[0;39m ==> Parameters: 
2021-12-20 10:41:30.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963559421415424[0;39m <==    Updates: 0
2021-12-20 10:41:30.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127963559421415424[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 10:41:35.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127963580342603776[0;39m 生成今日电子书快照开始
2021-12-20 10:41:35.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963580342603776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:35.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963580342603776[0;39m ==> Parameters: 
2021-12-20 10:41:35.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963580342603776[0;39m <==    Updates: 0
2021-12-20 10:41:35.234 INFO  com.job.EbookSnapshotJob                          :35   [32m127963580342603776[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:41:35.234 INFO  com.job.DocJob                                    :32   [32m127963581315682304[0;39m 更新电子书下的文档数据开始
2021-12-20 10:41:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963581315682304[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:41:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963581315682304[0;39m ==> Parameters: 
2021-12-20 10:41:35.419 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963581315682304[0;39m <==    Updates: 3
2021-12-20 10:41:35.419 INFO  com.job.DocJob                                    :35   [32m127963581315682304[0;39m 更新电子书下的文档数据结束，耗时：185毫秒
2021-12-20 10:41:40.114 INFO  com.job.EbookSnapshotJob                          :32   [32m127963601783885824[0;39m 生成今日电子书快照开始
2021-12-20 10:41:40.177 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963601783885824[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:40.192 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963601783885824[0;39m ==> Parameters: 
2021-12-20 10:41:40.342 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963601783885824[0;39m <==    Updates: 0
2021-12-20 10:41:40.342 INFO  com.job.EbookSnapshotJob                          :35   [32m127963601783885824[0;39m 生成今日电子书快照结束，耗时：228毫秒
2021-12-20 10:41:45.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127963622302420992[0;39m 生成今日电子书快照开始
2021-12-20 10:41:45.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963622302420992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:45.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963622302420992[0;39m ==> Parameters: 
2021-12-20 10:41:45.260 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963622302420992[0;39m <==    Updates: 0
2021-12-20 10:41:45.260 INFO  com.job.EbookSnapshotJob                          :35   [32m127963622302420992[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 10:41:50.024 INFO  com.job.EbookSnapshotJob                          :32   [32m127963643349438464[0;39m 生成今日电子书快照开始
2021-12-20 10:41:50.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963643349438464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:50.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963643349438464[0;39m ==> Parameters: 
2021-12-20 10:41:50.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963643349438464[0;39m <==    Updates: 0
2021-12-20 10:41:50.266 INFO  com.job.EbookSnapshotJob                          :35   [32m127963643349438464[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 10:41:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127963664237072384[0;39m 生成今日电子书快照开始
2021-12-20 10:41:55.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963664237072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:41:55.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963664237072384[0;39m ==> Parameters: 
2021-12-20 10:41:55.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963664237072384[0;39m <==    Updates: 0
2021-12-20 10:41:55.272 INFO  com.job.EbookSnapshotJob                          :35   [32m127963664237072384[0;39m 生成今日电子书快照结束，耗时：268毫秒
2021-12-20 10:42:00.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127963685254729728[0;39m 生成今日电子书快照开始
2021-12-20 10:42:00.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963685254729728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:00.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963685254729728[0;39m ==> Parameters: 
2021-12-20 10:42:00.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963685254729728[0;39m <==    Updates: 0
2021-12-20 10:42:00.241 INFO  com.job.EbookSnapshotJob                          :35   [32m127963685254729728[0;39m 生成今日电子书快照结束，耗时：226毫秒
2021-12-20 10:42:05.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127963706205278208[0;39m 生成今日电子书快照开始
2021-12-20 10:42:05.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963706205278208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:05.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963706205278208[0;39m ==> Parameters: 
2021-12-20 10:42:05.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963706205278208[0;39m <==    Updates: 0
2021-12-20 10:42:05.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127963706205278208[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-20 10:42:05.247 INFO  com.job.DocJob                                    :32   [32m127963707199328256[0;39m 更新电子书下的文档数据开始
2021-12-20 10:42:05.247 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963707199328256[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:42:05.247 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963707199328256[0;39m ==> Parameters: 
2021-12-20 10:42:05.510 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963707199328256[0;39m <==    Updates: 3
2021-12-20 10:42:05.510 INFO  com.job.DocJob                                    :35   [32m127963707199328256[0;39m 更新电子书下的文档数据结束，耗时：263毫秒
2021-12-20 10:42:10.021 INFO  com.job.EbookSnapshotJob                          :32   [32m127963727222935552[0;39m 生成今日电子书快照开始
2021-12-20 10:42:10.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963727222935552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:10.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963727222935552[0;39m ==> Parameters: 
2021-12-20 10:42:10.259 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963727222935552[0;39m <==    Updates: 0
2021-12-20 10:42:10.259 INFO  com.job.EbookSnapshotJob                          :35   [32m127963727222935552[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:42:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963748181872640[0;39m 生成今日电子书快照开始
2021-12-20 10:42:15.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963748181872640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:15.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963748181872640[0;39m ==> Parameters: 
2021-12-20 10:42:15.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963748181872640[0;39m <==    Updates: 0
2021-12-20 10:42:15.266 INFO  com.job.EbookSnapshotJob                          :35   [32m127963748181872640[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 10:42:20.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127963769145004032[0;39m 生成今日电子书快照开始
2021-12-20 10:42:20.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963769145004032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:20.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963769145004032[0;39m ==> Parameters: 
2021-12-20 10:42:20.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963769145004032[0;39m <==    Updates: 0
2021-12-20 10:42:20.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127963769145004032[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:42:25.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127963790099746816[0;39m 生成今日电子书快照开始
2021-12-20 10:42:25.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963790099746816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:25.112 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963790099746816[0;39m ==> Parameters: 
2021-12-20 10:42:25.259 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963790099746816[0;39m <==    Updates: 0
2021-12-20 10:42:25.259 INFO  com.job.EbookSnapshotJob                          :35   [32m127963790099746816[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:42:30.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127963811092238336[0;39m 生成今日电子书快照开始
2021-12-20 10:42:30.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963811092238336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:30.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963811092238336[0;39m ==> Parameters: 
2021-12-20 10:42:30.225 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963811092238336[0;39m <==    Updates: 0
2021-12-20 10:42:30.225 INFO  com.job.EbookSnapshotJob                          :35   [32m127963811092238336[0;39m 生成今日电子书快照结束，耗时：208毫秒
2021-12-20 10:42:35.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963832067952640[0;39m 生成今日电子书快照开始
2021-12-20 10:42:35.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963832067952640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:35.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963832067952640[0;39m ==> Parameters: 
2021-12-20 10:42:35.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963832067952640[0;39m <==    Updates: 0
2021-12-20 10:42:35.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127963832067952640[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-20 10:42:35.240 INFO  com.job.DocJob                                    :32   [32m127963832999088128[0;39m 更新电子书下的文档数据开始
2021-12-20 10:42:35.240 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963832999088128[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:42:35.240 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963832999088128[0;39m ==> Parameters: 
2021-12-20 10:42:35.419 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963832999088128[0;39m <==    Updates: 3
2021-12-20 10:42:35.419 INFO  com.job.DocJob                                    :35   [32m127963832999088128[0;39m 更新电子书下的文档数据结束，耗时：179毫秒
2021-12-20 10:42:40.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127963853043666944[0;39m 生成今日电子书快照开始
2021-12-20 10:42:40.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963853043666944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:40.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963853043666944[0;39m ==> Parameters: 
2021-12-20 10:42:40.220 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963853043666944[0;39m <==    Updates: 0
2021-12-20 10:42:40.220 INFO  com.job.EbookSnapshotJob                          :35   [32m127963853043666944[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:42:45.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127963874019381248[0;39m 生成今日电子书快照开始
2021-12-20 10:42:45.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963874019381248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:45.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963874019381248[0;39m ==> Parameters: 
2021-12-20 10:42:45.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963874019381248[0;39m <==    Updates: 0
2021-12-20 10:42:45.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127963874019381248[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-20 10:42:50.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127963894974124032[0;39m 生成今日电子书快照开始
2021-12-20 10:42:50.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963894974124032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:50.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963894974124032[0;39m ==> Parameters: 
2021-12-20 10:42:50.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963894974124032[0;39m <==    Updates: 0
2021-12-20 10:42:50.217 INFO  com.job.EbookSnapshotJob                          :35   [32m127963894974124032[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:42:55.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127963915937255424[0;39m 生成今日电子书快照开始
2021-12-20 10:42:55.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963915937255424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:42:55.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963915937255424[0;39m ==> Parameters: 
2021-12-20 10:42:55.277 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963915937255424[0;39m <==    Updates: 0
2021-12-20 10:42:55.277 INFO  com.job.EbookSnapshotJob                          :35   [32m127963915937255424[0;39m 生成今日电子书快照结束，耗时：263毫秒
2021-12-20 10:43:00.026 INFO  com.job.EbookSnapshotJob                          :32   [32m127963936959107072[0;39m 生成今日电子书快照开始
2021-12-20 10:43:00.111 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963936959107072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:00.111 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963936959107072[0;39m ==> Parameters: 
2021-12-20 10:43:00.274 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963936959107072[0;39m <==    Updates: 0
2021-12-20 10:43:00.274 INFO  com.job.EbookSnapshotJob                          :35   [32m127963936959107072[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 10:43:05.020 INFO  com.job.DocJob                                    :32   [32m127963957905461248[0;39m 更新电子书下的文档数据开始
2021-12-20 10:43:05.095 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963957905461248[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:43:05.095 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963957905461248[0;39m ==> Parameters: 
2021-12-20 10:43:05.258 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127963957905461248[0;39m <==    Updates: 3
2021-12-20 10:43:05.258 INFO  com.job.DocJob                                    :35   [32m127963957905461248[0;39m 更新电子书下的文档数据结束，耗时：238毫秒
2021-12-20 10:43:05.258 INFO  com.job.EbookSnapshotJob                          :32   [32m127963958903705600[0;39m 生成今日电子书快照开始
2021-12-20 10:43:05.258 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963958903705600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:05.258 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963958903705600[0;39m ==> Parameters: 
2021-12-20 10:43:05.420 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963958903705600[0;39m <==    Updates: 0
2021-12-20 10:43:05.427 INFO  com.job.EbookSnapshotJob                          :35   [32m127963958903705600[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-20 10:43:10.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127963978805678080[0;39m 生成今日电子书快照开始
2021-12-20 10:43:10.057 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963978805678080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:10.057 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963978805678080[0;39m ==> Parameters: 
2021-12-20 10:43:10.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963978805678080[0;39m <==    Updates: 0
2021-12-20 10:43:10.227 INFO  com.job.EbookSnapshotJob                          :35   [32m127963978805678080[0;39m 生成今日电子书快照结束，耗时：224毫秒
2021-12-20 10:43:15.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127963999840112640[0;39m 生成今日电子书快照开始
2021-12-20 10:43:15.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963999840112640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:15.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963999840112640[0;39m ==> Parameters: 
2021-12-20 10:43:15.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127963999840112640[0;39m <==    Updates: 0
2021-12-20 10:43:15.272 INFO  com.job.EbookSnapshotJob                          :35   [32m127963999840112640[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 10:43:20.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127964020799049728[0;39m 生成今日电子书快照开始
2021-12-20 10:43:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964020799049728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964020799049728[0;39m ==> Parameters: 
2021-12-20 10:43:20.330 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964020799049728[0;39m <==    Updates: 0
2021-12-20 10:43:20.346 INFO  com.job.EbookSnapshotJob                          :35   [32m127964020799049728[0;39m 生成今日电子书快照结束，耗时：331毫秒
2021-12-20 10:43:25.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127964041749598208[0;39m 生成今日电子书快照开始
2021-12-20 10:43:25.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964041749598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:25.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964041749598208[0;39m ==> Parameters: 
2021-12-20 10:43:25.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964041749598208[0;39m <==    Updates: 0
2021-12-20 10:43:25.232 INFO  com.job.EbookSnapshotJob                          :35   [32m127964041749598208[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-20 10:43:28.706 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：TMy9BsiUb5，session id：1，当前连接数：1
2021-12-20 10:43:29.026 INFO  com.aspect.LogAspect                              :54   [32m127964058593923072[0;39m ------------- 开始 -------------
2021-12-20 10:43:29.026 INFO  com.aspect.LogAspect                              :55   [32m127964058593923072[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:43:29.027 INFO  com.aspect.LogAspect                              :56   [32m127964058593923072[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:43:29.027 INFO  com.aspect.LogAspect                              :57   [32m127964058593923072[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:29.027 INFO  com.aspect.LogAspect                              :80   [32m127964058593923072[0;39m 请求参数: []
2021-12-20 10:43:29.033 INFO  com.aspect.LogAspect                              :54   [32m127964058619088896[0;39m ------------- 开始 -------------
2021-12-20 10:43:29.033 INFO  com.aspect.LogAspect                              :55   [32m127964058619088896[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:43:29.033 INFO  com.aspect.LogAspect                              :56   [32m127964058619088896[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:43:29.034 INFO  com.aspect.LogAspect                              :57   [32m127964058619088896[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:29.034 INFO  com.aspect.LogAspect                              :80   [32m127964058619088896[0;39m 请求参数: []
2021-12-20 10:43:29.037 INFO  com.aspect.LogAspect                              :54   [32m127964058640060416[0;39m ------------- 开始 -------------
2021-12-20 10:43:29.038 INFO  com.aspect.LogAspect                              :55   [32m127964058640060416[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:43:29.038 INFO  com.aspect.LogAspect                              :56   [32m127964058640060416[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:43:29.038 INFO  com.aspect.LogAspect                              :57   [32m127964058640060416[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:29.038 INFO  com.aspect.LogAspect                              :80   [32m127964058640060416[0;39m 请求参数: []
2021-12-20 10:43:29.110 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964058593923072[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:43:29.110 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964058593923072[0;39m ==> Parameters: 
2021-12-20 10:43:29.132 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964058619088896[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:43:29.132 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964058640060416[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:43:29.133 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964058640060416[0;39m ==> Parameters: 
2021-12-20 10:43:29.133 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964058619088896[0;39m ==> Parameters: 
2021-12-20 10:43:29.198 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964058593923072[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:43:29.199 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964058593923072[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:43:29.200 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964058593923072[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:43:29.201 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964058593923072[0;39m <==      Total: 2
2021-12-20 10:43:29.201 INFO  com.aspect.LogAspect                              :92   [32m127964058593923072[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:43:29.202 INFO  com.aspect.LogAspect                              :93   [32m127964058593923072[0;39m ------------- 结束 耗时：176 ms -------------
2021-12-20 10:43:29.209 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964058619088896[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:43:29.209 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964058619088896[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:43:29.211 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964058619088896[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:43:29.212 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964058619088896[0;39m <==      Total: 2
2021-12-20 10:43:29.212 INFO  com.aspect.LogAspect                              :92   [32m127964058619088896[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:43:29.212 INFO  com.aspect.LogAspect                              :93   [32m127964058619088896[0;39m ------------- 结束 耗时：180 ms -------------
2021-12-20 10:43:29.232 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:43:29.232 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:43:29.233 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:43:29.233 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:43:29.234 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:43:29.235 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:43:29.235 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:43:29.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:43:29.237 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:43:29.237 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:43:29.238 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:43:29.238 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:43:29.239 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:43:29.239 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:43:29.241 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:43:29.241 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:43:29.242 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:43:29.242 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:43:29.243 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:43:29.243 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964058640060416[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:43:29.244 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964058640060416[0;39m <==      Total: 19
2021-12-20 10:43:29.246 INFO  com.aspect.LogAspect                              :92   [32m127964058640060416[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:43:29.246 INFO  com.aspect.LogAspect                              :93   [32m127964058640060416[0;39m ------------- 结束 耗时：209 ms -------------
2021-12-20 10:43:30.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127964062712729600[0;39m 生成今日电子书快照开始
2021-12-20 10:43:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964062712729600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964062712729600[0;39m ==> Parameters: 
2021-12-20 10:43:30.260 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964062712729600[0;39m <==    Updates: 0
2021-12-20 10:43:30.260 INFO  com.job.EbookSnapshotJob                          :35   [32m127964062712729600[0;39m 生成今日电子书快照结束，耗时：251毫秒
2021-12-20 10:43:35.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127964083713609728[0;39m 生成今日电子书快照开始
2021-12-20 10:43:35.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964083713609728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:35.112 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964083713609728[0;39m ==> Parameters: 
2021-12-20 10:43:35.270 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964083713609728[0;39m <==    Updates: 0
2021-12-20 10:43:35.271 INFO  com.job.EbookSnapshotJob                          :35   [32m127964083713609728[0;39m 生成今日电子书快照结束，耗时：255毫秒
2021-12-20 10:43:35.271 INFO  com.job.DocJob                                    :32   [32m127964084787351552[0;39m 更新电子书下的文档数据开始
2021-12-20 10:43:35.271 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127964084787351552[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:43:35.271 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127964084787351552[0;39m ==> Parameters: 
2021-12-20 10:43:35.439 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127964084787351552[0;39m <==    Updates: 3
2021-12-20 10:43:35.440 INFO  com.job.DocJob                                    :35   [32m127964084787351552[0;39m 更新电子书下的文档数据结束，耗时：169毫秒
2021-12-20 10:43:36.369 INFO  com.aspect.LogAspect                              :54   [32m127964089392697344[0;39m ------------- 开始 -------------
2021-12-20 10:43:36.369 INFO  com.aspect.LogAspect                              :55   [32m127964089392697344[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 10:43:36.370 INFO  com.aspect.LogAspect                              :56   [32m127964089392697344[0;39m 类名方法: com.controller.UserController.login
2021-12-20 10:43:36.370 INFO  com.aspect.LogAspect                              :57   [32m127964089392697344[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:36.371 INFO  com.aspect.LogAspect                              :80   [32m127964089392697344[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-20 10:43:36.463 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127964089392697344[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 10:43:36.464 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127964089392697344[0;39m ==> Parameters: test123(String)
2021-12-20 10:43:36.535 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127964089392697344[0;39m <==    Columns: id, login_name, name, password
2021-12-20 10:43:36.537 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127964089392697344[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 10:43:36.538 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127964089392697344[0;39m <==      Total: 1
2021-12-20 10:43:36.551 INFO  com.controller.UserController                     :77   [32m127964089392697344[0;39m 生成单点登录token:127964090156060672,并放入redis中
2021-12-20 10:43:37.905 INFO  com.aspect.LogAspect                              :92   [32m127964089392697344[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"127964090156060672"},"success":true}
2021-12-20 10:43:37.905 INFO  com.aspect.LogAspect                              :93   [32m127964089392697344[0;39m ------------- 结束 耗时：1536 ms -------------
2021-12-20 10:43:38.030 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：TMy9BsiUb5，session id：1！当前连接数：0
2021-12-20 10:43:38.828 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：cHignOzZM0，session id：2，当前连接数：1
2021-12-20 10:43:38.907 INFO  com.aspect.LogAspect                              :54   [32m127964100037840896[0;39m ------------- 开始 -------------
2021-12-20 10:43:38.907 INFO  com.aspect.LogAspect                              :55   [32m127964100037840896[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:43:38.908 INFO  com.aspect.LogAspect                              :56   [32m127964100037840896[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:43:38.908 INFO  com.aspect.LogAspect                              :57   [32m127964100037840896[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:38.908 INFO  com.aspect.LogAspect                              :80   [32m127964100037840896[0;39m 请求参数: []
2021-12-20 10:43:38.909 INFO  com.aspect.LogAspect                              :54   [32m127964100046229504[0;39m ------------- 开始 -------------
2021-12-20 10:43:38.909 INFO  com.aspect.LogAspect                              :55   [32m127964100046229504[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:43:38.910 INFO  com.aspect.LogAspect                              :56   [32m127964100046229504[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:43:38.910 INFO  com.aspect.LogAspect                              :57   [32m127964100046229504[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:38.910 INFO  com.aspect.LogAspect                              :80   [32m127964100046229504[0;39m 请求参数: []
2021-12-20 10:43:38.912 INFO  com.aspect.LogAspect                              :54   [32m127964100058812416[0;39m ------------- 开始 -------------
2021-12-20 10:43:38.912 INFO  com.aspect.LogAspect                              :55   [32m127964100058812416[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:43:38.912 INFO  com.aspect.LogAspect                              :56   [32m127964100058812416[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:43:38.913 INFO  com.aspect.LogAspect                              :57   [32m127964100058812416[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:43:38.913 INFO  com.aspect.LogAspect                              :80   [32m127964100058812416[0;39m 请求参数: []
2021-12-20 10:43:38.984 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964100046229504[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:43:38.986 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964100046229504[0;39m ==> Parameters: 
2021-12-20 10:43:38.989 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964100037840896[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:43:38.990 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964100037840896[0;39m ==> Parameters: 
2021-12-20 10:43:38.990 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964100058812416[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:43:38.992 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964100058812416[0;39m ==> Parameters: 
2021-12-20 10:43:39.064 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964100046229504[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:43:39.065 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964100046229504[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:43:39.067 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127964100046229504[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:43:39.067 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127964100046229504[0;39m <==      Total: 2
2021-12-20 10:43:39.067 INFO  com.aspect.LogAspect                              :92   [32m127964100046229504[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:43:39.068 INFO  com.aspect.LogAspect                              :93   [32m127964100046229504[0;39m ------------- 结束 耗时：159 ms -------------
2021-12-20 10:43:39.073 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964100037840896[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:43:39.073 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:43:39.073 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964100037840896[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:43:39.073 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:43:39.074 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:43:39.074 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127964100037840896[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:43:39.074 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:43:39.074 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:43:39.074 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127964100037840896[0;39m <==      Total: 2
2021-12-20 10:43:39.075 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:43:39.075 INFO  com.aspect.LogAspect                              :92   [32m127964100037840896[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:43:39.075 INFO  com.aspect.LogAspect                              :93   [32m127964100037840896[0;39m ------------- 结束 耗时：168 ms -------------
2021-12-20 10:43:39.075 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:43:39.075 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:43:39.076 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:43:39.076 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:43:39.076 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:43:39.077 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:43:39.077 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:43:39.078 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:43:39.078 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:43:39.079 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:43:39.079 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:43:39.080 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:43:39.080 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:43:39.081 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127964100058812416[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:43:39.081 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127964100058812416[0;39m <==      Total: 19
2021-12-20 10:43:39.083 INFO  com.aspect.LogAspect                              :92   [32m127964100058812416[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:43:39.083 INFO  com.aspect.LogAspect                              :93   [32m127964100058812416[0;39m ------------- 结束 耗时：171 ms -------------
2021-12-20 10:43:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127964104659963904[0;39m 生成今日电子书快照开始
2021-12-20 10:43:40.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964104659963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:40.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964104659963904[0;39m ==> Parameters: 
2021-12-20 10:43:40.276 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964104659963904[0;39m <==    Updates: 0
2021-12-20 10:43:40.277 INFO  com.job.EbookSnapshotJob                          :35   [32m127964104659963904[0;39m 生成今日电子书快照结束，耗时：268毫秒
2021-12-20 10:43:44.961 INFO  com.websocket.WebSocketServer                     :41   [32m127962832691138561[0;39m 连接关闭，token：cHignOzZM0，session id：2！当前连接数：0
2021-12-20 10:43:45.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127964125623095296[0;39m 生成今日电子书快照开始
2021-12-20 10:43:45.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964125623095296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:43:45.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964125623095296[0;39m ==> Parameters: 
2021-12-20 10:43:45.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127964125623095296[0;39m <==    Updates: 0
2021-12-20 10:43:45.231 INFO  com.job.EbookSnapshotJob                          :35   [32m127964125623095296[0;39m 生成今日电子书快照结束，耗时：224毫秒
2021-12-20 10:47:52.717 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 10672 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-20 10:47:52.717 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-20 10:47:52.728 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-20 10:47:52.780 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-20 10:47:52.780 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-20 10:47:53.976 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-20 10:47:53.976 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-20 10:47:54.415 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 437 ms. Found 0 Redis repository interfaces.
2021-12-20 10:47:54.994 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-20 10:47:55.001 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-20 10:47:55.001 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-20 10:47:55.001 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-20 10:47:55.047 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-20 10:47:55.047 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2267 ms
2021-12-20 10:47:56.319 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-20 10:47:56.351 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-20 10:47:56.366 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-20 10:47:56.382 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 4.393 seconds (JVM running for 5.469)
2021-12-20 10:48:00.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127965195183198208[0;39m 生成今日电子书快照开始
2021-12-20 10:48:00.025 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m127965195183198208[0;39m HikariPool-1 - Starting...
2021-12-20 10:48:00.827 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m127965195183198208[0;39m HikariPool-1 - Start completed.
2021-12-20 10:48:00.842 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965195183198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:00.865 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965195183198208[0;39m ==> Parameters: 
2021-12-20 10:48:01.012 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965195183198208[0;39m <==    Updates: 0
2021-12-20 10:48:01.012 INFO  com.job.EbookSnapshotJob                          :35   [32m127965195183198208[0;39m 生成今日电子书快照结束，耗时：1002毫秒
2021-12-20 10:48:05.014 INFO  com.job.DocJob                                    :32   [32m127965216171495424[0;39m 更新电子书下的文档数据开始
2021-12-20 10:48:05.107 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965216171495424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:48:05.107 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965216171495424[0;39m ==> Parameters: 
2021-12-20 10:48:05.283 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965216171495424[0;39m <==    Updates: 3
2021-12-20 10:48:05.283 INFO  com.job.DocJob                                    :35   [32m127965216171495424[0;39m 更新电子书下的文档数据结束，耗时：269毫秒
2021-12-20 10:48:05.283 INFO  com.job.EbookSnapshotJob                          :32   [32m127965217299763200[0;39m 生成今日电子书快照开始
2021-12-20 10:48:05.283 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965217299763200[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:05.283 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965217299763200[0;39m ==> Parameters: 
2021-12-20 10:48:05.436 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965217299763200[0;39m <==    Updates: 0
2021-12-20 10:48:05.436 INFO  com.job.EbookSnapshotJob                          :35   [32m127965217299763200[0;39m 生成今日电子书快照结束，耗时：153毫秒
2021-12-20 10:48:10.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127965237168181248[0;39m 生成今日电子书快照开始
2021-12-20 10:48:10.120 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965237168181248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:10.120 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965237168181248[0;39m ==> Parameters: 
2021-12-20 10:48:10.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965237168181248[0;39m <==    Updates: 0
2021-12-20 10:48:10.267 INFO  com.job.EbookSnapshotJob                          :35   [32m127965237168181248[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:48:15.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127965258072592384[0;39m 生成今日电子书快照开始
2021-12-20 10:48:15.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965258072592384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:15.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965258072592384[0;39m ==> Parameters: 
2021-12-20 10:48:15.349 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965258072592384[0;39m <==    Updates: 0
2021-12-20 10:48:15.349 INFO  com.job.EbookSnapshotJob                          :35   [32m127965258072592384[0;39m 生成今日电子书快照结束，耗时：345毫秒
2021-12-20 10:48:20.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127965279044112384[0;39m 生成今日电子书快照开始
2021-12-20 10:48:20.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965279044112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:20.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965279044112384[0;39m ==> Parameters: 
2021-12-20 10:48:20.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965279044112384[0;39m <==    Updates: 0
2021-12-20 10:48:20.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127965279044112384[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:48:21.809 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-20 10:48:21.809 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-20 10:48:21.810 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-20 10:48:21.852 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：jdnILgaOP7，session id：0，当前连接数：1
2021-12-20 10:48:22.073 INFO  com.aspect.LogAspect                              :54   [32m127965287717933057[0;39m ------------- 开始 -------------
2021-12-20 10:48:22.073 INFO  com.aspect.LogAspect                              :54   [32m127965287717933058[0;39m ------------- 开始 -------------
2021-12-20 10:48:22.073 INFO  com.aspect.LogAspect                              :54   [32m127965287717933056[0;39m ------------- 开始 -------------
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :55   [32m127965287717933056[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :55   [32m127965287717933057[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :55   [32m127965287717933058[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :56   [32m127965287717933056[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :56   [32m127965287717933058[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :56   [32m127965287717933057[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :57   [32m127965287717933058[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :57   [32m127965287717933057[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:22.075 INFO  com.aspect.LogAspect                              :57   [32m127965287717933056[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:22.111 INFO  com.aspect.LogAspect                              :80   [32m127965287717933057[0;39m 请求参数: []
2021-12-20 10:48:22.111 INFO  com.aspect.LogAspect                              :80   [32m127965287717933056[0;39m 请求参数: []
2021-12-20 10:48:22.119 INFO  com.aspect.LogAspect                              :80   [32m127965287717933058[0;39m 请求参数: []
2021-12-20 10:48:22.203 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965287717933058[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:48:22.203 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965287717933057[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:48:22.205 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965287717933058[0;39m ==> Parameters: 
2021-12-20 10:48:22.205 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965287717933057[0;39m ==> Parameters: 
2021-12-20 10:48:22.231 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965287717933056[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:48:22.232 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965287717933056[0;39m ==> Parameters: 
2021-12-20 10:48:22.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:48:22.354 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965287717933058[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:48:22.354 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965287717933057[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:48:22.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:48:22.356 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965287717933057[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:48:22.356 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965287717933058[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:48:22.357 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:48:22.358 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:48:22.359 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965287717933058[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:48:22.359 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:48:22.359 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965287717933057[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:48:22.360 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:48:22.360 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965287717933057[0;39m <==      Total: 2
2021-12-20 10:48:22.360 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965287717933058[0;39m <==      Total: 2
2021-12-20 10:48:22.362 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:48:22.363 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:48:22.363 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:48:22.365 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:48:22.366 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:48:22.367 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:48:22.368 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:48:22.369 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:48:22.370 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:48:22.371 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:48:22.372 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:48:22.374 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:48:22.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:48:22.375 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965287717933056[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:48:22.376 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965287717933056[0;39m <==      Total: 19
2021-12-20 10:48:22.390 INFO  com.aspect.LogAspect                              :92   [32m127965287717933056[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:48:22.391 INFO  com.aspect.LogAspect                              :93   [32m127965287717933056[0;39m ------------- 结束 耗时：319 ms -------------
2021-12-20 10:48:22.391 INFO  com.aspect.LogAspect                              :92   [32m127965287717933058[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:48:22.391 INFO  com.aspect.LogAspect                              :92   [32m127965287717933057[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:48:22.391 INFO  com.aspect.LogAspect                              :93   [32m127965287717933058[0;39m ------------- 结束 耗时：319 ms -------------
2021-12-20 10:48:22.391 INFO  com.aspect.LogAspect                              :93   [32m127965287717933057[0;39m ------------- 结束 耗时：319 ms -------------
2021-12-20 10:48:25.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127965300049186816[0;39m 生成今日电子书快照开始
2021-12-20 10:48:25.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965300049186816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:25.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965300049186816[0;39m ==> Parameters: 
2021-12-20 10:48:25.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965300049186816[0;39m <==    Updates: 0
2021-12-20 10:48:25.267 INFO  com.job.EbookSnapshotJob                          :35   [32m127965300049186816[0;39m 生成今日电子书快照结束，耗时：255毫秒
2021-12-20 10:48:26.595 INFO  com.aspect.LogAspect                              :54   [32m127965306688770048[0;39m ------------- 开始 -------------
2021-12-20 10:48:26.595 INFO  com.aspect.LogAspect                              :55   [32m127965306688770048[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 10:48:26.595 INFO  com.aspect.LogAspect                              :56   [32m127965306688770048[0;39m 类名方法: com.controller.UserController.login
2021-12-20 10:48:26.596 INFO  com.aspect.LogAspect                              :57   [32m127965306688770048[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:26.597 INFO  com.aspect.LogAspect                              :80   [32m127965306688770048[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-20 10:48:26.705 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965306688770048[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 10:48:26.706 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965306688770048[0;39m ==> Parameters: test123(String)
2021-12-20 10:48:26.783 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965306688770048[0;39m <==    Columns: id, login_name, name, password
2021-12-20 10:48:26.783 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965306688770048[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 10:48:26.784 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965306688770048[0;39m <==      Total: 1
2021-12-20 10:48:26.790 INFO  com.controller.UserController                     :77   [32m127965306688770048[0;39m 生成单点登录token:127965307506659328,并放入redis中
2021-12-20 10:48:27.340 INFO  com.aspect.LogAspect                              :92   [32m127965306688770048[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"127965307506659328"},"success":true}
2021-12-20 10:48:27.341 INFO  com.aspect.LogAspect                              :93   [32m127965306688770048[0;39m ------------- 结束 耗时：746 ms -------------
2021-12-20 10:48:27.708 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：jdnILgaOP7，session id：0！当前连接数：0
2021-12-20 10:48:28.495 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：ZuZcCQeKvX，session id：1，当前连接数：1
2021-12-20 10:48:28.576 INFO  com.aspect.LogAspect                              :54   [32m127965314997686272[0;39m ------------- 开始 -------------
2021-12-20 10:48:28.576 INFO  com.aspect.LogAspect                              :55   [32m127965314997686272[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:48:28.576 INFO  com.aspect.LogAspect                              :56   [32m127965314997686272[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:48:28.576 INFO  com.aspect.LogAspect                              :57   [32m127965314997686272[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:28.577 INFO  com.aspect.LogAspect                              :54   [32m127965315001880576[0;39m ------------- 开始 -------------
2021-12-20 10:48:28.577 INFO  com.aspect.LogAspect                              :80   [32m127965314997686272[0;39m 请求参数: []
2021-12-20 10:48:28.577 INFO  com.aspect.LogAspect                              :55   [32m127965315001880576[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:48:28.577 INFO  com.aspect.LogAspect                              :56   [32m127965315001880576[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:48:28.577 INFO  com.aspect.LogAspect                              :57   [32m127965315001880576[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:28.578 INFO  com.aspect.LogAspect                              :80   [32m127965315001880576[0;39m 请求参数: []
2021-12-20 10:48:28.580 INFO  com.aspect.LogAspect                              :54   [32m127965315014463488[0;39m ------------- 开始 -------------
2021-12-20 10:48:28.581 INFO  com.aspect.LogAspect                              :55   [32m127965315014463488[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:48:28.581 INFO  com.aspect.LogAspect                              :56   [32m127965315014463488[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:48:28.581 INFO  com.aspect.LogAspect                              :57   [32m127965315014463488[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:28.582 INFO  com.aspect.LogAspect                              :80   [32m127965315014463488[0;39m 请求参数: []
2021-12-20 10:48:28.660 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965314997686272[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:48:28.661 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965314997686272[0;39m ==> Parameters: 
2021-12-20 10:48:28.662 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965315001880576[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:48:28.664 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965315001880576[0;39m ==> Parameters: 
2021-12-20 10:48:28.666 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965315014463488[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:48:28.667 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965315014463488[0;39m ==> Parameters: 
2021-12-20 10:48:28.741 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965314997686272[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:48:28.741 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965314997686272[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:48:28.741 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127965314997686272[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:48:28.750 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127965314997686272[0;39m <==      Total: 2
2021-12-20 10:48:28.752 INFO  com.aspect.LogAspect                              :92   [32m127965314997686272[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:48:28.754 INFO  com.aspect.LogAspect                              :93   [32m127965314997686272[0;39m ------------- 结束 耗时：178 ms -------------
2021-12-20 10:48:28.757 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965315001880576[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:48:28.757 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:48:28.758 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965315001880576[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:48:28.758 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:48:28.760 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:48:28.760 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127965315001880576[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:48:28.760 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127965315001880576[0;39m <==      Total: 2
2021-12-20 10:48:28.760 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:48:28.765 INFO  com.aspect.LogAspect                              :92   [32m127965315001880576[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:48:28.765 INFO  com.aspect.LogAspect                              :93   [32m127965315001880576[0;39m ------------- 结束 耗时：188 ms -------------
2021-12-20 10:48:28.765 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:48:28.767 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:48:28.768 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:48:28.769 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:48:28.770 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:48:28.771 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:48:28.772 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:48:28.773 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:48:28.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127965315014463488[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:48:28.774 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127965315014463488[0;39m <==      Total: 19
2021-12-20 10:48:28.782 INFO  com.aspect.LogAspect                              :92   [32m127965315014463488[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:48:28.782 INFO  com.aspect.LogAspect                              :93   [32m127965315014463488[0;39m ------------- 结束 耗时：202 ms -------------
2021-12-20 10:48:30.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127965321016512512[0;39m 生成今日电子书快照开始
2021-12-20 10:48:30.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965321016512512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:30.108 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965321016512512[0;39m ==> Parameters: 
2021-12-20 10:48:30.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965321016512512[0;39m <==    Updates: 0
2021-12-20 10:48:30.262 INFO  com.job.EbookSnapshotJob                          :35   [32m127965321016512512[0;39m 生成今日电子书快照结束，耗时：249毫秒
2021-12-20 10:48:31.949 INFO  com.interceptor.LoginInterceptor                  :29   [32m127965287717933056[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-20 10:48:31.949 INFO  com.interceptor.LoginInterceptor                  :65   [32m127965287717933056[0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-12-20 10:48:31.956 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-20 10:48:31.956 INFO  com.interceptor.LoginInterceptor                  :40   [32m                  [0;39m 接口登录拦截：，path：http://localhost:8081/user/list
2021-12-20 10:48:31.957 INFO  com.interceptor.LoginInterceptor                  :44   [32m                  [0;39m 登录校验开始，token：127965307506659328
2021-12-20 10:48:32.039 INFO  com.interceptor.LoginInterceptor                  :56   [32m                  [0;39m 已登录：{"id":120902130663034880,"loginName":"test123","name":"test123","token":"127965307506659328"}
2021-12-20 10:48:32.072 INFO  com.aspect.LogAspect                              :54   [32m127965329660973056[0;39m ------------- 开始 -------------
2021-12-20 10:48:32.073 INFO  com.aspect.LogAspect                              :55   [32m127965329660973056[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-20 10:48:32.073 INFO  com.aspect.LogAspect                              :56   [32m127965329660973056[0;39m 类名方法: com.controller.UserController.list
2021-12-20 10:48:32.073 INFO  com.aspect.LogAspect                              :57   [32m127965329660973056[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:48:32.074 INFO  com.aspect.LogAspect                              :80   [32m127965329660973056[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-20 10:48:32.238 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127965329660973056[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-20 10:48:32.239 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127965329660973056[0;39m ==> Parameters: 
2021-12-20 10:48:32.308 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127965329660973056[0;39m <==    Columns: count(0)
2021-12-20 10:48:32.308 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127965329660973056[0;39m <==        Row: 7
2021-12-20 10:48:32.309 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127965329660973056[0;39m <==      Total: 1
2021-12-20 10:48:32.313 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965329660973056[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-20 10:48:32.315 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965329660973056[0;39m ==> Parameters: 10(Integer)
2021-12-20 10:48:32.401 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==    Columns: id, login_name, name, password
2021-12-20 10:48:32.402 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-20 10:48:32.403 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-20 10:48:32.403 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-20 10:48:32.403 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-20 10:48:32.404 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-20 10:48:32.404 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 10:48:32.405 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127965329660973056[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 10:48:32.405 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127965329660973056[0;39m <==      Total: 7
2021-12-20 10:48:32.407 INFO  com.servicess.UserService                         :52   [32m127965329660973056[0;39m 总行数：7
2021-12-20 10:48:32.408 INFO  com.servicess.UserService                         :53   [32m127965329660973056[0;39m 总页数：1
2021-12-20 10:48:32.419 INFO  com.aspect.LogAspect                              :92   [32m127965329660973056[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"}],"total":7},"success":true}
2021-12-20 10:48:32.420 INFO  com.aspect.LogAspect                              :93   [32m127965329660973056[0;39m ------------- 结束 耗时：348 ms -------------
2021-12-20 10:48:32.424 INFO  com.interceptor.LoginInterceptor                  :65   [32m127965329660973056[0;39m ------------- LoginInterceptor 结束 耗时：468 ms -------------
2021-12-20 10:48:35.016 INFO  com.job.DocJob                                    :32   [32m127965342009004032[0;39m 更新电子书下的文档数据开始
2021-12-20 10:48:35.115 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965342009004032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:48:35.116 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965342009004032[0;39m ==> Parameters: 
2021-12-20 10:48:35.268 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127965342009004032[0;39m <==    Updates: 3
2021-12-20 10:48:35.270 INFO  com.job.DocJob                                    :35   [32m127965342009004032[0;39m 更新电子书下的文档数据结束，耗时：253毫秒
2021-12-20 10:48:35.271 INFO  com.job.EbookSnapshotJob                          :32   [32m127965343078551552[0;39m 生成今日电子书快照开始
2021-12-20 10:48:35.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965343078551552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:35.276 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965343078551552[0;39m ==> Parameters: 
2021-12-20 10:48:35.454 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965343078551552[0;39m <==    Updates: 0
2021-12-20 10:48:35.455 INFO  com.job.EbookSnapshotJob                          :35   [32m127965343078551552[0;39m 生成今日电子书快照结束，耗时：183毫秒
2021-12-20 10:48:40.001 INFO  com.job.EbookSnapshotJob                          :32   [32m127965362917609472[0;39m 生成今日电子书快照开始
2021-12-20 10:48:40.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965362917609472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:40.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965362917609472[0;39m ==> Parameters: 
2021-12-20 10:48:40.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965362917609472[0;39m <==    Updates: 0
2021-12-20 10:48:40.217 INFO  com.job.EbookSnapshotJob                          :35   [32m127965362917609472[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 10:48:45.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127965383910100992[0;39m 生成今日电子书快照开始
2021-12-20 10:48:45.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965383910100992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:45.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965383910100992[0;39m ==> Parameters: 
2021-12-20 10:48:45.228 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965383910100992[0;39m <==    Updates: 0
2021-12-20 10:48:45.228 INFO  com.job.EbookSnapshotJob                          :35   [32m127965383910100992[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-20 10:48:47.166 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：ZuZcCQeKvX，session id：1！当前连接数：0
2021-12-20 10:48:50.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127965404906786816[0;39m 生成今日电子书快照开始
2021-12-20 10:48:50.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965404906786816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:48:50.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965404906786816[0;39m ==> Parameters: 
2021-12-20 10:48:50.213 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127965404906786816[0;39m <==    Updates: 0
2021-12-20 10:48:50.213 INFO  com.job.EbookSnapshotJob                          :35   [32m127965404906786816[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 10:54:48.858 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-20 10:54:48.858 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 3224 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-20 10:54:48.864 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-20 10:54:48.917 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-20 10:54:48.925 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-20 10:54:50.752 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-20 10:54:50.752 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-20 10:54:51.572 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 796 ms. Found 0 Redis repository interfaces.
2021-12-20 10:54:52.320 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-20 10:54:52.336 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-20 10:54:52.336 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-20 10:54:52.336 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-20 10:54:52.405 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-20 10:54:52.405 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 3480 ms
2021-12-20 10:54:53.993 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-20 10:54:54.040 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-20 10:54:54.062 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-20 10:54:54.077 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 5.998 seconds (JVM running for 7.002)
2021-12-20 10:54:55.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127966935819358208[0;39m 生成今日电子书快照开始
2021-12-20 10:54:55.026 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m127966935819358208[0;39m HikariPool-1 - Starting...
2021-12-20 10:54:55.996 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m127966935819358208[0;39m HikariPool-1 - Start completed.
2021-12-20 10:54:55.996 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966935819358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:54:56.028 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966935819358208[0;39m ==> Parameters: 
2021-12-20 10:54:56.197 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966935819358208[0;39m <==    Updates: 0
2021-12-20 10:54:56.197 INFO  com.job.EbookSnapshotJob                          :35   [32m127966935819358208[0;39m 生成今日电子书快照结束，耗时：1187毫秒
2021-12-20 10:55:00.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127966956778295296[0;39m 生成今日电子书快照开始
2021-12-20 10:55:00.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966956778295296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:00.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966956778295296[0;39m ==> Parameters: 
2021-12-20 10:55:00.238 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966956778295296[0;39m <==    Updates: 0
2021-12-20 10:55:00.238 INFO  com.job.EbookSnapshotJob                          :35   [32m127966956778295296[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:55:05.015 INFO  com.job.DocJob                                    :32   [32m127966977783369728[0;39m 更新电子书下的文档数据开始
2021-12-20 10:55:05.096 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127966977783369728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:55:05.096 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127966977783369728[0;39m ==> Parameters: 
2021-12-20 10:55:05.246 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127966977783369728[0;39m <==    Updates: 3
2021-12-20 10:55:05.246 INFO  com.job.DocJob                                    :35   [32m127966977783369728[0;39m 更新电子书下的文档数据结束，耗时：231毫秒
2021-12-20 10:55:05.246 INFO  com.job.EbookSnapshotJob                          :32   [32m127966978752253952[0;39m 生成今日电子书快照开始
2021-12-20 10:55:05.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966978752253952[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:05.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966978752253952[0;39m ==> Parameters: 
2021-12-20 10:55:05.415 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966978752253952[0;39m <==    Updates: 0
2021-12-20 10:55:05.415 INFO  com.job.EbookSnapshotJob                          :35   [32m127966978752253952[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-20 10:55:10.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127966998796832768[0;39m 生成今日电子书快照开始
2021-12-20 10:55:10.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966998796832768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:10.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966998796832768[0;39m ==> Parameters: 
2021-12-20 10:55:10.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127966998796832768[0;39m <==    Updates: 0
2021-12-20 10:55:10.272 INFO  com.job.EbookSnapshotJob                          :35   [32m127966998796832768[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:55:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127967019730604032[0;39m 生成今日电子书快照开始
2021-12-20 10:55:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967019730604032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:15.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967019730604032[0;39m ==> Parameters: 
2021-12-20 10:55:15.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967019730604032[0;39m <==    Updates: 0
2021-12-20 10:55:15.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127967019730604032[0;39m 生成今日电子书快照结束，耗时：241毫秒
2021-12-20 10:55:16.311 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-20 10:55:16.311 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-20 10:55:16.312 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-20 10:55:16.350 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：B6eUViNVhi，session id：0，当前连接数：1
2021-12-20 10:55:16.556 INFO  com.aspect.LogAspect                              :54   [32m127967026185637889[0;39m ------------- 开始 -------------
2021-12-20 10:55:16.556 INFO  com.aspect.LogAspect                              :54   [32m127967026185637890[0;39m ------------- 开始 -------------
2021-12-20 10:55:16.556 INFO  com.aspect.LogAspect                              :54   [32m127967026185637888[0;39m ------------- 开始 -------------
2021-12-20 10:55:16.558 INFO  com.aspect.LogAspect                              :55   [32m127967026185637889[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:55:16.558 INFO  com.aspect.LogAspect                              :55   [32m127967026185637890[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:55:16.559 INFO  com.aspect.LogAspect                              :56   [32m127967026185637889[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:55:16.558 INFO  com.aspect.LogAspect                              :55   [32m127967026185637888[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:55:16.559 INFO  com.aspect.LogAspect                              :57   [32m127967026185637889[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:55:16.559 INFO  com.aspect.LogAspect                              :56   [32m127967026185637890[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:55:16.560 INFO  com.aspect.LogAspect                              :57   [32m127967026185637890[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:55:16.559 INFO  com.aspect.LogAspect                              :56   [32m127967026185637888[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:55:16.562 INFO  com.aspect.LogAspect                              :57   [32m127967026185637888[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:55:16.600 INFO  com.aspect.LogAspect                              :80   [32m127967026185637890[0;39m 请求参数: []
2021-12-20 10:55:16.600 INFO  com.aspect.LogAspect                              :80   [32m127967026185637888[0;39m 请求参数: []
2021-12-20 10:55:16.607 INFO  com.aspect.LogAspect                              :80   [32m127967026185637889[0;39m 请求参数: []
2021-12-20 10:55:16.671 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967026185637890[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:55:16.673 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967026185637890[0;39m ==> Parameters: 
2021-12-20 10:55:16.691 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967026185637889[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:55:16.693 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967026185637889[0;39m ==> Parameters: 
2021-12-20 10:55:16.696 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967026185637888[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:55:16.697 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967026185637888[0;39m ==> Parameters: 
2021-12-20 10:55:16.804 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:55:16.804 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967026185637889[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:55:16.804 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967026185637890[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:55:16.805 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:55:16.807 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967026185637889[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:55:16.807 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967026185637890[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:55:16.811 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:55:16.813 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:55:16.814 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:55:16.815 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967026185637889[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:55:16.815 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967026185637890[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:55:16.816 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:55:16.816 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967026185637889[0;39m <==      Total: 2
2021-12-20 10:55:16.817 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967026185637890[0;39m <==      Total: 2
2021-12-20 10:55:16.817 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:55:16.818 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:55:16.820 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:55:16.821 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:55:16.823 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:55:16.824 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:55:16.825 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:55:16.826 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:55:16.827 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:55:16.828 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:55:16.829 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:55:16.832 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:55:16.832 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:55:16.833 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967026185637888[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:55:16.833 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967026185637888[0;39m <==      Total: 19
2021-12-20 10:55:16.850 INFO  com.aspect.LogAspect                              :92   [32m127967026185637888[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:55:16.851 INFO  com.aspect.LogAspect                              :92   [32m127967026185637889[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:55:16.851 INFO  com.aspect.LogAspect                              :92   [32m127967026185637890[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:55:16.851 INFO  com.aspect.LogAspect                              :93   [32m127967026185637888[0;39m ------------- 结束 耗时：296 ms -------------
2021-12-20 10:55:16.851 INFO  com.aspect.LogAspect                              :93   [32m127967026185637889[0;39m ------------- 结束 耗时：296 ms -------------
2021-12-20 10:55:16.851 INFO  com.aspect.LogAspect                              :93   [32m127967026185637890[0;39m ------------- 结束 耗时：296 ms -------------
2021-12-20 10:55:20.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127967040697929728[0;39m 生成今日电子书快照开始
2021-12-20 10:55:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967040697929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:20.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967040697929728[0;39m ==> Parameters: 
2021-12-20 10:55:20.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967040697929728[0;39m <==    Updates: 0
2021-12-20 10:55:20.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127967040697929728[0;39m 生成今日电子书快照结束，耗时：233毫秒
2021-12-20 10:55:25.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127967061644283904[0;39m 生成今日电子书快照开始
2021-12-20 10:55:25.345 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967061644283904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:25.345 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967061644283904[0;39m ==> Parameters: 
2021-12-20 10:55:25.504 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967061644283904[0;39m <==    Updates: 0
2021-12-20 10:55:25.505 INFO  com.job.EbookSnapshotJob                          :35   [32m127967061644283904[0;39m 生成今日电子书快照结束，耗时：496毫秒
2021-12-20 10:55:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127967082619998208[0;39m 生成今日电子书快照开始
2021-12-20 10:55:30.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967082619998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:30.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967082619998208[0;39m ==> Parameters: 
2021-12-20 10:55:30.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967082619998208[0;39m <==    Updates: 0
2021-12-20 10:55:30.241 INFO  com.job.EbookSnapshotJob                          :35   [32m127967082619998208[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:55:35.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127967103646044160[0;39m 生成今日电子书快照开始
2021-12-20 10:55:35.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967103646044160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:35.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967103646044160[0;39m ==> Parameters: 
2021-12-20 10:55:35.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967103646044160[0;39m <==    Updates: 0
2021-12-20 10:55:35.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127967103646044160[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:55:35.254 INFO  com.job.DocJob                                    :32   [32m127967104614928384[0;39m 更新电子书下的文档数据开始
2021-12-20 10:55:35.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967104614928384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:55:35.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967104614928384[0;39m ==> Parameters: 
2021-12-20 10:55:35.424 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967104614928384[0;39m <==    Updates: 3
2021-12-20 10:55:35.424 INFO  com.job.DocJob                                    :35   [32m127967104614928384[0;39m 更新电子书下的文档数据结束，耗时：170毫秒
2021-12-20 10:55:40.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127967124575621120[0;39m 生成今日电子书快照开始
2021-12-20 10:55:40.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967124575621120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:40.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967124575621120[0;39m ==> Parameters: 
2021-12-20 10:55:40.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967124575621120[0;39m <==    Updates: 0
2021-12-20 10:55:40.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127967124575621120[0;39m 生成今日电子书快照结束，耗时：241毫秒
2021-12-20 10:55:45.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127967145542946816[0;39m 生成今日电子书快照开始
2021-12-20 10:55:45.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967145542946816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:45.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967145542946816[0;39m ==> Parameters: 
2021-12-20 10:55:45.335 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967145542946816[0;39m <==    Updates: 0
2021-12-20 10:55:45.335 INFO  com.job.EbookSnapshotJob                          :35   [32m127967145542946816[0;39m 生成今日电子书快照结束，耗时：323毫秒
2021-12-20 10:55:49.232 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-20 10:55:49.234 INFO  com.interceptor.LoginInterceptor                  :65   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2021-12-20 10:55:49.240 INFO  com.interceptor.LoginInterceptor                  :29   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-12-20 10:55:49.240 INFO  com.interceptor.LoginInterceptor                  :40   [32m                  [0;39m 接口登录拦截：，path：http://localhost:8081/user/save
2021-12-20 10:55:49.240 INFO  com.interceptor.LoginInterceptor                  :44   [32m                  [0;39m 登录校验开始，token：null
2021-12-20 10:55:49.240 INFO  com.interceptor.LoginInterceptor                  :46   [32m                  [0;39m token为空，请求被拦截
2021-12-20 10:55:50.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127967166522855424[0;39m 生成今日电子书快照开始
2021-12-20 10:55:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967166522855424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:50.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967166522855424[0;39m ==> Parameters: 
2021-12-20 10:55:50.342 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967166522855424[0;39m <==    Updates: 0
2021-12-20 10:55:50.343 INFO  com.job.EbookSnapshotJob                          :35   [32m127967166522855424[0;39m 生成今日电子书快照结束，耗时：328毫秒
2021-12-20 10:55:55.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127967187460820992[0;39m 生成今日电子书快照开始
2021-12-20 10:55:55.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967187460820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:55:55.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967187460820992[0;39m ==> Parameters: 
2021-12-20 10:55:55.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967187460820992[0;39m <==    Updates: 0
2021-12-20 10:55:55.250 INFO  com.job.EbookSnapshotJob                          :35   [32m127967187460820992[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 10:56:00.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127967208474284032[0;39m 生成今日电子书快照开始
2021-12-20 10:56:00.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967208474284032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:00.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967208474284032[0;39m ==> Parameters: 
2021-12-20 10:56:00.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967208474284032[0;39m <==    Updates: 0
2021-12-20 10:56:00.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127967208474284032[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:56:05.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127967229395472384[0;39m 生成今日电子书快照开始
2021-12-20 10:56:05.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967229395472384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:05.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967229395472384[0;39m ==> Parameters: 
2021-12-20 10:56:05.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967229395472384[0;39m <==    Updates: 0
2021-12-20 10:56:05.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127967229395472384[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:56:05.251 INFO  com.job.DocJob                                    :32   [32m127967230431465472[0;39m 更新电子书下的文档数据开始
2021-12-20 10:56:05.251 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967230431465472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:56:05.251 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967230431465472[0;39m ==> Parameters: 
2021-12-20 10:56:05.406 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967230431465472[0;39m <==    Updates: 3
2021-12-20 10:56:05.406 INFO  com.job.DocJob                                    :35   [32m127967230431465472[0;39m 更新电子书下的文档数据结束，耗时：155毫秒
2021-12-20 10:56:10.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127967250417324032[0;39m 生成今日电子书快照开始
2021-12-20 10:56:10.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967250417324032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:10.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967250417324032[0;39m ==> Parameters: 
2021-12-20 10:56:10.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967250417324032[0;39m <==    Updates: 0
2021-12-20 10:56:10.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127967250417324032[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:56:15.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127967271363678208[0;39m 生成今日电子书快照开始
2021-12-20 10:56:15.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967271363678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:15.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967271363678208[0;39m ==> Parameters: 
2021-12-20 10:56:15.261 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967271363678208[0;39m <==    Updates: 0
2021-12-20 10:56:15.261 INFO  com.job.EbookSnapshotJob                          :35   [32m127967271363678208[0;39m 生成今日电子书快照结束，耗时：251毫秒
2021-12-20 10:56:20.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127967292372946944[0;39m 生成今日电子书快照开始
2021-12-20 10:56:20.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967292372946944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:20.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967292372946944[0;39m ==> Parameters: 
2021-12-20 10:56:20.258 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967292372946944[0;39m <==    Updates: 0
2021-12-20 10:56:20.258 INFO  com.job.EbookSnapshotJob                          :35   [32m127967292372946944[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:56:24.956 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：YBjnEYmA7J，session id：1，当前连接数：2
2021-12-20 10:56:25.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127967313369632768[0;39m 生成今日电子书快照开始
2021-12-20 10:56:25.093 INFO  com.aspect.LogAspect                              :54   [32m127967313654845440[0;39m ------------- 开始 -------------
2021-12-20 10:56:25.094 INFO  com.aspect.LogAspect                              :55   [32m127967313654845440[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 10:56:25.094 INFO  com.aspect.LogAspect                              :56   [32m127967313654845440[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 10:56:25.095 INFO  com.aspect.LogAspect                              :57   [32m127967313654845440[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:56:25.095 INFO  com.aspect.LogAspect                              :80   [32m127967313654845440[0;39m 请求参数: []
2021-12-20 10:56:25.099 INFO  com.aspect.LogAspect                              :54   [32m127967313680011265[0;39m ------------- 开始 -------------
2021-12-20 10:56:25.099 INFO  com.aspect.LogAspect                              :54   [32m127967313680011264[0;39m ------------- 开始 -------------
2021-12-20 10:56:25.099 INFO  com.aspect.LogAspect                              :55   [32m127967313680011265[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :55   [32m127967313680011264[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :56   [32m127967313680011265[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :56   [32m127967313680011264[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :57   [32m127967313680011265[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :57   [32m127967313680011264[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :80   [32m127967313680011265[0;39m 请求参数: []
2021-12-20 10:56:25.100 INFO  com.aspect.LogAspect                              :80   [32m127967313680011264[0;39m 请求参数: []
2021-12-20 10:56:25.108 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967313369632768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:25.109 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967313369632768[0;39m ==> Parameters: 
2021-12-20 10:56:25.182 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967313680011264[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:56:25.184 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967313680011264[0;39m ==> Parameters: 
2021-12-20 10:56:25.186 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967313654845440[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 10:56:25.187 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967313654845440[0;39m ==> Parameters: 
2021-12-20 10:56:25.193 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967313680011265[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 10:56:25.194 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967313680011265[0;39m ==> Parameters: 
2021-12-20 10:56:25.284 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967313680011264[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 10:56:25.284 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967313654845440[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 10:56:25.284 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967313369632768[0;39m <==    Updates: 0
2021-12-20 10:56:25.285 INFO  com.job.EbookSnapshotJob                          :35   [32m127967313369632768[0;39m 生成今日电子书快照结束，耗时：260毫秒
2021-12-20 10:56:25.285 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967313680011264[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 10:56:25.285 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967313654845440[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 10:56:25.285 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==    Columns: id, parent, name, sort
2021-12-20 10:56:25.285 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 10:56:25.286 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127967313680011264[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 10:56:25.286 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127967313654845440[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 10:56:25.286 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 10:56:25.287 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 10:56:25.287 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127967313654845440[0;39m <==      Total: 2
2021-12-20 10:56:25.287 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127967313680011264[0;39m <==      Total: 2
2021-12-20 10:56:25.287 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 10:56:25.287 INFO  com.aspect.LogAspect                              :92   [32m127967313654845440[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 10:56:25.287 INFO  com.aspect.LogAspect                              :92   [32m127967313680011264[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 10:56:25.287 INFO  com.aspect.LogAspect                              :93   [32m127967313680011264[0;39m ------------- 结束 耗时：188 ms -------------
2021-12-20 10:56:25.287 INFO  com.aspect.LogAspect                              :93   [32m127967313654845440[0;39m ------------- 结束 耗时：194 ms -------------
2021-12-20 10:56:25.288 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 10:56:25.288 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 10:56:25.289 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 10:56:25.289 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 10:56:25.290 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 10:56:25.291 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 10:56:25.292 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 10:56:25.292 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 10:56:25.293 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 10:56:25.293 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 10:56:25.294 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 10:56:25.294 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 10:56:25.295 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 10:56:25.295 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 10:56:25.295 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127967313680011265[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 10:56:25.296 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127967313680011265[0;39m <==      Total: 19
2021-12-20 10:56:25.297 INFO  com.aspect.LogAspect                              :92   [32m127967313680011265[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 10:56:25.297 INFO  com.aspect.LogAspect                              :93   [32m127967313680011265[0;39m ------------- 结束 耗时：198 ms -------------
2021-12-20 10:56:26.200 INFO  com.websocket.WebSocketServer                     :41   [32m127967026185637889[0;39m 连接关闭，token：B6eUViNVhi，session id：0！当前连接数：1
2021-12-20 10:56:30.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127967334282432512[0;39m 生成今日电子书快照开始
2021-12-20 10:56:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967334282432512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:30.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967334282432512[0;39m ==> Parameters: 
2021-12-20 10:56:30.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967334282432512[0;39m <==    Updates: 0
2021-12-20 10:56:30.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127967334282432512[0;39m 生成今日电子书快照结束，耗时：229毫秒
2021-12-20 10:56:35.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127967355274924032[0;39m 生成今日电子书快照开始
2021-12-20 10:56:35.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967355274924032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:35.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967355274924032[0;39m ==> Parameters: 
2021-12-20 10:56:35.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967355274924032[0;39m <==    Updates: 0
2021-12-20 10:56:35.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127967355274924032[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:56:35.254 INFO  com.job.DocJob                                    :32   [32m127967356273168384[0;39m 更新电子书下的文档数据开始
2021-12-20 10:56:35.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967356273168384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:56:35.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967356273168384[0;39m ==> Parameters: 
2021-12-20 10:56:35.470 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967356273168384[0;39m <==    Updates: 3
2021-12-20 10:56:35.470 INFO  com.job.DocJob                                    :35   [32m127967356273168384[0;39m 更新电子书下的文档数据结束，耗时：216毫秒
2021-12-20 10:56:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127967376242249728[0;39m 生成今日电子书快照开始
2021-12-20 10:56:40.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967376242249728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:40.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967376242249728[0;39m ==> Parameters: 
2021-12-20 10:56:40.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967376242249728[0;39m <==    Updates: 0
2021-12-20 10:56:40.246 INFO  com.job.EbookSnapshotJob                          :35   [32m127967376242249728[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:56:45.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127967397264101376[0;39m 生成今日电子书快照开始
2021-12-20 10:56:45.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967397264101376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:45.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967397264101376[0;39m ==> Parameters: 
2021-12-20 10:56:45.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967397264101376[0;39m <==    Updates: 0
2021-12-20 10:56:45.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127967397264101376[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-20 10:56:50.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127967418168512512[0;39m 生成今日电子书快照开始
2021-12-20 10:56:50.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967418168512512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:50.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967418168512512[0;39m ==> Parameters: 
2021-12-20 10:56:50.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967418168512512[0;39m <==    Updates: 0
2021-12-20 10:56:50.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127967418168512512[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:56:55.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127967439198752768[0;39m 生成今日电子书快照开始
2021-12-20 10:56:55.126 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967439198752768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:56:55.126 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967439198752768[0;39m ==> Parameters: 
2021-12-20 10:56:55.295 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967439198752768[0;39m <==    Updates: 0
2021-12-20 10:56:55.310 INFO  com.job.EbookSnapshotJob                          :35   [32m127967439198752768[0;39m 生成今日电子书快照结束，耗时：285毫秒
2021-12-20 10:57:00.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127967460107358208[0;39m 生成今日电子书快照开始
2021-12-20 10:57:00.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967460107358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:00.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967460107358208[0;39m ==> Parameters: 
2021-12-20 10:57:00.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967460107358208[0;39m <==    Updates: 0
2021-12-20 10:57:00.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127967460107358208[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:57:05.008 INFO  com.job.DocJob                                    :32   [32m127967481070489600[0;39m 更新电子书下的文档数据开始
2021-12-20 10:57:05.093 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967481070489600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:57:05.093 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967481070489600[0;39m ==> Parameters: 
2021-12-20 10:57:05.256 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967481070489600[0;39m <==    Updates: 3
2021-12-20 10:57:05.256 INFO  com.job.DocJob                                    :35   [32m127967481070489600[0;39m 更新电子书下的文档数据结束，耗时：248毫秒
2021-12-20 10:57:05.256 INFO  com.job.EbookSnapshotJob                          :32   [32m127967482110676992[0;39m 生成今日电子书快照开始
2021-12-20 10:57:05.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967482110676992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:05.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967482110676992[0;39m ==> Parameters: 
2021-12-20 10:57:05.433 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967482110676992[0;39m <==    Updates: 0
2021-12-20 10:57:05.433 INFO  com.job.EbookSnapshotJob                          :35   [32m127967482110676992[0;39m 生成今日电子书快照结束，耗时：177毫秒
2021-12-20 10:57:10.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127967502104924160[0;39m 生成今日电子书快照开始
2021-12-20 10:57:10.123 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967502104924160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:10.123 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967502104924160[0;39m ==> Parameters: 
2021-12-20 10:57:10.308 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967502104924160[0;39m <==    Updates: 0
2021-12-20 10:57:10.308 INFO  com.job.EbookSnapshotJob                          :35   [32m127967502104924160[0;39m 生成今日电子书快照结束，耗时：285毫秒
2021-12-20 10:57:15.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127967523005140992[0;39m 生成今日电子书快照开始
2021-12-20 10:57:15.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967523005140992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:15.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967523005140992[0;39m ==> Parameters: 
2021-12-20 10:57:15.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967523005140992[0;39m <==    Updates: 0
2021-12-20 10:57:15.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127967523005140992[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 10:57:20.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127967543972466688[0;39m 生成今日电子书快照开始
2021-12-20 10:57:20.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967543972466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:20.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967543972466688[0;39m ==> Parameters: 
2021-12-20 10:57:20.279 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967543972466688[0;39m <==    Updates: 0
2021-12-20 10:57:20.279 INFO  com.job.EbookSnapshotJob                          :35   [32m127967543972466688[0;39m 生成今日电子书快照结束，耗时：274毫秒
2021-12-20 10:57:25.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127967564964958208[0;39m 生成今日电子书快照开始
2021-12-20 10:57:25.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967564964958208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:25.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967564964958208[0;39m ==> Parameters: 
2021-12-20 10:57:25.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967564964958208[0;39m <==    Updates: 0
2021-12-20 10:57:25.263 INFO  com.job.EbookSnapshotJob                          :35   [32m127967564964958208[0;39m 生成今日电子书快照结束，耗时：253毫秒
2021-12-20 10:57:30.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127967585986809856[0;39m 生成今日电子书快照开始
2021-12-20 10:57:30.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967585986809856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:30.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967585986809856[0;39m ==> Parameters: 
2021-12-20 10:57:30.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967585986809856[0;39m <==    Updates: 0
2021-12-20 10:57:30.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127967585986809856[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:57:35.020 INFO  com.job.DocJob                                    :32   [32m127967606949941248[0;39m 更新电子书下的文档数据开始
2021-12-20 10:57:35.089 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967606949941248[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:57:35.089 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967606949941248[0;39m ==> Parameters: 
2021-12-20 10:57:35.252 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967606949941248[0;39m <==    Updates: 3
2021-12-20 10:57:35.252 INFO  com.job.DocJob                                    :35   [32m127967606949941248[0;39m 更新电子书下的文档数据结束，耗时：232毫秒
2021-12-20 10:57:35.252 INFO  com.job.EbookSnapshotJob                          :32   [32m127967607923019776[0;39m 生成今日电子书快照开始
2021-12-20 10:57:35.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967607923019776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:35.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967607923019776[0;39m ==> Parameters: 
2021-12-20 10:57:35.421 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967607923019776[0;39m <==    Updates: 0
2021-12-20 10:57:35.437 INFO  com.job.EbookSnapshotJob                          :35   [32m127967607923019776[0;39m 生成今日电子书快照结束，耗时：185毫秒
2021-12-20 10:57:40.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127967627850158080[0;39m 生成今日电子书快照开始
2021-12-20 10:57:40.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967627850158080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:40.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967627850158080[0;39m ==> Parameters: 
2021-12-20 10:57:40.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967627850158080[0;39m <==    Updates: 0
2021-12-20 10:57:40.266 INFO  com.job.EbookSnapshotJob                          :35   [32m127967627850158080[0;39m 生成今日电子书快照结束，耗时：263毫秒
2021-12-20 10:57:45.032 INFO  com.job.EbookSnapshotJob                          :32   [32m127967648943312896[0;39m 生成今日电子书快照开始
2021-12-20 10:57:45.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967648943312896[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:45.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967648943312896[0;39m ==> Parameters: 
2021-12-20 10:57:45.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967648943312896[0;39m <==    Updates: 0
2021-12-20 10:57:45.264 INFO  com.job.EbookSnapshotJob                          :35   [32m127967648943312896[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 10:57:50.001 INFO  com.job.EbookSnapshotJob                          :32   [32m127967669784809472[0;39m 生成今日电子书快照开始
2021-12-20 10:57:50.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967669784809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:50.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967669784809472[0;39m ==> Parameters: 
2021-12-20 10:57:50.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967669784809472[0;39m <==    Updates: 0
2021-12-20 10:57:50.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127967669784809472[0;39m 生成今日电子书快照结束，耗时：229毫秒
2021-12-20 10:57:55.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127967690823438336[0;39m 生成今日电子书快照开始
2021-12-20 10:57:55.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967690823438336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:57:55.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967690823438336[0;39m ==> Parameters: 
2021-12-20 10:57:55.280 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967690823438336[0;39m <==    Updates: 0
2021-12-20 10:57:55.280 INFO  com.job.EbookSnapshotJob                          :35   [32m127967690823438336[0;39m 生成今日电子书快照结束，耗时：263毫秒
2021-12-20 10:58:00.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127967711765598208[0;39m 生成今日电子书快照开始
2021-12-20 10:58:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967711765598208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:00.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967711765598208[0;39m ==> Parameters: 
2021-12-20 10:58:00.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967711765598208[0;39m <==    Updates: 0
2021-12-20 10:58:00.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127967711765598208[0;39m 生成今日电子书快照结束，耗时：245毫秒
2021-12-20 10:58:05.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127967732774866944[0;39m 生成今日电子书快照开始
2021-12-20 10:58:05.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967732774866944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:05.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967732774866944[0;39m ==> Parameters: 
2021-12-20 10:58:05.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967732774866944[0;39m <==    Updates: 0
2021-12-20 10:58:05.236 INFO  com.job.EbookSnapshotJob                          :35   [32m127967732774866944[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 10:58:05.236 INFO  com.job.DocJob                                    :32   [32m127967733685030912[0;39m 更新电子书下的文档数据开始
2021-12-20 10:58:05.236 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967733685030912[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:58:05.236 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967733685030912[0;39m ==> Parameters: 
2021-12-20 10:58:05.421 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967733685030912[0;39m <==    Updates: 3
2021-12-20 10:58:05.421 INFO  com.job.DocJob                                    :35   [32m127967733685030912[0;39m 更新电子书下的文档数据结束，耗时：185毫秒
2021-12-20 10:58:10.034 INFO  com.job.EbookSnapshotJob                          :32   [32m127967753809301504[0;39m 生成今日电子书快照开始
2021-12-20 10:58:10.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967753809301504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:10.116 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967753809301504[0;39m ==> Parameters: 
2021-12-20 10:58:10.279 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967753809301504[0;39m <==    Updates: 0
2021-12-20 10:58:10.279 INFO  com.job.EbookSnapshotJob                          :35   [32m127967753809301504[0;39m 生成今日电子书快照结束，耗时：245毫秒
2021-12-20 10:58:15.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127967774734684160[0;39m 生成今日电子书快照开始
2021-12-20 10:58:15.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967774734684160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:15.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967774734684160[0;39m ==> Parameters: 
2021-12-20 10:58:15.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967774734684160[0;39m <==    Updates: 0
2021-12-20 10:58:15.262 INFO  com.job.EbookSnapshotJob                          :35   [32m127967774734684160[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 10:58:20.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127967795634900992[0;39m 生成今日电子书快照开始
2021-12-20 10:58:20.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967795634900992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:20.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967795634900992[0;39m ==> Parameters: 
2021-12-20 10:58:20.285 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967795634900992[0;39m <==    Updates: 0
2021-12-20 10:58:20.285 INFO  com.job.EbookSnapshotJob                          :35   [32m127967795634900992[0;39m 生成今日电子书快照结束，耗时：279毫秒
2021-12-20 10:58:25.021 INFO  com.job.EbookSnapshotJob                          :32   [32m127967816669335552[0;39m 生成今日电子书快照开始
2021-12-20 10:58:25.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967816669335552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:25.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967816669335552[0;39m ==> Parameters: 
2021-12-20 10:58:25.274 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967816669335552[0;39m <==    Updates: 0
2021-12-20 10:58:25.274 INFO  com.job.EbookSnapshotJob                          :35   [32m127967816669335552[0;39m 生成今日电子书快照结束，耗时：253毫秒
2021-12-20 10:58:30.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127967837636661248[0;39m 生成今日电子书快照开始
2021-12-20 10:58:30.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967837636661248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:30.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967837636661248[0;39m ==> Parameters: 
2021-12-20 10:58:30.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967837636661248[0;39m <==    Updates: 0
2021-12-20 10:58:30.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127967837636661248[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 10:58:35.017 INFO  com.job.DocJob                                    :32   [32m127967858595598336[0;39m 更新电子书下的文档数据开始
2021-12-20 10:58:35.089 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967858595598336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:58:35.089 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967858595598336[0;39m ==> Parameters: 
2021-12-20 10:58:35.250 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967858595598336[0;39m <==    Updates: 3
2021-12-20 10:58:35.250 INFO  com.job.DocJob                                    :35   [32m127967858595598336[0;39m 更新电子书下的文档数据结束，耗时：233毫秒
2021-12-20 10:58:35.250 INFO  com.job.EbookSnapshotJob                          :32   [32m127967859572871168[0;39m 生成今日电子书快照开始
2021-12-20 10:58:35.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967859572871168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:35.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967859572871168[0;39m ==> Parameters: 
2021-12-20 10:58:35.418 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967859572871168[0;39m <==    Updates: 0
2021-12-20 10:58:35.433 INFO  com.job.EbookSnapshotJob                          :35   [32m127967859572871168[0;39m 生成今日电子书快照结束，耗时：183毫秒
2021-12-20 10:58:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127967879558729728[0;39m 生成今日电子书快照开始
2021-12-20 10:58:40.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967879558729728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:40.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967879558729728[0;39m ==> Parameters: 
2021-12-20 10:58:40.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967879558729728[0;39m <==    Updates: 0
2021-12-20 10:58:40.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127967879558729728[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-20 10:58:45.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127967900521861120[0;39m 生成今日电子书快照开始
2021-12-20 10:58:45.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967900521861120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:45.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967900521861120[0;39m ==> Parameters: 
2021-12-20 10:58:45.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967900521861120[0;39m <==    Updates: 0
2021-12-20 10:58:45.256 INFO  com.job.EbookSnapshotJob                          :35   [32m127967900521861120[0;39m 生成今日电子书快照结束，耗时：243毫秒
2021-12-20 10:58:50.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127967921510158336[0;39m 生成今日电子书快照开始
2021-12-20 10:58:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967921510158336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967921510158336[0;39m ==> Parameters: 
2021-12-20 10:58:50.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967921510158336[0;39m <==    Updates: 0
2021-12-20 10:58:50.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127967921510158336[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 10:58:55.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127967942473289728[0;39m 生成今日电子书快照开始
2021-12-20 10:58:55.137 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967942473289728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:58:55.139 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967942473289728[0;39m ==> Parameters: 
2021-12-20 10:58:55.301 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967942473289728[0;39m <==    Updates: 0
2021-12-20 10:58:55.301 INFO  com.job.EbookSnapshotJob                          :35   [32m127967942473289728[0;39m 生成今日电子书快照结束，耗时：286毫秒
2021-12-20 10:59:00.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127967963440615424[0;39m 生成今日电子书快照开始
2021-12-20 10:59:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967963440615424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:00.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967963440615424[0;39m ==> Parameters: 
2021-12-20 10:59:00.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967963440615424[0;39m <==    Updates: 0
2021-12-20 10:59:00.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127967963440615424[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 10:59:05.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127967984399552512[0;39m 生成今日电子书快照开始
2021-12-20 10:59:05.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967984399552512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:05.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967984399552512[0;39m ==> Parameters: 
2021-12-20 10:59:05.345 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127967984399552512[0;39m <==    Updates: 0
2021-12-20 10:59:05.346 INFO  com.job.EbookSnapshotJob                          :35   [32m127967984399552512[0;39m 生成今日电子书快照结束，耗时：335毫秒
2021-12-20 10:59:05.347 INFO  com.job.DocJob                                    :32   [32m127967985808838656[0;39m 更新电子书下的文档数据开始
2021-12-20 10:59:05.347 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967985808838656[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:59:05.347 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967985808838656[0;39m ==> Parameters: 
2021-12-20 10:59:05.496 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127967985808838656[0;39m <==    Updates: 3
2021-12-20 10:59:05.496 INFO  com.job.DocJob                                    :35   [32m127967985808838656[0;39m 更新电子书下的文档数据结束，耗时：149毫秒
2021-12-20 10:59:10.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127968005350100992[0;39m 生成今日电子书快照开始
2021-12-20 10:59:10.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968005350100992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:10.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968005350100992[0;39m ==> Parameters: 
2021-12-20 10:59:10.306 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968005350100992[0;39m <==    Updates: 0
2021-12-20 10:59:10.306 INFO  com.job.EbookSnapshotJob                          :35   [32m127968005350100992[0;39m 生成今日电子书快照结束，耗时：300毫秒
2021-12-20 10:59:15.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127968026313232384[0;39m 生成今日电子书快照开始
2021-12-20 10:59:15.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968026313232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:15.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968026313232384[0;39m ==> Parameters: 
2021-12-20 10:59:15.274 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968026313232384[0;39m <==    Updates: 0
2021-12-20 10:59:15.274 INFO  com.job.EbookSnapshotJob                          :35   [32m127968026313232384[0;39m 生成今日电子书快照结束，耗时：270毫秒
2021-12-20 10:59:20.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127968047343472640[0;39m 生成今日电子书快照开始
2021-12-20 10:59:20.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968047343472640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:20.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968047343472640[0;39m ==> Parameters: 
2021-12-20 10:59:20.272 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968047343472640[0;39m <==    Updates: 0
2021-12-20 10:59:20.272 INFO  com.job.EbookSnapshotJob                          :35   [32m127968047343472640[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 10:59:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127968068302409728[0;39m 生成今日电子书快照开始
2021-12-20 10:59:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968068302409728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968068302409728[0;39m ==> Parameters: 
2021-12-20 10:59:25.271 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968068302409728[0;39m <==    Updates: 0
2021-12-20 10:59:25.271 INFO  com.job.EbookSnapshotJob                          :35   [32m127968068302409728[0;39m 生成今日电子书快照结束，耗时：256毫秒
2021-12-20 10:59:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127968089269735424[0;39m 生成今日电子书快照开始
2021-12-20 10:59:30.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968089269735424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:30.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968089269735424[0;39m ==> Parameters: 
2021-12-20 10:59:30.285 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968089269735424[0;39m <==    Updates: 0
2021-12-20 10:59:30.285 INFO  com.job.EbookSnapshotJob                          :35   [32m127968089269735424[0;39m 生成今日电子书快照结束，耗时：271毫秒
2021-12-20 10:59:35.011 INFO  com.job.DocJob                                    :32   [32m127968110228672512[0;39m 更新电子书下的文档数据开始
2021-12-20 10:59:35.112 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968110228672512[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 10:59:35.112 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968110228672512[0;39m ==> Parameters: 
2021-12-20 10:59:35.264 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968110228672512[0;39m <==    Updates: 3
2021-12-20 10:59:35.264 INFO  com.job.DocJob                                    :35   [32m127968110228672512[0;39m 更新电子书下的文档数据结束，耗时：253毫秒
2021-12-20 10:59:35.264 INFO  com.job.EbookSnapshotJob                          :32   [32m127968111289831424[0;39m 生成今日电子书快照开始
2021-12-20 10:59:35.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968111289831424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:35.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968111289831424[0;39m ==> Parameters: 
2021-12-20 10:59:35.422 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968111289831424[0;39m <==    Updates: 0
2021-12-20 10:59:35.422 INFO  com.job.EbookSnapshotJob                          :35   [32m127968111289831424[0;39m 生成今日电子书快照结束，耗时：158毫秒
2021-12-20 10:59:35.694 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：YBjnEYmA7J，session id：1！当前连接数：0
2021-12-20 10:59:40.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127968131195998208[0;39m 生成今日电子书快照开始
2021-12-20 10:59:40.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968131195998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:40.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968131195998208[0;39m ==> Parameters: 
2021-12-20 10:59:40.292 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968131195998208[0;39m <==    Updates: 0
2021-12-20 10:59:40.293 INFO  com.job.EbookSnapshotJob                          :35   [32m127968131195998208[0;39m 生成今日电子书快照结束，耗时：282毫秒
2021-12-20 10:59:45.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127968152180101120[0;39m 生成今日电子书快照开始
2021-12-20 10:59:45.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968152180101120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:45.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968152180101120[0;39m ==> Parameters: 
2021-12-20 10:59:45.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968152180101120[0;39m <==    Updates: 0
2021-12-20 10:59:45.268 INFO  com.job.EbookSnapshotJob                          :35   [32m127968152180101120[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 10:59:50.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127968173113872384[0;39m 生成今日电子书快照开始
2021-12-20 10:59:50.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968173113872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:50.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968173113872384[0;39m ==> Parameters: 
2021-12-20 10:59:50.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968173113872384[0;39m <==    Updates: 0
2021-12-20 10:59:50.242 INFO  com.job.EbookSnapshotJob                          :35   [32m127968173113872384[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-20 10:59:55.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127968194077003776[0;39m 生成今日电子书快照开始
2021-12-20 10:59:55.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968194077003776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 10:59:55.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968194077003776[0;39m ==> Parameters: 
2021-12-20 10:59:55.276 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968194077003776[0;39m <==    Updates: 0
2021-12-20 10:59:55.277 INFO  com.job.EbookSnapshotJob                          :35   [32m127968194077003776[0;39m 生成今日电子书快照结束，耗时：275毫秒
2021-12-20 11:00:00.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127968215065300992[0;39m 生成今日电子书快照开始
2021-12-20 11:00:00.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968215065300992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:00.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968215065300992[0;39m ==> Parameters: 
2021-12-20 11:00:00.277 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968215065300992[0;39m <==    Updates: 0
2021-12-20 11:00:00.279 INFO  com.job.EbookSnapshotJob                          :35   [32m127968215065300992[0;39m 生成今日电子书快照结束，耗时：272毫秒
2021-12-20 11:00:05.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127968236032626688[0;39m 生成今日电子书快照开始
2021-12-20 11:00:05.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968236032626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:05.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968236032626688[0;39m ==> Parameters: 
2021-12-20 11:00:05.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968236032626688[0;39m <==    Updates: 0
2021-12-20 11:00:05.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127968236032626688[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 11:00:05.254 INFO  com.job.DocJob                                    :32   [32m127968237077008384[0;39m 更新电子书下的文档数据开始
2021-12-20 11:00:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968237077008384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:00:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968237077008384[0;39m ==> Parameters: 
2021-12-20 11:00:05.410 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968237077008384[0;39m <==    Updates: 3
2021-12-20 11:00:05.411 INFO  com.job.DocJob                                    :35   [32m127968237077008384[0;39m 更新电子书下的文档数据结束，耗时：157毫秒
2021-12-20 11:00:10.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127968257016729600[0;39m 生成今日电子书快照开始
2021-12-20 11:00:10.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968257016729600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968257016729600[0;39m ==> Parameters: 
2021-12-20 11:00:10.294 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968257016729600[0;39m <==    Updates: 0
2021-12-20 11:00:10.295 INFO  com.job.EbookSnapshotJob                          :35   [32m127968257016729600[0;39m 生成今日电子书快照结束，耗时：286毫秒
2021-12-20 11:00:15.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127968277979860992[0;39m 生成今日电子书快照开始
2021-12-20 11:00:15.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968277979860992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:15.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968277979860992[0;39m ==> Parameters: 
2021-12-20 11:00:15.226 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968277979860992[0;39m <==    Updates: 0
2021-12-20 11:00:15.226 INFO  com.job.EbookSnapshotJob                          :35   [32m127968277979860992[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-20 11:00:20.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127968298984935424[0;39m 生成今日电子书快照开始
2021-12-20 11:00:20.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968298984935424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:20.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968298984935424[0;39m ==> Parameters: 
2021-12-20 11:00:20.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968298984935424[0;39m <==    Updates: 0
2021-12-20 11:00:20.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127968298984935424[0;39m 生成今日电子书快照结束，耗时：230毫秒
2021-12-20 11:00:25.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127968319931289600[0;39m 生成今日电子书快照开始
2021-12-20 11:00:25.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968319931289600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:25.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968319931289600[0;39m ==> Parameters: 
2021-12-20 11:00:25.266 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968319931289600[0;39m <==    Updates: 0
2021-12-20 11:00:25.267 INFO  com.job.EbookSnapshotJob                          :35   [32m127968319931289600[0;39m 生成今日电子书快照结束，耗时：258毫秒
2021-12-20 11:00:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127968340927975424[0;39m 生成今日电子书快照开始
2021-12-20 11:00:30.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968340927975424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:30.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968340927975424[0;39m ==> Parameters: 
2021-12-20 11:00:30.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968340927975424[0;39m <==    Updates: 0
2021-12-20 11:00:30.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127968340927975424[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:00:35.006 INFO  com.job.DocJob                                    :32   [32m127968361865940992[0;39m 更新电子书下的文档数据开始
2021-12-20 11:00:35.090 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968361865940992[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:00:35.091 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968361865940992[0;39m ==> Parameters: 
2021-12-20 11:00:35.253 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968361865940992[0;39m <==    Updates: 3
2021-12-20 11:00:35.253 INFO  com.job.DocJob                                    :35   [32m127968361865940992[0;39m 更新电子书下的文档数据结束，耗时：247毫秒
2021-12-20 11:00:35.253 INFO  com.job.EbookSnapshotJob                          :32   [32m127968362901934080[0;39m 生成今日电子书快照开始
2021-12-20 11:00:35.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968362901934080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:35.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968362901934080[0;39m ==> Parameters: 
2021-12-20 11:00:35.436 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968362901934080[0;39m <==    Updates: 0
2021-12-20 11:00:35.437 INFO  com.job.EbookSnapshotJob                          :35   [32m127968362901934080[0;39m 生成今日电子书快照结束，耗时：183毫秒
2021-12-20 11:00:40.001 INFO  com.job.EbookSnapshotJob                          :32   [32m127968382816489472[0;39m 生成今日电子书快照开始
2021-12-20 11:00:40.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968382816489472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:40.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968382816489472[0;39m ==> Parameters: 
2021-12-20 11:00:40.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968382816489472[0;39m <==    Updates: 0
2021-12-20 11:00:40.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127968382816489472[0;39m 生成今日电子书快照结束，耗时：251毫秒
2021-12-20 11:00:45.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127968403817369600[0;39m 生成今日电子书快照开始
2021-12-20 11:00:45.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968403817369600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:45.106 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968403817369600[0;39m ==> Parameters: 
2021-12-20 11:00:45.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968403817369600[0;39m <==    Updates: 0
2021-12-20 11:00:45.264 INFO  com.job.EbookSnapshotJob                          :35   [32m127968403817369600[0;39m 生成今日电子书快照结束，耗时：255毫秒
2021-12-20 11:00:50.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127968424776306688[0;39m 生成今日电子书快照开始
2021-12-20 11:00:50.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968424776306688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:50.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968424776306688[0;39m ==> Parameters: 
2021-12-20 11:00:50.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968424776306688[0;39m <==    Updates: 0
2021-12-20 11:00:50.268 INFO  com.job.EbookSnapshotJob                          :35   [32m127968424776306688[0;39m 生成今日电子书快照结束，耗时：263毫秒
2021-12-20 11:00:55.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127968445756215296[0;39m 生成今日电子书快照开始
2021-12-20 11:00:55.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968445756215296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:00:55.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968445756215296[0;39m ==> Parameters: 
2021-12-20 11:00:55.282 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968445756215296[0;39m <==    Updates: 0
2021-12-20 11:00:55.283 INFO  com.job.EbookSnapshotJob                          :35   [32m127968445756215296[0;39m 生成今日电子书快照结束，耗时：275毫秒
2021-12-20 11:01:00.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127968466706763776[0;39m 生成今日电子书快照开始
2021-12-20 11:01:00.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968466706763776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:00.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968466706763776[0;39m ==> Parameters: 
2021-12-20 11:01:00.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968466706763776[0;39m <==    Updates: 0
2021-12-20 11:01:00.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127968466706763776[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 11:01:05.008 INFO  com.job.DocJob                                    :32   [32m127968487703449600[0;39m 更新电子书下的文档数据开始
2021-12-20 11:01:05.101 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968487703449600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:01:05.102 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968487703449600[0;39m ==> Parameters: 
2021-12-20 11:01:05.263 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968487703449600[0;39m <==    Updates: 3
2021-12-20 11:01:05.263 INFO  com.job.DocJob                                    :35   [32m127968487703449600[0;39m 更新电子书下的文档数据结束，耗时：255毫秒
2021-12-20 11:01:05.263 INFO  com.job.EbookSnapshotJob                          :32   [32m127968488772997120[0;39m 生成今日电子书快照开始
2021-12-20 11:01:05.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968488772997120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:05.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968488772997120[0;39m ==> Parameters: 
2021-12-20 11:01:05.420 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968488772997120[0;39m <==    Updates: 0
2021-12-20 11:01:05.420 INFO  com.job.EbookSnapshotJob                          :35   [32m127968488772997120[0;39m 生成今日电子书快照结束，耗时：157毫秒
2021-12-20 11:01:10.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127968508683358208[0;39m 生成今日电子书快照开始
2021-12-20 11:01:10.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968508683358208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:10.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968508683358208[0;39m ==> Parameters: 
2021-12-20 11:01:10.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968508683358208[0;39m <==    Updates: 0
2021-12-20 11:01:10.241 INFO  com.job.EbookSnapshotJob                          :35   [32m127968508683358208[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 11:01:15.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127968529621323776[0;39m 生成今日电子书快照开始
2021-12-20 11:01:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968529621323776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968529621323776[0;39m ==> Parameters: 
2021-12-20 11:01:15.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968529621323776[0;39m <==    Updates: 0
2021-12-20 11:01:15.234 INFO  com.job.EbookSnapshotJob                          :35   [32m127968529621323776[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:01:20.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127968550630592512[0;39m 生成今日电子书快照开始
2021-12-20 11:01:20.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968550630592512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:20.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968550630592512[0;39m ==> Parameters: 
2021-12-20 11:01:20.230 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968550630592512[0;39m <==    Updates: 0
2021-12-20 11:01:20.231 INFO  com.job.EbookSnapshotJob                          :35   [32m127968550630592512[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-20 11:01:25.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127968571602112512[0;39m 生成今日电子书快照开始
2021-12-20 11:01:25.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968571602112512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:25.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968571602112512[0;39m ==> Parameters: 
2021-12-20 11:01:25.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968571602112512[0;39m <==    Updates: 0
2021-12-20 11:01:25.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127968571602112512[0;39m 生成今日电子书快照结束，耗时：246毫秒
2021-12-20 11:01:30.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127968592552660992[0;39m 生成今日电子书快照开始
2021-12-20 11:01:30.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968592552660992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:30.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968592552660992[0;39m ==> Parameters: 
2021-12-20 11:01:30.244 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968592552660992[0;39m <==    Updates: 0
2021-12-20 11:01:30.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127968592552660992[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:01:35.004 INFO  com.job.DocJob                                    :32   [32m127968613515792384[0;39m 更新电子书下的文档数据开始
2021-12-20 11:01:35.095 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968613515792384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:01:35.095 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968613515792384[0;39m ==> Parameters: 
2021-12-20 11:01:35.250 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968613515792384[0;39m <==    Updates: 3
2021-12-20 11:01:35.251 INFO  com.job.DocJob                                    :35   [32m127968613515792384[0;39m 更新电子书下的文档数据结束，耗时：246毫秒
2021-12-20 11:01:35.252 INFO  com.job.EbookSnapshotJob                          :32   [32m127968614555979776[0;39m 生成今日电子书快照开始
2021-12-20 11:01:35.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968614555979776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:35.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968614555979776[0;39m ==> Parameters: 
2021-12-20 11:01:35.414 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968614555979776[0;39m <==    Updates: 0
2021-12-20 11:01:35.414 INFO  com.job.EbookSnapshotJob                          :35   [32m127968614555979776[0;39m 生成今日电子书快照结束，耗时：162毫秒
2021-12-20 11:01:40.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127968634508283904[0;39m 生成今日电子书快照开始
2021-12-20 11:01:40.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968634508283904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:40.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968634508283904[0;39m ==> Parameters: 
2021-12-20 11:01:40.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968634508283904[0;39m <==    Updates: 0
2021-12-20 11:01:40.235 INFO  com.job.EbookSnapshotJob                          :35   [32m127968634508283904[0;39m 生成今日电子书快照结束，耗时：226毫秒
2021-12-20 11:01:43.518 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：pvhpfEXZSM，session id：2，当前连接数：1
2021-12-20 11:01:43.660 INFO  com.aspect.LogAspect                              :54   [32m127968649821687808[0;39m ------------- 开始 -------------
2021-12-20 11:01:43.661 INFO  com.aspect.LogAspect                              :55   [32m127968649821687808[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:01:43.661 INFO  com.aspect.LogAspect                              :56   [32m127968649821687808[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:01:43.661 INFO  com.aspect.LogAspect                              :57   [32m127968649821687808[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:01:43.661 INFO  com.aspect.LogAspect                              :80   [32m127968649821687808[0;39m 请求参数: []
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :54   [32m127968649838465025[0;39m ------------- 开始 -------------
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :54   [32m127968649838465024[0;39m ------------- 开始 -------------
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :55   [32m127968649838465024[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :56   [32m127968649838465024[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :55   [32m127968649838465025[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :57   [32m127968649838465024[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:01:43.664 INFO  com.aspect.LogAspect                              :56   [32m127968649838465025[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:01:43.665 INFO  com.aspect.LogAspect                              :57   [32m127968649838465025[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:01:43.665 INFO  com.aspect.LogAspect                              :80   [32m127968649838465024[0;39m 请求参数: []
2021-12-20 11:01:43.665 INFO  com.aspect.LogAspect                              :80   [32m127968649838465025[0;39m 请求参数: []
2021-12-20 11:01:43.747 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127968649821687808[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:01:43.748 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127968649821687808[0;39m ==> Parameters: 
2021-12-20 11:01:43.751 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127968649838465024[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:01:43.752 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127968649838465024[0;39m ==> Parameters: 
2021-12-20 11:01:43.753 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127968649838465025[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:01:43.753 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127968649838465025[0;39m ==> Parameters: 
2021-12-20 11:01:43.829 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127968649821687808[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:01:43.830 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127968649821687808[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:01:43.832 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127968649821687808[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:01:43.834 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127968649821687808[0;39m <==      Total: 2
2021-12-20 11:01:43.834 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:01:43.835 INFO  com.aspect.LogAspect                              :92   [32m127968649821687808[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:01:43.835 INFO  com.aspect.LogAspect                              :93   [32m127968649821687808[0;39m ------------- 结束 耗时：175 ms -------------
2021-12-20 11:01:43.835 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:01:43.837 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:01:43.839 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:01:43.840 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:01:43.841 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:01:43.842 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:01:43.844 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:01:43.845 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127968649838465025[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:01:43.845 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:01:43.846 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:01:43.846 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127968649838465025[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:01:43.847 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:01:43.848 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127968649838465025[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:01:43.849 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:01:43.849 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127968649838465025[0;39m <==      Total: 2
2021-12-20 11:01:43.850 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:01:43.851 INFO  com.aspect.LogAspect                              :92   [32m127968649838465025[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:01:43.851 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:01:43.851 INFO  com.aspect.LogAspect                              :93   [32m127968649838465025[0;39m ------------- 结束 耗时：187 ms -------------
2021-12-20 11:01:43.852 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:01:43.853 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:01:43.854 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:01:43.855 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:01:43.856 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:01:43.857 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127968649838465024[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:01:43.858 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127968649838465024[0;39m <==      Total: 19
2021-12-20 11:01:43.860 INFO  com.aspect.LogAspect                              :92   [32m127968649838465024[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:01:43.860 INFO  com.aspect.LogAspect                              :93   [32m127968649838465024[0;39m ------------- 结束 耗时：196 ms -------------
2021-12-20 11:01:45.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127968655488192512[0;39m 生成今日电子书快照开始
2021-12-20 11:01:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968655488192512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968655488192512[0;39m ==> Parameters: 
2021-12-20 11:01:45.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968655488192512[0;39m <==    Updates: 0
2021-12-20 11:01:45.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127968655488192512[0;39m 生成今日电子书快照结束，耗时：244毫秒
2021-12-20 11:01:50.000 INFO  com.job.EbookSnapshotJob                          :32   [32m127968676413575168[0;39m 生成今日电子书快照开始
2021-12-20 11:01:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968676413575168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968676413575168[0;39m ==> Parameters: 
2021-12-20 11:01:50.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968676413575168[0;39m <==    Updates: 0
2021-12-20 11:01:50.229 INFO  com.job.EbookSnapshotJob                          :35   [32m127968676413575168[0;39m 生成今日电子书快照结束，耗时：228毫秒
2021-12-20 11:01:55.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127968697431232512[0;39m 生成今日电子书快照开始
2021-12-20 11:01:55.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968697431232512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:01:55.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968697431232512[0;39m ==> Parameters: 
2021-12-20 11:01:55.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968697431232512[0;39m <==    Updates: 0
2021-12-20 11:01:55.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127968697431232512[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:02:00.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127968718373392384[0;39m 生成今日电子书快照开始
2021-12-20 11:02:00.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968718373392384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:00.105 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968718373392384[0;39m ==> Parameters: 
2021-12-20 11:02:00.258 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968718373392384[0;39m <==    Updates: 0
2021-12-20 11:02:00.258 INFO  com.job.EbookSnapshotJob                          :35   [32m127968718373392384[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 11:02:05.007 INFO  com.job.DocJob                                    :32   [32m127968739357495296[0;39m 更新电子书下的文档数据开始
2021-12-20 11:02:05.076 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968739357495296[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:02:05.091 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968739357495296[0;39m ==> Parameters: 
2021-12-20 11:02:05.248 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968739357495296[0;39m <==    Updates: 3
2021-12-20 11:02:05.248 INFO  com.job.DocJob                                    :35   [32m127968739357495296[0;39m 更新电子书下的文档数据结束，耗时：241毫秒
2021-12-20 11:02:05.248 INFO  com.job.EbookSnapshotJob                          :32   [32m127968740368322560[0;39m 生成今日电子书快照开始
2021-12-20 11:02:05.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968740368322560[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:05.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968740368322560[0;39m ==> Parameters: 
2021-12-20 11:02:05.402 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968740368322560[0;39m <==    Updates: 0
2021-12-20 11:02:05.402 INFO  com.job.EbookSnapshotJob                          :35   [32m127968740368322560[0;39m 生成今日电子书快照结束，耗时：154毫秒
2021-12-20 11:02:06.738 INFO  com.interceptor.LoginInterceptor                  :29   [32m127967313680011265[0;39m ------------- LoginInterceptor 开始 -------------
2021-12-20 11:02:06.738 INFO  com.interceptor.LoginInterceptor                  :40   [32m127967313680011265[0;39m 接口登录拦截：，path：http://localhost:8081/user/save
2021-12-20 11:02:06.738 INFO  com.interceptor.LoginInterceptor                  :44   [32m127967313680011265[0;39m 登录校验开始，token：null
2021-12-20 11:02:06.738 INFO  com.interceptor.LoginInterceptor                  :46   [32m127967313680011265[0;39m token为空，请求被拦截
2021-12-20 11:02:10.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127968760370958336[0;39m 生成今日电子书快照开始
2021-12-20 11:02:10.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968760370958336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:10.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968760370958336[0;39m ==> Parameters: 
2021-12-20 11:02:10.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968760370958336[0;39m <==    Updates: 0
2021-12-20 11:02:10.265 INFO  com.job.EbookSnapshotJob                          :35   [32m127968760370958336[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 11:02:15.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127968781300535296[0;39m 生成今日电子书快照开始
2021-12-20 11:02:15.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968781300535296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:15.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968781300535296[0;39m ==> Parameters: 
2021-12-20 11:02:15.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968781300535296[0;39m <==    Updates: 0
2021-12-20 11:02:15.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127968781300535296[0;39m 生成今日电子书快照结束，耗时：249毫秒
2021-12-20 11:02:20.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127968802309804032[0;39m 生成今日电子书快照开始
2021-12-20 11:02:20.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968802309804032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:20.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968802309804032[0;39m ==> Parameters: 
2021-12-20 11:02:20.268 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968802309804032[0;39m <==    Updates: 0
2021-12-20 11:02:20.269 INFO  com.job.EbookSnapshotJob                          :35   [32m127968802309804032[0;39m 生成今日电子书快照结束，耗时：252毫秒
2021-12-20 11:02:21.182 INFO  com.websocket.WebSocketServer                     :41   [32m127967026185637889[0;39m 连接关闭，token：pvhpfEXZSM，session id：2！当前连接数：0
2021-12-20 11:02:25.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127968823226798080[0;39m 生成今日电子书快照开始
2021-12-20 11:02:25.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968823226798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:25.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968823226798080[0;39m ==> Parameters: 
2021-12-20 11:02:25.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968823226798080[0;39m <==    Updates: 0
2021-12-20 11:02:25.243 INFO  com.job.EbookSnapshotJob                          :35   [32m127968823226798080[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:02:30.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127968844257038336[0;39m 生成今日电子书快照开始
2021-12-20 11:02:30.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968844257038336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:30.101 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968844257038336[0;39m ==> Parameters: 
2021-12-20 11:02:30.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968844257038336[0;39m <==    Updates: 0
2021-12-20 11:02:30.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127968844257038336[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:02:35.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127968865211781120[0;39m 生成今日电子书快照开始
2021-12-20 11:02:35.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968865211781120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:35.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968865211781120[0;39m ==> Parameters: 
2021-12-20 11:02:35.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968865211781120[0;39m <==    Updates: 0
2021-12-20 11:02:35.267 INFO  com.job.EbookSnapshotJob                          :35   [32m127968865211781120[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 11:02:35.267 INFO  com.job.DocJob                                    :32   [32m127968866277134336[0;39m 更新电子书下的文档数据开始
2021-12-20 11:02:35.267 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968866277134336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:02:35.267 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968866277134336[0;39m ==> Parameters: 
2021-12-20 11:02:35.452 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968866277134336[0;39m <==    Updates: 3
2021-12-20 11:02:35.452 INFO  com.job.DocJob                                    :35   [32m127968866277134336[0;39m 更新电子书下的文档数据结束，耗时：185毫秒
2021-12-20 11:02:40.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127968886174912512[0;39m 生成今日电子书快照开始
2021-12-20 11:02:40.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968886174912512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:40.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968886174912512[0;39m ==> Parameters: 
2021-12-20 11:02:40.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968886174912512[0;39m <==    Updates: 0
2021-12-20 11:02:40.227 INFO  com.job.EbookSnapshotJob                          :35   [32m127968886174912512[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:02:45.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127968907167404032[0;39m 生成今日电子书快照开始
2021-12-20 11:02:45.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968907167404032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:45.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968907167404032[0;39m ==> Parameters: 
2021-12-20 11:02:45.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968907167404032[0;39m <==    Updates: 0
2021-12-20 11:02:45.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127968907167404032[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:02:50.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127968928122146816[0;39m 生成今日电子书快照开始
2021-12-20 11:02:50.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968928122146816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:50.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968928122146816[0;39m ==> Parameters: 
2021-12-20 11:02:50.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968928122146816[0;39m <==    Updates: 0
2021-12-20 11:02:50.229 INFO  com.job.EbookSnapshotJob                          :35   [32m127968928122146816[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:02:55.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127968949093666816[0;39m 生成今日电子书快照开始
2021-12-20 11:02:55.112 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968949093666816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:02:55.112 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968949093666816[0;39m ==> Parameters: 
2021-12-20 11:02:55.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968949093666816[0;39m <==    Updates: 0
2021-12-20 11:02:55.265 INFO  com.job.EbookSnapshotJob                          :35   [32m127968949093666816[0;39m 生成今日电子书快照结束，耗时：253毫秒
2021-12-20 11:03:00.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127968970052603904[0;39m 生成今日电子书快照开始
2021-12-20 11:03:00.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968970052603904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:00.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968970052603904[0;39m ==> Parameters: 
2021-12-20 11:03:00.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968970052603904[0;39m <==    Updates: 0
2021-12-20 11:03:00.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127968970052603904[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 11:03:05.006 INFO  com.job.EbookSnapshotJob                          :32   [32m127968991011540992[0;39m 生成今日电子书快照开始
2021-12-20 11:03:05.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968991011540992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:05.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968991011540992[0;39m ==> Parameters: 
2021-12-20 11:03:05.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127968991011540992[0;39m <==    Updates: 0
2021-12-20 11:03:05.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127968991011540992[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 11:03:05.254 INFO  com.job.DocJob                                    :32   [32m127968992051728384[0;39m 更新电子书下的文档数据开始
2021-12-20 11:03:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968992051728384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:03:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968992051728384[0;39m ==> Parameters: 
2021-12-20 11:03:05.470 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127968992051728384[0;39m <==    Updates: 3
2021-12-20 11:03:05.470 INFO  com.job.DocJob                                    :35   [32m127968992051728384[0;39m 更新电子书下的文档数据结束，耗时：216毫秒
2021-12-20 11:03:10.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127969012041781248[0;39m 生成今日电子书快照开始
2021-12-20 11:03:10.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969012041781248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:10.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969012041781248[0;39m ==> Parameters: 
2021-12-20 11:03:10.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969012041781248[0;39m <==    Updates: 0
2021-12-20 11:03:10.253 INFO  com.job.EbookSnapshotJob                          :35   [32m127969012041781248[0;39m 生成今日电子书快照结束，耗时：233毫秒
2021-12-20 11:03:15.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127969032979746816[0;39m 生成今日电子书快照开始
2021-12-20 11:03:15.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969032979746816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:15.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969032979746816[0;39m ==> Parameters: 
2021-12-20 11:03:15.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969032979746816[0;39m <==    Updates: 0
2021-12-20 11:03:15.234 INFO  com.job.EbookSnapshotJob                          :35   [32m127969032979746816[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-20 11:03:20.028 INFO  com.job.EbookSnapshotJob                          :32   [32m127969054018375680[0;39m 生成今日电子书快照开始
2021-12-20 11:03:20.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969054018375680[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:20.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969054018375680[0;39m ==> Parameters: 
2021-12-20 11:03:20.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969054018375680[0;39m <==    Updates: 0
2021-12-20 11:03:20.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127969054018375680[0;39m 生成今日电子书快照结束，耗时：221毫秒
2021-12-20 11:03:25.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127969074968924160[0;39m 生成今日电子书快照开始
2021-12-20 11:03:25.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969074968924160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:25.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969074968924160[0;39m ==> Parameters: 
2021-12-20 11:03:25.262 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969074968924160[0;39m <==    Updates: 0
2021-12-20 11:03:25.278 INFO  com.job.EbookSnapshotJob                          :35   [32m127969074968924160[0;39m 生成今日电子书快照结束，耗时：255毫秒
2021-12-20 11:03:30.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127969095873335296[0;39m 生成今日电子书快照开始
2021-12-20 11:03:30.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969095873335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:30.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969095873335296[0;39m ==> Parameters: 
2021-12-20 11:03:30.224 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969095873335296[0;39m <==    Updates: 0
2021-12-20 11:03:30.224 INFO  com.job.EbookSnapshotJob                          :35   [32m127969095873335296[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:03:35.016 INFO  com.job.DocJob                                    :32   [32m127969116882604032[0;39m 更新电子书下的文档数据开始
2021-12-20 11:03:35.079 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969116882604032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:03:35.079 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969116882604032[0;39m ==> Parameters: 
2021-12-20 11:03:35.233 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969116882604032[0;39m <==    Updates: 3
2021-12-20 11:03:35.233 INFO  com.job.DocJob                                    :35   [32m127969116882604032[0;39m 更新电子书下的文档数据结束，耗时：217毫秒
2021-12-20 11:03:35.233 INFO  com.job.EbookSnapshotJob                          :32   [32m127969117792768000[0;39m 生成今日电子书快照开始
2021-12-20 11:03:35.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969117792768000[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:35.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969117792768000[0;39m ==> Parameters: 
2021-12-20 11:03:35.418 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969117792768000[0;39m <==    Updates: 0
2021-12-20 11:03:35.418 INFO  com.job.EbookSnapshotJob                          :35   [32m127969117792768000[0;39m 生成今日电子书快照结束，耗时：185毫秒
2021-12-20 11:03:40.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127969137837346816[0;39m 生成今日电子书快照开始
2021-12-20 11:03:40.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969137837346816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:40.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969137837346816[0;39m ==> Parameters: 
2021-12-20 11:03:40.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969137837346816[0;39m <==    Updates: 0
2021-12-20 11:03:40.250 INFO  com.job.EbookSnapshotJob                          :35   [32m127969137837346816[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:03:45.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127969158863392768[0;39m 生成今日电子书快照开始
2021-12-20 11:03:45.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969158863392768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:45.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969158863392768[0;39m ==> Parameters: 
2021-12-20 11:03:45.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969158863392768[0;39m <==    Updates: 0
2021-12-20 11:03:45.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127969158863392768[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-20 11:03:50.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127969179751026688[0;39m 生成今日电子书快照开始
2021-12-20 11:03:50.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969179751026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:50.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969179751026688[0;39m ==> Parameters: 
2021-12-20 11:03:50.290 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969179751026688[0;39m <==    Updates: 0
2021-12-20 11:03:50.290 INFO  com.job.EbookSnapshotJob                          :35   [32m127969179751026688[0;39m 生成今日电子书快照结束，耗时：285毫秒
2021-12-20 11:03:55.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127969200768684032[0;39m 生成今日电子书快照开始
2021-12-20 11:03:55.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969200768684032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:03:55.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969200768684032[0;39m ==> Parameters: 
2021-12-20 11:03:55.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969200768684032[0;39m <==    Updates: 0
2021-12-20 11:03:55.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127969200768684032[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:04:00.029 INFO  com.job.EbookSnapshotJob                          :32   [32m127969221794729984[0;39m 生成今日电子书快照开始
2021-12-20 11:04:00.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969221794729984[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:00.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969221794729984[0;39m ==> Parameters: 
2021-12-20 11:04:00.261 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969221794729984[0;39m <==    Updates: 0
2021-12-20 11:04:00.261 INFO  com.job.EbookSnapshotJob                          :35   [32m127969221794729984[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:04:05.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127969242673975296[0;39m 生成今日电子书快照开始
2021-12-20 11:04:05.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969242673975296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:05.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969242673975296[0;39m ==> Parameters: 
2021-12-20 11:04:05.335 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969242673975296[0;39m <==    Updates: 0
2021-12-20 11:04:05.335 INFO  com.job.EbookSnapshotJob                          :35   [32m127969242673975296[0;39m 生成今日电子书快照结束，耗时：328毫秒
2021-12-20 11:04:05.335 INFO  com.job.DocJob                                    :32   [32m127969244049707008[0;39m 更新电子书下的文档数据开始
2021-12-20 11:04:05.335 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969244049707008[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:04:05.335 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969244049707008[0;39m ==> Parameters: 
2021-12-20 11:04:05.486 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969244049707008[0;39m <==    Updates: 3
2021-12-20 11:04:05.486 INFO  com.job.DocJob                                    :35   [32m127969244049707008[0;39m 更新电子书下的文档数据结束，耗时：151毫秒
2021-12-20 11:04:10.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127969263670661120[0;39m 生成今日电子书快照开始
2021-12-20 11:04:10.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969263670661120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:10.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969263670661120[0;39m ==> Parameters: 
2021-12-20 11:04:10.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969263670661120[0;39m <==    Updates: 0
2021-12-20 11:04:10.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127969263670661120[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-20 11:04:15.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127969284642181120[0;39m 生成今日电子书快照开始
2021-12-20 11:04:15.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969284642181120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:15.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969284642181120[0;39m ==> Parameters: 
2021-12-20 11:04:15.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969284642181120[0;39m <==    Updates: 0
2021-12-20 11:04:15.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127969284642181120[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 11:04:20.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127969305605312512[0;39m 生成今日电子书快照开始
2021-12-20 11:04:20.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969305605312512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:20.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969305605312512[0;39m ==> Parameters: 
2021-12-20 11:04:20.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969305605312512[0;39m <==    Updates: 0
2021-12-20 11:04:20.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127969305605312512[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:04:25.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127969326597804032[0;39m 生成今日电子书快照开始
2021-12-20 11:04:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969326597804032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969326597804032[0;39m ==> Parameters: 
2021-12-20 11:04:25.280 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969326597804032[0;39m <==    Updates: 0
2021-12-20 11:04:25.280 INFO  com.job.EbookSnapshotJob                          :35   [32m127969326597804032[0;39m 生成今日电子书快照结束，耗时：264毫秒
2021-12-20 11:04:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127969347560935424[0;39m 生成今日电子书快照开始
2021-12-20 11:04:30.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969347560935424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:30.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969347560935424[0;39m ==> Parameters: 
2021-12-20 11:04:30.380 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969347560935424[0;39m <==    Updates: 0
2021-12-20 11:04:30.380 INFO  com.job.EbookSnapshotJob                          :35   [32m127969347560935424[0;39m 生成今日电子书快照结束，耗时：366毫秒
2021-12-20 11:04:33.115 INFO  com.zaxxer.hikari.HikariDataSource                :350  [32m                  [0;39m HikariPool-1 - Shutdown initiated...
2021-12-20 11:04:33.166 INFO  com.zaxxer.hikari.HikariDataSource                :352  [32m                  [0;39m HikariPool-1 - Shutdown completed.
2021-12-20 11:04:33.366 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 3224 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-20 11:04:33.366 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-20 11:04:34.665 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-20 11:04:34.665 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-20 11:04:35.496 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 822 ms. Found 0 Redis repository interfaces.
2021-12-20 11:04:35.738 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-20 11:04:35.738 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-20 11:04:35.738 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-20 11:04:35.738 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-20 11:04:35.778 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-20 11:04:35.778 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2396 ms
2021-12-20 11:04:36.628 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-20 11:04:36.643 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-20 11:04:36.643 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-20 11:04:36.643 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 3.34 seconds (JVM running for 589.575)
2021-12-20 11:04:36.643 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2021-12-20 11:04:39.247 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 3224 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-20 11:04:39.247 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-20 11:04:40.384 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-20 11:04:40.384 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-20 11:04:40.785 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 397 ms. Found 0 Redis repository interfaces.
2021-12-20 11:04:40.901 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-20 11:04:40.917 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-20 11:04:40.917 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-20 11:04:40.917 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-20 11:04:40.917 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-20 11:04:40.917 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1670 ms
2021-12-20 11:04:41.533 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-20 11:04:41.533 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-20 11:04:41.533 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-20 11:04:41.549 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 2.344 seconds (JVM running for 594.47)
2021-12-20 11:04:41.549 INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener :63   [32m                  [0;39m Condition evaluation unchanged
2021-12-20 11:04:45.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127969410475495424[0;39m 生成今日电子书快照开始
2021-12-20 11:04:45.014 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m127969410475495424[0;39m HikariPool-2 - Starting...
2021-12-20 11:04:45.815 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m127969410475495424[0;39m HikariPool-2 - Start completed.
2021-12-20 11:04:45.831 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969410475495424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:45.831 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969410475495424[0;39m ==> Parameters: 
2021-12-20 11:04:45.982 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969410475495424[0;39m <==    Updates: 0
2021-12-20 11:04:45.982 INFO  com.job.EbookSnapshotJob                          :35   [32m127969410475495424[0;39m 生成今日电子书快照结束，耗时：968毫秒
2021-12-20 11:04:50.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127969431501541376[0;39m 生成今日电子书快照开始
2021-12-20 11:04:50.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969431501541376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:50.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969431501541376[0;39m ==> Parameters: 
2021-12-20 11:04:50.228 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969431501541376[0;39m <==    Updates: 0
2021-12-20 11:04:50.228 INFO  com.job.EbookSnapshotJob                          :35   [32m127969431501541376[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:04:55.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127969452439506944[0;39m 生成今日电子书快照开始
2021-12-20 11:04:55.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969452439506944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:04:55.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969452439506944[0;39m ==> Parameters: 
2021-12-20 11:04:55.225 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969452439506944[0;39m <==    Updates: 0
2021-12-20 11:04:55.225 INFO  com.job.EbookSnapshotJob                          :35   [32m127969452439506944[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-20 11:05:00.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127969473398444032[0;39m 生成今日电子书快照开始
2021-12-20 11:05:00.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969473398444032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:00.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969473398444032[0;39m ==> Parameters: 
2021-12-20 11:05:00.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969473398444032[0;39m <==    Updates: 0
2021-12-20 11:05:00.256 INFO  com.job.EbookSnapshotJob                          :35   [32m127969473398444032[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:05:05.016 INFO  com.job.DocJob                                    :32   [32m127969494369964032[0;39m 更新电子书下的文档数据开始
2021-12-20 11:05:05.085 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969494369964032[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:05:05.085 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969494369964032[0;39m ==> Parameters: 
2021-12-20 11:05:05.217 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969494369964032[0;39m <==    Updates: 3
2021-12-20 11:05:05.217 INFO  com.job.DocJob                                    :35   [32m127969494369964032[0;39m 更新电子书下的文档数据结束，耗时：201毫秒
2021-12-20 11:05:05.217 INFO  com.job.EbookSnapshotJob                          :32   [32m127969495213019136[0;39m 生成今日电子书快照开始
2021-12-20 11:05:05.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969495213019136[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:05.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969495213019136[0;39m ==> Parameters: 
2021-12-20 11:05:05.401 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969495213019136[0;39m <==    Updates: 0
2021-12-20 11:05:05.417 INFO  com.job.EbookSnapshotJob                          :35   [32m127969495213019136[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:05:10.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127969515295346688[0;39m 生成今日电子书快照开始
2021-12-20 11:05:10.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969515295346688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:10.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969515295346688[0;39m ==> Parameters: 
2021-12-20 11:05:10.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969515295346688[0;39m <==    Updates: 0
2021-12-20 11:05:10.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127969515295346688[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:05:15.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127969536292032512[0;39m 生成今日电子书快照开始
2021-12-20 11:05:15.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969536292032512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:15.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969536292032512[0;39m ==> Parameters: 
2021-12-20 11:05:15.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969536292032512[0;39m <==    Updates: 0
2021-12-20 11:05:15.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127969536292032512[0;39m 生成今日电子书快照结束，耗时：241毫秒
2021-12-20 11:05:20.024 INFO  com.job.EbookSnapshotJob                          :32   [32m127969557318078464[0;39m 生成今日电子书快照开始
2021-12-20 11:05:20.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969557318078464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:20.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969557318078464[0;39m ==> Parameters: 
2021-12-20 11:05:20.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969557318078464[0;39m <==    Updates: 0
2021-12-20 11:05:20.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127969557318078464[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:05:25.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127969578281209856[0;39m 生成今日电子书快照开始
2021-12-20 11:05:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969578281209856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:25.099 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969578281209856[0;39m ==> Parameters: 
2021-12-20 11:05:25.238 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969578281209856[0;39m <==    Updates: 0
2021-12-20 11:05:25.238 INFO  com.job.EbookSnapshotJob                          :35   [32m127969578281209856[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:05:30.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127969599273701376[0;39m 生成今日电子书快照开始
2021-12-20 11:05:30.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969599273701376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:30.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969599273701376[0;39m ==> Parameters: 
2021-12-20 11:05:30.244 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969599273701376[0;39m <==    Updates: 0
2021-12-20 11:05:30.244 INFO  com.job.EbookSnapshotJob                          :35   [32m127969599273701376[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:05:35.017 INFO  com.job.DocJob                                    :32   [32m127969620203278336[0;39m 更新电子书下的文档数据开始
2021-12-20 11:05:35.102 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969620203278336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:05:35.102 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969620203278336[0;39m ==> Parameters: 
2021-12-20 11:05:35.267 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969620203278336[0;39m <==    Updates: 3
2021-12-20 11:05:35.267 INFO  com.job.DocJob                                    :35   [32m127969620203278336[0;39m 更新电子书下的文档数据结束，耗时：250毫秒
2021-12-20 11:05:35.267 INFO  com.job.EbookSnapshotJob                          :32   [32m127969621251854336[0;39m 生成今日电子书快照开始
2021-12-20 11:05:35.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969621251854336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:35.267 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969621251854336[0;39m ==> Parameters: 
2021-12-20 11:05:35.434 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969621251854336[0;39m <==    Updates: 0
2021-12-20 11:05:35.434 INFO  com.job.EbookSnapshotJob                          :35   [32m127969621251854336[0;39m 生成今日电子书快照结束，耗时：167毫秒
2021-12-20 11:05:40.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127969641158021120[0;39m 生成今日电子书快照开始
2021-12-20 11:05:40.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969641158021120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:40.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969641158021120[0;39m ==> Parameters: 
2021-12-20 11:05:40.244 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969641158021120[0;39m <==    Updates: 0
2021-12-20 11:05:40.244 INFO  com.job.EbookSnapshotJob                          :35   [32m127969641158021120[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 11:05:41.836 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-20 11:05:41.836 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-20 11:05:41.837 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-20 11:05:41.839 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：kjVcEVWzkv，session id：3，当前连接数：1
2021-12-20 11:05:41.989 INFO  com.aspect.LogAspect                              :54   [32m127969649441771520[0;39m ------------- 开始 -------------
2021-12-20 11:05:41.989 INFO  com.aspect.LogAspect                              :55   [32m127969649441771520[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:05:41.989 INFO  com.aspect.LogAspect                              :56   [32m127969649441771520[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:05:41.989 INFO  com.aspect.LogAspect                              :57   [32m127969649441771520[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:05:41.991 INFO  com.aspect.LogAspect                              :80   [32m127969649441771520[0;39m 请求参数: []
2021-12-20 11:05:41.995 INFO  com.aspect.LogAspect                              :54   [32m127969649471131648[0;39m ------------- 开始 -------------
2021-12-20 11:05:41.996 INFO  com.aspect.LogAspect                              :55   [32m127969649471131648[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:05:41.997 INFO  com.aspect.LogAspect                              :56   [32m127969649471131648[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:05:41.997 INFO  com.aspect.LogAspect                              :57   [32m127969649471131648[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:05:41.998 INFO  com.aspect.LogAspect                              :80   [32m127969649471131648[0;39m 请求参数: []
2021-12-20 11:05:41.999 INFO  com.aspect.LogAspect                              :54   [32m127969649487908864[0;39m ------------- 开始 -------------
2021-12-20 11:05:42.000 INFO  com.aspect.LogAspect                              :55   [32m127969649487908864[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:05:42.000 INFO  com.aspect.LogAspect                              :56   [32m127969649487908864[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:05:42.000 INFO  com.aspect.LogAspect                              :57   [32m127969649487908864[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:05:42.000 INFO  com.aspect.LogAspect                              :80   [32m127969649487908864[0;39m 请求参数: []
2021-12-20 11:05:42.075 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969649471131648[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:05:42.075 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969649441771520[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:05:42.075 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969649441771520[0;39m ==> Parameters: 
2021-12-20 11:05:42.075 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969649471131648[0;39m ==> Parameters: 
2021-12-20 11:05:42.077 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969649487908864[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:05:42.078 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969649487908864[0;39m ==> Parameters: 
2021-12-20 11:05:42.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:05:42.237 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:05:42.238 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:05:42.238 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969649441771520[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:05:42.238 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969649471131648[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:05:42.239 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:05:42.239 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969649471131648[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:05:42.239 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969649441771520[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:05:42.240 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:05:42.240 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:05:42.241 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:05:42.242 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969649471131648[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:05:42.242 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969649441771520[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:05:42.242 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:05:42.243 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969649471131648[0;39m <==      Total: 2
2021-12-20 11:05:42.243 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:05:42.244 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969649441771520[0;39m <==      Total: 2
2021-12-20 11:05:42.244 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:05:42.245 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:05:42.248 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:05:42.250 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:05:42.251 INFO  com.aspect.LogAspect                              :92   [32m127969649471131648[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:05:42.251 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:05:42.252 INFO  com.aspect.LogAspect                              :93   [32m127969649471131648[0;39m ------------- 结束 耗时：257 ms -------------
2021-12-20 11:05:42.252 INFO  com.aspect.LogAspect                              :92   [32m127969649441771520[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:05:42.253 INFO  com.aspect.LogAspect                              :93   [32m127969649441771520[0;39m ------------- 结束 耗时：265 ms -------------
2021-12-20 11:05:42.253 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:05:42.254 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:05:42.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:05:42.260 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:05:42.261 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:05:42.262 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969649487908864[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:05:42.263 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969649487908864[0;39m <==      Total: 19
2021-12-20 11:05:42.281 INFO  com.aspect.LogAspect                              :92   [32m127969649487908864[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:05:42.281 INFO  com.aspect.LogAspect                              :93   [32m127969649487908864[0;39m ------------- 结束 耗时：282 ms -------------
2021-12-20 11:05:45.024 INFO  com.job.EbookSnapshotJob                          :32   [32m127969662175678464[0;39m 生成今日电子书快照开始
2021-12-20 11:05:45.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969662175678464[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:45.110 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969662175678464[0;39m ==> Parameters: 
2021-12-20 11:05:45.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969662175678464[0;39m <==    Updates: 0
2021-12-20 11:05:45.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127969662175678464[0;39m 生成今日电子书快照结束，耗时：233毫秒
2021-12-20 11:05:50.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127969683143004160[0;39m 生成今日电子书快照开始
2021-12-20 11:05:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969683143004160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969683143004160[0;39m ==> Parameters: 
2021-12-20 11:05:50.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969683143004160[0;39m <==    Updates: 0
2021-12-20 11:05:50.256 INFO  com.job.EbookSnapshotJob                          :35   [32m127969683143004160[0;39m 生成今日电子书快照结束，耗时：233毫秒
2021-12-20 11:05:55.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127969704076775424[0;39m 生成今日电子书快照开始
2021-12-20 11:05:55.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969704076775424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:05:55.102 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969704076775424[0;39m ==> Parameters: 
2021-12-20 11:05:55.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969704076775424[0;39m <==    Updates: 0
2021-12-20 11:05:55.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127969704076775424[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-20 11:05:56.327 INFO  com.aspect.LogAspect                              :54   [32m127969709583896576[0;39m ------------- 开始 -------------
2021-12-20 11:05:56.327 INFO  com.aspect.LogAspect                              :55   [32m127969709583896576[0;39m 请求地址: http://localhost:8081/user/save POST
2021-12-20 11:05:56.328 INFO  com.aspect.LogAspect                              :56   [32m127969709583896576[0;39m 类名方法: com.controller.UserController.save
2021-12-20 11:05:56.328 INFO  com.aspect.LogAspect                              :57   [32m127969709583896576[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:05:56.328 INFO  com.aspect.LogAspect                              :80   [32m127969709583896576[0;39m 请求参数: [{"loginName":"test12345","name":"12345"}]
2021-12-20 11:05:56.424 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969709583896576[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:05:56.424 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969709583896576[0;39m ==> Parameters: test12345(String)
2021-12-20 11:05:56.505 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969709583896576[0;39m <==      Total: 0
2021-12-20 11:05:56.506 DEBUG com.mapper.UserMapper.insert                      :137  [32m127969709583896576[0;39m ==>  Preparing: insert into user (id, login_name, `name`, `password`) values (?, ?, ?, ?)
2021-12-20 11:05:56.507 DEBUG com.mapper.UserMapper.insert                      :137  [32m127969709583896576[0;39m ==> Parameters: 127969710334676992(Long), test12345(String), 12345(String), cc03e747a6afbbcbf8be7668acfebee5(String)
2021-12-20 11:05:56.665 DEBUG com.mapper.UserMapper.insert                      :137  [32m127969709583896576[0;39m <==    Updates: 1
2021-12-20 11:05:56.666 INFO  com.aspect.LogAspect                              :92   [32m127969709583896576[0;39m 返回结果: {"success":true}
2021-12-20 11:05:56.667 INFO  com.aspect.LogAspect                              :93   [32m127969709583896576[0;39m ------------- 结束 耗时：340 ms -------------
2021-12-20 11:06:00.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127969725006352384[0;39m 生成今日电子书快照开始
2021-12-20 11:06:00.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969725006352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:00.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969725006352384[0;39m ==> Parameters: 
2021-12-20 11:06:00.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969725006352384[0;39m <==    Updates: 0
2021-12-20 11:06:00.214 INFO  com.job.EbookSnapshotJob                          :35   [32m127969725006352384[0;39m 生成今日电子书快照结束，耗时：209毫秒
2021-12-20 11:06:05.017 INFO  com.job.DocJob                                    :32   [32m127969746032398336[0;39m 更新电子书下的文档数据开始
2021-12-20 11:06:05.077 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969746032398336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:06:05.077 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969746032398336[0;39m ==> Parameters: 
2021-12-20 11:06:05.250 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969746032398336[0;39m <==    Updates: 3
2021-12-20 11:06:05.251 INFO  com.job.DocJob                                    :35   [32m127969746032398336[0;39m 更新电子书下的文档数据结束，耗时：234毫秒
2021-12-20 11:06:05.252 INFO  com.job.EbookSnapshotJob                          :32   [32m127969747018059776[0;39m 生成今日电子书快照开始
2021-12-20 11:06:05.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969747018059776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:05.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969747018059776[0;39m ==> Parameters: 
2021-12-20 11:06:05.407 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969747018059776[0;39m <==    Updates: 0
2021-12-20 11:06:05.407 INFO  com.job.EbookSnapshotJob                          :35   [32m127969747018059776[0;39m 生成今日电子书快照结束，耗时：155毫秒
2021-12-20 11:06:06.879 INFO  com.aspect.LogAspect                              :54   [32m127969753842192384[0;39m ------------- 开始 -------------
2021-12-20 11:06:06.879 INFO  com.aspect.LogAspect                              :55   [32m127969753842192384[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:06:06.880 INFO  com.aspect.LogAspect                              :56   [32m127969753842192384[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:06:06.881 INFO  com.aspect.LogAspect                              :57   [32m127969753842192384[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:06.881 INFO  com.aspect.LogAspect                              :80   [32m127969753842192384[0;39m 请求参数: [{"loginName":"test12345"}]
2021-12-20 11:06:06.957 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969753842192384[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:06:06.959 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969753842192384[0;39m ==> Parameters: test12345(String)
2021-12-20 11:06:07.039 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969753842192384[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:06:07.040 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969753842192384[0;39m <==        Row: 127969710334676992, test12345, 12345, cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:06:07.041 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969753842192384[0;39m <==      Total: 1
2021-12-20 11:06:07.043 INFO  com.servicess.UserService                         :144  [32m127969753842192384[0;39m 密码不对，输入密码：7354a1d413535a6c0dc5c209e198d799，数据库密码：cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:06:07.051 WARN  com.controller.ControllerExceptionHandler         :44   [32m127969753842192384[0;39m 业务异常：用户名不存在或密码错误
2021-12-20 11:06:07.055 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m127969753842192384[0;39m Resolved [com.exception.BusinessException: 用户名不存在或密码错误]
2021-12-20 11:06:10.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127969766953586688[0;39m 生成今日电子书快照开始
2021-12-20 11:06:10.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969766953586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:10.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969766953586688[0;39m ==> Parameters: 
2021-12-20 11:06:10.242 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969766953586688[0;39m <==    Updates: 0
2021-12-20 11:06:10.243 INFO  com.job.EbookSnapshotJob                          :35   [32m127969766953586688[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:06:14.965 INFO  com.aspect.LogAspect                              :54   [32m127969787757334528[0;39m ------------- 开始 -------------
2021-12-20 11:06:14.966 INFO  com.aspect.LogAspect                              :55   [32m127969787757334528[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:06:14.968 INFO  com.aspect.LogAspect                              :56   [32m127969787757334528[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:06:14.968 INFO  com.aspect.LogAspect                              :57   [32m127969787757334528[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:14.968 INFO  com.aspect.LogAspect                              :80   [32m127969787757334528[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-20 11:06:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127969787971244032[0;39m 生成今日电子书快照开始
2021-12-20 11:06:15.049 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969787757334528[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:06:15.049 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969787757334528[0;39m ==> Parameters: test123(String)
2021-12-20 11:06:15.112 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969787971244032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:15.113 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969787971244032[0;39m ==> Parameters: 
2021-12-20 11:06:15.128 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969787757334528[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:06:15.129 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969787757334528[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:06:15.129 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969787757334528[0;39m <==      Total: 1
2021-12-20 11:06:15.130 INFO  com.servicess.UserService                         :144  [32m127969787757334528[0;39m 密码不对，输入密码：3238368c42416797d05be704a84cf6c0，数据库密码：7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:06:15.130 WARN  com.controller.ControllerExceptionHandler         :44   [32m127969787757334528[0;39m 业务异常：用户名不存在或密码错误
2021-12-20 11:06:15.132 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m127969787757334528[0;39m Resolved [com.exception.BusinessException: 用户名不存在或密码错误]
2021-12-20 11:06:15.265 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969787971244032[0;39m <==    Updates: 0
2021-12-20 11:06:15.266 INFO  com.job.EbookSnapshotJob                          :35   [32m127969787971244032[0;39m 生成今日电子书快照结束，耗时：250毫秒
2021-12-20 11:06:20.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127969808888238080[0;39m 生成今日电子书快照开始
2021-12-20 11:06:20.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969808888238080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:20.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969808888238080[0;39m ==> Parameters: 
2021-12-20 11:06:20.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969808888238080[0;39m <==    Updates: 0
2021-12-20 11:06:20.230 INFO  com.job.EbookSnapshotJob                          :35   [32m127969808888238080[0;39m 生成今日电子书快照结束，耗时：226毫秒
2021-12-20 11:06:20.683 INFO  com.aspect.LogAspect                              :54   [32m127969811740364800[0;39m ------------- 开始 -------------
2021-12-20 11:06:20.684 INFO  com.aspect.LogAspect                              :55   [32m127969811740364800[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:06:20.685 INFO  com.aspect.LogAspect                              :56   [32m127969811740364800[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:06:20.685 INFO  com.aspect.LogAspect                              :57   [32m127969811740364800[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:20.685 INFO  com.aspect.LogAspect                              :80   [32m127969811740364800[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-20 11:06:20.781 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969811740364800[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:06:20.782 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969811740364800[0;39m ==> Parameters: test123(String)
2021-12-20 11:06:20.876 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969811740364800[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:06:20.877 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969811740364800[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:06:20.878 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969811740364800[0;39m <==      Total: 1
2021-12-20 11:06:20.893 INFO  com.controller.UserController                     :77   [32m127969811740364800[0;39m 生成单点登录token:127969812621168640,并放入redis中
2021-12-20 11:06:21.497 INFO  com.aspect.LogAspect                              :92   [32m127969811740364800[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"127969812621168640"},"success":true}
2021-12-20 11:06:21.497 INFO  com.aspect.LogAspect                              :93   [32m127969811740364800[0;39m ------------- 结束 耗时：814 ms -------------
2021-12-20 11:06:21.596 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：kjVcEVWzkv，session id：3！当前连接数：0
2021-12-20 11:06:22.714 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：cq9ALBf35r，session id：4，当前连接数：1
2021-12-20 11:06:22.800 INFO  com.aspect.LogAspect                              :54   [32m127969820619706368[0;39m ------------- 开始 -------------
2021-12-20 11:06:22.800 INFO  com.aspect.LogAspect                              :55   [32m127969820619706368[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :56   [32m127969820619706368[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :54   [32m127969820623900672[0;39m ------------- 开始 -------------
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :55   [32m127969820623900672[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :57   [32m127969820619706368[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :56   [32m127969820623900672[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :80   [32m127969820619706368[0;39m 请求参数: []
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :57   [32m127969820623900672[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:22.801 INFO  com.aspect.LogAspect                              :80   [32m127969820623900672[0;39m 请求参数: []
2021-12-20 11:06:22.804 INFO  com.aspect.LogAspect                              :54   [32m127969820636483584[0;39m ------------- 开始 -------------
2021-12-20 11:06:22.804 INFO  com.aspect.LogAspect                              :55   [32m127969820636483584[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:06:22.805 INFO  com.aspect.LogAspect                              :56   [32m127969820636483584[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:06:22.805 INFO  com.aspect.LogAspect                              :57   [32m127969820636483584[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:22.805 INFO  com.aspect.LogAspect                              :80   [32m127969820636483584[0;39m 请求参数: []
2021-12-20 11:06:22.885 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969820623900672[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:06:22.885 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969820623900672[0;39m ==> Parameters: 
2021-12-20 11:06:22.886 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969820619706368[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:06:22.886 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969820619706368[0;39m ==> Parameters: 
2021-12-20 11:06:22.890 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969820636483584[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:06:22.890 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969820636483584[0;39m ==> Parameters: 
2021-12-20 11:06:22.968 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:06:22.968 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:06:22.969 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:06:22.969 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:06:22.969 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:06:22.969 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:06:22.970 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:06:22.971 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:06:22.971 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:06:22.971 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:06:22.971 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:06:22.972 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:06:22.972 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:06:22.972 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:06:22.972 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969820636483584[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:06:22.973 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969820636483584[0;39m <==      Total: 19
2021-12-20 11:06:22.973 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969820623900672[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:06:22.973 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969820619706368[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:06:22.974 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969820623900672[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:06:22.974 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969820619706368[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:06:22.975 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969820619706368[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:06:22.975 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969820623900672[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:06:22.975 INFO  com.aspect.LogAspect                              :92   [32m127969820636483584[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:06:22.975 INFO  com.aspect.LogAspect                              :93   [32m127969820636483584[0;39m ------------- 结束 耗时：171 ms -------------
2021-12-20 11:06:22.975 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969820619706368[0;39m <==      Total: 2
2021-12-20 11:06:22.975 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969820623900672[0;39m <==      Total: 2
2021-12-20 11:06:22.975 INFO  com.aspect.LogAspect                              :92   [32m127969820623900672[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:06:22.975 INFO  com.aspect.LogAspect                              :92   [32m127969820619706368[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:06:22.976 INFO  com.aspect.LogAspect                              :93   [32m127969820619706368[0;39m ------------- 结束 耗时：176 ms -------------
2021-12-20 11:06:22.976 INFO  com.aspect.LogAspect                              :93   [32m127969820623900672[0;39m ------------- 结束 耗时：175 ms -------------
2021-12-20 11:06:25.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127969829855563776[0;39m 生成今日电子书快照开始
2021-12-20 11:06:25.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969829855563776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:25.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969829855563776[0;39m ==> Parameters: 
2021-12-20 11:06:25.108 INFO  com.aspect.LogAspect                              :54   [32m127969830300160000[0;39m ------------- 开始 -------------
2021-12-20 11:06:25.108 INFO  com.aspect.LogAspect                              :55   [32m127969830300160000[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-20 11:06:25.108 INFO  com.aspect.LogAspect                              :56   [32m127969830300160000[0;39m 类名方法: com.controller.UserController.list
2021-12-20 11:06:25.109 INFO  com.aspect.LogAspect                              :57   [32m127969830300160000[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:25.110 INFO  com.aspect.LogAspect                              :80   [32m127969830300160000[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-20 11:06:25.214 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969830300160000[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-20 11:06:25.215 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969830300160000[0;39m ==> Parameters: 
2021-12-20 11:06:25.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969829855563776[0;39m <==    Updates: 0
2021-12-20 11:06:25.258 INFO  com.job.EbookSnapshotJob                          :35   [32m127969829855563776[0;39m 生成今日电子书快照结束，耗时：255毫秒
2021-12-20 11:06:25.279 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127969830300160000[0;39m <==    Columns: count(0)
2021-12-20 11:06:25.280 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127969830300160000[0;39m <==        Row: 8
2021-12-20 11:06:25.282 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969830300160000[0;39m <==      Total: 1
2021-12-20 11:06:25.287 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969830300160000[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-20 11:06:25.288 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969830300160000[0;39m ==> Parameters: 10(Integer)
2021-12-20 11:06:25.367 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:06:25.368 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:06:25.368 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:06:25.369 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:06:25.370 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:06:25.370 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-20 11:06:25.371 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:06:25.372 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:06:25.372 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969830300160000[0;39m <==        Row: 127969710334676992, test12345, 12345, cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:06:25.373 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969830300160000[0;39m <==      Total: 8
2021-12-20 11:06:25.379 INFO  com.servicess.UserService                         :52   [32m127969830300160000[0;39m 总行数：8
2021-12-20 11:06:25.380 INFO  com.servicess.UserService                         :53   [32m127969830300160000[0;39m 总页数：1
2021-12-20 11:06:25.400 INFO  com.aspect.LogAspect                              :92   [32m127969830300160000[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"},{"id":127969710334676992,"loginName":"test12345","name":"12345"}],"total":8},"success":true}
2021-12-20 11:06:25.401 INFO  com.aspect.LogAspect                              :93   [32m127969830300160000[0;39m ------------- 结束 耗时：293 ms -------------
2021-12-20 11:06:30.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127969850869026816[0;39m 生成今日电子书快照开始
2021-12-20 11:06:30.097 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969850869026816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:30.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969850869026816[0;39m ==> Parameters: 
2021-12-20 11:06:30.270 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969850869026816[0;39m <==    Updates: 0
2021-12-20 11:06:30.270 INFO  com.job.EbookSnapshotJob                          :35   [32m127969850869026816[0;39m 生成今日电子书快照结束，耗时：258毫秒
2021-12-20 11:06:34.630 INFO  com.aspect.LogAspect                              :54   [32m127969870238322688[0;39m ------------- 开始 -------------
2021-12-20 11:06:34.630 INFO  com.aspect.LogAspect                              :55   [32m127969870238322688[0;39m 请求地址: http://localhost:8081/user/logout/127969812621168640 GET
2021-12-20 11:06:34.630 INFO  com.aspect.LogAspect                              :56   [32m127969870238322688[0;39m 类名方法: com.controller.UserController.logout
2021-12-20 11:06:34.630 INFO  com.aspect.LogAspect                              :57   [32m127969870238322688[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:34.631 INFO  com.aspect.LogAspect                              :80   [32m127969870238322688[0;39m 请求参数: ["127969812621168640"]
2021-12-20 11:06:34.695 INFO  com.controller.UserController                     :89   [32m127969870238322688[0;39m 从redis中删除token：127969812621168640
2021-12-20 11:06:34.695 INFO  com.aspect.LogAspect                              :92   [32m127969870238322688[0;39m 返回结果: {"success":true}
2021-12-20 11:06:34.696 INFO  com.aspect.LogAspect                              :93   [32m127969870238322688[0;39m ------------- 结束 耗时：66 ms -------------
2021-12-20 11:06:35.000 INFO  com.job.EbookSnapshotJob                          :32   [32m127969871790215168[0;39m 生成今日电子书快照开始
2021-12-20 11:06:35.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969871790215168[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:35.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969871790215168[0;39m ==> Parameters: 
2021-12-20 11:06:35.258 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969871790215168[0;39m <==    Updates: 0
2021-12-20 11:06:35.259 INFO  com.job.EbookSnapshotJob                          :35   [32m127969871790215168[0;39m 生成今日电子书快照结束，耗时：258毫秒
2021-12-20 11:06:35.259 INFO  com.job.DocJob                                    :32   [32m127969872876539904[0;39m 更新电子书下的文档数据开始
2021-12-20 11:06:35.260 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969872876539904[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:06:35.261 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969872876539904[0;39m ==> Parameters: 
2021-12-20 11:06:35.402 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969872876539904[0;39m <==    Updates: 3
2021-12-20 11:06:35.403 INFO  com.job.DocJob                                    :35   [32m127969872876539904[0;39m 更新电子书下的文档数据结束，耗时：144毫秒
2021-12-20 11:06:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127969892824649728[0;39m 生成今日电子书快照开始
2021-12-20 11:06:40.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969892824649728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:40.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969892824649728[0;39m ==> Parameters: 
2021-12-20 11:06:40.238 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969892824649728[0;39m <==    Updates: 0
2021-12-20 11:06:40.238 INFO  com.job.EbookSnapshotJob                          :35   [32m127969892824649728[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-20 11:06:43.873 INFO  com.aspect.LogAspect                              :54   [32m127969909006274560[0;39m ------------- 开始 -------------
2021-12-20 11:06:43.873 INFO  com.aspect.LogAspect                              :55   [32m127969909006274560[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:06:43.873 INFO  com.aspect.LogAspect                              :56   [32m127969909006274560[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:06:43.874 INFO  com.aspect.LogAspect                              :57   [32m127969909006274560[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:43.874 INFO  com.aspect.LogAspect                              :80   [32m127969909006274560[0;39m 请求参数: [{"loginName":"test12345"}]
2021-12-20 11:06:43.947 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969909006274560[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:06:43.949 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969909006274560[0;39m ==> Parameters: test12345(String)
2021-12-20 11:06:44.028 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969909006274560[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:06:44.029 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969909006274560[0;39m <==        Row: 127969710334676992, test12345, 12345, cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:06:44.031 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969909006274560[0;39m <==      Total: 1
2021-12-20 11:06:44.032 INFO  com.servicess.UserService                         :144  [32m127969909006274560[0;39m 密码不对，输入密码：7354a1d413535a6c0dc5c209e198d799，数据库密码：cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:06:44.034 WARN  com.controller.ControllerExceptionHandler         :44   [32m127969909006274560[0;39m 业务异常：用户名不存在或密码错误
2021-12-20 11:06:44.037 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m127969909006274560[0;39m Resolved [com.exception.BusinessException: 用户名不存在或密码错误]
2021-12-20 11:06:45.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127969913787781120[0;39m 生成今日电子书快照开始
2021-12-20 11:06:45.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969913787781120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:45.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969913787781120[0;39m ==> Parameters: 
2021-12-20 11:06:45.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969913787781120[0;39m <==    Updates: 0
2021-12-20 11:06:45.258 INFO  com.job.EbookSnapshotJob                          :35   [32m127969913787781120[0;39m 生成今日电子书快照结束，耗时：244毫秒
2021-12-20 11:06:50.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127969934725746688[0;39m 生成今日电子书快照开始
2021-12-20 11:06:50.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969934725746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:50.094 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969934725746688[0;39m ==> Parameters: 
2021-12-20 11:06:50.235 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969934725746688[0;39m <==    Updates: 0
2021-12-20 11:06:50.250 INFO  com.job.EbookSnapshotJob                          :35   [32m127969934725746688[0;39m 生成今日电子书快照结束，耗时：245毫秒
2021-12-20 11:06:55.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127969955739209728[0;39m 生成今日电子书快照开始
2021-12-20 11:06:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969955739209728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:06:55.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969955739209728[0;39m ==> Parameters: 
2021-12-20 11:06:55.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969955739209728[0;39m <==    Updates: 0
2021-12-20 11:06:55.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127969955739209728[0;39m 生成今日电子书快照结束，耗时：236毫秒
2021-12-20 11:06:56.077 INFO  com.websocket.WebSocketServer                     :41   [32m127969811740364800[0;39m 连接关闭，token：cq9ALBf35r，session id：4！当前连接数：0
2021-12-20 11:06:56.755 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：LfA2IwF2gk，session id：5，当前连接数：1
2021-12-20 11:06:56.825 INFO  com.aspect.LogAspect                              :54   [32m127969963330899968[0;39m ------------- 开始 -------------
2021-12-20 11:06:56.825 INFO  com.aspect.LogAspect                              :55   [32m127969963330899968[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:06:56.825 INFO  com.aspect.LogAspect                              :56   [32m127969963330899968[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:06:56.825 INFO  com.aspect.LogAspect                              :57   [32m127969963330899968[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:56.826 INFO  com.aspect.LogAspect                              :80   [32m127969963330899968[0;39m 请求参数: []
2021-12-20 11:06:56.826 INFO  com.aspect.LogAspect                              :54   [32m127969963335094272[0;39m ------------- 开始 -------------
2021-12-20 11:06:56.826 INFO  com.aspect.LogAspect                              :55   [32m127969963335094272[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:06:56.826 INFO  com.aspect.LogAspect                              :56   [32m127969963335094272[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:06:56.827 INFO  com.aspect.LogAspect                              :57   [32m127969963335094272[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:56.827 INFO  com.aspect.LogAspect                              :80   [32m127969963335094272[0;39m 请求参数: []
2021-12-20 11:06:56.829 INFO  com.aspect.LogAspect                              :54   [32m127969963347677184[0;39m ------------- 开始 -------------
2021-12-20 11:06:56.829 INFO  com.aspect.LogAspect                              :55   [32m127969963347677184[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:06:56.829 INFO  com.aspect.LogAspect                              :56   [32m127969963347677184[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:06:56.830 INFO  com.aspect.LogAspect                              :57   [32m127969963347677184[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:06:56.830 INFO  com.aspect.LogAspect                              :80   [32m127969963347677184[0;39m 请求参数: []
2021-12-20 11:06:56.995 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969963330899968[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:06:56.995 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969963330899968[0;39m ==> Parameters: 
2021-12-20 11:06:57.014 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969963335094272[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:06:57.015 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969963347677184[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:06:57.016 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969963335094272[0;39m ==> Parameters: 
2021-12-20 11:06:57.016 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969963347677184[0;39m ==> Parameters: 
2021-12-20 11:06:57.089 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969963330899968[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:06:57.091 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969963330899968[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:06:57.093 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969963330899968[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:06:57.094 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969963330899968[0;39m <==      Total: 2
2021-12-20 11:06:57.095 INFO  com.aspect.LogAspect                              :92   [32m127969963330899968[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:06:57.096 INFO  com.aspect.LogAspect                              :93   [32m127969963330899968[0;39m ------------- 结束 耗时：271 ms -------------
2021-12-20 11:06:57.100 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969963335094272[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:06:57.100 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:06:57.101 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:06:57.102 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969963335094272[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:06:57.102 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:06:57.104 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:06:57.104 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969963335094272[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:06:57.105 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:06:57.105 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969963335094272[0;39m <==      Total: 2
2021-12-20 11:06:57.106 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:06:57.107 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:06:57.107 INFO  com.aspect.LogAspect                              :92   [32m127969963335094272[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:06:57.108 INFO  com.aspect.LogAspect                              :93   [32m127969963335094272[0;39m ------------- 结束 耗时：282 ms -------------
2021-12-20 11:06:57.108 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:06:57.109 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:06:57.111 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:06:57.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:06:57.113 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:06:57.115 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:06:57.118 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:06:57.119 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:06:57.121 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:06:57.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:06:57.124 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:06:57.125 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:06:57.126 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969963347677184[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:06:57.128 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969963347677184[0;39m <==      Total: 19
2021-12-20 11:06:57.131 INFO  com.aspect.LogAspect                              :92   [32m127969963347677184[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:06:57.132 INFO  com.aspect.LogAspect                              :93   [32m127969963347677184[0;39m ------------- 结束 耗时：303 ms -------------
2021-12-20 11:07:00.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127969976706535424[0;39m 生成今日电子书快照开始
2021-12-20 11:07:00.141 INFO  com.aspect.LogAspect                              :54   [32m127969977239212032[0;39m ------------- 开始 -------------
2021-12-20 11:07:00.141 INFO  com.aspect.LogAspect                              :55   [32m127969977239212032[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:07:00.141 INFO  com.aspect.LogAspect                              :56   [32m127969977239212032[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:07:00.142 INFO  com.aspect.LogAspect                              :57   [32m127969977239212032[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:00.142 INFO  com.aspect.LogAspect                              :80   [32m127969977239212032[0;39m 请求参数: [{"loginName":"test123"}]
2021-12-20 11:07:00.207 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969976706535424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:00.207 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969976706535424[0;39m ==> Parameters: 
2021-12-20 11:07:00.218 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969977239212032[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:07:00.218 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969977239212032[0;39m ==> Parameters: test123(String)
2021-12-20 11:07:00.302 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969977239212032[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:07:00.302 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969977239212032[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:00.303 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969977239212032[0;39m <==      Total: 1
2021-12-20 11:07:00.303 INFO  com.controller.UserController                     :77   [32m127969977239212032[0;39m 生成单点登录token:127969977918689280,并放入redis中
2021-12-20 11:07:00.344 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969976706535424[0;39m <==    Updates: 0
2021-12-20 11:07:00.345 INFO  com.job.EbookSnapshotJob                          :35   [32m127969976706535424[0;39m 生成今日电子书快照结束，耗时：330毫秒
2021-12-20 11:07:00.345 INFO  com.aspect.LogAspect                              :92   [32m127969977239212032[0;39m 返回结果: {"content":{"id":120902130663034880,"loginName":"test123","name":"test123","token":"127969977918689280"},"success":true}
2021-12-20 11:07:00.346 INFO  com.aspect.LogAspect                              :93   [32m127969977239212032[0;39m ------------- 结束 耗时：205 ms -------------
2021-12-20 11:07:00.473 INFO  com.websocket.WebSocketServer                     :41   [32m127969830300160000[0;39m 连接关闭，token：LfA2IwF2gk，session id：5！当前连接数：0
2021-12-20 11:07:01.113 INFO  com.websocket.WebSocketServer                     :32   [32m127969709583896576[0;39m 有新连接：token：bHnimva0PY，session id：6，当前连接数：1
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :54   [32m127969981676785664[0;39m ------------- 开始 -------------
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :54   [32m127969981676785665[0;39m ------------- 开始 -------------
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :55   [32m127969981676785665[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :55   [32m127969981676785664[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :56   [32m127969981676785664[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :56   [32m127969981676785665[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :57   [32m127969981676785664[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:01.199 INFO  com.aspect.LogAspect                              :57   [32m127969981676785665[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:01.200 INFO  com.aspect.LogAspect                              :80   [32m127969981676785665[0;39m 请求参数: []
2021-12-20 11:07:01.200 INFO  com.aspect.LogAspect                              :80   [32m127969981676785664[0;39m 请求参数: []
2021-12-20 11:07:01.202 INFO  com.aspect.LogAspect                              :54   [32m127969981689368576[0;39m ------------- 开始 -------------
2021-12-20 11:07:01.202 INFO  com.aspect.LogAspect                              :55   [32m127969981689368576[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:01.202 INFO  com.aspect.LogAspect                              :56   [32m127969981689368576[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:01.202 INFO  com.aspect.LogAspect                              :57   [32m127969981689368576[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:01.203 INFO  com.aspect.LogAspect                              :80   [32m127969981689368576[0;39m 请求参数: []
2021-12-20 11:07:01.269 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969981676785665[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:01.269 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969981676785664[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:01.269 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969981676785665[0;39m ==> Parameters: 
2021-12-20 11:07:01.269 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969981676785664[0;39m ==> Parameters: 
2021-12-20 11:07:01.275 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969981689368576[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:01.275 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969981689368576[0;39m ==> Parameters: 
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969981676785665[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969981676785664[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969981676785665[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969981676785664[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127969981676785664[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:01.356 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127969981676785665[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:01.356 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127969981676785664[0;39m <==      Total: 2
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:01.356 INFO  com.aspect.LogAspect                              :92   [32m127969981676785664[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:01.356 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127969981676785665[0;39m <==      Total: 2
2021-12-20 11:07:01.356 INFO  com.aspect.LogAspect                              :93   [32m127969981676785664[0;39m ------------- 结束 耗时：157 ms -------------
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:01.356 INFO  com.aspect.LogAspect                              :92   [32m127969981676785665[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:01.356 INFO  com.aspect.LogAspect                              :93   [32m127969981676785665[0;39m ------------- 结束 耗时：157 ms -------------
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:01.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:01.361 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:01.362 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:01.362 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:01.363 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127969981689368576[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:01.364 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127969981689368576[0;39m <==      Total: 19
2021-12-20 11:07:01.365 INFO  com.aspect.LogAspect                              :92   [32m127969981689368576[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:01.365 INFO  com.aspect.LogAspect                              :93   [32m127969981689368576[0;39m ------------- 结束 耗时：163 ms -------------
2021-12-20 11:07:01.709 INFO  com.aspect.LogAspect                              :54   [32m127969983815880704[0;39m ------------- 开始 -------------
2021-12-20 11:07:01.710 INFO  com.aspect.LogAspect                              :55   [32m127969983815880704[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-20 11:07:01.710 INFO  com.aspect.LogAspect                              :56   [32m127969983815880704[0;39m 类名方法: com.controller.UserController.list
2021-12-20 11:07:01.710 INFO  com.aspect.LogAspect                              :57   [32m127969983815880704[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:01.710 INFO  com.aspect.LogAspect                              :80   [32m127969983815880704[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-20 11:07:01.712 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969983815880704[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-20 11:07:01.713 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969983815880704[0;39m ==> Parameters: 
2021-12-20 11:07:01.816 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127969983815880704[0;39m <==    Columns: count(0)
2021-12-20 11:07:01.816 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127969983815880704[0;39m <==        Row: 8
2021-12-20 11:07:01.816 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127969983815880704[0;39m <==      Total: 1
2021-12-20 11:07:01.817 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969983815880704[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-20 11:07:01.817 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969983815880704[0;39m ==> Parameters: 10(Integer)
2021-12-20 11:07:01.894 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:07:01.895 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:01.895 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:01.896 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:01.898 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:01.899 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-20 11:07:01.900 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:01.900 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:01.901 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127969983815880704[0;39m <==        Row: 127969710334676992, test12345, 12345, cc03e747a6afbbcbf8be7668acfebee5
2021-12-20 11:07:01.901 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127969983815880704[0;39m <==      Total: 8
2021-12-20 11:07:01.901 INFO  com.servicess.UserService                         :52   [32m127969983815880704[0;39m 总行数：8
2021-12-20 11:07:01.902 INFO  com.servicess.UserService                         :53   [32m127969983815880704[0;39m 总页数：1
2021-12-20 11:07:01.904 INFO  com.aspect.LogAspect                              :92   [32m127969983815880704[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"},{"id":127969710334676992,"loginName":"test12345","name":"12345"}],"total":8},"success":true}
2021-12-20 11:07:01.904 INFO  com.aspect.LogAspect                              :93   [32m127969983815880704[0;39m ------------- 结束 耗时：195 ms -------------
2021-12-20 11:07:05.001 INFO  com.job.DocJob                                    :32   [32m127969997623529472[0;39m 更新电子书下的文档数据开始
2021-12-20 11:07:05.065 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969997623529472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:07:05.065 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969997623529472[0;39m ==> Parameters: 
2021-12-20 11:07:05.208 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127969997623529472[0;39m <==    Updates: 3
2021-12-20 11:07:05.209 INFO  com.job.DocJob                                    :35   [32m127969997623529472[0;39m 更新电子书下的文档数据结束，耗时：208毫秒
2021-12-20 11:07:05.210 INFO  com.job.EbookSnapshotJob                          :32   [32m127969998500139008[0;39m 生成今日电子书快照开始
2021-12-20 11:07:05.211 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969998500139008[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:05.213 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969998500139008[0;39m ==> Parameters: 
2021-12-20 11:07:05.377 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127969998500139008[0;39m <==    Updates: 0
2021-12-20 11:07:05.378 INFO  com.job.EbookSnapshotJob                          :35   [32m127969998500139008[0;39m 生成今日电子书快照结束，耗时：168毫秒
2021-12-20 11:07:09.564 INFO  com.aspect.LogAspect                              :54   [32m127970016762138624[0;39m ------------- 开始 -------------
2021-12-20 11:07:09.565 INFO  com.aspect.LogAspect                              :55   [32m127970016762138624[0;39m 请求地址: http://localhost:8081/user/reset-password POST
2021-12-20 11:07:09.565 INFO  com.aspect.LogAspect                              :56   [32m127970016762138624[0;39m 类名方法: com.controller.UserController.resetPassword
2021-12-20 11:07:09.565 INFO  com.aspect.LogAspect                              :57   [32m127970016762138624[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:09.566 INFO  com.aspect.LogAspect                              :80   [32m127970016762138624[0;39m 请求参数: [{"id":127969710334676992}]
2021-12-20 11:07:09.647 DEBUG com.mapper.UserMapper.updateByPrimaryKeySelective :137  [32m127970016762138624[0;39m ==>  Preparing: update user SET `password` = ? where id = ?
2021-12-20 11:07:09.647 DEBUG com.mapper.UserMapper.updateByPrimaryKeySelective :137  [32m127970016762138624[0;39m ==> Parameters: 7354a1d413535a6c0dc5c209e198d799(String), 127969710334676992(Long)
2021-12-20 11:07:09.780 DEBUG com.mapper.UserMapper.updateByPrimaryKeySelective :137  [32m127970016762138624[0;39m <==    Updates: 1
2021-12-20 11:07:09.781 INFO  com.aspect.LogAspect                              :92   [32m127970016762138624[0;39m 返回结果: {"success":true}
2021-12-20 11:07:09.781 INFO  com.aspect.LogAspect                              :93   [32m127970016762138624[0;39m ------------- 结束 耗时：217 ms -------------
2021-12-20 11:07:09.813 INFO  com.aspect.LogAspect                              :54   [32m127970017806520320[0;39m ------------- 开始 -------------
2021-12-20 11:07:09.813 INFO  com.aspect.LogAspect                              :55   [32m127970017806520320[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-20 11:07:09.814 INFO  com.aspect.LogAspect                              :56   [32m127970017806520320[0;39m 类名方法: com.controller.UserController.list
2021-12-20 11:07:09.814 INFO  com.aspect.LogAspect                              :57   [32m127970017806520320[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:09.814 INFO  com.aspect.LogAspect                              :80   [32m127970017806520320[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-20 11:07:09.893 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970017806520320[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-20 11:07:09.893 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970017806520320[0;39m ==> Parameters: 
2021-12-20 11:07:09.972 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127970017806520320[0;39m <==    Columns: count(0)
2021-12-20 11:07:09.973 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127970017806520320[0;39m <==        Row: 8
2021-12-20 11:07:09.974 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970017806520320[0;39m <==      Total: 1
2021-12-20 11:07:09.975 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970017806520320[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-20 11:07:09.976 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970017806520320[0;39m ==> Parameters: 10(Integer)
2021-12-20 11:07:10.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127970018607632384[0;39m 生成今日电子书快照开始
2021-12-20 11:07:10.059 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:07:10.060 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:10.060 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:10.061 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:10.061 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:10.061 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-20 11:07:10.061 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:10.062 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:10.062 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970017806520320[0;39m <==        Row: 127969710334676992, test12345, 12345, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:10.063 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970017806520320[0;39m <==      Total: 8
2021-12-20 11:07:10.063 INFO  com.servicess.UserService                         :52   [32m127970017806520320[0;39m 总行数：8
2021-12-20 11:07:10.063 INFO  com.servicess.UserService                         :53   [32m127970017806520320[0;39m 总页数：1
2021-12-20 11:07:10.064 INFO  com.aspect.LogAspect                              :92   [32m127970017806520320[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"},{"id":127969710334676992,"loginName":"test12345","name":"12345"}],"total":8},"success":true}
2021-12-20 11:07:10.065 INFO  com.aspect.LogAspect                              :93   [32m127970017806520320[0;39m ------------- 结束 耗时：252 ms -------------
2021-12-20 11:07:10.075 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970018607632384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:10.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970018607632384[0;39m ==> Parameters: 
2021-12-20 11:07:10.216 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970018607632384[0;39m <==    Updates: 0
2021-12-20 11:07:10.216 INFO  com.job.EbookSnapshotJob                          :35   [32m127970018607632384[0;39m 生成今日电子书快照结束，耗时：211毫秒
2021-12-20 11:07:13.328 INFO  com.aspect.LogAspect                              :54   [32m127970032549498880[0;39m ------------- 开始 -------------
2021-12-20 11:07:13.329 INFO  com.aspect.LogAspect                              :55   [32m127970032549498880[0;39m 请求地址: http://localhost:8081/user/logout/127969977918689280 GET
2021-12-20 11:07:13.329 INFO  com.aspect.LogAspect                              :56   [32m127970032549498880[0;39m 类名方法: com.controller.UserController.logout
2021-12-20 11:07:13.329 INFO  com.aspect.LogAspect                              :57   [32m127970032549498880[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:13.330 INFO  com.aspect.LogAspect                              :80   [32m127970032549498880[0;39m 请求参数: ["127969977918689280"]
2021-12-20 11:07:13.373 INFO  com.controller.UserController                     :89   [32m127970032549498880[0;39m 从redis中删除token：127969977918689280
2021-12-20 11:07:13.373 INFO  com.aspect.LogAspect                              :92   [32m127970032549498880[0;39m 返回结果: {"success":true}
2021-12-20 11:07:13.374 INFO  com.aspect.LogAspect                              :93   [32m127970032549498880[0;39m ------------- 结束 耗时：46 ms -------------
2021-12-20 11:07:15.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127970039621095424[0;39m 生成今日电子书快照开始
2021-12-20 11:07:15.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970039621095424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:15.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970039621095424[0;39m ==> Parameters: 
2021-12-20 11:07:15.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970039621095424[0;39m <==    Updates: 0
2021-12-20 11:07:15.256 INFO  com.job.EbookSnapshotJob                          :35   [32m127970039621095424[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 11:07:15.323 INFO  com.aspect.LogAspect                              :54   [32m127970040917135360[0;39m ------------- 开始 -------------
2021-12-20 11:07:15.324 INFO  com.aspect.LogAspect                              :55   [32m127970040917135360[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:15.324 INFO  com.aspect.LogAspect                              :56   [32m127970040917135360[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:15.324 INFO  com.aspect.LogAspect                              :57   [32m127970040917135360[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:15.324 INFO  com.aspect.LogAspect                              :80   [32m127970040917135360[0;39m 请求参数: []
2021-12-20 11:07:15.324 INFO  com.aspect.LogAspect                              :54   [32m127970040921329664[0;39m ------------- 开始 -------------
2021-12-20 11:07:15.325 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970040917135360[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:15.325 INFO  com.aspect.LogAspect                              :55   [32m127970040921329664[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:15.325 INFO  com.aspect.LogAspect                              :56   [32m127970040921329664[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:15.325 INFO  com.aspect.LogAspect                              :57   [32m127970040921329664[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:15.325 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970040917135360[0;39m ==> Parameters: 
2021-12-20 11:07:15.325 INFO  com.aspect.LogAspect                              :80   [32m127970040921329664[0;39m 请求参数: []
2021-12-20 11:07:15.328 INFO  com.aspect.LogAspect                              :54   [32m127970040938106880[0;39m ------------- 开始 -------------
2021-12-20 11:07:15.328 INFO  com.aspect.LogAspect                              :55   [32m127970040938106880[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:15.328 INFO  com.aspect.LogAspect                              :56   [32m127970040938106880[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:15.328 INFO  com.aspect.LogAspect                              :57   [32m127970040938106880[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:15.329 INFO  com.aspect.LogAspect                              :80   [32m127970040938106880[0;39m 请求参数: []
2021-12-20 11:07:15.398 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970040938106880[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:15.398 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970040938106880[0;39m ==> Parameters: 
2021-12-20 11:07:15.398 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970040921329664[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:15.398 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970040917135360[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:15.398 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970040921329664[0;39m ==> Parameters: 
2021-12-20 11:07:15.398 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970040917135360[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:15.398 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970040917135360[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:15.398 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970040917135360[0;39m <==      Total: 2
2021-12-20 11:07:15.398 INFO  com.aspect.LogAspect                              :92   [32m127970040917135360[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:15.398 INFO  com.aspect.LogAspect                              :93   [32m127970040917135360[0;39m ------------- 结束 耗时：75 ms -------------
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:15.481 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970040921329664[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:15.481 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970040921329664[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:15.481 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970040921329664[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:15.481 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970040921329664[0;39m <==      Total: 2
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:15.481 INFO  com.aspect.LogAspect                              :92   [32m127970040921329664[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:15.481 INFO  com.aspect.LogAspect                              :93   [32m127970040921329664[0;39m ------------- 结束 耗时：157 ms -------------
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:15.481 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:15.497 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:15.497 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:15.499 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:15.500 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:15.501 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970040938106880[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:15.502 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970040938106880[0;39m <==      Total: 19
2021-12-20 11:07:15.510 INFO  com.aspect.LogAspect                              :92   [32m127970040938106880[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:15.511 INFO  com.aspect.LogAspect                              :93   [32m127970040938106880[0;39m ------------- 结束 耗时：183 ms -------------
2021-12-20 11:07:20.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127970060546478080[0;39m 生成今日电子书快照开始
2021-12-20 11:07:20.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970060546478080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:20.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970060546478080[0;39m ==> Parameters: 
2021-12-20 11:07:20.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970060546478080[0;39m <==    Updates: 0
2021-12-20 11:07:20.227 INFO  com.job.EbookSnapshotJob                          :35   [32m127970060546478080[0;39m 生成今日电子书快照结束，耗时：224毫秒
2021-12-20 11:07:25.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127970081564135424[0;39m 生成今日电子书快照开始
2021-12-20 11:07:25.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970081564135424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:25.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970081564135424[0;39m ==> Parameters: 
2021-12-20 11:07:25.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970081564135424[0;39m <==    Updates: 0
2021-12-20 11:07:25.246 INFO  com.job.EbookSnapshotJob                          :35   [32m127970081564135424[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:07:26.760 INFO  com.websocket.WebSocketServer                     :41   [32m127969981689368576[0;39m 连接关闭，token：bHnimva0PY，session id：6！当前连接数：0
2021-12-20 11:07:27.470 INFO  com.websocket.WebSocketServer                     :32   [32m127969983815880704[0;39m 有新连接：token：mScnAwDRwI，session id：7，当前连接数：1
2021-12-20 11:07:27.536 INFO  com.aspect.LogAspect                              :54   [32m127970092142170112[0;39m ------------- 开始 -------------
2021-12-20 11:07:27.537 INFO  com.aspect.LogAspect                              :55   [32m127970092142170112[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:27.537 INFO  com.aspect.LogAspect                              :56   [32m127970092142170112[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:27.537 INFO  com.aspect.LogAspect                              :57   [32m127970092142170112[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:27.537 INFO  com.aspect.LogAspect                              :80   [32m127970092142170112[0;39m 请求参数: []
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :54   [32m127970092158947329[0;39m ------------- 开始 -------------
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :54   [32m127970092158947328[0;39m ------------- 开始 -------------
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :55   [32m127970092158947329[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :55   [32m127970092158947328[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :56   [32m127970092158947329[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :56   [32m127970092158947328[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :57   [32m127970092158947329[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:27.540 INFO  com.aspect.LogAspect                              :57   [32m127970092158947328[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:27.541 INFO  com.aspect.LogAspect                              :80   [32m127970092158947329[0;39m 请求参数: []
2021-12-20 11:07:27.541 INFO  com.aspect.LogAspect                              :80   [32m127970092158947328[0;39m 请求参数: []
2021-12-20 11:07:27.610 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970092158947328[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:27.610 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970092158947328[0;39m ==> Parameters: 
2021-12-20 11:07:27.613 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970092158947329[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:27.613 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970092142170112[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:27.614 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970092142170112[0;39m ==> Parameters: 
2021-12-20 11:07:27.614 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970092158947329[0;39m ==> Parameters: 
2021-12-20 11:07:27.689 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970092158947328[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:27.690 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970092158947328[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:27.691 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970092158947328[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:27.691 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970092158947328[0;39m <==      Total: 2
2021-12-20 11:07:27.692 INFO  com.aspect.LogAspect                              :92   [32m127970092158947328[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:27.692 INFO  com.aspect.LogAspect                              :93   [32m127970092158947328[0;39m ------------- 结束 耗时：152 ms -------------
2021-12-20 11:07:27.693 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:27.693 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:27.694 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:27.694 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:27.695 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:27.696 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:27.696 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:27.697 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:27.698 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:27.698 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:27.699 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:27.699 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:27.699 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:27.700 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:27.700 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:27.701 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:27.701 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:27.702 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:27.702 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:27.703 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970092158947329[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:27.703 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970092158947329[0;39m <==      Total: 19
2021-12-20 11:07:27.705 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970092142170112[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:27.705 INFO  com.aspect.LogAspect                              :92   [32m127970092158947329[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:27.705 INFO  com.aspect.LogAspect                              :93   [32m127970092158947329[0;39m ------------- 结束 耗时：165 ms -------------
2021-12-20 11:07:27.705 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970092142170112[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:27.706 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970092142170112[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:27.707 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970092142170112[0;39m <==      Total: 2
2021-12-20 11:07:27.708 INFO  com.aspect.LogAspect                              :92   [32m127970092142170112[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:27.708 INFO  com.aspect.LogAspect                              :93   [32m127970092142170112[0;39m ------------- 结束 耗时：172 ms -------------
2021-12-20 11:07:30.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127970102556626944[0;39m 生成今日电子书快照开始
2021-12-20 11:07:30.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970102556626944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:30.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970102556626944[0;39m ==> Parameters: 
2021-12-20 11:07:30.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970102556626944[0;39m <==    Updates: 0
2021-12-20 11:07:30.263 INFO  com.job.EbookSnapshotJob                          :35   [32m127970102556626944[0;39m 生成今日电子书快照结束，耗时：243毫秒
2021-12-20 11:07:33.865 INFO  com.aspect.LogAspect                              :54   [32m127970118687920128[0;39m ------------- 开始 -------------
2021-12-20 11:07:33.865 INFO  com.aspect.LogAspect                              :55   [32m127970118687920128[0;39m 请求地址: http://localhost:8081/user/login POST
2021-12-20 11:07:33.865 INFO  com.aspect.LogAspect                              :56   [32m127970118687920128[0;39m 类名方法: com.controller.UserController.login
2021-12-20 11:07:33.865 INFO  com.aspect.LogAspect                              :57   [32m127970118687920128[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:33.866 INFO  com.aspect.LogAspect                              :80   [32m127970118687920128[0;39m 请求参数: [{"loginName":"test12345"}]
2021-12-20 11:07:33.964 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970118687920128[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-12-20 11:07:33.965 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970118687920128[0;39m ==> Parameters: test12345(String)
2021-12-20 11:07:34.054 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970118687920128[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:07:34.054 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970118687920128[0;39m <==        Row: 127969710334676992, test12345, 12345, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:34.055 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970118687920128[0;39m <==      Total: 1
2021-12-20 11:07:34.056 INFO  com.controller.UserController                     :77   [32m127970118687920128[0;39m 生成单点登录token:127970119489032192,并放入redis中
2021-12-20 11:07:34.107 INFO  com.aspect.LogAspect                              :92   [32m127970118687920128[0;39m 返回结果: {"content":{"id":127969710334676992,"loginName":"test12345","name":"12345","token":"127970119489032192"},"success":true}
2021-12-20 11:07:34.108 INFO  com.aspect.LogAspect                              :93   [32m127970118687920128[0;39m ------------- 结束 耗时：243 ms -------------
2021-12-20 11:07:34.234 INFO  com.websocket.WebSocketServer                     :41   [32m127970032549498880[0;39m 连接关闭，token：mScnAwDRwI，session id：7！当前连接数：0
2021-12-20 11:07:34.868 INFO  com.websocket.WebSocketServer                     :32   [32m127970040917135360[0;39m 有新连接：token：qq7guPEJcB，session id：8，当前连接数：1
2021-12-20 11:07:34.946 INFO  com.aspect.LogAspect                              :54   [32m127970123221962752[0;39m ------------- 开始 -------------
2021-12-20 11:07:34.947 INFO  com.aspect.LogAspect                              :55   [32m127970123221962752[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:34.947 INFO  com.aspect.LogAspect                              :56   [32m127970123221962752[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:34.947 INFO  com.aspect.LogAspect                              :57   [32m127970123221962752[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:34.947 INFO  com.aspect.LogAspect                              :80   [32m127970123221962752[0;39m 请求参数: []
2021-12-20 11:07:34.949 INFO  com.aspect.LogAspect                              :54   [32m127970123234545664[0;39m ------------- 开始 -------------
2021-12-20 11:07:34.949 INFO  com.aspect.LogAspect                              :55   [32m127970123234545664[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:34.949 INFO  com.aspect.LogAspect                              :56   [32m127970123234545664[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:34.949 INFO  com.aspect.LogAspect                              :54   [32m127970123234545665[0;39m ------------- 开始 -------------
2021-12-20 11:07:34.950 INFO  com.aspect.LogAspect                              :57   [32m127970123234545664[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:34.950 INFO  com.aspect.LogAspect                              :80   [32m127970123234545664[0;39m 请求参数: []
2021-12-20 11:07:34.950 INFO  com.aspect.LogAspect                              :55   [32m127970123234545665[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:34.950 INFO  com.aspect.LogAspect                              :56   [32m127970123234545665[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:34.951 INFO  com.aspect.LogAspect                              :57   [32m127970123234545665[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:34.951 INFO  com.aspect.LogAspect                              :80   [32m127970123234545665[0;39m 请求参数: []
2021-12-20 11:07:35.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127970123502981120[0;39m 生成今日电子书快照开始
2021-12-20 11:07:35.018 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970123221962752[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:35.018 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970123221962752[0;39m ==> Parameters: 
2021-12-20 11:07:35.033 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970123234545664[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:35.033 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970123234545664[0;39m ==> Parameters: 
2021-12-20 11:07:35.044 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970123234545665[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:35.044 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970123234545665[0;39m ==> Parameters: 
2021-12-20 11:07:35.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970123502981120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:35.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970123502981120[0;39m ==> Parameters: 
2021-12-20 11:07:35.109 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970123221962752[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:35.110 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970123221962752[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:35.111 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970123221962752[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:35.112 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970123221962752[0;39m <==      Total: 2
2021-12-20 11:07:35.112 INFO  com.aspect.LogAspect                              :92   [32m127970123221962752[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:35.113 INFO  com.aspect.LogAspect                              :93   [32m127970123221962752[0;39m ------------- 结束 耗时：167 ms -------------
2021-12-20 11:07:35.134 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970123234545664[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:35.135 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970123234545664[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:35.137 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970123234545664[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:35.138 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970123234545664[0;39m <==      Total: 2
2021-12-20 11:07:35.140 INFO  com.aspect.LogAspect                              :92   [32m127970123234545664[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:35.140 INFO  com.aspect.LogAspect                              :93   [32m127970123234545664[0;39m ------------- 结束 耗时：191 ms -------------
2021-12-20 11:07:35.143 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:35.144 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:35.146 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:35.146 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:35.147 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:35.147 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:35.148 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:35.149 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:35.149 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:35.150 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:35.150 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:35.150 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:35.150 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:35.151 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:35.151 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:35.151 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:35.152 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:35.152 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:35.153 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:35.153 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970123234545665[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:35.154 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970123234545665[0;39m <==      Total: 19
2021-12-20 11:07:35.156 INFO  com.aspect.LogAspect                              :92   [32m127970123234545665[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:35.156 INFO  com.aspect.LogAspect                              :93   [32m127970123234545665[0;39m ------------- 结束 耗时：207 ms -------------
2021-12-20 11:07:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970123502981120[0;39m <==    Updates: 0
2021-12-20 11:07:35.221 INFO  com.job.EbookSnapshotJob                          :35   [32m127970123502981120[0;39m 生成今日电子书快照结束，耗时：208毫秒
2021-12-20 11:07:35.221 INFO  com.job.DocJob                                    :32   [32m127970124375396352[0;39m 更新电子书下的文档数据开始
2021-12-20 11:07:35.221 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970124375396352[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:07:35.222 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970124375396352[0;39m ==> Parameters: 
2021-12-20 11:07:35.363 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970124375396352[0;39m <==    Updates: 3
2021-12-20 11:07:35.364 INFO  com.job.DocJob                                    :35   [32m127970124375396352[0;39m 更新电子书下的文档数据结束，耗时：143毫秒
2021-12-20 11:07:36.343 INFO  com.aspect.LogAspect                              :54   [32m127970129081405440[0;39m ------------- 开始 -------------
2021-12-20 11:07:36.343 INFO  com.aspect.LogAspect                              :55   [32m127970129081405440[0;39m 请求地址: http://localhost:8081/user/list GET
2021-12-20 11:07:36.344 INFO  com.aspect.LogAspect                              :56   [32m127970129081405440[0;39m 类名方法: com.controller.UserController.list
2021-12-20 11:07:36.344 INFO  com.aspect.LogAspect                              :57   [32m127970129081405440[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:36.344 INFO  com.aspect.LogAspect                              :80   [32m127970129081405440[0;39m 请求参数: [{"page":1,"size":10}]
2021-12-20 11:07:36.415 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970129081405440[0;39m ==>  Preparing: SELECT count(0) FROM user
2021-12-20 11:07:36.416 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970129081405440[0;39m ==> Parameters: 
2021-12-20 11:07:36.474 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127970129081405440[0;39m <==    Columns: count(0)
2021-12-20 11:07:36.474 TRACE com.mapper.UserMapper.selectByExample_COUNT       :143  [32m127970129081405440[0;39m <==        Row: 8
2021-12-20 11:07:36.474 DEBUG com.mapper.UserMapper.selectByExample_COUNT       :137  [32m127970129081405440[0;39m <==      Total: 1
2021-12-20 11:07:36.475 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970129081405440[0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-12-20 11:07:36.475 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970129081405440[0;39m ==> Parameters: 10(Integer)
2021-12-20 11:07:36.536 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==    Columns: id, login_name, name, password
2021-12-20 11:07:36.536 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 1, test, 测试, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:36.537 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 119742410820554752, test21, test1, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:36.537 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 120066331910475776, test1, test12, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:36.537 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 120207548115718144, test111, test1112, f418afc57d59e8367c9c226e6906a79d
2021-12-20 11:07:36.538 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 120561372676362240, test159, test222, 409349eb88728b557cbb7e83372fe2bb
2021-12-20 11:07:36.538 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 120902130663034880, test123, test123, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:36.538 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 124192551086460928, test11, test11, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:36.539 TRACE com.mapper.UserMapper.selectByExample             :143  [32m127970129081405440[0;39m <==        Row: 127969710334676992, test12345, 12345, 7354a1d413535a6c0dc5c209e198d799
2021-12-20 11:07:36.539 DEBUG com.mapper.UserMapper.selectByExample             :137  [32m127970129081405440[0;39m <==      Total: 8
2021-12-20 11:07:36.539 INFO  com.servicess.UserService                         :52   [32m127970129081405440[0;39m 总行数：8
2021-12-20 11:07:36.539 INFO  com.servicess.UserService                         :53   [32m127970129081405440[0;39m 总页数：1
2021-12-20 11:07:36.540 INFO  com.aspect.LogAspect                              :92   [32m127970129081405440[0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":119742410820554752,"loginName":"test21","name":"test1"},{"id":120066331910475776,"loginName":"test1","name":"test12"},{"id":120207548115718144,"loginName":"test111","name":"test1112"},{"id":120561372676362240,"loginName":"test159","name":"test222"},{"id":120902130663034880,"loginName":"test123","name":"test123"},{"id":124192551086460928,"loginName":"test11","name":"test11"},{"id":127969710334676992,"loginName":"test12345","name":"12345"}],"total":8},"success":true}
2021-12-20 11:07:36.541 INFO  com.aspect.LogAspect                              :93   [32m127970129081405440[0;39m ------------- 结束 耗时：198 ms -------------
2021-12-20 11:07:38.106 INFO  com.aspect.LogAspect                              :54   [32m127970136475963392[0;39m ------------- 开始 -------------
2021-12-20 11:07:38.106 INFO  com.aspect.LogAspect                              :55   [32m127970136475963392[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:38.107 INFO  com.aspect.LogAspect                              :56   [32m127970136475963392[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:38.107 INFO  com.aspect.LogAspect                              :57   [32m127970136475963392[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:38.107 INFO  com.aspect.LogAspect                              :80   [32m127970136475963392[0;39m 请求参数: []
2021-12-20 11:07:38.173 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970136475963392[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:38.173 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970136475963392[0;39m ==> Parameters: 
2021-12-20 11:07:38.249 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:38.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:38.254 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:38.254 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:38.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:38.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:38.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:38.257 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:38.257 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:38.258 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:38.258 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:38.259 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:38.261 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:38.262 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:38.264 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:38.266 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:38.268 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:38.270 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:38.272 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:38.273 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970136475963392[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:38.274 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970136475963392[0;39m <==      Total: 19
2021-12-20 11:07:38.286 INFO  com.aspect.LogAspect                              :92   [32m127970136475963392[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:38.287 INFO  com.aspect.LogAspect                              :93   [32m127970136475963392[0;39m ------------- 结束 耗时：181 ms -------------
2021-12-20 11:07:39.059 INFO  com.aspect.LogAspect                              :54   [32m127970140473135104[0;39m ------------- 开始 -------------
2021-12-20 11:07:39.059 INFO  com.aspect.LogAspect                              :55   [32m127970140473135104[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:39.059 INFO  com.aspect.LogAspect                              :56   [32m127970140473135104[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:39.059 INFO  com.aspect.LogAspect                              :54   [32m127970140473135105[0;39m ------------- 开始 -------------
2021-12-20 11:07:39.059 INFO  com.aspect.LogAspect                              :57   [32m127970140473135104[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:39.060 INFO  com.aspect.LogAspect                              :55   [32m127970140473135105[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:39.060 INFO  com.aspect.LogAspect                              :80   [32m127970140473135104[0;39m 请求参数: []
2021-12-20 11:07:39.060 INFO  com.aspect.LogAspect                              :56   [32m127970140473135105[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:39.060 INFO  com.aspect.LogAspect                              :57   [32m127970140473135105[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:39.060 INFO  com.aspect.LogAspect                              :80   [32m127970140473135105[0;39m 请求参数: []
2021-12-20 11:07:39.063 INFO  com.aspect.LogAspect                              :54   [32m127970140489912320[0;39m ------------- 开始 -------------
2021-12-20 11:07:39.063 INFO  com.aspect.LogAspect                              :55   [32m127970140489912320[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:39.063 INFO  com.aspect.LogAspect                              :56   [32m127970140489912320[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:39.063 INFO  com.aspect.LogAspect                              :57   [32m127970140489912320[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:39.064 INFO  com.aspect.LogAspect                              :80   [32m127970140489912320[0;39m 请求参数: []
2021-12-20 11:07:39.130 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970140473135104[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:39.130 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970140473135104[0;39m ==> Parameters: 
2021-12-20 11:07:39.142 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970140489912320[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:39.142 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970140489912320[0;39m ==> Parameters: 
2021-12-20 11:07:39.150 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970140473135105[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:39.150 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970140473135105[0;39m ==> Parameters: 
2021-12-20 11:07:39.215 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:39.216 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:39.217 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:39.217 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:39.218 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:39.219 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:39.219 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970140473135104[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:39.220 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:39.220 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970140473135104[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:39.220 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:39.221 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:39.222 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970140473135104[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:39.222 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:39.224 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:39.225 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970140473135104[0;39m <==      Total: 2
2021-12-20 11:07:39.225 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:39.226 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:39.227 INFO  com.aspect.LogAspect                              :92   [32m127970140473135104[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:39.227 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:39.228 INFO  com.aspect.LogAspect                              :93   [32m127970140473135104[0;39m ------------- 结束 耗时：169 ms -------------
2021-12-20 11:07:39.229 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:39.232 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:39.233 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:39.234 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:39.234 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970140473135105[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:39.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:39.237 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970140473135105[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:39.237 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970140489912320[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:39.238 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970140489912320[0;39m <==      Total: 19
2021-12-20 11:07:39.239 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970140473135105[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:39.239 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970140473135105[0;39m <==      Total: 2
2021-12-20 11:07:39.239 INFO  com.aspect.LogAspect                              :92   [32m127970140473135105[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:39.245 INFO  com.aspect.LogAspect                              :93   [32m127970140473135105[0;39m ------------- 结束 耗时：186 ms -------------
2021-12-20 11:07:39.247 INFO  com.aspect.LogAspect                              :92   [32m127970140489912320[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:39.249 INFO  com.aspect.LogAspect                              :93   [32m127970140489912320[0;39m ------------- 结束 耗时：186 ms -------------
2021-12-20 11:07:40.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127970144449335296[0;39m 生成今日电子书快照开始
2021-12-20 11:07:40.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970144449335296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:40.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970144449335296[0;39m ==> Parameters: 
2021-12-20 11:07:40.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970144449335296[0;39m <==    Updates: 0
2021-12-20 11:07:40.249 INFO  com.job.EbookSnapshotJob                          :35   [32m127970144449335296[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 11:07:45.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127970165408272384[0;39m 生成今日电子书快照开始
2021-12-20 11:07:45.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970165408272384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:45.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970165408272384[0;39m ==> Parameters: 
2021-12-20 11:07:45.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970165408272384[0;39m <==    Updates: 0
2021-12-20 11:07:45.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127970165408272384[0;39m 生成今日电子书快照结束，耗时：243毫秒
2021-12-20 11:07:47.364 INFO  com.aspect.LogAspect                              :54   [32m127970175306829824[0;39m ------------- 开始 -------------
2021-12-20 11:07:47.364 INFO  com.aspect.LogAspect                              :55   [32m127970175306829824[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-20 11:07:47.364 INFO  com.aspect.LogAspect                              :56   [32m127970175306829824[0;39m 类名方法: com.controller.EbookController.list
2021-12-20 11:07:47.365 INFO  com.aspect.LogAspect                              :57   [32m127970175306829824[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:47.365 INFO  com.aspect.LogAspect                              :80   [32m127970175306829824[0;39m 请求参数: [{"categoryId2":301,"page":1,"size":1000}]
2021-12-20 11:07:47.483 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m127970175306829824[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-20 11:07:47.484 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m127970175306829824[0;39m ==> Parameters: 301(Long)
2021-12-20 11:07:47.578 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m127970175306829824[0;39m <==    Columns: count(0)
2021-12-20 11:07:47.578 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m127970175306829824[0;39m <==        Row: 1
2021-12-20 11:07:47.579 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m127970175306829824[0;39m <==      Total: 1
2021-12-20 11:07:47.580 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m127970175306829824[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-20 11:07:47.580 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m127970175306829824[0;39m ==> Parameters: 301(Long), 1000(Integer)
2021-12-20 11:07:47.667 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m127970175306829824[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-20 11:07:47.668 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m127970175306829824[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 1, 1, 1
2021-12-20 11:07:47.670 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m127970175306829824[0;39m <==      Total: 1
2021-12-20 11:07:47.673 INFO  com.servicess.EbookService                        :48   [32m127970175306829824[0;39m 总行数：1
2021-12-20 11:07:47.674 INFO  com.servicess.EbookService                        :49   [32m127970175306829824[0;39m 总页数：1
2021-12-20 11:07:47.701 INFO  com.aspect.LogAspect                              :92   [32m127970175306829824[0;39m 返回结果: {"content":{"list":[{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":1,"id":3,"name":"Python入门教程","viewCount":1,"voteCount":1}],"total":1},"success":true}
2021-12-20 11:07:47.701 INFO  com.aspect.LogAspect                              :93   [32m127970175306829824[0;39m ------------- 结束 耗时：337 ms -------------
2021-12-20 11:07:48.644 INFO  com.aspect.LogAspect                              :54   [32m127970180675538944[0;39m ------------- 开始 -------------
2021-12-20 11:07:48.645 INFO  com.aspect.LogAspect                              :55   [32m127970180675538944[0;39m 请求地址: http://localhost:8081/doc/all/3 GET
2021-12-20 11:07:48.645 INFO  com.aspect.LogAspect                              :56   [32m127970180675538944[0;39m 类名方法: com.controller.DocController.all
2021-12-20 11:07:48.645 INFO  com.aspect.LogAspect                              :57   [32m127970180675538944[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:48.645 INFO  com.aspect.LogAspect                              :80   [32m127970180675538944[0;39m 请求参数: [3]
2021-12-20 11:07:48.733 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m127970180675538944[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-20 11:07:48.733 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m127970180675538944[0;39m ==> Parameters: 3(Long)
2021-12-20 11:07:48.795 TRACE com.mapper.DocMapper.selectByExample              :143  [32m127970180675538944[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-20 11:07:48.795 TRACE com.mapper.DocMapper.selectByExample              :143  [32m127970180675538944[0;39m <==        Row: 125274442472493056, 3, 0, test, 1, 1, 1
2021-12-20 11:07:48.795 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m127970180675538944[0;39m <==      Total: 1
2021-12-20 11:07:48.810 INFO  com.aspect.LogAspect                              :92   [32m127970180675538944[0;39m 返回结果: {"content":[{"ebookId":3,"id":125274442472493056,"name":"test","parent":0,"sort":1,"viewCount":1,"voteCount":1}],"success":true}
2021-12-20 11:07:48.826 INFO  com.aspect.LogAspect                              :93   [32m127970180675538944[0;39m ------------- 结束 耗时：182 ms -------------
2021-12-20 11:07:48.849 INFO  com.aspect.LogAspect                              :54   [32m127970181535371264[0;39m ------------- 开始 -------------
2021-12-20 11:07:48.849 INFO  com.aspect.LogAspect                              :55   [32m127970181535371264[0;39m 请求地址: http://localhost:8081/doc/find-content/125274442472493056 GET
2021-12-20 11:07:48.849 INFO  com.aspect.LogAspect                              :56   [32m127970181535371264[0;39m 类名方法: com.controller.DocController.findContent
2021-12-20 11:07:48.849 INFO  com.aspect.LogAspect                              :57   [32m127970181535371264[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:48.850 INFO  com.aspect.LogAspect                              :80   [32m127970181535371264[0;39m 请求参数: [125274442472493056]
2021-12-20 11:07:48.926 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m127970181535371264[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-20 11:07:48.926 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m127970181535371264[0;39m ==> Parameters: 125274442472493056(Long)
2021-12-20 11:07:49.004 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m127970181535371264[0;39m <==    Columns: id, content
2021-12-20 11:07:49.005 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m127970181535371264[0;39m <==        Row: 125274442472493056, <<BLOB>>
2021-12-20 11:07:49.007 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m127970181535371264[0;39m <==      Total: 1
2021-12-20 11:07:49.011 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m127970181535371264[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-20 11:07:49.012 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m127970181535371264[0;39m ==> Parameters: 125274442472493056(Long)
2021-12-20 11:07:49.139 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m127970181535371264[0;39m <==    Updates: 1
2021-12-20 11:07:49.139 INFO  com.aspect.LogAspect                              :92   [32m127970181535371264[0;39m 返回结果: {"content":"","success":true}
2021-12-20 11:07:49.139 INFO  com.aspect.LogAspect                              :93   [32m127970181535371264[0;39m ------------- 结束 耗时：291 ms -------------
2021-12-20 11:07:50.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970186425929728[0;39m 生成今日电子书快照开始
2021-12-20 11:07:50.266 INFO  com.aspect.LogAspect                              :54   [32m127970187478700032[0;39m ------------- 开始 -------------
2021-12-20 11:07:50.266 INFO  com.aspect.LogAspect                              :55   [32m127970187478700032[0;39m 请求地址: http://localhost:8081/doc/vote/125274442472493056 GET
2021-12-20 11:07:50.266 INFO  com.aspect.LogAspect                              :56   [32m127970187478700032[0;39m 类名方法: com.controller.DocController.vote
2021-12-20 11:07:50.266 INFO  com.aspect.LogAspect                              :57   [32m127970187478700032[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:50.266 INFO  com.aspect.LogAspect                              :80   [32m127970187478700032[0;39m 请求参数: [125274442472493056]
2021-12-20 11:07:50.282 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970186425929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:50.282 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970186425929728[0;39m ==> Parameters: 
2021-12-20 11:07:50.337 INFO  com.Util.RedisUtil                                :31   [32m127970187478700032[0;39m key不存在，放入：DOC_VOTE_125274442472493056_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-20 11:07:50.447 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970186425929728[0;39m <==    Updates: 0
2021-12-20 11:07:50.448 INFO  com.job.EbookSnapshotJob                          :35   [32m127970186425929728[0;39m 生成今日电子书快照结束，耗时：433毫秒
2021-12-20 11:07:50.460 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m127970187478700032[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-20 11:07:50.461 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m127970187478700032[0;39m ==> Parameters: 125274442472493056(Long)
2021-12-20 11:07:50.620 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m127970187478700032[0;39m <==    Updates: 1
2021-12-20 11:07:50.623 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m127970187478700032[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-20 11:07:50.624 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m127970187478700032[0;39m ==> Parameters: 125274442472493056(Long)
2021-12-20 11:07:50.704 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m127970187478700032[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-20 11:07:50.704 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m127970187478700032[0;39m <==        Row: 125274442472493056, 3, 0, test, 1, 2, 2
2021-12-20 11:07:50.705 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m127970187478700032[0;39m <==      Total: 1
2021-12-20 11:07:50.707 INFO  com.aspect.LogAspect                              :92   [32m127970187478700032[0;39m 返回结果: {"success":true}
2021-12-20 11:07:50.708 INFO  com.aspect.LogAspect                              :93   [32m127970187478700032[0;39m ------------- 结束 耗时：442 ms -------------
2021-12-20 11:07:50.741 INFO  com.websocket.WebSocketServer                     :71   [32m127970187478700032[0;39m 推送消息：qq7guPEJcB，内容：【test】被点赞！
2021-12-20 11:07:52.003 INFO  com.aspect.LogAspect                              :54   [32m127970194764206080[0;39m ------------- 开始 -------------
2021-12-20 11:07:52.003 INFO  com.aspect.LogAspect                              :54   [32m127970194764206081[0;39m ------------- 开始 -------------
2021-12-20 11:07:52.003 INFO  com.aspect.LogAspect                              :55   [32m127970194764206080[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:07:52.003 INFO  com.aspect.LogAspect                              :55   [32m127970194764206081[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:07:52.003 INFO  com.aspect.LogAspect                              :56   [32m127970194764206080[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :57   [32m127970194764206080[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :56   [32m127970194764206081[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :54   [32m127970194768400384[0;39m ------------- 开始 -------------
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :57   [32m127970194764206081[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :55   [32m127970194768400384[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :80   [32m127970194764206080[0;39m 请求参数: []
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :80   [32m127970194764206081[0;39m 请求参数: []
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :56   [32m127970194768400384[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :57   [32m127970194768400384[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:52.004 INFO  com.aspect.LogAspect                              :80   [32m127970194768400384[0;39m 请求参数: []
2021-12-20 11:07:52.074 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970194764206081[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:52.075 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970194764206081[0;39m ==> Parameters: 
2021-12-20 11:07:52.078 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970194764206080[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:07:52.078 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970194764206080[0;39m ==> Parameters: 
2021-12-20 11:07:52.083 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970194768400384[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:07:52.083 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970194768400384[0;39m ==> Parameters: 
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970194764206081[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970194764206081[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127970194764206081[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:07:52.146 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127970194764206081[0;39m <==      Total: 2
2021-12-20 11:07:52.146 INFO  com.aspect.LogAspect                              :92   [32m127970194764206081[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:07:52.146 INFO  com.aspect.LogAspect                              :93   [32m127970194764206081[0;39m ------------- 结束 耗时：143 ms -------------
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970194764206080[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970194764206080[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:07:52.146 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127970194764206080[0;39m <==        Row: 2021-12-20, 502, 173, 0, 0
2021-12-20 11:07:52.159 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127970194764206080[0;39m <==      Total: 2
2021-12-20 11:07:52.159 INFO  com.aspect.LogAspect                              :92   [32m127970194764206080[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0}],"success":true}
2021-12-20 11:07:52.159 INFO  com.aspect.LogAspect                              :93   [32m127970194764206080[0;39m ------------- 结束 耗时：156 ms -------------
2021-12-20 11:07:52.169 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:07:52.170 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:07:52.171 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:07:52.172 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:07:52.172 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:07:52.173 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:07:52.174 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:07:52.175 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:07:52.176 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:07:52.178 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:07:52.179 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:07:52.180 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:07:52.181 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:07:52.182 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:07:52.184 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:07:52.185 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:07:52.186 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:07:52.187 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:07:52.188 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:07:52.189 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127970194768400384[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:07:52.190 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127970194768400384[0;39m <==      Total: 19
2021-12-20 11:07:52.193 INFO  com.aspect.LogAspect                              :92   [32m127970194768400384[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:07:52.211 INFO  com.aspect.LogAspect                              :93   [32m127970194768400384[0;39m ------------- 结束 耗时：207 ms -------------
2021-12-20 11:07:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127970207351312384[0;39m 生成今日电子书快照开始
2021-12-20 11:07:55.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970207351312384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:07:55.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970207351312384[0;39m ==> Parameters: 
2021-12-20 11:07:55.263 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970207351312384[0;39m <==    Updates: 0
2021-12-20 11:07:55.264 INFO  com.job.EbookSnapshotJob                          :35   [32m127970207351312384[0;39m 生成今日电子书快照结束，耗时：259毫秒
2021-12-20 11:07:57.167 INFO  com.aspect.LogAspect                              :54   [32m127970216423591936[0;39m ------------- 开始 -------------
2021-12-20 11:07:57.168 INFO  com.aspect.LogAspect                              :55   [32m127970216423591936[0;39m 请求地址: http://localhost:8081/user/logout/127970119489032192 GET
2021-12-20 11:07:57.168 INFO  com.aspect.LogAspect                              :56   [32m127970216423591936[0;39m 类名方法: com.controller.UserController.logout
2021-12-20 11:07:57.169 INFO  com.aspect.LogAspect                              :57   [32m127970216423591936[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:07:57.169 INFO  com.aspect.LogAspect                              :80   [32m127970216423591936[0;39m 请求参数: ["127970119489032192"]
2021-12-20 11:07:57.213 INFO  com.controller.UserController                     :89   [32m127970216423591936[0;39m 从redis中删除token：127970119489032192
2021-12-20 11:07:57.213 INFO  com.aspect.LogAspect                              :92   [32m127970216423591936[0;39m 返回结果: {"success":true}
2021-12-20 11:07:57.213 INFO  com.aspect.LogAspect                              :93   [32m127970216423591936[0;39m ------------- 结束 耗时：46 ms -------------
2021-12-20 11:08:00.005 INFO  com.job.EbookSnapshotJob                          :32   [32m127970228327026688[0;39m 生成今日电子书快照开始
2021-12-20 11:08:00.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970228327026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:00.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970228327026688[0;39m ==> Parameters: 
2021-12-20 11:08:00.195 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970228327026688[0;39m <==    Updates: 0
2021-12-20 11:08:00.195 INFO  com.job.EbookSnapshotJob                          :35   [32m127970228327026688[0;39m 生成今日电子书快照结束，耗时：189毫秒
2021-12-20 11:08:05.008 INFO  com.job.DocJob                                    :32   [32m127970249311129600[0;39m 更新电子书下的文档数据开始
2021-12-20 11:08:05.070 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970249311129600[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:08:05.070 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970249311129600[0;39m ==> Parameters: 
2021-12-20 11:08:05.208 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970249311129600[0;39m <==    Updates: 3
2021-12-20 11:08:05.223 INFO  com.job.DocJob                                    :35   [32m127970249311129600[0;39m 更新电子书下的文档数据结束，耗时：215毫秒
2021-12-20 11:08:05.223 INFO  com.job.EbookSnapshotJob                          :32   [32m127970250212904960[0;39m 生成今日电子书快照开始
2021-12-20 11:08:05.223 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970250212904960[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:05.223 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970250212904960[0;39m ==> Parameters: 
2021-12-20 11:08:05.528 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970250212904960[0;39m <==    Updates: 0
2021-12-20 11:08:05.528 INFO  com.job.EbookSnapshotJob                          :35   [32m127970250212904960[0;39m 生成今日电子书快照结束，耗时：305毫秒
2021-12-20 11:08:10.021 INFO  com.job.EbookSnapshotJob                          :32   [32m127970270337175552[0;39m 生成今日电子书快照开始
2021-12-20 11:08:10.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970270337175552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:10.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970270337175552[0;39m ==> Parameters: 
2021-12-20 11:08:10.253 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970270337175552[0;39m <==    Updates: 0
2021-12-20 11:08:10.268 INFO  com.job.EbookSnapshotJob                          :35   [32m127970270337175552[0;39m 生成今日电子书快照结束，耗时：247毫秒
2021-12-20 11:08:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970291283529728[0;39m 生成今日电子书快照开始
2021-12-20 11:08:15.138 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970291283529728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:15.138 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970291283529728[0;39m ==> Parameters: 
2021-12-20 11:08:15.269 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970291283529728[0;39m <==    Updates: 0
2021-12-20 11:08:15.269 INFO  com.job.EbookSnapshotJob                          :35   [32m127970291283529728[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 11:08:20.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127970312259244032[0;39m 生成今日电子书快照开始
2021-12-20 11:08:20.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970312259244032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:20.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970312259244032[0;39m ==> Parameters: 
2021-12-20 11:08:20.208 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970312259244032[0;39m <==    Updates: 0
2021-12-20 11:08:20.208 INFO  com.job.EbookSnapshotJob                          :35   [32m127970312259244032[0;39m 生成今日电子书快照结束，耗时：192毫秒
2021-12-20 11:08:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970333226569728[0;39m 生成今日电子书快照开始
2021-12-20 11:08:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970333226569728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:25.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970333226569728[0;39m ==> Parameters: 
2021-12-20 11:08:25.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970333226569728[0;39m <==    Updates: 0
2021-12-20 11:08:25.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127970333226569728[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:08:30.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127970354193895424[0;39m 生成今日电子书快照开始
2021-12-20 11:08:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970354193895424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:30.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970354193895424[0;39m ==> Parameters: 
2021-12-20 11:08:30.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970354193895424[0;39m <==    Updates: 0
2021-12-20 11:08:30.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127970354193895424[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:08:35.012 INFO  com.job.DocJob                                    :32   [32m127970375157026816[0;39m 更新电子书下的文档数据开始
2021-12-20 11:08:35.081 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970375157026816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:08:35.081 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970375157026816[0;39m ==> Parameters: 
2021-12-20 11:08:35.228 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970375157026816[0;39m <==    Updates: 3
2021-12-20 11:08:35.228 INFO  com.job.DocJob                                    :35   [32m127970375157026816[0;39m 更新电子书下的文档数据结束，耗时：216毫秒
2021-12-20 11:08:35.228 INFO  com.job.EbookSnapshotJob                          :32   [32m127970376062996480[0;39m 生成今日电子书快照开始
2021-12-20 11:08:35.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970376062996480[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:35.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970376062996480[0;39m ==> Parameters: 
2021-12-20 11:08:35.359 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970376062996480[0;39m <==    Updates: 0
2021-12-20 11:08:35.359 INFO  com.job.EbookSnapshotJob                          :35   [32m127970376062996480[0;39m 生成今日电子书快照结束，耗时：116毫秒
2021-12-20 11:08:40.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127970396128546816[0;39m 生成今日电子书快照开始
2021-12-20 11:08:40.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970396128546816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:40.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970396128546816[0;39m ==> Parameters: 
2021-12-20 11:08:40.243 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970396128546816[0;39m <==    Updates: 0
2021-12-20 11:08:40.243 INFO  com.job.EbookSnapshotJob                          :35   [32m127970396128546816[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 11:08:45.027 INFO  com.job.EbookSnapshotJob                          :32   [32m127970417162981376[0;39m 生成今日电子书快照开始
2021-12-20 11:08:45.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970417162981376[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:45.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970417162981376[0;39m ==> Parameters: 
2021-12-20 11:08:45.228 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970417162981376[0;39m <==    Updates: 0
2021-12-20 11:08:45.243 INFO  com.job.EbookSnapshotJob                          :35   [32m127970417162981376[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:08:50.002 INFO  com.job.EbookSnapshotJob                          :32   [32m127970438029643776[0;39m 生成今日电子书快照开始
2021-12-20 11:08:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970438029643776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970438029643776[0;39m ==> Parameters: 
2021-12-20 11:08:50.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970438029643776[0;39m <==    Updates: 0
2021-12-20 11:08:50.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127970438029643776[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:08:55.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127970459097632768[0;39m 生成今日电子书快照开始
2021-12-20 11:08:55.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970459097632768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:08:55.100 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970459097632768[0;39m ==> Parameters: 
2021-12-20 11:08:55.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970459097632768[0;39m <==    Updates: 0
2021-12-20 11:08:55.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127970459097632768[0;39m 生成今日电子书快照结束，耗时：229毫秒
2021-12-20 11:09:00.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127970480023015424[0;39m 生成今日电子书快照开始
2021-12-20 11:09:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970480023015424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970480023015424[0;39m ==> Parameters: 
2021-12-20 11:09:00.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970480023015424[0;39m <==    Updates: 0
2021-12-20 11:09:00.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127970480023015424[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:09:05.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127970500986146816[0;39m 生成今日电子书快照开始
2021-12-20 11:09:05.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970500986146816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:05.081 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970500986146816[0;39m ==> Parameters: 
2021-12-20 11:09:05.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970500986146816[0;39m <==    Updates: 0
2021-12-20 11:09:05.254 INFO  com.job.EbookSnapshotJob                          :35   [32m127970500986146816[0;39m 生成今日电子书快照结束，耗时：242毫秒
2021-12-20 11:09:05.254 INFO  com.job.DocJob                                    :32   [32m127970502001168384[0;39m 更新电子书下的文档数据开始
2021-12-20 11:09:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970502001168384[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:09:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970502001168384[0;39m ==> Parameters: 
2021-12-20 11:09:05.398 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970502001168384[0;39m <==    Updates: 3
2021-12-20 11:09:05.398 INFO  com.job.DocJob                                    :35   [32m127970502001168384[0;39m 更新电子书下的文档数据结束，耗时：144毫秒
2021-12-20 11:09:10.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127970521961861120[0;39m 生成今日电子书快照开始
2021-12-20 11:09:10.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970521961861120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:10.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970521961861120[0;39m ==> Parameters: 
2021-12-20 11:09:10.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970521961861120[0;39m <==    Updates: 0
2021-12-20 11:09:10.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127970521961861120[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:09:15.028 INFO  com.job.EbookSnapshotJob                          :32   [32m127970542996295680[0;39m 生成今日电子书快照开始
2021-12-20 11:09:15.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970542996295680[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:15.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970542996295680[0;39m ==> Parameters: 
2021-12-20 11:09:15.244 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970542996295680[0;39m <==    Updates: 0
2021-12-20 11:09:15.244 INFO  com.job.EbookSnapshotJob                          :35   [32m127970542996295680[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:09:20.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127970563930066944[0;39m 生成今日电子书快照开始
2021-12-20 11:09:20.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970563930066944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:20.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970563930066944[0;39m ==> Parameters: 
2021-12-20 11:09:20.225 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970563930066944[0;39m <==    Updates: 0
2021-12-20 11:09:20.225 INFO  com.job.EbookSnapshotJob                          :35   [32m127970563930066944[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-20 11:09:25.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127970584893198336[0;39m 生成今日电子书快照开始
2021-12-20 11:09:25.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970584893198336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:25.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970584893198336[0;39m ==> Parameters: 
2021-12-20 11:09:25.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970584893198336[0;39m <==    Updates: 0
2021-12-20 11:09:25.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127970584893198336[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-20 11:09:30.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127970605864718336[0;39m 生成今日电子书快照开始
2021-12-20 11:09:30.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970605864718336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:30.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970605864718336[0;39m ==> Parameters: 
2021-12-20 11:09:30.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970605864718336[0;39m <==    Updates: 0
2021-12-20 11:09:30.217 INFO  com.job.EbookSnapshotJob                          :35   [32m127970605864718336[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:09:35.017 INFO  com.job.DocJob                                    :32   [32m127970626836238336[0;39m 更新电子书下的文档数据开始
2021-12-20 11:09:35.069 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970626836238336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:09:35.069 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970626836238336[0;39m ==> Parameters: 
2021-12-20 11:09:35.233 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970626836238336[0;39m <==    Updates: 3
2021-12-20 11:09:35.233 INFO  com.job.DocJob                                    :35   [32m127970626836238336[0;39m 更新电子书下的文档数据结束，耗时：216毫秒
2021-12-20 11:09:35.233 INFO  com.job.EbookSnapshotJob                          :32   [32m127970627742208000[0;39m 生成今日电子书快照开始
2021-12-20 11:09:35.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970627742208000[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:35.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970627742208000[0;39m ==> Parameters: 
2021-12-20 11:09:35.386 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970627742208000[0;39m <==    Updates: 0
2021-12-20 11:09:35.402 INFO  com.job.EbookSnapshotJob                          :35   [32m127970627742208000[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-20 11:09:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970647799369728[0;39m 生成今日电子书快照开始
2021-12-20 11:09:40.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970647799369728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:40.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970647799369728[0;39m ==> Parameters: 
2021-12-20 11:09:40.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970647799369728[0;39m <==    Updates: 0
2021-12-20 11:09:40.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127970647799369728[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:09:45.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127970668762501120[0;39m 生成今日电子书快照开始
2021-12-20 11:09:45.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970668762501120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:45.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970668762501120[0;39m ==> Parameters: 
2021-12-20 11:09:45.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970668762501120[0;39m <==    Updates: 0
2021-12-20 11:09:45.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127970668762501120[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:09:50.026 INFO  com.job.EbookSnapshotJob                          :32   [32m127970689788547072[0;39m 生成今日电子书快照开始
2021-12-20 11:09:50.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970689788547072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:50.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970689788547072[0;39m ==> Parameters: 
2021-12-20 11:09:50.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970689788547072[0;39m <==    Updates: 0
2021-12-20 11:09:50.231 INFO  com.job.EbookSnapshotJob                          :35   [32m127970689788547072[0;39m 生成今日电子书快照结束，耗时：205毫秒
2021-12-20 11:09:55.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127970710663598080[0;39m 生成今日电子书快照开始
2021-12-20 11:09:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970710663598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:09:55.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970710663598080[0;39m ==> Parameters: 
2021-12-20 11:09:55.257 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970710663598080[0;39m <==    Updates: 0
2021-12-20 11:09:55.257 INFO  com.job.EbookSnapshotJob                          :35   [32m127970710663598080[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 11:10:00.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127970731693838336[0;39m 生成今日电子书快照开始
2021-12-20 11:10:00.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970731693838336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:00.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970731693838336[0;39m ==> Parameters: 
2021-12-20 11:10:00.255 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970731693838336[0;39m <==    Updates: 0
2021-12-20 11:10:00.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127970731693838336[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:10:05.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127970752661164032[0;39m 生成今日电子书快照开始
2021-12-20 11:10:05.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970752661164032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:05.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970752661164032[0;39m ==> Parameters: 
2021-12-20 11:10:05.201 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970752661164032[0;39m <==    Updates: 0
2021-12-20 11:10:05.201 INFO  com.job.EbookSnapshotJob                          :35   [32m127970752661164032[0;39m 生成今日电子书快照结束，耗时：185毫秒
2021-12-20 11:10:05.201 INFO  com.job.DocJob                                    :32   [32m127970753437110272[0;39m 更新电子书下的文档数据开始
2021-12-20 11:10:05.201 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970753437110272[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:10:05.201 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970753437110272[0;39m ==> Parameters: 
2021-12-20 11:10:05.347 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970753437110272[0;39m <==    Updates: 3
2021-12-20 11:10:05.347 INFO  com.job.DocJob                                    :35   [32m127970753437110272[0;39m 更新电子书下的文档数据结束，耗时：146毫秒
2021-12-20 11:10:10.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970773628489728[0;39m 生成今日电子书快照开始
2021-12-20 11:10:10.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970773628489728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:10.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970773628489728[0;39m ==> Parameters: 
2021-12-20 11:10:10.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970773628489728[0;39m <==    Updates: 0
2021-12-20 11:10:10.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127970773628489728[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:10:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127970794600009728[0;39m 生成今日电子书快照开始
2021-12-20 11:10:15.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970794600009728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:15.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970794600009728[0;39m ==> Parameters: 
2021-12-20 11:10:15.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970794600009728[0;39m <==    Updates: 0
2021-12-20 11:10:15.246 INFO  com.job.EbookSnapshotJob                          :35   [32m127970794600009728[0;39m 生成今日电子书快照结束，耗时：231毫秒
2021-12-20 11:10:20.013 INFO  com.job.EbookSnapshotJob                          :32   [32m127970815563141120[0;39m 生成今日电子书快照开始
2021-12-20 11:10:20.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970815563141120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:20.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970815563141120[0;39m ==> Parameters: 
2021-12-20 11:10:20.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970815563141120[0;39m <==    Updates: 0
2021-12-20 11:10:20.229 INFO  com.job.EbookSnapshotJob                          :35   [32m127970815563141120[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:10:25.026 INFO  com.job.EbookSnapshotJob                          :32   [32m127970836589187072[0;39m 生成今日电子书快照开始
2021-12-20 11:10:25.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970836589187072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:25.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970836589187072[0;39m ==> Parameters: 
2021-12-20 11:10:25.274 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970836589187072[0;39m <==    Updates: 0
2021-12-20 11:10:25.274 INFO  com.job.EbookSnapshotJob                          :35   [32m127970836589187072[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 11:10:30.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127970857522958336[0;39m 生成今日电子书快照开始
2021-12-20 11:10:30.118 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970857522958336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:30.118 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970857522958336[0;39m ==> Parameters: 
2021-12-20 11:10:30.256 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970857522958336[0;39m <==    Updates: 0
2021-12-20 11:10:30.256 INFO  com.job.EbookSnapshotJob                          :35   [32m127970857522958336[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 11:10:35.014 INFO  com.job.DocJob                                    :32   [32m127970878481895424[0;39m 更新电子书下的文档数据开始
2021-12-20 11:10:35.067 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970878481895424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:10:35.067 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970878481895424[0;39m ==> Parameters: 
2021-12-20 11:10:35.221 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127970878481895424[0;39m <==    Updates: 3
2021-12-20 11:10:35.221 INFO  com.job.DocJob                                    :35   [32m127970878481895424[0;39m 更新电子书下的文档数据结束，耗时：207毫秒
2021-12-20 11:10:35.221 INFO  com.job.EbookSnapshotJob                          :32   [32m127970879350116352[0;39m 生成今日电子书快照开始
2021-12-20 11:10:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970879350116352[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970879350116352[0;39m ==> Parameters: 
2021-12-20 11:10:35.337 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970879350116352[0;39m <==    Updates: 0
2021-12-20 11:10:35.352 INFO  com.job.EbookSnapshotJob                          :35   [32m127970879350116352[0;39m 生成今日电子书快照结束，耗时：131毫秒
2021-12-20 11:10:40.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127970899436638208[0;39m 生成今日电子书快照开始
2021-12-20 11:10:40.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970899436638208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:40.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970899436638208[0;39m ==> Parameters: 
2021-12-20 11:10:40.233 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970899436638208[0;39m <==    Updates: 0
2021-12-20 11:10:40.233 INFO  com.job.EbookSnapshotJob                          :35   [32m127970899436638208[0;39m 生成今日电子书快照结束，耗时：223毫秒
2021-12-20 11:10:45.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127970920403963904[0;39m 生成今日电子书快照开始
2021-12-20 11:10:45.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970920403963904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:45.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970920403963904[0;39m ==> Parameters: 
2021-12-20 11:10:45.248 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970920403963904[0;39m <==    Updates: 0
2021-12-20 11:10:45.248 INFO  com.job.EbookSnapshotJob                          :35   [32m127970920403963904[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 11:10:50.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127970941442592768[0;39m 生成今日电子书快照开始
2021-12-20 11:10:50.162 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970941442592768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:50.162 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970941442592768[0;39m ==> Parameters: 
2021-12-20 11:10:50.309 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970941442592768[0;39m <==    Updates: 0
2021-12-20 11:10:50.309 INFO  com.job.EbookSnapshotJob                          :35   [32m127970941442592768[0;39m 生成今日电子书快照结束，耗时：284毫秒
2021-12-20 11:10:55.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127970962401529856[0;39m 生成今日电子书快照开始
2021-12-20 11:10:55.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970962401529856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:10:55.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970962401529856[0;39m ==> Parameters: 
2021-12-20 11:10:55.237 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970962401529856[0;39m <==    Updates: 0
2021-12-20 11:10:55.237 INFO  com.job.EbookSnapshotJob                          :35   [32m127970962401529856[0;39m 生成今日电子书快照结束，耗时：215毫秒
2021-12-20 11:11:00.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127970983364661248[0;39m 生成今日电子书快照开始
2021-12-20 11:11:00.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970983364661248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:00.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970983364661248[0;39m ==> Parameters: 
2021-12-20 11:11:00.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127970983364661248[0;39m <==    Updates: 0
2021-12-20 11:11:00.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127970983364661248[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:11:05.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127971004336181248[0;39m 生成今日电子书快照开始
2021-12-20 11:11:05.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971004336181248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:05.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971004336181248[0;39m ==> Parameters: 
2021-12-20 11:11:05.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971004336181248[0;39m <==    Updates: 0
2021-12-20 11:11:05.236 INFO  com.job.EbookSnapshotJob                          :35   [32m127971004336181248[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:11:05.236 INFO  com.job.DocJob                                    :32   [32m127971005242150912[0;39m 更新电子书下的文档数据开始
2021-12-20 11:11:05.236 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971005242150912[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:11:05.236 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971005242150912[0;39m ==> Parameters: 
2021-12-20 11:11:05.405 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971005242150912[0;39m <==    Updates: 3
2021-12-20 11:11:05.405 INFO  com.job.DocJob                                    :35   [32m127971005242150912[0;39m 更新电子书下的文档数据结束，耗时：169毫秒
2021-12-20 11:11:10.034 INFO  com.job.EbookSnapshotJob                          :32   [32m127971025366421504[0;39m 生成今日电子书快照开始
2021-12-20 11:11:10.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971025366421504[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:10.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971025366421504[0;39m ==> Parameters: 
2021-12-20 11:11:10.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971025366421504[0;39m <==    Updates: 0
2021-12-20 11:11:10.234 INFO  com.job.EbookSnapshotJob                          :35   [32m127971025366421504[0;39m 生成今日电子书快照结束，耗时：199毫秒
2021-12-20 11:11:15.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971046241472512[0;39m 生成今日电子书快照开始
2021-12-20 11:11:15.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971046241472512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:15.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971046241472512[0;39m ==> Parameters: 
2021-12-20 11:11:15.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971046241472512[0;39m <==    Updates: 0
2021-12-20 11:11:15.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127971046241472512[0;39m 生成今日电子书快照结束，耗时：241毫秒
2021-12-20 11:11:20.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127971067208798208[0;39m 生成今日电子书快照开始
2021-12-20 11:11:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971067208798208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971067208798208[0;39m ==> Parameters: 
2021-12-20 11:11:20.210 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971067208798208[0;39m <==    Updates: 0
2021-12-20 11:11:20.210 INFO  com.job.EbookSnapshotJob                          :35   [32m127971067208798208[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:11:25.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971088171929600[0;39m 生成今日电子书快照开始
2021-12-20 11:11:25.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971088171929600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:25.093 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971088171929600[0;39m ==> Parameters: 
2021-12-20 11:11:25.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971088171929600[0;39m <==    Updates: 0
2021-12-20 11:11:25.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127971088171929600[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:11:30.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127971109206364160[0;39m 生成今日电子书快照开始
2021-12-20 11:11:30.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971109206364160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:30.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971109206364160[0;39m ==> Parameters: 
2021-12-20 11:11:30.239 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971109206364160[0;39m <==    Updates: 0
2021-12-20 11:11:30.239 INFO  com.job.EbookSnapshotJob                          :35   [32m127971109206364160[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:11:35.005 INFO  com.job.DocJob                                    :32   [32m127971130102386688[0;39m 更新电子书下的文档数据开始
2021-12-20 11:11:35.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971130102386688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:11:35.068 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971130102386688[0;39m ==> Parameters: 
2021-12-20 11:11:35.221 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971130102386688[0;39m <==    Updates: 3
2021-12-20 11:11:35.221 INFO  com.job.DocJob                                    :35   [32m127971130102386688[0;39m 更新电子书下的文档数据结束，耗时：216毫秒
2021-12-20 11:11:35.221 INFO  com.job.EbookSnapshotJob                          :32   [32m127971131008356352[0;39m 生成今日电子书快照开始
2021-12-20 11:11:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971131008356352[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:35.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971131008356352[0;39m ==> Parameters: 
2021-12-20 11:11:35.390 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971131008356352[0;39m <==    Updates: 0
2021-12-20 11:11:35.390 INFO  com.job.EbookSnapshotJob                          :35   [32m127971131008356352[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-20 11:11:40.021 INFO  com.job.EbookSnapshotJob                          :32   [32m127971151141015552[0;39m 生成今日电子书快照开始
2021-12-20 11:11:40.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971151141015552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:40.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971151141015552[0;39m ==> Parameters: 
2021-12-20 11:11:40.237 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971151141015552[0;39m <==    Updates: 0
2021-12-20 11:11:40.237 INFO  com.job.EbookSnapshotJob                          :35   [32m127971151141015552[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:11:45.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127971172083175424[0;39m 生成今日电子书快照开始
2021-12-20 11:11:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971172083175424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971172083175424[0;39m ==> Parameters: 
2021-12-20 11:11:45.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971172083175424[0;39m <==    Updates: 0
2021-12-20 11:11:45.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127971172083175424[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:11:50.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971193042112512[0;39m 生成今日电子书快照开始
2021-12-20 11:11:50.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971193042112512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:50.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971193042112512[0;39m ==> Parameters: 
2021-12-20 11:11:50.215 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971193042112512[0;39m <==    Updates: 0
2021-12-20 11:11:50.215 INFO  com.job.EbookSnapshotJob                          :35   [32m127971193042112512[0;39m 生成今日电子书快照结束，耗时：204毫秒
2021-12-20 11:11:55.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127971214072352768[0;39m 生成今日电子书快照开始
2021-12-20 11:11:55.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971214072352768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:11:55.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971214072352768[0;39m ==> Parameters: 
2021-12-20 11:11:55.247 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971214072352768[0;39m <==    Updates: 0
2021-12-20 11:11:55.247 INFO  com.job.EbookSnapshotJob                          :35   [32m127971214072352768[0;39m 生成今日电子书快照结束，耗时：222毫秒
2021-12-20 11:12:00.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127971234976763904[0;39m 生成今日电子书快照开始
2021-12-20 11:12:00.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971234976763904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:00.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971234976763904[0;39m ==> Parameters: 
2021-12-20 11:12:00.326 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971234976763904[0;39m <==    Updates: 0
2021-12-20 11:12:00.342 INFO  com.job.EbookSnapshotJob                          :35   [32m127971234976763904[0;39m 生成今日电子书快照结束，耗时：333毫秒
2021-12-20 11:12:05.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127971255948283904[0;39m 生成今日电子书快照开始
2021-12-20 11:12:05.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971255948283904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:05.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971255948283904[0;39m ==> Parameters: 
2021-12-20 11:12:05.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971255948283904[0;39m <==    Updates: 0
2021-12-20 11:12:05.241 INFO  com.job.EbookSnapshotJob                          :35   [32m127971255948283904[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:12:05.241 INFO  com.job.DocJob                                    :32   [32m127971256921362432[0;39m 更新电子书下的文档数据开始
2021-12-20 11:12:05.241 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971256921362432[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:12:05.241 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971256921362432[0;39m ==> Parameters: 
2021-12-20 11:12:05.411 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971256921362432[0;39m <==    Updates: 3
2021-12-20 11:12:05.411 INFO  com.job.DocJob                                    :35   [32m127971256921362432[0;39m 更新电子书下的文档数据结束，耗时：170毫秒
2021-12-20 11:12:10.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971276915609600[0;39m 生成今日电子书快照开始
2021-12-20 11:12:10.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971276915609600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:10.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971276915609600[0;39m ==> Parameters: 
2021-12-20 11:12:10.192 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971276915609600[0;39m <==    Updates: 0
2021-12-20 11:12:10.192 INFO  com.job.EbookSnapshotJob                          :35   [32m127971276915609600[0;39m 生成今日电子书快照结束，耗时：184毫秒
2021-12-20 11:12:15.020 INFO  com.job.EbookSnapshotJob                          :32   [32m127971297937461248[0;39m 生成今日电子书快照开始
2021-12-20 11:12:15.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971297937461248[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:15.098 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971297937461248[0;39m ==> Parameters: 
2021-12-20 11:12:15.237 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971297937461248[0;39m <==    Updates: 0
2021-12-20 11:12:15.237 INFO  com.job.EbookSnapshotJob                          :35   [32m127971297937461248[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:12:20.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127971318883815424[0;39m 生成今日电子书快照开始
2021-12-20 11:12:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971318883815424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971318883815424[0;39m ==> Parameters: 
2021-12-20 11:12:20.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971318883815424[0;39m <==    Updates: 0
2021-12-20 11:12:20.219 INFO  com.job.EbookSnapshotJob                          :35   [32m127971318883815424[0;39m 生成今日电子书快照结束，耗时：205毫秒
2021-12-20 11:12:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127971339859529728[0;39m 生成今日电子书快照开始
2021-12-20 11:12:25.328 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971339859529728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:25.334 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971339859529728[0;39m ==> Parameters: 
2021-12-20 11:12:25.535 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971339859529728[0;39m <==    Updates: 0
2021-12-20 11:12:25.535 INFO  com.job.EbookSnapshotJob                          :35   [32m127971339859529728[0;39m 生成今日电子书快照结束，耗时：520毫秒
2021-12-20 11:12:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m127971360831049728[0;39m 生成今日电子书快照开始
2021-12-20 11:12:30.283 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971360831049728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:30.283 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971360831049728[0;39m ==> Parameters: 
2021-12-20 11:12:30.816 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971360831049728[0;39m <==    Updates: 0
2021-12-20 11:12:30.816 INFO  com.job.EbookSnapshotJob                          :35   [32m127971360831049728[0;39m 生成今日电子书快照结束，耗时：801毫秒
2021-12-20 11:12:35.012 INFO  com.job.DocJob                                    :32   [32m127971381789986816[0;39m 更新电子书下的文档数据开始
2021-12-20 11:12:35.082 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971381789986816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:12:35.082 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971381789986816[0;39m ==> Parameters: 
2021-12-20 11:12:35.229 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971381789986816[0;39m <==    Updates: 3
2021-12-20 11:12:35.229 INFO  com.job.DocJob                                    :35   [32m127971381789986816[0;39m 更新电子书下的文档数据结束，耗时：217毫秒
2021-12-20 11:12:35.229 INFO  com.job.EbookSnapshotJob                          :32   [32m127971382700150784[0;39m 生成今日电子书快照开始
2021-12-20 11:12:35.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971382700150784[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:35.229 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971382700150784[0;39m ==> Parameters: 
2021-12-20 11:12:35.398 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971382700150784[0;39m <==    Updates: 0
2021-12-20 11:12:35.398 INFO  com.job.EbookSnapshotJob                          :35   [32m127971382700150784[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-20 11:12:40.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971402757312512[0;39m 生成今日电子书快照开始
2021-12-20 11:12:40.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971402757312512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:40.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971402757312512[0;39m ==> Parameters: 
2021-12-20 11:12:40.259 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971402757312512[0;39m <==    Updates: 0
2021-12-20 11:12:40.259 INFO  com.job.EbookSnapshotJob                          :35   [32m127971402757312512[0;39m 生成今日电子书快照结束，耗时：248毫秒
2021-12-20 11:12:45.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971423716249600[0;39m 生成今日电子书快照开始
2021-12-20 11:12:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971423716249600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:45.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971423716249600[0;39m ==> Parameters: 
2021-12-20 11:12:45.209 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971423716249600[0;39m <==    Updates: 0
2021-12-20 11:12:45.209 INFO  com.job.EbookSnapshotJob                          :35   [32m127971423716249600[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:12:50.023 INFO  com.job.EbookSnapshotJob                          :32   [32m127971444750684160[0;39m 生成今日电子书快照开始
2021-12-20 11:12:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971444750684160[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:50.086 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971444750684160[0;39m ==> Parameters: 
2021-12-20 11:12:50.223 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971444750684160[0;39m <==    Updates: 0
2021-12-20 11:12:50.223 INFO  com.job.EbookSnapshotJob                          :35   [32m127971444750684160[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:12:55.016 INFO  com.job.EbookSnapshotJob                          :32   [32m127971465692844032[0;39m 生成今日电子书快照开始
2021-12-20 11:12:55.368 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971465692844032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:12:55.368 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971465692844032[0;39m ==> Parameters: 
2021-12-20 11:12:55.554 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971465692844032[0;39m <==    Updates: 0
2021-12-20 11:12:55.569 INFO  com.job.EbookSnapshotJob                          :35   [32m127971465692844032[0;39m 生成今日电子书快照结束，耗时：553毫秒
2021-12-20 11:13:00.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127971486655975424[0;39m 生成今日电子书快照开始
2021-12-20 11:13:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971486655975424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971486655975424[0;39m ==> Parameters: 
2021-12-20 11:13:00.252 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971486655975424[0;39m <==    Updates: 0
2021-12-20 11:13:00.252 INFO  com.job.EbookSnapshotJob                          :35   [32m127971486655975424[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:13:05.012 INFO  com.job.EbookSnapshotJob                          :32   [32m127971507619106816[0;39m 生成今日电子书快照开始
2021-12-20 11:13:05.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971507619106816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:05.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971507619106816[0;39m ==> Parameters: 
2021-12-20 11:13:05.213 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971507619106816[0;39m <==    Updates: 0
2021-12-20 11:13:05.213 INFO  com.job.EbookSnapshotJob                          :35   [32m127971507619106816[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:13:05.213 INFO  com.job.DocJob                                    :32   [32m127971508462161920[0;39m 更新电子书下的文档数据开始
2021-12-20 11:13:05.213 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971508462161920[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:13:05.213 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971508462161920[0;39m ==> Parameters: 
2021-12-20 11:13:05.367 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971508462161920[0;39m <==    Updates: 3
2021-12-20 11:13:05.367 INFO  com.job.DocJob                                    :35   [32m127971508462161920[0;39m 更新电子书下的文档数据结束，耗时：154毫秒
2021-12-20 11:13:10.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127971528582238208[0;39m 生成今日电子书快照开始
2021-12-20 11:13:10.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971528582238208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:10.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971528582238208[0;39m ==> Parameters: 
2021-12-20 11:13:10.227 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971528582238208[0;39m <==    Updates: 0
2021-12-20 11:13:10.227 INFO  com.job.EbookSnapshotJob                          :35   [32m127971528582238208[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:13:15.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971549545369600[0;39m 生成今日电子书快照开始
2021-12-20 11:13:15.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971549545369600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:15.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971549545369600[0;39m ==> Parameters: 
2021-12-20 11:13:15.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971549545369600[0;39m <==    Updates: 0
2021-12-20 11:13:15.240 INFO  com.job.EbookSnapshotJob                          :35   [32m127971549545369600[0;39m 生成今日电子书快照结束，耗时：232毫秒
2021-12-20 11:13:20.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127971570512695296[0;39m 生成今日电子书快照开始
2021-12-20 11:13:20.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971570512695296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:20.069 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971570512695296[0;39m ==> Parameters: 
2021-12-20 11:13:20.208 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971570512695296[0;39m <==    Updates: 0
2021-12-20 11:13:20.208 INFO  com.job.EbookSnapshotJob                          :35   [32m127971570512695296[0;39m 生成今日电子书快照结束，耗时：201毫秒
2021-12-20 11:13:25.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127971591534546944[0;39m 生成今日电子书快照开始
2021-12-20 11:13:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971591534546944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:25.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971591534546944[0;39m ==> Parameters: 
2021-12-20 11:13:25.236 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971591534546944[0;39m <==    Updates: 0
2021-12-20 11:13:25.236 INFO  com.job.EbookSnapshotJob                          :35   [32m127971591534546944[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:13:30.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971612472512512[0;39m 生成今日电子书快照开始
2021-12-20 11:13:30.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971612472512512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:30.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971612472512512[0;39m ==> Parameters: 
2021-12-20 11:13:30.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971612472512512[0;39m <==    Updates: 0
2021-12-20 11:13:30.218 INFO  com.job.EbookSnapshotJob                          :35   [32m127971612472512512[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-20 11:13:35.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971633431449600[0;39m 生成今日电子书快照开始
2021-12-20 11:13:35.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971633431449600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:35.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971633431449600[0;39m ==> Parameters: 
2021-12-20 11:13:35.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971633431449600[0;39m <==    Updates: 0
2021-12-20 11:13:35.214 INFO  com.job.EbookSnapshotJob                          :35   [32m127971633431449600[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-20 11:13:35.214 INFO  com.job.DocJob                                    :32   [32m127971634295476224[0;39m 更新电子书下的文档数据开始
2021-12-20 11:13:35.214 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971634295476224[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:13:35.214 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971634295476224[0;39m ==> Parameters: 
2021-12-20 11:13:35.363 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971634295476224[0;39m <==    Updates: 3
2021-12-20 11:13:35.363 INFO  com.job.DocJob                                    :35   [32m127971634295476224[0;39m 更新电子书下的文档数据结束，耗时：149毫秒
2021-12-20 11:13:40.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127971654398775296[0;39m 生成今日电子书快照开始
2021-12-20 11:13:40.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971654398775296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:40.092 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971654398775296[0;39m ==> Parameters: 
2021-12-20 11:13:40.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971654398775296[0;39m <==    Updates: 0
2021-12-20 11:13:40.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127971654398775296[0;39m 生成今日电子书快照结束，耗时：238毫秒
2021-12-20 11:13:45.021 INFO  com.job.EbookSnapshotJob                          :32   [32m127971675429015552[0;39m 生成今日电子书快照开始
2021-12-20 11:13:45.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971675429015552[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:45.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971675429015552[0;39m ==> Parameters: 
2021-12-20 11:13:45.275 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971675429015552[0;39m <==    Updates: 0
2021-12-20 11:13:45.275 INFO  com.job.EbookSnapshotJob                          :35   [32m127971675429015552[0;39m 生成今日电子书快照结束，耗时：254毫秒
2021-12-20 11:13:50.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127971696392146944[0;39m 生成今日电子书快照开始
2021-12-20 11:13:50.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971696392146944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:50.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971696392146944[0;39m ==> Parameters: 
2021-12-20 11:13:50.219 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971696392146944[0;39m <==    Updates: 0
2021-12-20 11:13:50.219 INFO  com.job.EbookSnapshotJob                          :35   [32m127971696392146944[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:13:55.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127971717359472640[0;39m 生成今日电子书快照开始
2021-12-20 11:13:55.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971717359472640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:13:55.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971717359472640[0;39m ==> Parameters: 
2021-12-20 11:13:55.235 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971717359472640[0;39m <==    Updates: 0
2021-12-20 11:13:55.235 INFO  com.job.EbookSnapshotJob                          :35   [32m127971717359472640[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:14:00.017 INFO  com.job.EbookSnapshotJob                          :32   [32m127971738326798336[0;39m 生成今日电子书快照开始
2021-12-20 11:14:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971738326798336[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:00.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971738326798336[0;39m ==> Parameters: 
2021-12-20 11:14:00.234 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971738326798336[0;39m <==    Updates: 0
2021-12-20 11:14:00.234 INFO  com.job.EbookSnapshotJob                          :35   [32m127971738326798336[0;39m 生成今日电子书快照结束，耗时：217毫秒
2021-12-20 11:14:05.008 INFO  com.job.EbookSnapshotJob                          :32   [32m127971759260569600[0;39m 生成今日电子书快照开始
2021-12-20 11:14:05.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971759260569600[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:05.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971759260569600[0;39m ==> Parameters: 
2021-12-20 11:14:05.212 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971759260569600[0;39m <==    Updates: 0
2021-12-20 11:14:05.212 INFO  com.job.EbookSnapshotJob                          :35   [32m127971759260569600[0;39m 生成今日电子书快照结束，耗时：204毫秒
2021-12-20 11:14:05.212 INFO  com.job.DocJob                                    :32   [32m127971760116207616[0;39m 更新电子书下的文档数据开始
2021-12-20 11:14:05.212 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971760116207616[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:14:05.212 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971760116207616[0;39m ==> Parameters: 
2021-12-20 11:14:05.350 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971760116207616[0;39m <==    Updates: 3
2021-12-20 11:14:05.350 INFO  com.job.DocJob                                    :35   [32m127971760116207616[0;39m 更新电子书下的文档数据结束，耗时：138毫秒
2021-12-20 11:14:10.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971780244672512[0;39m 生成今日电子书快照开始
2021-12-20 11:14:10.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971780244672512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:10.068 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971780244672512[0;39m ==> Parameters: 
2021-12-20 11:14:10.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971780244672512[0;39m <==    Updates: 0
2021-12-20 11:14:10.214 INFO  com.job.EbookSnapshotJob                          :35   [32m127971780244672512[0;39m 生成今日电子书快照结束，耗时：203毫秒
2021-12-20 11:14:15.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127971801216192512[0;39m 生成今日电子书快照开始
2021-12-20 11:14:15.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971801216192512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:15.080 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971801216192512[0;39m ==> Parameters: 
2021-12-20 11:14:15.249 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971801216192512[0;39m <==    Updates: 0
2021-12-20 11:14:15.250 INFO  com.job.EbookSnapshotJob                          :35   [32m127971801216192512[0;39m 生成今日电子书快照结束，耗时：239毫秒
2021-12-20 11:14:20.010 INFO  com.job.EbookSnapshotJob                          :32   [32m127971822183518208[0;39m 生成今日电子书快照开始
2021-12-20 11:14:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971822183518208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:20.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971822183518208[0;39m ==> Parameters: 
2021-12-20 11:14:20.210 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971822183518208[0;39m <==    Updates: 0
2021-12-20 11:14:20.210 INFO  com.job.EbookSnapshotJob                          :35   [32m127971822183518208[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:14:25.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127971843150843904[0;39m 生成今日电子书快照开始
2021-12-20 11:14:25.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971843150843904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:25.076 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971843150843904[0;39m ==> Parameters: 
2021-12-20 11:14:25.324 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971843150843904[0;39m <==    Updates: 0
2021-12-20 11:14:25.324 INFO  com.job.EbookSnapshotJob                          :35   [32m127971843150843904[0;39m 生成今日电子书快照结束，耗时：315毫秒
2021-12-20 11:14:30.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127971864176889856[0;39m 生成今日电子书快照开始
2021-12-20 11:14:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971864176889856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:30.084 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971864176889856[0;39m ==> Parameters: 
2021-12-20 11:14:30.222 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971864176889856[0;39m <==    Updates: 0
2021-12-20 11:14:30.222 INFO  com.job.EbookSnapshotJob                          :35   [32m127971864176889856[0;39m 生成今日电子书快照结束，耗时：200毫秒
2021-12-20 11:14:35.019 INFO  com.job.EbookSnapshotJob                          :32   [32m127971885135826944[0;39m 生成今日电子书快照开始
2021-12-20 11:14:35.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971885135826944[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:35.103 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971885135826944[0;39m ==> Parameters: 
2021-12-20 11:14:35.235 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971885135826944[0;39m <==    Updates: 0
2021-12-20 11:14:35.235 INFO  com.job.EbookSnapshotJob                          :35   [32m127971885135826944[0;39m 生成今日电子书快照结束，耗时：216毫秒
2021-12-20 11:14:35.235 INFO  com.job.DocJob                                    :32   [32m127971886041796608[0;39m 更新电子书下的文档数据开始
2021-12-20 11:14:35.235 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971886041796608[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:14:35.235 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971886041796608[0;39m ==> Parameters: 
2021-12-20 11:14:35.498 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127971886041796608[0;39m <==    Updates: 3
2021-12-20 11:14:35.498 INFO  com.job.DocJob                                    :35   [32m127971886041796608[0;39m 更新电子书下的文档数据结束，耗时：263毫秒
2021-12-20 11:14:40.014 INFO  com.job.EbookSnapshotJob                          :32   [32m127971906086375424[0;39m 生成今日电子书快照开始
2021-12-20 11:14:40.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971906086375424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:40.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971906086375424[0;39m ==> Parameters: 
2021-12-20 11:14:40.198 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971906086375424[0;39m <==    Updates: 0
2021-12-20 11:14:40.198 INFO  com.job.EbookSnapshotJob                          :35   [32m127971906086375424[0;39m 生成今日电子书快照结束，耗时：184毫秒
2021-12-20 11:14:45.025 INFO  com.job.EbookSnapshotJob                          :32   [32m127971927104032768[0;39m 生成今日电子书快照开始
2021-12-20 11:14:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971927104032768[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:45.083 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971927104032768[0;39m ==> Parameters: 
2021-12-20 11:14:45.232 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971927104032768[0;39m <==    Updates: 0
2021-12-20 11:14:45.232 INFO  com.job.EbookSnapshotJob                          :35   [32m127971927104032768[0;39m 生成今日电子书快照结束，耗时：207毫秒
2021-12-20 11:14:50.018 INFO  com.job.EbookSnapshotJob                          :32   [32m127971948046192640[0;39m 生成今日电子书快照开始
2021-12-20 11:14:50.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971948046192640[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:50.077 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971948046192640[0;39m ==> Parameters: 
2021-12-20 11:14:50.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971948046192640[0;39m <==    Updates: 0
2021-12-20 11:14:50.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127971948046192640[0;39m 生成今日电子书快照结束，耗时：233毫秒
2021-12-20 11:14:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127971968958992384[0;39m 生成今日电子书快照开始
2021-12-20 11:14:55.090 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971968958992384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:14:55.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971968958992384[0;39m ==> Parameters: 
2021-12-20 11:14:55.254 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971968958992384[0;39m <==    Updates: 0
2021-12-20 11:14:55.255 INFO  com.job.EbookSnapshotJob                          :35   [32m127971968958992384[0;39m 生成今日电子书快照结束，耗时：250毫秒
2021-12-20 11:14:59.597 INFO  com.aspect.LogAspect                              :54   [32m127971988223430656[0;39m ------------- 开始 -------------
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :55   [32m127971988223430656[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :54   [32m127971988227624960[0;39m ------------- 开始 -------------
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :54   [32m127971988227624961[0;39m ------------- 开始 -------------
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :56   [32m127971988223430656[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :55   [32m127971988227624960[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :55   [32m127971988227624961[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :57   [32m127971988223430656[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :56   [32m127971988227624960[0;39m 类名方法: com.controller.CategoryController.all
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :56   [32m127971988227624961[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :80   [32m127971988223430656[0;39m 请求参数: []
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :57   [32m127971988227624960[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:14:59.598 INFO  com.aspect.LogAspect                              :57   [32m127971988227624961[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-20 11:14:59.599 INFO  com.aspect.LogAspect                              :80   [32m127971988227624961[0;39m 请求参数: []
2021-12-20 11:14:59.599 INFO  com.aspect.LogAspect                              :80   [32m127971988227624960[0;39m 请求参数: []
2021-12-20 11:14:59.692 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127971988223430656[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:14:59.692 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127971988227624960[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-20 11:14:59.692 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127971988227624961[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-20 11:14:59.692 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127971988223430656[0;39m ==> Parameters: 
2021-12-20 11:14:59.692 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127971988227624961[0;39m ==> Parameters: 
2021-12-20 11:14:59.692 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127971988227624960[0;39m ==> Parameters: 
2021-12-20 11:14:59.763 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127971988223430656[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-20 11:14:59.766 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127971988223430656[0;39m <==        Row: 2021-12-19, 502, 173, 0, 0
2021-12-20 11:14:59.767 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m127971988223430656[0;39m <==        Row: 2021-12-20, 503, 174, 1, 1
2021-12-20 11:14:59.768 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m127971988223430656[0;39m <==      Total: 2
2021-12-20 11:14:59.769 INFO  com.aspect.LogAspect                              :92   [32m127971988223430656[0;39m 返回结果: {"content":[{"date":1639843200000,"viewCount":502,"viewIncrease":0,"voteCount":173,"voteIncrease":0},{"date":1639929600000,"viewCount":503,"viewIncrease":1,"voteCount":174,"voteIncrease":1}],"success":true}
2021-12-20 11:14:59.769 INFO  com.aspect.LogAspect                              :93   [32m127971988223430656[0;39m ------------- 结束 耗时：172 ms -------------
2021-12-20 11:14:59.774 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127971988227624961[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-20 11:14:59.774 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127971988227624961[0;39m <==        Row: 2021-12-18, 502, 173
2021-12-20 11:14:59.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==    Columns: id, parent, name, sort
2021-12-20 11:14:59.774 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-20 11:14:59.777 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m127971988227624961[0;39m <==        Row: 2021-12-19, 0, 0
2021-12-20 11:14:59.777 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-20 11:14:59.778 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m127971988227624961[0;39m <==      Total: 2
2021-12-20 11:14:59.778 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-20 11:14:59.779 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-20 11:14:59.779 INFO  com.aspect.LogAspect                              :92   [32m127971988227624961[0;39m 返回结果: {"content":[{"date":1639756800000,"viewCount":0,"viewIncrease":502,"voteCount":0,"voteIncrease":173},{"date":1639843200000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0}],"success":true}
2021-12-20 11:14:59.780 INFO  com.aspect.LogAspect                              :93   [32m127971988227624961[0;39m ------------- 结束 耗时：182 ms -------------
2021-12-20 11:14:59.780 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 101, 100, Vue, 101
2021-12-20 11:14:59.780 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-20 11:14:59.781 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 200, 0, Java, 200
2021-12-20 11:14:59.781 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-20 11:14:59.782 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-20 11:14:59.783 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 300, 0, Python, 300
2021-12-20 11:14:59.783 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-20 11:14:59.783 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-20 11:14:59.784 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-20 11:14:59.784 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-20 11:14:59.785 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-20 11:14:59.785 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 500, 0, 其他, 500
2021-12-20 11:14:59.785 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-20 11:14:59.786 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-20 11:14:59.786 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m127971988227624960[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-20 11:14:59.787 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m127971988227624960[0;39m <==      Total: 19
2021-12-20 11:14:59.789 INFO  com.aspect.LogAspect                              :92   [32m127971988227624960[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-20 11:14:59.789 INFO  com.aspect.LogAspect                              :93   [32m127971988227624960[0;39m ------------- 结束 耗时：191 ms -------------
2021-12-20 11:15:00.003 INFO  com.job.EbookSnapshotJob                          :32   [32m127971989926318080[0;39m 生成今日电子书快照开始
2021-12-20 11:15:00.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971989926318080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:00.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971989926318080[0;39m ==> Parameters: 
2021-12-20 11:15:00.224 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127971989926318080[0;39m <==    Updates: 0
2021-12-20 11:15:00.224 INFO  com.job.EbookSnapshotJob                          :35   [32m127971989926318080[0;39m 生成今日电子书快照结束，耗时：220毫秒
2021-12-20 11:15:05.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127972010931392512[0;39m 生成今日电子书快照开始
2021-12-20 11:15:05.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972010931392512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:05.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972010931392512[0;39m ==> Parameters: 
2021-12-20 11:15:05.251 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972010931392512[0;39m <==    Updates: 0
2021-12-20 11:15:05.251 INFO  com.job.EbookSnapshotJob                          :35   [32m127972010931392512[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:15:05.251 INFO  com.job.DocJob                                    :32   [32m127972011938025472[0;39m 更新电子书下的文档数据开始
2021-12-20 11:15:05.251 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972011938025472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:15:05.251 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972011938025472[0;39m ==> Parameters: 
2021-12-20 11:15:05.401 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972011938025472[0;39m <==    Updates: 3
2021-12-20 11:15:05.401 INFO  com.job.DocJob                                    :35   [32m127972011938025472[0;39m 更新电子书下的文档数据结束，耗时：150毫秒
2021-12-20 11:15:10.022 INFO  com.job.EbookSnapshotJob                          :32   [32m127972031949049856[0;39m 生成今日电子书快照开始
2021-12-20 11:15:10.244 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972031949049856[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:10.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972031949049856[0;39m ==> Parameters: 
2021-12-20 11:15:10.526 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972031949049856[0;39m <==    Updates: 0
2021-12-20 11:15:10.526 INFO  com.job.EbookSnapshotJob                          :35   [32m127972031949049856[0;39m 生成今日电子书快照结束，耗时：503毫秒
2021-12-20 11:15:15.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127972052845072384[0;39m 生成今日电子书快照开始
2021-12-20 11:15:15.088 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972052845072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:15.091 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972052845072384[0;39m ==> Parameters: 
2021-12-20 11:15:15.245 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972052845072384[0;39m <==    Updates: 0
2021-12-20 11:15:15.245 INFO  com.job.EbookSnapshotJob                          :35   [32m127972052845072384[0;39m 生成今日电子书快照结束，耗时：240毫秒
2021-12-20 11:15:20.007 INFO  com.job.EbookSnapshotJob                          :32   [32m127972073829175296[0;39m 生成今日电子书快照开始
2021-12-20 11:15:20.082 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972073829175296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:20.085 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972073829175296[0;39m ==> Parameters: 
2021-12-20 11:15:20.221 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972073829175296[0;39m <==    Updates: 0
2021-12-20 11:15:20.222 INFO  com.job.EbookSnapshotJob                          :35   [32m127972073829175296[0;39m 生成今日电子书快照结束，耗时：214毫秒
2021-12-20 11:15:25.009 INFO  com.job.EbookSnapshotJob                          :32   [32m127972094809083904[0;39m 生成今日电子书快照开始
2021-12-20 11:15:25.078 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972094809083904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:25.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972094809083904[0;39m ==> Parameters: 
2021-12-20 11:15:25.218 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972094809083904[0;39m <==    Updates: 0
2021-12-20 11:15:25.219 INFO  com.job.EbookSnapshotJob                          :35   [32m127972094809083904[0;39m 生成今日电子书快照结束，耗时：210毫秒
2021-12-20 11:15:28.649 INFO  com.websocket.WebSocketServer                     :41   [32m127970194764206080[0;39m 连接关闭，token：qq7guPEJcB，session id：8！当前连接数：0
2021-12-20 11:15:30.011 INFO  com.job.EbookSnapshotJob                          :32   [32m127972115788992512[0;39m 生成今日电子书快照开始
2021-12-20 11:15:30.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972115788992512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:30.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972115788992512[0;39m ==> Parameters: 
2021-12-20 11:15:30.217 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972115788992512[0;39m <==    Updates: 0
2021-12-20 11:15:30.218 INFO  com.job.EbookSnapshotJob                          :35   [32m127972115788992512[0;39m 生成今日电子书快照结束，耗时：206毫秒
2021-12-20 11:15:35.004 INFO  com.job.EbookSnapshotJob                          :32   [32m127972136731152384[0;39m 生成今日电子书快照开始
2021-12-20 11:15:35.087 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972136731152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-20 11:15:35.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972136731152384[0;39m ==> Parameters: 
2021-12-20 11:15:35.250 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m127972136731152384[0;39m <==    Updates: 0
2021-12-20 11:15:35.250 INFO  com.job.EbookSnapshotJob                          :35   [32m127972136731152384[0;39m 生成今日电子书快照结束，耗时：246毫秒
2021-12-20 11:15:35.251 INFO  com.job.DocJob                                    :32   [32m127972137767145472[0;39m 更新电子书下的文档数据开始
2021-12-20 11:15:35.252 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972137767145472[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-20 11:15:35.253 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972137767145472[0;39m ==> Parameters: 
2021-12-20 11:15:35.396 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m127972137767145472[0;39m <==    Updates: 3
2021-12-20 11:15:35.397 INFO  com.job.DocJob                                    :35   [32m127972137767145472[0;39m 更新电子书下的文档数据结束，耗时：146毫秒
