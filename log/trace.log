2021-12-12 01:21:07.380 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-12 01:21:07.390 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 3076 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-12 01:21:07.390 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-12 01:21:07.474 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-12 01:21:07.474 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-12 01:21:11.563 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-12 01:21:11.563 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-12 01:21:12.139 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 553 ms. Found 0 Redis repository interfaces.
2021-12-12 01:21:13.808 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-12 01:21:13.888 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-12 01:21:13.888 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-12 01:21:13.888 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-12 01:21:14.168 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-12 01:21:14.168 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 6694 ms
2021-12-12 01:21:16.464 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-12 01:21:16.494 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-12 01:21:16.514 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-12 01:21:16.574 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 9.936 seconds (JVM running for 11.842)
2021-12-12 01:21:20.004 INFO  com.job.EbookSnapshotJob                          :32   [32m124923485897232384[0;39m 生成今日电子书快照开始
2021-12-12 01:21:20.064 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m124923485897232384[0;39m HikariPool-1 - Starting...
2021-12-12 01:21:20.884 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m124923485897232384[0;39m HikariPool-1 - Start completed.
2021-12-12 01:21:20.894 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923485897232384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:20.914 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923485897232384[0;39m ==> Parameters: 
2021-12-12 01:21:21.023 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923485897232384[0;39m <==    Updates: 6
2021-12-12 01:21:21.023 INFO  com.job.EbookSnapshotJob                          :35   [32m124923485897232384[0;39m 生成今日电子书快照结束，耗时：1019毫秒
2021-12-12 01:21:25.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923506872946688[0;39m 生成今日电子书快照开始
2021-12-12 01:21:25.046 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923506872946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:25.046 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923506872946688[0;39m ==> Parameters: 
2021-12-12 01:21:25.135 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923506872946688[0;39m <==    Updates: 0
2021-12-12 01:21:25.135 INFO  com.job.EbookSnapshotJob                          :35   [32m124923506872946688[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-12 01:21:30.010 INFO  com.job.EbookSnapshotJob                          :32   [32m124923527865438208[0;39m 生成今日电子书快照开始
2021-12-12 01:21:30.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923527865438208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:30.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923527865438208[0;39m ==> Parameters: 
2021-12-12 01:21:30.159 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923527865438208[0;39m <==    Updates: 0
2021-12-12 01:21:30.161 INFO  com.job.EbookSnapshotJob                          :35   [32m124923527865438208[0;39m 生成今日电子书快照结束，耗时：151毫秒
2021-12-12 01:21:35.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923548815986688[0;39m 生成今日电子书快照开始
2021-12-12 01:21:35.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923548815986688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:35.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923548815986688[0;39m ==> Parameters: 
2021-12-12 01:21:35.165 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923548815986688[0;39m <==    Updates: 0
2021-12-12 01:21:35.165 INFO  com.job.EbookSnapshotJob                          :35   [32m124923548815986688[0;39m 生成今日电子书快照结束，耗时：160毫秒
2021-12-12 01:21:35.165 INFO  com.job.DocJob                                    :32   [32m124923549487075328[0;39m 更新电子书下的文档数据开始
2021-12-12 01:21:35.165 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923549487075328[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-12 01:21:35.165 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923549487075328[0;39m ==> Parameters: 
2021-12-12 01:21:35.295 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923549487075328[0;39m <==    Updates: 2
2021-12-12 01:21:35.295 INFO  com.job.DocJob                                    :35   [32m124923549487075328[0;39m 更新电子书下的文档数据结束，耗时：130毫秒
2021-12-12 01:21:40.007 INFO  com.job.EbookSnapshotJob                          :32   [32m124923569795895296[0;39m 生成今日电子书快照开始
2021-12-12 01:21:40.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923569795895296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:40.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923569795895296[0;39m ==> Parameters: 
2021-12-12 01:21:40.134 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923569795895296[0;39m <==    Updates: 0
2021-12-12 01:21:40.134 INFO  com.job.EbookSnapshotJob                          :35   [32m124923569795895296[0;39m 生成今日电子书快照结束，耗时：127毫秒
2021-12-12 01:21:45.014 INFO  com.job.EbookSnapshotJob                          :32   [32m124923590796775424[0;39m 生成今日电子书快照开始
2021-12-12 01:21:45.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923590796775424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:45.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923590796775424[0;39m ==> Parameters: 
2021-12-12 01:21:45.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923590796775424[0;39m <==    Updates: 0
2021-12-12 01:21:45.155 INFO  com.job.EbookSnapshotJob                          :35   [32m124923590796775424[0;39m 生成今日电子书快照结束，耗时：141毫秒
2021-12-12 01:21:50.004 INFO  com.job.EbookSnapshotJob                          :32   [32m124923611726352384[0;39m 生成今日电子书快照开始
2021-12-12 01:21:50.044 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923611726352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:50.044 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923611726352384[0;39m ==> Parameters: 
2021-12-12 01:21:50.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923611726352384[0;39m <==    Updates: 0
2021-12-12 01:21:50.144 INFO  com.job.EbookSnapshotJob                          :35   [32m124923611726352384[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-12 01:21:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m124923632697872384[0;39m 生成今日电子书快照开始
2021-12-12 01:21:55.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923632697872384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:21:55.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923632697872384[0;39m ==> Parameters: 
2021-12-12 01:21:55.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923632697872384[0;39m <==    Updates: 0
2021-12-12 01:21:55.154 INFO  com.job.EbookSnapshotJob                          :35   [32m124923632697872384[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-12 01:22:00.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923653673586688[0;39m 生成今日电子书快照开始
2021-12-12 01:22:00.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923653673586688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:00.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923653673586688[0;39m ==> Parameters: 
2021-12-12 01:22:00.165 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923653673586688[0;39m <==    Updates: 0
2021-12-12 01:22:00.165 INFO  com.job.EbookSnapshotJob                          :35   [32m124923653673586688[0;39m 生成今日电子书快照结束，耗时：160毫秒
2021-12-12 01:22:05.009 INFO  com.job.EbookSnapshotJob                          :32   [32m124923674661883904[0;39m 生成今日电子书快照开始
2021-12-12 01:22:05.079 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923674661883904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:05.089 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923674661883904[0;39m ==> Parameters: 
2021-12-12 01:22:05.178 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923674661883904[0;39m <==    Updates: 0
2021-12-12 01:22:05.178 INFO  com.job.EbookSnapshotJob                          :35   [32m124923674661883904[0;39m 生成今日电子书快照结束，耗时：169毫秒
2021-12-12 01:22:05.178 INFO  com.job.DocJob                                    :32   [32m124923675370721280[0;39m 更新电子书下的文档数据开始
2021-12-12 01:22:05.178 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923675370721280[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-12 01:22:05.178 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923675370721280[0;39m ==> Parameters: 
2021-12-12 01:22:05.268 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923675370721280[0;39m <==    Updates: 2
2021-12-12 01:22:05.268 INFO  com.job.DocJob                                    :35   [32m124923675370721280[0;39m 更新电子书下的文档数据结束，耗时：90毫秒
2021-12-12 01:22:10.014 INFO  com.job.EbookSnapshotJob                          :32   [32m124923695654375424[0;39m 生成今日电子书快照开始
2021-12-12 01:22:10.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923695654375424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:10.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923695654375424[0;39m ==> Parameters: 
2021-12-12 01:22:10.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923695654375424[0;39m <==    Updates: 0
2021-12-12 01:22:10.144 INFO  com.job.EbookSnapshotJob                          :35   [32m124923695654375424[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-12 01:22:15.013 INFO  com.job.EbookSnapshotJob                          :32   [32m124923716621701120[0;39m 生成今日电子书快照开始
2021-12-12 01:22:15.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923716621701120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:15.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923716621701120[0;39m ==> Parameters: 
2021-12-12 01:22:15.162 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923716621701120[0;39m <==    Updates: 0
2021-12-12 01:22:15.162 INFO  com.job.EbookSnapshotJob                          :35   [32m124923716621701120[0;39m 生成今日电子书快照结束，耗时：149毫秒
2021-12-12 01:22:20.011 INFO  com.job.EbookSnapshotJob                          :32   [32m124923737584832512[0;39m 生成今日电子书快照开始
2021-12-12 01:22:20.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923737584832512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:20.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923737584832512[0;39m ==> Parameters: 
2021-12-12 01:22:20.152 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923737584832512[0;39m <==    Updates: 0
2021-12-12 01:22:20.162 INFO  com.job.EbookSnapshotJob                          :35   [32m124923737584832512[0;39m 生成今日电子书快照结束，耗时：151毫秒
2021-12-12 01:22:25.003 INFO  com.job.EbookSnapshotJob                          :32   [32m124923758522798080[0;39m 生成今日电子书快照开始
2021-12-12 01:22:25.049 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923758522798080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:25.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923758522798080[0;39m ==> Parameters: 
2021-12-12 01:22:25.149 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923758522798080[0;39m <==    Updates: 0
2021-12-12 01:22:25.150 INFO  com.job.EbookSnapshotJob                          :35   [32m124923758522798080[0;39m 生成今日电子书快照结束，耗时：147毫秒
2021-12-12 01:22:26.446 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-12 01:22:26.446 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-12 01:22:26.448 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 2 ms
2021-12-12 01:22:26.760 INFO  com.aspect.LogAspect                              :54   [32m124923765867024385[0;39m ------------- 开始 -------------
2021-12-12 01:22:26.760 INFO  com.aspect.LogAspect                              :54   [32m124923765867024384[0;39m ------------- 开始 -------------
2021-12-12 01:22:26.762 INFO  com.aspect.LogAspect                              :55   [32m124923765867024384[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-12 01:22:26.762 INFO  com.aspect.LogAspect                              :55   [32m124923765867024385[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-12 01:22:26.763 INFO  com.aspect.LogAspect                              :56   [32m124923765867024385[0;39m 类名方法: com.controller.CategoryController.all
2021-12-12 01:22:26.763 INFO  com.aspect.LogAspect                              :56   [32m124923765867024384[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-12 01:22:26.764 INFO  com.aspect.LogAspect                              :57   [32m124923765867024384[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:22:26.764 INFO  com.aspect.LogAspect                              :57   [32m124923765867024385[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:22:26.844 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：maz59IwezI，session id：0，当前连接数：1
2021-12-12 01:22:26.864 INFO  com.aspect.LogAspect                              :80   [32m124923765867024385[0;39m 请求参数: []
2021-12-12 01:22:26.864 INFO  com.aspect.LogAspect                              :80   [32m124923765867024384[0;39m 请求参数: []
2021-12-12 01:22:26.915 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124923765867024384[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-12 01:22:26.917 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124923765867024384[0;39m ==> Parameters: 
2021-12-12 01:22:26.976 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124923765867024385[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-12 01:22:26.983 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124923765867024385[0;39m ==> Parameters: 
2021-12-12 01:22:27.003 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124923765867024384[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-12 01:22:27.003 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124923765867024384[0;39m <==        Row: 2021-12-11, 521, 185, 64, 50
2021-12-12 01:22:27.013 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124923765867024384[0;39m <==        Row: 2021-12-12, 521, 185, 0, 0
2021-12-12 01:22:27.013 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124923765867024384[0;39m <==      Total: 2
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==    Columns: id, parent, name, sort
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 101, 100, Vue, 101
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 200, 0, Java, 200
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-12 01:22:27.023 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 300, 0, Python, 300
2021-12-12 01:22:27.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-12 01:22:27.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-12 01:22:27.034 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-12 01:22:27.034 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-12 01:22:27.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-12 01:22:27.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 500, 0, 其他, 500
2021-12-12 01:22:27.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-12 01:22:27.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-12 01:22:27.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124923765867024385[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-12 01:22:27.035 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124923765867024385[0;39m <==      Total: 19
2021-12-12 01:22:27.066 INFO  com.aspect.LogAspect                              :92   [32m124923765867024384[0;39m 返回结果: {"content":[{"date":1639152000000,"viewCount":521,"viewIncrease":64,"voteCount":185,"voteIncrease":50},{"date":1639238400000,"viewCount":521,"viewIncrease":0,"voteCount":185,"voteIncrease":0}],"success":true}
2021-12-12 01:22:27.066 INFO  com.aspect.LogAspect                              :92   [32m124923765867024385[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-12 01:22:27.066 INFO  com.aspect.LogAspect                              :93   [32m124923765867024384[0;39m ------------- 结束 耗时：312 ms -------------
2021-12-12 01:22:27.066 INFO  com.aspect.LogAspect                              :93   [32m124923765867024385[0;39m ------------- 结束 耗时：312 ms -------------
2021-12-12 01:22:30.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923779502706688[0;39m 生成今日电子书快照开始
2021-12-12 01:22:30.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923779502706688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:30.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923779502706688[0;39m ==> Parameters: 
2021-12-12 01:22:30.165 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923779502706688[0;39m <==    Updates: 0
2021-12-12 01:22:30.175 INFO  com.job.EbookSnapshotJob                          :35   [32m124923779502706688[0;39m 生成今日电子书快照结束，耗时：170毫秒
2021-12-12 01:22:35.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923800474226688[0;39m 生成今日电子书快照开始
2021-12-12 01:22:35.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923800474226688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:35.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923800474226688[0;39m ==> Parameters: 
2021-12-12 01:22:35.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923800474226688[0;39m <==    Updates: 0
2021-12-12 01:22:35.155 INFO  com.job.EbookSnapshotJob                          :35   [32m124923800474226688[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-12 01:22:35.155 INFO  com.job.DocJob                                    :32   [32m124923801103372288[0;39m 更新电子书下的文档数据开始
2021-12-12 01:22:35.155 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923801103372288[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-12 01:22:35.155 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923801103372288[0;39m ==> Parameters: 
2021-12-12 01:22:35.245 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923801103372288[0;39m <==    Updates: 2
2021-12-12 01:22:35.245 INFO  com.job.DocJob                                    :35   [32m124923801103372288[0;39m 更新电子书下的文档数据结束，耗时：90毫秒
2021-12-12 01:22:40.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923821445746688[0;39m 生成今日电子书快照开始
2021-12-12 01:22:40.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923821445746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:40.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923821445746688[0;39m ==> Parameters: 
2021-12-12 01:22:40.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923821445746688[0;39m <==    Updates: 0
2021-12-12 01:22:40.155 INFO  com.job.EbookSnapshotJob                          :35   [32m124923821445746688[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-12 01:22:45.011 INFO  com.job.EbookSnapshotJob                          :32   [32m124923842442432512[0;39m 生成今日电子书快照开始
2021-12-12 01:22:45.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923842442432512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:45.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923842442432512[0;39m ==> Parameters: 
2021-12-12 01:22:45.181 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923842442432512[0;39m <==    Updates: 0
2021-12-12 01:22:45.181 INFO  com.job.EbookSnapshotJob                          :35   [32m124923842442432512[0;39m 生成今日电子书快照结束，耗时：170毫秒
2021-12-12 01:22:50.014 INFO  com.job.EbookSnapshotJob                          :32   [32m124923863426535424[0;39m 生成今日电子书快照开始
2021-12-12 01:22:50.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923863426535424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:50.104 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923863426535424[0;39m ==> Parameters: 
2021-12-12 01:22:50.204 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923863426535424[0;39m <==    Updates: 0
2021-12-12 01:22:50.204 INFO  com.job.EbookSnapshotJob                          :35   [32m124923863426535424[0;39m 生成今日电子书快照结束，耗时：190毫秒
2021-12-12 01:22:55.015 INFO  com.job.EbookSnapshotJob                          :32   [32m124923884402249728[0;39m 生成今日电子书快照开始
2021-12-12 01:22:55.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923884402249728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:22:55.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923884402249728[0;39m ==> Parameters: 
2021-12-12 01:22:55.166 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923884402249728[0;39m <==    Updates: 0
2021-12-12 01:22:55.166 INFO  com.job.EbookSnapshotJob                          :35   [32m124923884402249728[0;39m 生成今日电子书快照结束，耗时：151毫秒
2021-12-12 01:23:00.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124923905331826688[0;39m 生成今日电子书快照开始
2021-12-12 01:23:00.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923905331826688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:00.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923905331826688[0;39m ==> Parameters: 
2021-12-12 01:23:00.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923905331826688[0;39m <==    Updates: 0
2021-12-12 01:23:00.155 INFO  com.job.EbookSnapshotJob                          :35   [32m124923905331826688[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-12 01:23:05.004 INFO  com.job.EbookSnapshotJob                          :32   [32m124923926299152384[0;39m 生成今日电子书快照开始
2021-12-12 01:23:05.047 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923926299152384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:05.047 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923926299152384[0;39m ==> Parameters: 
2021-12-12 01:23:05.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923926299152384[0;39m <==    Updates: 0
2021-12-12 01:23:05.144 INFO  com.job.EbookSnapshotJob                          :35   [32m124923926299152384[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-12 01:23:05.144 INFO  com.job.DocJob                                    :32   [32m124923926886354944[0;39m 更新电子书下的文档数据开始
2021-12-12 01:23:05.144 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923926886354944[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-12 01:23:05.144 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923926886354944[0;39m ==> Parameters: 
2021-12-12 01:23:05.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124923926886354944[0;39m <==    Updates: 2
2021-12-12 01:23:05.244 INFO  com.job.DocJob                                    :35   [32m124923926886354944[0;39m 更新电子书下的文档数据结束，耗时：100毫秒
2021-12-12 01:23:10.009 INFO  com.job.EbookSnapshotJob                          :32   [32m124923947291643904[0;39m 生成今日电子书快照开始
2021-12-12 01:23:10.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923947291643904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:10.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923947291643904[0;39m ==> Parameters: 
2021-12-12 01:23:10.176 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923947291643904[0;39m <==    Updates: 0
2021-12-12 01:23:10.177 INFO  com.job.EbookSnapshotJob                          :35   [32m124923947291643904[0;39m 生成今日电子书快照结束，耗时：168毫秒
2021-12-12 01:23:11.616 INFO  com.aspect.LogAspect                              :54   [32m124923954031890432[0;39m ------------- 开始 -------------
2021-12-12 01:23:11.616 INFO  com.aspect.LogAspect                              :55   [32m124923954031890432[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-12 01:23:11.616 INFO  com.aspect.LogAspect                              :56   [32m124923954031890432[0;39m 类名方法: com.controller.EbookController.list
2021-12-12 01:23:11.617 INFO  com.aspect.LogAspect                              :57   [32m124923954031890432[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:11.618 INFO  com.aspect.LogAspect                              :80   [32m124923954031890432[0;39m 请求参数: [{"categoryId2":101,"page":1,"size":1000}]
2021-12-12 01:23:11.779 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m124923954031890432[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-12 01:23:11.779 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m124923954031890432[0;39m ==> Parameters: 101(Long)
2021-12-12 01:23:11.828 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m124923954031890432[0;39m <==    Columns: count(0)
2021-12-12 01:23:11.828 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m124923954031890432[0;39m <==        Row: 1
2021-12-12 01:23:11.829 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m124923954031890432[0;39m <==      Total: 1
2021-12-12 01:23:11.832 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m124923954031890432[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-12 01:23:11.833 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m124923954031890432[0;39m ==> Parameters: 101(Long), 1000(Integer)
2021-12-12 01:23:11.878 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m124923954031890432[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-12 01:23:11.878 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m124923954031890432[0;39m <==        Row: 2, Vue入门教程, 100, 101, 零基础入门Vue开发，企业级应用开发最佳首选框架, /image/cover2.png, 8, 65, 20
2021-12-12 01:23:11.879 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m124923954031890432[0;39m <==      Total: 1
2021-12-12 01:23:11.882 INFO  com.servicess.EbookService                        :48   [32m124923954031890432[0;39m 总行数：1
2021-12-12 01:23:11.883 INFO  com.servicess.EbookService                        :49   [32m124923954031890432[0;39m 总页数：1
2021-12-12 01:23:11.897 INFO  com.aspect.LogAspect                              :92   [32m124923954031890432[0;39m 返回结果: {"content":{"list":[{"category1Id":100,"category2Id":101,"cover":"/image/cover2.png","description":"零基础入门Vue开发，企业级应用开发最佳首选框架","docCount":8,"id":2,"name":"Vue入门教程","viewCount":65,"voteCount":20}],"total":1},"success":true}
2021-12-12 01:23:11.898 INFO  com.aspect.LogAspect                              :93   [32m124923954031890432[0;39m ------------- 结束 耗时：282 ms -------------
2021-12-12 01:23:12.904 INFO  com.aspect.LogAspect                              :54   [32m124923959434153984[0;39m ------------- 开始 -------------
2021-12-12 01:23:12.904 INFO  com.aspect.LogAspect                              :55   [32m124923959434153984[0;39m 请求地址: http://localhost:8081/doc/all/2 GET
2021-12-12 01:23:12.904 INFO  com.aspect.LogAspect                              :56   [32m124923959434153984[0;39m 类名方法: com.controller.DocController.all
2021-12-12 01:23:12.904 INFO  com.aspect.LogAspect                              :57   [32m124923959434153984[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:12.904 INFO  com.aspect.LogAspect                              :80   [32m124923959434153984[0;39m 请求参数: [2]
2021-12-12 01:23:12.977 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m124923959434153984[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-12 01:23:12.977 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m124923959434153984[0;39m ==> Parameters: 2(Long)
2021-12-12 01:23:13.027 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-12 01:23:13.027 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 9, 2, 0, 文档1, 1, 27, 2
2021-12-12 01:23:13.027 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 122746345772683264, 2, 0, 文档2, 1, 12, 2
2021-12-12 01:23:13.027 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 123355131981991936, 2, 9, 文档1.1, 1, 8, 3
2021-12-12 01:23:13.027 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 123355236525019136, 2, 122746345772683264, 文档2.1, 1, 6, 4
2021-12-12 01:23:13.037 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 124191156778176512, 2, 0, 文档3, 1, 2, 2
2021-12-12 01:23:13.037 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 123355187095146496, 2, 9, 文档1.2, 2, 6, 3
2021-12-12 01:23:13.037 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 124191201023889408, 2, 124191156778176512, 文档3.1, 2, 3, 3
2021-12-12 01:23:13.037 TRACE com.mapper.DocMapper.selectByExample              :143  [32m124923959434153984[0;39m <==        Row: 124191230128164864, 2, 124191156778176512, 文档3.2, 3, 1, 1
2021-12-12 01:23:13.037 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m124923959434153984[0;39m <==      Total: 8
2021-12-12 01:23:13.064 INFO  com.aspect.LogAspect                              :92   [32m124923959434153984[0;39m 返回结果: {"content":[{"ebookId":2,"id":9,"name":"文档1","parent":0,"sort":1,"viewCount":27,"voteCount":2},{"ebookId":2,"id":122746345772683264,"name":"文档2","parent":0,"sort":1,"viewCount":12,"voteCount":2},{"ebookId":2,"id":123355131981991936,"name":"文档1.1","parent":9,"sort":1,"viewCount":8,"voteCount":3},{"ebookId":2,"id":123355236525019136,"name":"文档2.1","parent":122746345772683264,"sort":1,"viewCount":6,"voteCount":4},{"ebookId":2,"id":124191156778176512,"name":"文档3","parent":0,"sort":1,"viewCount":2,"voteCount":2},{"ebookId":2,"id":123355187095146496,"name":"文档1.2","parent":9,"sort":2,"viewCount":6,"voteCount":3},{"ebookId":2,"id":124191201023889408,"name":"文档3.1","parent":124191156778176512,"sort":2,"viewCount":3,"voteCount":3},{"ebookId":2,"id":124191230128164864,"name":"文档3.2","parent":124191156778176512,"sort":3,"viewCount":1,"voteCount":1}],"success":true}
2021-12-12 01:23:13.065 INFO  com.aspect.LogAspect                              :93   [32m124923959434153984[0;39m ------------- 结束 耗时：161 ms -------------
2021-12-12 01:23:13.110 INFO  com.aspect.LogAspect                              :54   [32m124923960298180608[0;39m ------------- 开始 -------------
2021-12-12 01:23:13.111 INFO  com.aspect.LogAspect                              :55   [32m124923960298180608[0;39m 请求地址: http://localhost:8081/doc/find-content/9 GET
2021-12-12 01:23:13.111 INFO  com.aspect.LogAspect                              :56   [32m124923960298180608[0;39m 类名方法: com.controller.DocController.findContent
2021-12-12 01:23:13.111 INFO  com.aspect.LogAspect                              :57   [32m124923960298180608[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:13.111 INFO  com.aspect.LogAspect                              :80   [32m124923960298180608[0;39m 请求参数: [9]
2021-12-12 01:23:13.112 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923960298180608[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-12 01:23:13.113 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923960298180608[0;39m ==> Parameters: 9(Long)
2021-12-12 01:23:13.158 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923960298180608[0;39m <==      Total: 0
2021-12-12 01:23:13.160 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923960298180608[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-12 01:23:13.160 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923960298180608[0;39m ==> Parameters: 9(Long)
2021-12-12 01:23:13.250 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923960298180608[0;39m <==    Updates: 1
2021-12-12 01:23:13.252 INFO  com.aspect.LogAspect                              :92   [32m124923960298180608[0;39m 返回结果: {"content":"","success":true}
2021-12-12 01:23:13.252 INFO  com.aspect.LogAspect                              :93   [32m124923960298180608[0;39m ------------- 结束 耗时：142 ms -------------
2021-12-12 01:23:13.975 INFO  com.aspect.LogAspect                              :54   [32m124923963926253568[0;39m ------------- 开始 -------------
2021-12-12 01:23:13.976 INFO  com.aspect.LogAspect                              :55   [32m124923963926253568[0;39m 请求地址: http://localhost:8081/doc/vote/9 GET
2021-12-12 01:23:13.976 INFO  com.aspect.LogAspect                              :56   [32m124923963926253568[0;39m 类名方法: com.controller.DocController.vote
2021-12-12 01:23:13.976 INFO  com.aspect.LogAspect                              :57   [32m124923963926253568[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:13.976 INFO  com.aspect.LogAspect                              :80   [32m124923963926253568[0;39m 请求参数: [9]
2021-12-12 01:23:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m124923968288329728[0;39m 生成今日电子书快照开始
2021-12-12 01:23:15.052 INFO  com.Util.RedisUtil                                :31   [32m124923963926253568[0;39m key不存在，放入：DOC_VOTE_9_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-12 01:23:15.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923968288329728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:15.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923968288329728[0;39m ==> Parameters: 
2021-12-12 01:23:15.122 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923963926253568[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-12 01:23:15.123 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923963926253568[0;39m ==> Parameters: 9(Long)
2021-12-12 01:23:15.153 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923968288329728[0;39m <==    Updates: 0
2021-12-12 01:23:15.154 INFO  com.job.EbookSnapshotJob                          :35   [32m124923968288329728[0;39m 生成今日电子书快照结束，耗时：139毫秒
2021-12-12 01:23:15.258 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923963926253568[0;39m <==    Updates: 1
2021-12-12 01:23:15.259 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923963926253568[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-12 01:23:15.261 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923963926253568[0;39m ==> Parameters: 9(Long)
2021-12-12 01:23:15.320 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923963926253568[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-12 01:23:15.321 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923963926253568[0;39m <==        Row: 9, 2, 0, 文档1, 1, 28, 3
2021-12-12 01:23:15.322 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923963926253568[0;39m <==      Total: 1
2021-12-12 01:23:15.329 INFO  com.aspect.LogAspect                              :92   [32m124923963926253568[0;39m 返回结果: {"success":true}
2021-12-12 01:23:15.329 INFO  com.aspect.LogAspect                              :93   [32m124923963926253568[0;39m ------------- 结束 耗时：1354 ms -------------
2021-12-12 01:23:15.364 INFO  com.websocket.WebSocketServer                     :71   [32m124923963926253568[0;39m 推送消息：maz59IwezI，内容：【文档1】被点赞！
2021-12-12 01:23:16.913 INFO  com.aspect.LogAspect                              :54   [32m124923976249118720[0;39m ------------- 开始 -------------
2021-12-12 01:23:16.913 INFO  com.aspect.LogAspect                              :55   [32m124923976249118720[0;39m 请求地址: http://localhost:8081/doc/find-content/123355131981991936 GET
2021-12-12 01:23:16.914 INFO  com.aspect.LogAspect                              :56   [32m124923976249118720[0;39m 类名方法: com.controller.DocController.findContent
2021-12-12 01:23:16.914 INFO  com.aspect.LogAspect                              :57   [32m124923976249118720[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:16.914 INFO  com.aspect.LogAspect                              :80   [32m124923976249118720[0;39m 请求参数: [123355131981991936]
2021-12-12 01:23:16.994 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923976249118720[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-12 01:23:16.996 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923976249118720[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-12 01:23:17.046 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923976249118720[0;39m <==    Columns: id, content
2021-12-12 01:23:17.047 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923976249118720[0;39m <==        Row: 123355131981991936, <<BLOB>>
2021-12-12 01:23:17.048 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923976249118720[0;39m <==      Total: 1
2021-12-12 01:23:17.050 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923976249118720[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-12 01:23:17.051 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923976249118720[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-12 01:23:17.163 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923976249118720[0;39m <==    Updates: 1
2021-12-12 01:23:17.164 INFO  com.aspect.LogAspect                              :92   [32m124923976249118720[0;39m 返回结果: {"content":"","success":true}
2021-12-12 01:23:17.165 INFO  com.aspect.LogAspect                              :93   [32m124923976249118720[0;39m ------------- 结束 耗时：252 ms -------------
2021-12-12 01:23:18.415 INFO  com.aspect.LogAspect                              :54   [32m124923982548963328[0;39m ------------- 开始 -------------
2021-12-12 01:23:18.416 INFO  com.aspect.LogAspect                              :55   [32m124923982548963328[0;39m 请求地址: http://localhost:8081/doc/vote/123355131981991936 GET
2021-12-12 01:23:18.416 INFO  com.aspect.LogAspect                              :56   [32m124923982548963328[0;39m 类名方法: com.controller.DocController.vote
2021-12-12 01:23:18.416 INFO  com.aspect.LogAspect                              :57   [32m124923982548963328[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:18.416 INFO  com.aspect.LogAspect                              :80   [32m124923982548963328[0;39m 请求参数: [123355131981991936]
2021-12-12 01:23:18.439 INFO  com.Util.RedisUtil                                :31   [32m124923982548963328[0;39m key不存在，放入：DOC_VOTE_123355131981991936_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-12 01:23:18.525 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923982548963328[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-12 01:23:18.526 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923982548963328[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-12 01:23:18.687 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923982548963328[0;39m <==    Updates: 1
2021-12-12 01:23:18.689 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923982548963328[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-12 01:23:18.690 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923982548963328[0;39m ==> Parameters: 123355131981991936(Long)
2021-12-12 01:23:18.736 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923982548963328[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-12 01:23:18.737 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923982548963328[0;39m <==        Row: 123355131981991936, 2, 9, 文档1.1, 1, 9, 4
2021-12-12 01:23:18.738 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923982548963328[0;39m <==      Total: 1
2021-12-12 01:23:18.741 INFO  com.aspect.LogAspect                              :92   [32m124923982548963328[0;39m 返回结果: {"success":true}
2021-12-12 01:23:18.742 INFO  com.aspect.LogAspect                              :93   [32m124923982548963328[0;39m ------------- 结束 耗时：327 ms -------------
2021-12-12 01:23:18.746 INFO  com.websocket.WebSocketServer                     :71   [32m124923982548963328[0;39m 推送消息：maz59IwezI，内容：【文档1.1】被点赞！
2021-12-12 01:23:19.817 INFO  com.aspect.LogAspect                              :54   [32m124923988429377536[0;39m ------------- 开始 -------------
2021-12-12 01:23:19.818 INFO  com.aspect.LogAspect                              :55   [32m124923988429377536[0;39m 请求地址: http://localhost:8081/doc/find-content/123355187095146496 GET
2021-12-12 01:23:19.818 INFO  com.aspect.LogAspect                              :56   [32m124923988429377536[0;39m 类名方法: com.controller.DocController.findContent
2021-12-12 01:23:19.818 INFO  com.aspect.LogAspect                              :57   [32m124923988429377536[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:19.818 INFO  com.aspect.LogAspect                              :80   [32m124923988429377536[0;39m 请求参数: [123355187095146496]
2021-12-12 01:23:19.892 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923988429377536[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-12 01:23:19.894 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923988429377536[0;39m ==> Parameters: 123355187095146496(Long)
2021-12-12 01:23:19.941 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923988429377536[0;39m <==    Columns: id, content
2021-12-12 01:23:19.941 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923988429377536[0;39m <==        Row: 123355187095146496, <<BLOB>>
2021-12-12 01:23:19.942 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923988429377536[0;39m <==      Total: 1
2021-12-12 01:23:19.943 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923988429377536[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-12 01:23:19.944 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923988429377536[0;39m ==> Parameters: 123355187095146496(Long)
2021-12-12 01:23:20.010 INFO  com.job.EbookSnapshotJob                          :32   [32m124923989238878208[0;39m 生成今日电子书快照开始
2021-12-12 01:23:20.043 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923988429377536[0;39m <==    Updates: 1
2021-12-12 01:23:20.044 INFO  com.aspect.LogAspect                              :92   [32m124923988429377536[0;39m 返回结果: {"content":"","success":true}
2021-12-12 01:23:20.044 INFO  com.aspect.LogAspect                              :93   [32m124923988429377536[0;39m ------------- 结束 耗时：227 ms -------------
2021-12-12 01:23:20.095 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923989238878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:20.096 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923989238878208[0;39m ==> Parameters: 
2021-12-12 01:23:20.220 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124923989238878208[0;39m <==    Updates: 0
2021-12-12 01:23:20.221 INFO  com.job.EbookSnapshotJob                          :35   [32m124923989238878208[0;39m 生成今日电子书快照结束，耗时：211毫秒
2021-12-12 01:23:20.813 INFO  com.aspect.LogAspect                              :54   [32m124923992606904320[0;39m ------------- 开始 -------------
2021-12-12 01:23:20.814 INFO  com.aspect.LogAspect                              :55   [32m124923992606904320[0;39m 请求地址: http://localhost:8081/doc/vote/123355187095146496 GET
2021-12-12 01:23:20.814 INFO  com.aspect.LogAspect                              :56   [32m124923992606904320[0;39m 类名方法: com.controller.DocController.vote
2021-12-12 01:23:20.814 INFO  com.aspect.LogAspect                              :57   [32m124923992606904320[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:20.814 INFO  com.aspect.LogAspect                              :80   [32m124923992606904320[0;39m 请求参数: [123355187095146496]
2021-12-12 01:23:20.840 INFO  com.Util.RedisUtil                                :31   [32m124923992606904320[0;39m key不存在，放入：DOC_VOTE_123355187095146496_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-12 01:23:20.926 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923992606904320[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-12 01:23:20.928 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923992606904320[0;39m ==> Parameters: 123355187095146496(Long)
2021-12-12 01:23:21.034 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124923992606904320[0;39m <==    Updates: 1
2021-12-12 01:23:21.036 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923992606904320[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-12 01:23:21.038 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923992606904320[0;39m ==> Parameters: 123355187095146496(Long)
2021-12-12 01:23:21.110 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923992606904320[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-12 01:23:21.110 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124923992606904320[0;39m <==        Row: 123355187095146496, 2, 9, 文档1.2, 2, 7, 4
2021-12-12 01:23:21.110 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124923992606904320[0;39m <==      Total: 1
2021-12-12 01:23:21.111 INFO  com.aspect.LogAspect                              :92   [32m124923992606904320[0;39m 返回结果: {"success":true}
2021-12-12 01:23:21.111 INFO  com.aspect.LogAspect                              :93   [32m124923992606904320[0;39m ------------- 结束 耗时：298 ms -------------
2021-12-12 01:23:21.111 INFO  com.websocket.WebSocketServer                     :71   [32m124923992606904320[0;39m 推送消息：maz59IwezI，内容：【文档1.2】被点赞！
2021-12-12 01:23:22.010 INFO  com.aspect.LogAspect                              :54   [32m124923997627486208[0;39m ------------- 开始 -------------
2021-12-12 01:23:22.011 INFO  com.aspect.LogAspect                              :55   [32m124923997627486208[0;39m 请求地址: http://localhost:8081/doc/find-content/123355236525019136 GET
2021-12-12 01:23:22.011 INFO  com.aspect.LogAspect                              :56   [32m124923997627486208[0;39m 类名方法: com.controller.DocController.findContent
2021-12-12 01:23:22.011 INFO  com.aspect.LogAspect                              :57   [32m124923997627486208[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:22.011 INFO  com.aspect.LogAspect                              :80   [32m124923997627486208[0;39m 请求参数: [123355236525019136]
2021-12-12 01:23:22.065 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923997627486208[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-12 01:23:22.066 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923997627486208[0;39m ==> Parameters: 123355236525019136(Long)
2021-12-12 01:23:22.109 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923997627486208[0;39m <==    Columns: id, content
2021-12-12 01:23:22.110 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m124923997627486208[0;39m <==        Row: 123355236525019136, <<BLOB>>
2021-12-12 01:23:22.110 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m124923997627486208[0;39m <==      Total: 1
2021-12-12 01:23:22.111 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923997627486208[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-12 01:23:22.111 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923997627486208[0;39m ==> Parameters: 123355236525019136(Long)
2021-12-12 01:23:22.492 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m124923997627486208[0;39m <==    Updates: 1
2021-12-12 01:23:22.494 INFO  com.aspect.LogAspect                              :92   [32m124923997627486208[0;39m 返回结果: {"content":"","success":true}
2021-12-12 01:23:22.494 INFO  com.aspect.LogAspect                              :93   [32m124923997627486208[0;39m ------------- 结束 耗时：484 ms -------------
2021-12-12 01:23:22.897 INFO  com.aspect.LogAspect                              :54   [32m124924001347833856[0;39m ------------- 开始 -------------
2021-12-12 01:23:22.898 INFO  com.aspect.LogAspect                              :55   [32m124924001347833856[0;39m 请求地址: http://localhost:8081/doc/vote/123355236525019136 GET
2021-12-12 01:23:22.898 INFO  com.aspect.LogAspect                              :56   [32m124924001347833856[0;39m 类名方法: com.controller.DocController.vote
2021-12-12 01:23:22.898 INFO  com.aspect.LogAspect                              :57   [32m124924001347833856[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:22.898 INFO  com.aspect.LogAspect                              :80   [32m124924001347833856[0;39m 请求参数: [123355236525019136]
2021-12-12 01:23:22.948 INFO  com.Util.RedisUtil                                :31   [32m124924001347833856[0;39m key不存在，放入：DOC_VOTE_123355236525019136_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-12 01:23:23.259 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124924001347833856[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-12 01:23:23.260 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124924001347833856[0;39m ==> Parameters: 123355236525019136(Long)
2021-12-12 01:23:23.367 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m124924001347833856[0;39m <==    Updates: 1
2021-12-12 01:23:23.368 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124924001347833856[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-12 01:23:23.368 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124924001347833856[0;39m ==> Parameters: 123355236525019136(Long)
2021-12-12 01:23:23.467 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124924001347833856[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-12 01:23:23.467 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m124924001347833856[0;39m <==        Row: 123355236525019136, 2, 122746345772683264, 文档2.1, 1, 7, 5
2021-12-12 01:23:23.469 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m124924001347833856[0;39m <==      Total: 1
2021-12-12 01:23:23.472 INFO  com.aspect.LogAspect                              :92   [32m124924001347833856[0;39m 返回结果: {"success":true}
2021-12-12 01:23:23.473 INFO  com.aspect.LogAspect                              :93   [32m124924001347833856[0;39m ------------- 结束 耗时：576 ms -------------
2021-12-12 01:23:23.489 INFO  com.websocket.WebSocketServer                     :71   [32m124924001347833856[0;39m 推送消息：maz59IwezI，内容：【文档2.1】被点赞！
2021-12-12 01:23:24.138 INFO  com.aspect.LogAspect                              :54   [32m124924006552965120[0;39m ------------- 开始 -------------
2021-12-12 01:23:24.140 INFO  com.aspect.LogAspect                              :54   [32m124924006561353728[0;39m ------------- 开始 -------------
2021-12-12 01:23:24.140 INFO  com.aspect.LogAspect                              :55   [32m124924006561353728[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-12 01:23:24.140 INFO  com.aspect.LogAspect                              :56   [32m124924006561353728[0;39m 类名方法: com.controller.CategoryController.all
2021-12-12 01:23:24.140 INFO  com.aspect.LogAspect                              :57   [32m124924006561353728[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:24.141 INFO  com.aspect.LogAspect                              :80   [32m124924006561353728[0;39m 请求参数: []
2021-12-12 01:23:24.139 INFO  com.aspect.LogAspect                              :55   [32m124924006552965120[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-12 01:23:24.141 INFO  com.aspect.LogAspect                              :56   [32m124924006552965120[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-12 01:23:24.142 INFO  com.aspect.LogAspect                              :57   [32m124924006552965120[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:24.142 INFO  com.aspect.LogAspect                              :80   [32m124924006552965120[0;39m 请求参数: []
2021-12-12 01:23:24.188 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924006561353728[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-12 01:23:24.188 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924006552965120[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-12 01:23:24.190 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924006561353728[0;39m ==> Parameters: 
2021-12-12 01:23:24.190 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924006552965120[0;39m ==> Parameters: 
2021-12-12 01:23:24.236 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924006552965120[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==    Columns: id, parent, name, sort
2021-12-12 01:23:24.236 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924006552965120[0;39m <==        Row: 2021-12-11, 521, 185, 64, 50
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-12 01:23:24.236 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924006552965120[0;39m <==        Row: 2021-12-12, 521, 185, 0, 0
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-12 01:23:24.236 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924006552965120[0;39m <==      Total: 2
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-12 01:23:24.236 INFO  com.aspect.LogAspect                              :92   [32m124924006552965120[0;39m 返回结果: {"content":[{"date":1639152000000,"viewCount":521,"viewIncrease":64,"voteCount":185,"voteIncrease":50},{"date":1639238400000,"viewCount":521,"viewIncrease":0,"voteCount":185,"voteIncrease":0}],"success":true}
2021-12-12 01:23:24.236 INFO  com.aspect.LogAspect                              :93   [32m124924006552965120[0;39m ------------- 结束 耗时：98 ms -------------
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 101, 100, Vue, 101
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 200, 0, Java, 200
2021-12-12 01:23:24.236 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 300, 0, Python, 300
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-12 01:23:24.246 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-12 01:23:24.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 500, 0, 其他, 500
2021-12-12 01:23:24.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-12 01:23:24.253 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-12 01:23:24.253 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924006561353728[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-12 01:23:24.254 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924006561353728[0;39m <==      Total: 19
2021-12-12 01:23:24.257 INFO  com.aspect.LogAspect                              :92   [32m124924006561353728[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-12 01:23:24.257 INFO  com.aspect.LogAspect                              :93   [32m124924006561353728[0;39m ------------- 结束 耗时：117 ms -------------
2021-12-12 01:23:25.007 INFO  com.job.EbookSnapshotJob                          :32   [32m124924010197815296[0;39m 生成今日电子书快照开始
2021-12-12 01:23:25.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924010197815296[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:25.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924010197815296[0;39m ==> Parameters: 
2021-12-12 01:23:25.145 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924010197815296[0;39m <==    Updates: 0
2021-12-12 01:23:25.145 INFO  com.job.EbookSnapshotJob                          :35   [32m124924010197815296[0;39m 生成今日电子书快照结束，耗时：137毫秒
2021-12-12 01:23:28.029 INFO  com.websocket.WebSocketServer                     :41   [32m124923960298180608[0;39m 连接关闭，token：maz59IwezI，session id：0！当前连接数：0
2021-12-12 01:23:29.136 INFO  com.websocket.WebSocketServer                     :32   [32m124923963926253568[0;39m 有新连接：token：suq9sfH4Um，session id：1，当前连接数：1
2021-12-12 01:23:29.216 INFO  com.aspect.LogAspect                              :54   [32m124924027851640832[0;39m ------------- 开始 -------------
2021-12-12 01:23:29.217 INFO  com.aspect.LogAspect                              :55   [32m124924027851640832[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-12 01:23:29.217 INFO  com.aspect.LogAspect                              :56   [32m124924027851640832[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-12 01:23:29.217 INFO  com.aspect.LogAspect                              :57   [32m124924027851640832[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:29.218 INFO  com.aspect.LogAspect                              :80   [32m124924027851640832[0;39m 请求参数: []
2021-12-12 01:23:29.219 INFO  com.aspect.LogAspect                              :54   [32m124924027864223744[0;39m ------------- 开始 -------------
2021-12-12 01:23:29.220 INFO  com.aspect.LogAspect                              :55   [32m124924027864223744[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-12 01:23:29.220 INFO  com.aspect.LogAspect                              :56   [32m124924027864223744[0;39m 类名方法: com.controller.CategoryController.all
2021-12-12 01:23:29.220 INFO  com.aspect.LogAspect                              :57   [32m124924027864223744[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:29.220 INFO  com.aspect.LogAspect                              :80   [32m124924027864223744[0;39m 请求参数: []
2021-12-12 01:23:29.269 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924027851640832[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-12 01:23:29.270 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924027851640832[0;39m ==> Parameters: 
2021-12-12 01:23:29.274 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924027864223744[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-12 01:23:29.275 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924027864223744[0;39m ==> Parameters: 
2021-12-12 01:23:29.314 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924027851640832[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-12 01:23:29.315 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924027851640832[0;39m <==        Row: 2021-12-11, 521, 185, 64, 50
2021-12-12 01:23:29.316 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924027851640832[0;39m <==        Row: 2021-12-12, 521, 185, 0, 0
2021-12-12 01:23:29.316 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924027851640832[0;39m <==      Total: 2
2021-12-12 01:23:29.317 INFO  com.aspect.LogAspect                              :92   [32m124924027851640832[0;39m 返回结果: {"content":[{"date":1639152000000,"viewCount":521,"viewIncrease":64,"voteCount":185,"voteIncrease":50},{"date":1639238400000,"viewCount":521,"viewIncrease":0,"voteCount":185,"voteIncrease":0}],"success":true}
2021-12-12 01:23:29.317 INFO  com.aspect.LogAspect                              :93   [32m124924027851640832[0;39m ------------- 结束 耗时：101 ms -------------
2021-12-12 01:23:29.350 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==    Columns: id, parent, name, sort
2021-12-12 01:23:29.350 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-12 01:23:29.351 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-12 01:23:29.351 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-12 01:23:29.351 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-12 01:23:29.352 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 101, 100, Vue, 101
2021-12-12 01:23:29.352 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-12 01:23:29.353 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 200, 0, Java, 200
2021-12-12 01:23:29.353 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-12 01:23:29.353 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-12 01:23:29.353 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 300, 0, Python, 300
2021-12-12 01:23:29.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-12 01:23:29.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-12 01:23:29.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-12 01:23:29.354 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-12 01:23:29.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-12 01:23:29.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 500, 0, 其他, 500
2021-12-12 01:23:29.355 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-12 01:23:29.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-12 01:23:29.356 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924027864223744[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-12 01:23:29.357 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924027864223744[0;39m <==      Total: 19
2021-12-12 01:23:29.358 INFO  com.aspect.LogAspect                              :92   [32m124924027864223744[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-12 01:23:29.358 INFO  com.aspect.LogAspect                              :93   [32m124924027864223744[0;39m ------------- 结束 耗时：139 ms -------------
2021-12-12 01:23:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m124924031202889728[0;39m 生成今日电子书快照开始
2021-12-12 01:23:30.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924031202889728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:30.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924031202889728[0;39m ==> Parameters: 
2021-12-12 01:23:30.167 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924031202889728[0;39m <==    Updates: 0
2021-12-12 01:23:30.167 INFO  com.job.EbookSnapshotJob                          :35   [32m124924031202889728[0;39m 生成今日电子书快照结束，耗时：152毫秒
2021-12-12 01:23:32.315 INFO  com.websocket.WebSocketServer                     :41   [32m124923988429377536[0;39m 连接关闭，token：suq9sfH4Um，session id：1！当前连接数：0
2021-12-12 01:23:35.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124924052132466688[0;39m 生成今日电子书快照开始
2021-12-12 01:23:35.044 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924052132466688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:35.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924052132466688[0;39m ==> Parameters: 
2021-12-12 01:23:35.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924052132466688[0;39m <==    Updates: 0
2021-12-12 01:23:35.144 INFO  com.job.EbookSnapshotJob                          :35   [32m124924052132466688[0;39m 生成今日电子书快照结束，耗时：139毫秒
2021-12-12 01:23:35.144 INFO  com.job.DocJob                                    :32   [32m124924052715474944[0;39m 更新电子书下的文档数据开始
2021-12-12 01:23:35.144 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124924052715474944[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-12 01:23:35.144 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124924052715474944[0;39m ==> Parameters: 
2021-12-12 01:23:35.234 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m124924052715474944[0;39m <==    Updates: 2
2021-12-12 01:23:35.234 INFO  com.job.DocJob                                    :35   [32m124924052715474944[0;39m 更新电子书下的文档数据结束，耗时：90毫秒
2021-12-12 01:23:40.016 INFO  com.job.EbookSnapshotJob                          :32   [32m124924073150124032[0;39m 生成今日电子书快照开始
2021-12-12 01:23:40.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924073150124032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:40.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924073150124032[0;39m ==> Parameters: 
2021-12-12 01:23:40.231 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924073150124032[0;39m <==    Updates: 0
2021-12-12 01:23:40.231 INFO  com.job.EbookSnapshotJob                          :35   [32m124924073150124032[0;39m 生成今日电子书快照结束，耗时：214毫秒
2021-12-12 01:23:41.640 INFO  com.websocket.WebSocketServer                     :32   [32m124924001347833856[0;39m 有新连接：token：28yDiJ08jb，session id：2，当前连接数：1
2021-12-12 01:23:41.859 INFO  com.aspect.LogAspect                              :54   [32m124924080880226304[0;39m ------------- 开始 -------------
2021-12-12 01:23:41.860 INFO  com.aspect.LogAspect                              :55   [32m124924080880226304[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-12 01:23:41.860 INFO  com.aspect.LogAspect                              :56   [32m124924080880226304[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :57   [32m124924080880226304[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :54   [32m124924080888614912[0;39m ------------- 开始 -------------
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :80   [32m124924080880226304[0;39m 请求参数: []
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :55   [32m124924080888614912[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :56   [32m124924080888614912[0;39m 类名方法: com.controller.CategoryController.all
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :57   [32m124924080888614912[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-12 01:23:41.861 INFO  com.aspect.LogAspect                              :80   [32m124924080888614912[0;39m 请求参数: []
2021-12-12 01:23:41.908 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924080888614912[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-12 01:23:41.908 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924080880226304[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-12 01:23:41.908 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924080888614912[0;39m ==> Parameters: 
2021-12-12 01:23:41.908 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924080880226304[0;39m ==> Parameters: 
2021-12-12 01:23:41.982 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924080880226304[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-12 01:23:41.983 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924080880226304[0;39m <==        Row: 2021-12-11, 521, 185, 64, 50
2021-12-12 01:23:41.984 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m124924080880226304[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-12 01:23:41.984 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m124924080880226304[0;39m <==      Total: 2
2021-12-12 01:23:41.984 INFO  com.aspect.LogAspect                              :92   [32m124924080880226304[0;39m 返回结果: {"content":[{"date":1639152000000,"viewCount":521,"viewIncrease":64,"voteCount":185,"voteIncrease":50},{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4}],"success":true}
2021-12-12 01:23:41.984 INFO  com.aspect.LogAspect                              :93   [32m124924080880226304[0;39m ------------- 结束 耗时：125 ms -------------
2021-12-12 01:23:41.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==    Columns: id, parent, name, sort
2021-12-12 01:23:41.988 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-12 01:23:41.989 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-12 01:23:41.989 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-12 01:23:41.990 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-12 01:23:41.990 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 101, 100, Vue, 101
2021-12-12 01:23:41.990 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-12 01:23:41.991 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 200, 0, Java, 200
2021-12-12 01:23:41.991 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-12 01:23:41.991 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-12 01:23:41.991 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 300, 0, Python, 300
2021-12-12 01:23:41.992 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-12 01:23:41.992 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-12 01:23:41.992 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-12 01:23:41.992 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-12 01:23:41.993 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-12 01:23:41.993 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 500, 0, 其他, 500
2021-12-12 01:23:41.994 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-12 01:23:41.994 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-12 01:23:41.995 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m124924080888614912[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-12 01:23:41.995 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m124924080888614912[0;39m <==      Total: 19
2021-12-12 01:23:41.997 INFO  com.aspect.LogAspect                              :92   [32m124924080888614912[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-12 01:23:41.997 INFO  com.aspect.LogAspect                              :93   [32m124924080888614912[0;39m ------------- 结束 耗时：136 ms -------------
2021-12-12 01:23:45.012 INFO  com.job.EbookSnapshotJob                          :32   [32m124924094104866816[0;39m 生成今日电子书快照开始
2021-12-12 01:23:45.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924094104866816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:45.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924094104866816[0;39m ==> Parameters: 
2021-12-12 01:23:45.142 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924094104866816[0;39m <==    Updates: 0
2021-12-12 01:23:45.142 INFO  com.job.EbookSnapshotJob                          :35   [32m124924094104866816[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-12 01:23:50.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124924115047026688[0;39m 生成今日电子书快照开始
2021-12-12 01:23:50.046 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924115047026688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:50.046 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924115047026688[0;39m ==> Parameters: 
2021-12-12 01:23:50.146 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924115047026688[0;39m <==    Updates: 0
2021-12-12 01:23:50.146 INFO  com.job.EbookSnapshotJob                          :35   [32m124924115047026688[0;39m 生成今日电子书快照结束，耗时：141毫秒
2021-12-12 01:23:52.095 INFO  com.websocket.WebSocketServer                     :41   [32m124923960298180608[0;39m 连接关闭，token：28yDiJ08jb，session id：2！当前连接数：0
2021-12-12 01:23:55.005 INFO  com.job.EbookSnapshotJob                          :32   [32m124924136018546688[0;39m 生成今日电子书快照开始
2021-12-12 01:23:55.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924136018546688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-12 01:23:55.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m124924136018546688[0;39m ==> Parameters: 
