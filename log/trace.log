2021-12-13 00:01:51.174 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-13 00:01:51.180 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 2276 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-13 00:01:51.180 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-13 00:01:51.281 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-13 00:01:51.281 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-13 00:01:52.956 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-13 00:01:52.966 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-13 00:01:53.667 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 687 ms. Found 0 Redis repository interfaces.
2021-12-13 00:01:54.617 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-13 00:01:54.627 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-13 00:01:54.627 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-13 00:01:54.627 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-13 00:01:54.707 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-13 00:01:54.707 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 3426 ms
2021-12-13 00:01:56.715 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-13 00:01:56.755 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-13 00:01:56.782 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-13 00:01:56.796 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 6.383 seconds (JVM running for 7.642)
2021-12-13 00:02:00.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125265908871598080[0;39m 生成今日电子书快照开始
2021-12-13 00:02:00.023 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125265908871598080[0;39m HikariPool-1 - Starting...
2021-12-13 00:02:00.792 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125265908871598080[0;39m HikariPool-1 - Start completed.
2021-12-13 00:02:00.802 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265908871598080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:00.832 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265908871598080[0;39m ==> Parameters: 
2021-12-13 00:02:00.932 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265908871598080[0;39m <==    Updates: 6
2021-12-13 00:02:00.942 INFO  com.job.EbookSnapshotJob                          :35   [32m125265908871598080[0;39m 生成今日电子书快照结束，耗时：939毫秒
2021-12-13 00:02:05.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125265929838923776[0;39m 生成今日电子书快照开始
2021-12-13 00:02:05.042 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265929838923776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:05.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265929838923776[0;39m ==> Parameters: 
2021-12-13 00:02:05.142 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265929838923776[0;39m <==    Updates: 0
2021-12-13 00:02:05.142 INFO  com.job.EbookSnapshotJob                          :35   [32m125265929838923776[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:02:05.142 INFO  com.job.DocJob                                    :32   [32m125265930426126336[0;39m 更新电子书下的文档数据开始
2021-12-13 00:02:05.152 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125265930426126336[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:02:05.152 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125265930426126336[0;39m ==> Parameters: 
2021-12-13 00:02:05.252 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125265930426126336[0;39m <==    Updates: 2
2021-12-13 00:02:05.252 INFO  com.job.DocJob                                    :35   [32m125265930426126336[0;39m 更新电子书下的文档数据结束，耗时：110毫秒
2021-12-13 00:02:10.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125265950843998208[0;39m 生成今日电子书快照开始
2021-12-13 00:02:10.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265950843998208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:10.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265950843998208[0;39m ==> Parameters: 
2021-12-13 00:02:10.140 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265950843998208[0;39m <==    Updates: 0
2021-12-13 00:02:10.140 INFO  com.job.EbookSnapshotJob                          :35   [32m125265950843998208[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:02:15.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125265971819712512[0;39m 生成今日电子书快照开始
2021-12-13 00:02:15.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265971819712512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:15.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265971819712512[0;39m ==> Parameters: 
2021-12-13 00:02:15.151 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265971819712512[0;39m <==    Updates: 0
2021-12-13 00:02:15.151 INFO  com.job.EbookSnapshotJob                          :35   [32m125265971819712512[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:02:20.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125265992795426816[0;39m 生成今日电子书快照开始
2021-12-13 00:02:20.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265992795426816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:20.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265992795426816[0;39m ==> Parameters: 
2021-12-13 00:02:20.141 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125265992795426816[0;39m <==    Updates: 0
2021-12-13 00:02:20.141 INFO  com.job.EbookSnapshotJob                          :35   [32m125265992795426816[0;39m 生成今日电子书快照结束，耗时：129毫秒
2021-12-13 00:02:25.009 INFO  com.job.EbookSnapshotJob                          :32   [32m125266013754363904[0;39m 生成今日电子书快照开始
2021-12-13 00:02:25.049 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266013754363904[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:25.049 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266013754363904[0;39m ==> Parameters: 
2021-12-13 00:02:25.149 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266013754363904[0;39m <==    Updates: 0
2021-12-13 00:02:25.149 INFO  com.job.EbookSnapshotJob                          :35   [32m125266013754363904[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:02:30.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125266034738466816[0;39m 生成今日电子书快照开始
2021-12-13 00:02:30.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266034738466816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:30.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266034738466816[0;39m ==> Parameters: 
2021-12-13 00:02:30.142 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266034738466816[0;39m <==    Updates: 0
2021-12-13 00:02:30.142 INFO  com.job.EbookSnapshotJob                          :35   [32m125266034738466816[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:02:35.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125266055709986816[0;39m 生成今日电子书快照开始
2021-12-13 00:02:35.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266055709986816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:35.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266055709986816[0;39m ==> Parameters: 
2021-12-13 00:02:35.141 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266055709986816[0;39m <==    Updates: 0
2021-12-13 00:02:35.151 INFO  com.job.EbookSnapshotJob                          :35   [32m125266055709986816[0;39m 生成今日电子书快照结束，耗时：139毫秒
2021-12-13 00:02:35.151 INFO  com.job.DocJob                                    :32   [32m125266056292995072[0;39m 更新电子书下的文档数据开始
2021-12-13 00:02:35.151 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266056292995072[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:02:35.151 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266056292995072[0;39m ==> Parameters: 
2021-12-13 00:02:35.242 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266056292995072[0;39m <==    Updates: 2
2021-12-13 00:02:35.242 INFO  com.job.DocJob                                    :35   [32m125266056292995072[0;39m 更新电子书下的文档数据结束，耗时：91毫秒
2021-12-13 00:02:40.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125266076677312512[0;39m 生成今日电子书快照开始
2021-12-13 00:02:40.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266076677312512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:40.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266076677312512[0;39m ==> Parameters: 
2021-12-13 00:02:40.161 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266076677312512[0;39m <==    Updates: 0
2021-12-13 00:02:40.161 INFO  com.job.EbookSnapshotJob                          :35   [32m125266076677312512[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:02:45.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125266097653026816[0;39m 生成今日电子书快照开始
2021-12-13 00:02:45.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266097653026816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:45.052 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266097653026816[0;39m ==> Parameters: 
2021-12-13 00:02:45.142 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266097653026816[0;39m <==    Updates: 0
2021-12-13 00:02:45.142 INFO  com.job.EbookSnapshotJob                          :35   [32m125266097653026816[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:02:50.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125266118578409472[0;39m 生成今日电子书快照开始
2021-12-13 00:02:50.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266118578409472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:50.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266118578409472[0;39m ==> Parameters: 
2021-12-13 00:02:50.181 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266118578409472[0;39m <==    Updates: 0
2021-12-13 00:02:50.181 INFO  com.job.EbookSnapshotJob                          :35   [32m125266118578409472[0;39m 生成今日电子书快照结束，耗时：180毫秒
2021-12-13 00:02:55.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125266139587678208[0;39m 生成今日电子书快照开始
2021-12-13 00:02:55.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266139587678208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:02:55.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266139587678208[0;39m ==> Parameters: 
2021-12-13 00:02:55.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266139587678208[0;39m <==    Updates: 0
2021-12-13 00:02:55.150 INFO  com.job.EbookSnapshotJob                          :35   [32m125266139587678208[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:03:00.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125266160559198208[0;39m 生成今日电子书快照开始
2021-12-13 00:03:00.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266160559198208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:00.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266160559198208[0;39m ==> Parameters: 
2021-12-13 00:03:00.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266160559198208[0;39m <==    Updates: 0
2021-12-13 00:03:00.150 INFO  com.job.EbookSnapshotJob                          :35   [32m125266160559198208[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:03:05.012 INFO  com.job.DocJob                                    :32   [32m125266181539106816[0;39m 更新电子书下的文档数据开始
2021-12-13 00:03:05.052 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266181539106816[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:03:05.062 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266181539106816[0;39m ==> Parameters: 
2021-12-13 00:03:05.172 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266181539106816[0;39m <==    Updates: 2
2021-12-13 00:03:05.172 INFO  com.job.DocJob                                    :35   [32m125266181539106816[0;39m 更新电子书下的文档数据结束，耗时：160毫秒
2021-12-13 00:03:05.172 INFO  com.job.EbookSnapshotJob                          :32   [32m125266182210195456[0;39m 生成今日电子书快照开始
2021-12-13 00:03:05.172 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266182210195456[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:05.182 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266182210195456[0;39m ==> Parameters: 
2021-12-13 00:03:05.282 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266182210195456[0;39m <==    Updates: 0
2021-12-13 00:03:05.282 INFO  com.job.EbookSnapshotJob                          :35   [32m125266182210195456[0;39m 生成今日电子书快照结束，耗时：110毫秒
2021-12-13 00:03:10.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125266202506432512[0;39m 生成今日电子书快照开始
2021-12-13 00:03:10.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266202506432512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:10.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266202506432512[0;39m ==> Parameters: 
2021-12-13 00:03:10.161 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266202506432512[0;39m <==    Updates: 0
2021-12-13 00:03:10.161 INFO  com.job.EbookSnapshotJob                          :35   [32m125266202506432512[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:03:15.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125266223473758208[0;39m 生成今日电子书快照开始
2021-12-13 00:03:15.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266223473758208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:15.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266223473758208[0;39m ==> Parameters: 
2021-12-13 00:03:15.140 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266223473758208[0;39m <==    Updates: 0
2021-12-13 00:03:15.140 INFO  com.job.EbookSnapshotJob                          :35   [32m125266223473758208[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:03:20.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125266244449472512[0;39m 生成今日电子书快照开始
2021-12-13 00:03:20.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266244449472512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:20.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266244449472512[0;39m ==> Parameters: 
2021-12-13 00:03:20.141 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266244449472512[0;39m <==    Updates: 0
2021-12-13 00:03:20.141 INFO  com.job.EbookSnapshotJob                          :35   [32m125266244449472512[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:03:24.519 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-13 00:03:24.519 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-13 00:03:24.521 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-13 00:03:24.752 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：cjD4FbbG66，session id：0，当前连接数：1
2021-12-13 00:03:24.773 INFO  com.aspect.LogAspect                              :54   [32m125266264418553856[0;39m ------------- 开始 -------------
2021-12-13 00:03:24.773 INFO  com.aspect.LogAspect                              :54   [32m125266264418553858[0;39m ------------- 开始 -------------
2021-12-13 00:03:24.773 INFO  com.aspect.LogAspect                              :54   [32m125266264418553857[0;39m ------------- 开始 -------------
2021-12-13 00:03:24.774 INFO  com.aspect.LogAspect                              :55   [32m125266264418553858[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:03:24.774 INFO  com.aspect.LogAspect                              :55   [32m125266264418553857[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:03:24.774 INFO  com.aspect.LogAspect                              :55   [32m125266264418553856[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :56   [32m125266264418553857[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :56   [32m125266264418553858[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :56   [32m125266264418553856[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :57   [32m125266264418553857[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :57   [32m125266264418553856[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:24.775 INFO  com.aspect.LogAspect                              :57   [32m125266264418553858[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:24.820 INFO  com.aspect.LogAspect                              :80   [32m125266264418553858[0;39m 请求参数: []
2021-12-13 00:03:24.820 INFO  com.aspect.LogAspect                              :80   [32m125266264418553856[0;39m 请求参数: []
2021-12-13 00:03:24.820 INFO  com.aspect.LogAspect                              :80   [32m125266264418553857[0;39m 请求参数: []
2021-12-13 00:03:24.867 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266264418553857[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:03:24.867 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266264418553857[0;39m ==> Parameters: 
2021-12-13 00:03:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266264418553858[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:03:24.877 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266264418553858[0;39m ==> Parameters: 
2021-12-13 00:03:24.923 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266264418553856[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:03:24.926 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266264418553856[0;39m ==> Parameters: 
2021-12-13 00:03:24.966 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266264418553857[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:03:24.966 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266264418553858[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:03:24.967 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266264418553858[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:03:24.967 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266264418553857[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:03:24.976 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266264418553857[0;39m <==        Row: 2021-12-13, 525, 189, 0, 0
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:03:24.976 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266264418553857[0;39m <==      Total: 2
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:03:24.976 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266264418553858[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:03:24.976 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:03:24.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:03:24.983 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266264418553858[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:03:24.983 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266264418553858[0;39m <==      Total: 3
2021-12-13 00:03:24.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:03:24.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:03:24.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:03:24.983 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:03:24.987 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:03:24.987 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:03:24.987 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:03:24.987 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:03:24.987 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266264418553856[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:03:24.987 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266264418553856[0;39m <==      Total: 19
2021-12-13 00:03:25.010 INFO  com.aspect.LogAspect                              :92   [32m125266264418553858[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:03:25.010 INFO  com.aspect.LogAspect                              :93   [32m125266264418553858[0;39m ------------- 结束 耗时：238 ms -------------
2021-12-13 00:03:25.013 INFO  com.aspect.LogAspect                              :92   [32m125266264418553857[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":525,"viewIncrease":0,"voteCount":189,"voteIncrease":0}],"success":true}
2021-12-13 00:03:25.013 INFO  com.aspect.LogAspect                              :93   [32m125266264418553857[0;39m ------------- 结束 耗时：241 ms -------------
2021-12-13 00:03:25.014 INFO  com.aspect.LogAspect                              :92   [32m125266264418553856[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:03:25.014 INFO  com.aspect.LogAspect                              :93   [32m125266264418553856[0;39m ------------- 结束 耗时：242 ms -------------
2021-12-13 00:03:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125266265437769728[0;39m 生成今日电子书快照开始
2021-12-13 00:03:25.015 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266265437769728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:25.018 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266265437769728[0;39m ==> Parameters: 
2021-12-13 00:03:25.122 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266265437769728[0;39m <==    Updates: 0
2021-12-13 00:03:25.122 INFO  com.job.EbookSnapshotJob                          :35   [32m125266265437769728[0;39m 生成今日电子书快照结束，耗时：107毫秒
2021-12-13 00:03:30.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125266286413484032[0;39m 生成今日电子书快照开始
2021-12-13 00:03:30.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266286413484032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:30.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266286413484032[0;39m ==> Parameters: 
2021-12-13 00:03:30.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266286413484032[0;39m <==    Updates: 0
2021-12-13 00:03:30.150 INFO  com.job.EbookSnapshotJob                          :35   [32m125266286413484032[0;39m 生成今日电子书快照结束，耗时：133毫秒
2021-12-13 00:03:35.006 INFO  com.job.EbookSnapshotJob                          :32   [32m125266307343060992[0;39m 生成今日电子书快照开始
2021-12-13 00:03:35.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266307343060992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:35.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266307343060992[0;39m ==> Parameters: 
2021-12-13 00:03:35.145 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266307343060992[0;39m <==    Updates: 0
2021-12-13 00:03:35.146 INFO  com.job.EbookSnapshotJob                          :35   [32m125266307343060992[0;39m 生成今日电子书快照结束，耗时：139毫秒
2021-12-13 00:03:35.147 INFO  com.job.DocJob                                    :32   [32m125266307934457856[0;39m 更新电子书下的文档数据开始
2021-12-13 00:03:35.148 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266307934457856[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:03:35.148 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266307934457856[0;39m ==> Parameters: 
2021-12-13 00:03:35.245 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266307934457856[0;39m <==    Updates: 2
2021-12-13 00:03:35.246 INFO  com.job.DocJob                                    :35   [32m125266307934457856[0;39m 更新电子书下的文档数据结束，耗时：99毫秒
2021-12-13 00:03:40.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125266328339746816[0;39m 生成今日电子书快照开始
2021-12-13 00:03:40.058 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266328339746816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:40.059 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266328339746816[0;39m ==> Parameters: 
2021-12-13 00:03:40.147 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266328339746816[0;39m <==    Updates: 0
2021-12-13 00:03:40.148 INFO  com.job.EbookSnapshotJob                          :35   [32m125266328339746816[0;39m 生成今日电子书快照结束，耗时：136毫秒
2021-12-13 00:03:45.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125266349302878208[0;39m 生成今日电子书快照开始
2021-12-13 00:03:45.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266349302878208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:45.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266349302878208[0;39m ==> Parameters: 
2021-12-13 00:03:45.140 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266349302878208[0;39m <==    Updates: 0
2021-12-13 00:03:45.140 INFO  com.job.EbookSnapshotJob                          :35   [32m125266349302878208[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:03:50.010 INFO  com.job.EbookSnapshotJob                          :32   [32m125266370274398208[0;39m 生成今日电子书快照开始
2021-12-13 00:03:50.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266370274398208[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266370274398208[0;39m ==> Parameters: 
2021-12-13 00:03:50.162 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266370274398208[0;39m <==    Updates: 0
2021-12-13 00:03:50.164 INFO  com.job.EbookSnapshotJob                          :35   [32m125266370274398208[0;39m 生成今日电子书快照结束，耗时：154毫秒
2021-12-13 00:03:51.267 INFO  com.aspect.LogAspect                              :54   [32m125266375546638336[0;39m ------------- 开始 -------------
2021-12-13 00:03:51.267 INFO  com.aspect.LogAspect                              :55   [32m125266375546638336[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-13 00:03:51.267 INFO  com.aspect.LogAspect                              :56   [32m125266375546638336[0;39m 类名方法: com.controller.EbookController.list
2021-12-13 00:03:51.267 INFO  com.aspect.LogAspect                              :57   [32m125266375546638336[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:51.270 INFO  com.aspect.LogAspect                              :80   [32m125266375546638336[0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2021-12-13 00:03:51.402 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266375546638336[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-13 00:03:51.403 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266375546638336[0;39m ==> Parameters: 202(Long)
2021-12-13 00:03:51.447 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266375546638336[0;39m <==    Columns: count(0)
2021-12-13 00:03:51.448 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266375546638336[0;39m <==        Row: 1
2021-12-13 00:03:51.449 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266375546638336[0;39m <==      Total: 1
2021-12-13 00:03:51.451 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266375546638336[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-13 00:03:51.451 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266375546638336[0;39m ==> Parameters: 202(Long), 1000(Integer)
2021-12-13 00:03:51.497 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266375546638336[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-13 00:03:51.497 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266375546638336[0;39m <==        Row: 1, Spring Boot 入门教程, 200, 202, 零基础入门Java开发，企业级应用开发最佳首选框架, /image/cover1.png, 7, 87, 11
2021-12-13 00:03:51.498 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266375546638336[0;39m <==      Total: 1
2021-12-13 00:03:51.499 INFO  com.servicess.EbookService                        :48   [32m125266375546638336[0;39m 总行数：1
2021-12-13 00:03:51.500 INFO  com.servicess.EbookService                        :49   [32m125266375546638336[0;39m 总页数：1
2021-12-13 00:03:51.513 INFO  com.aspect.LogAspect                              :92   [32m125266375546638336[0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"/image/cover1.png","description":"零基础入门Java开发，企业级应用开发最佳首选框架","docCount":7,"id":1,"name":"Spring Boot 入门教程","viewCount":87,"voteCount":11}],"total":1},"success":true}
2021-12-13 00:03:51.513 INFO  com.aspect.LogAspect                              :93   [32m125266375546638336[0;39m ------------- 结束 耗时：246 ms -------------
2021-12-13 00:03:52.400 INFO  com.aspect.LogAspect                              :54   [32m125266380298784768[0;39m ------------- 开始 -------------
2021-12-13 00:03:52.400 INFO  com.aspect.LogAspect                              :55   [32m125266380298784768[0;39m 请求地址: http://localhost:8081/doc/all/1 GET
2021-12-13 00:03:52.401 INFO  com.aspect.LogAspect                              :56   [32m125266380298784768[0;39m 类名方法: com.controller.DocController.all
2021-12-13 00:03:52.401 INFO  com.aspect.LogAspect                              :57   [32m125266380298784768[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:52.402 INFO  com.aspect.LogAspect                              :80   [32m125266380298784768[0;39m 请求参数: [1]
2021-12-13 00:03:52.448 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266380298784768[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-13 00:03:52.448 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266380298784768[0;39m ==> Parameters: 1(Long)
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 1, 1, 119304585604108288, 文档1, 1, 14, 2
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 12, 3
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 8, 2
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 118617791401168896, 1, 5, 文档2.2.1, 1, 13, 1
2021-12-13 00:03:52.508 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 17, 1
2021-12-13 00:03:52.518 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 3, 1, 0, 文档2, 2, 10, 1
2021-12-13 00:03:52.518 TRACE com.mapper.DocMapper.selectByExample              :143  [32m125266380298784768[0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 13, 1
2021-12-13 00:03:52.518 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266380298784768[0;39m <==      Total: 7
2021-12-13 00:03:52.538 INFO  com.aspect.LogAspect                              :92   [32m125266380298784768[0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"文档1","parent":119304585604108288,"sort":1,"viewCount":14,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":12,"voteCount":3},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":8,"voteCount":2},{"ebookId":1,"id":118617791401168896,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":13,"voteCount":1},{"ebookId":1,"id":119304585604108288,"name":"Ant Design of Vue","parent":0,"sort":1,"viewCount":17,"voteCount":1},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":10,"voteCount":1},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":13,"voteCount":1}],"success":true}
2021-12-13 00:03:52.538 INFO  com.aspect.LogAspect                              :93   [32m125266380298784768[0;39m ------------- 结束 耗时：138 ms -------------
2021-12-13 00:03:52.604 INFO  com.aspect.LogAspect                              :54   [32m125266381154422784[0;39m ------------- 开始 -------------
2021-12-13 00:03:52.604 INFO  com.aspect.LogAspect                              :55   [32m125266381154422784[0;39m 请求地址: http://localhost:8081/doc/find-content/119304585604108288 GET
2021-12-13 00:03:52.604 INFO  com.aspect.LogAspect                              :56   [32m125266381154422784[0;39m 类名方法: com.controller.DocController.findContent
2021-12-13 00:03:52.604 INFO  com.aspect.LogAspect                              :57   [32m125266381154422784[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:52.605 INFO  com.aspect.LogAspect                              :80   [32m125266381154422784[0;39m 请求参数: [119304585604108288]
2021-12-13 00:03:52.605 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266381154422784[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-13 00:03:52.606 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266381154422784[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-13 00:03:52.660 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125266381154422784[0;39m <==    Columns: id, content
2021-12-13 00:03:52.661 TRACE com.mapper.ContentMapper.selectByPrimaryKey       :143  [32m125266381154422784[0;39m <==        Row: 119304585604108288, <<BLOB>>
2021-12-13 00:03:52.661 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266381154422784[0;39m <==      Total: 1
2021-12-13 00:03:52.662 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266381154422784[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-13 00:03:52.663 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266381154422784[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-13 00:03:52.778 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266381154422784[0;39m <==    Updates: 1
2021-12-13 00:03:52.779 INFO  com.aspect.LogAspect                              :92   [32m125266381154422784[0;39m 返回结果: {"content":"<blockquote><h1><b id=\"9lkez\"><font face=\"微软雅黑\">Ant Design of Vue</font></b></h1><p>这里是 Ant Design 的 Vue 实现，开发和服务于企业级后台<font face=\"标楷体\"></font>产品。</p></blockquote>","success":true}
2021-12-13 00:03:52.780 INFO  com.aspect.LogAspect                              :93   [32m125266381154422784[0;39m ------------- 结束 耗时：177 ms -------------
2021-12-13 00:03:53.915 INFO  com.aspect.LogAspect                              :54   [32m125266386653155328[0;39m ------------- 开始 -------------
2021-12-13 00:03:53.915 INFO  com.aspect.LogAspect                              :55   [32m125266386653155328[0;39m 请求地址: http://localhost:8081/doc/vote/119304585604108288 GET
2021-12-13 00:03:53.915 INFO  com.aspect.LogAspect                              :56   [32m125266386653155328[0;39m 类名方法: com.controller.DocController.vote
2021-12-13 00:03:53.915 INFO  com.aspect.LogAspect                              :57   [32m125266386653155328[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:53.915 INFO  com.aspect.LogAspect                              :80   [32m125266386653155328[0;39m 请求参数: [119304585604108288]
2021-12-13 00:03:55.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125266391224946688[0;39m 生成今日电子书快照开始
2021-12-13 00:03:55.020 INFO  com.Util.RedisUtil                                :31   [32m125266386653155328[0;39m key不存在，放入：DOC_VOTE_119304585604108288_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-13 00:03:55.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266391224946688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:03:55.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266391224946688[0;39m ==> Parameters: 
2021-12-13 00:03:55.082 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266386653155328[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-13 00:03:55.083 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266386653155328[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-13 00:03:55.156 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266391224946688[0;39m <==    Updates: 0
2021-12-13 00:03:55.156 INFO  com.job.EbookSnapshotJob                          :35   [32m125266391224946688[0;39m 生成今日电子书快照结束，耗时：151毫秒
2021-12-13 00:03:55.178 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266386653155328[0;39m <==    Updates: 1
2021-12-13 00:03:55.179 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266386653155328[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-13 00:03:55.179 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266386653155328[0;39m ==> Parameters: 119304585604108288(Long)
2021-12-13 00:03:55.229 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125266386653155328[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-13 00:03:55.230 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125266386653155328[0;39m <==        Row: 119304585604108288, 1, 0, Ant Design of Vue, 1, 18, 2
2021-12-13 00:03:55.230 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266386653155328[0;39m <==      Total: 1
2021-12-13 00:03:55.233 INFO  com.aspect.LogAspect                              :92   [32m125266386653155328[0;39m 返回结果: {"success":true}
2021-12-13 00:03:55.233 INFO  com.aspect.LogAspect                              :93   [32m125266386653155328[0;39m ------------- 结束 耗时：1318 ms -------------
2021-12-13 00:03:55.241 INFO  com.websocket.WebSocketServer                     :71   [32m125266386653155328[0;39m 推送消息：cjD4FbbG66，内容：【Ant Design of Vue】被点赞！
2021-12-13 00:03:55.975 INFO  com.aspect.LogAspect                              :54   [32m125266395293421568[0;39m ------------- 开始 -------------
2021-12-13 00:03:55.976 INFO  com.aspect.LogAspect                              :55   [32m125266395293421568[0;39m 请求地址: http://localhost:8081/doc/find-content/118617791401168896 GET
2021-12-13 00:03:55.976 INFO  com.aspect.LogAspect                              :56   [32m125266395293421568[0;39m 类名方法: com.controller.DocController.findContent
2021-12-13 00:03:55.976 INFO  com.aspect.LogAspect                              :57   [32m125266395293421568[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:55.977 INFO  com.aspect.LogAspect                              :80   [32m125266395293421568[0;39m 请求参数: [118617791401168896]
2021-12-13 00:03:56.047 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266395293421568[0;39m ==>  Preparing: select id , content from content where id = ?
2021-12-13 00:03:56.048 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266395293421568[0;39m ==> Parameters: 118617791401168896(Long)
2021-12-13 00:03:56.100 DEBUG com.mapper.ContentMapper.selectByPrimaryKey       :137  [32m125266395293421568[0;39m <==      Total: 0
2021-12-13 00:03:56.101 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266395293421568[0;39m ==>  Preparing: update doc set view_count = view_count + 1 where id = ?
2021-12-13 00:03:56.101 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266395293421568[0;39m ==> Parameters: 118617791401168896(Long)
2021-12-13 00:03:56.212 DEBUG com.mapper.DocMapperCust.increaseViewCount        :137  [32m125266395293421568[0;39m <==    Updates: 1
2021-12-13 00:03:56.213 INFO  com.aspect.LogAspect                              :92   [32m125266395293421568[0;39m 返回结果: {"content":"","success":true}
2021-12-13 00:03:56.214 INFO  com.aspect.LogAspect                              :93   [32m125266395293421568[0;39m ------------- 结束 耗时：239 ms -------------
2021-12-13 00:03:56.935 INFO  com.aspect.LogAspect                              :54   [32m125266399319953408[0;39m ------------- 开始 -------------
2021-12-13 00:03:56.935 INFO  com.aspect.LogAspect                              :55   [32m125266399319953408[0;39m 请求地址: http://localhost:8081/doc/vote/118617791401168896 GET
2021-12-13 00:03:56.935 INFO  com.aspect.LogAspect                              :56   [32m125266399319953408[0;39m 类名方法: com.controller.DocController.vote
2021-12-13 00:03:56.935 INFO  com.aspect.LogAspect                              :57   [32m125266399319953408[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:56.936 INFO  com.aspect.LogAspect                              :80   [32m125266399319953408[0;39m 请求参数: [118617791401168896]
2021-12-13 00:03:56.950 INFO  com.Util.RedisUtil                                :31   [32m125266399319953408[0;39m key不存在，放入：DOC_VOTE_118617791401168896_0:0:0:0:0:0:0:1，过期 60 秒
2021-12-13 00:03:57.008 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266399319953408[0;39m ==>  Preparing: update doc set vote_count = vote_count + 1 where id = ?
2021-12-13 00:03:57.009 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266399319953408[0;39m ==> Parameters: 118617791401168896(Long)
2021-12-13 00:03:57.106 DEBUG com.mapper.DocMapperCust.increaseVoteCount        :137  [32m125266399319953408[0;39m <==    Updates: 1
2021-12-13 00:03:57.106 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266399319953408[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc where id = ?
2021-12-13 00:03:57.107 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266399319953408[0;39m ==> Parameters: 118617791401168896(Long)
2021-12-13 00:03:57.162 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125266399319953408[0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-12-13 00:03:57.162 TRACE com.mapper.DocMapper.selectByPrimaryKey           :143  [32m125266399319953408[0;39m <==        Row: 118617791401168896, 1, 5, 文档2.2.1, 1, 14, 2
2021-12-13 00:03:57.163 DEBUG com.mapper.DocMapper.selectByPrimaryKey           :137  [32m125266399319953408[0;39m <==      Total: 1
2021-12-13 00:03:57.165 INFO  com.aspect.LogAspect                              :92   [32m125266399319953408[0;39m 返回结果: {"success":true}
2021-12-13 00:03:57.165 INFO  com.aspect.LogAspect                              :93   [32m125266399319953408[0;39m ------------- 结束 耗时：230 ms -------------
2021-12-13 00:03:57.166 INFO  com.websocket.WebSocketServer                     :71   [32m125266399319953408[0;39m 推送消息：cjD4FbbG66，内容：【文档2.2.1】被点赞！
2021-12-13 00:03:58.082 INFO  com.aspect.LogAspect                              :54   [32m125266404130820097[0;39m ------------- 开始 -------------
2021-12-13 00:03:58.082 INFO  com.aspect.LogAspect                              :54   [32m125266404130820096[0;39m ------------- 开始 -------------
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :55   [32m125266404130820097[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :55   [32m125266404130820096[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :56   [32m125266404130820097[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :56   [32m125266404130820096[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :57   [32m125266404130820097[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :57   [32m125266404130820096[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :80   [32m125266404130820097[0;39m 请求参数: []
2021-12-13 00:03:58.083 INFO  com.aspect.LogAspect                              :80   [32m125266404130820096[0;39m 请求参数: []
2021-12-13 00:03:58.086 INFO  com.aspect.LogAspect                              :54   [32m125266404147597312[0;39m ------------- 开始 -------------
2021-12-13 00:03:58.086 INFO  com.aspect.LogAspect                              :55   [32m125266404147597312[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:03:58.086 INFO  com.aspect.LogAspect                              :56   [32m125266404147597312[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:03:58.087 INFO  com.aspect.LogAspect                              :57   [32m125266404147597312[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:03:58.087 INFO  com.aspect.LogAspect                              :80   [32m125266404147597312[0;39m 请求参数: []
2021-12-13 00:03:58.133 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266404130820096[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:03:58.133 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266404130820097[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:03:58.133 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266404130820096[0;39m ==> Parameters: 
2021-12-13 00:03:58.133 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266404130820097[0;39m ==> Parameters: 
2021-12-13 00:03:58.141 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266404147597312[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:03:58.142 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266404147597312[0;39m ==> Parameters: 
2021-12-13 00:03:58.177 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266404130820096[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:03:58.177 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266404130820096[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:03:58.178 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266404130820096[0;39m <==        Row: 2021-12-13, 525, 189, 0, 0
2021-12-13 00:03:58.179 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266404130820096[0;39m <==      Total: 2
2021-12-13 00:03:58.179 INFO  com.aspect.LogAspect                              :92   [32m125266404130820096[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":525,"viewIncrease":0,"voteCount":189,"voteIncrease":0}],"success":true}
2021-12-13 00:03:58.180 INFO  com.aspect.LogAspect                              :93   [32m125266404130820096[0;39m ------------- 结束 耗时：98 ms -------------
2021-12-13 00:03:58.188 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:03:58.188 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266404130820097[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:03:58.188 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:03:58.189 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266404130820097[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:03:58.189 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:03:58.190 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266404130820097[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:03:58.191 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:03:58.192 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266404130820097[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:03:58.192 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:03:58.192 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266404130820097[0;39m <==      Total: 3
2021-12-13 00:03:58.193 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:03:58.193 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:03:58.193 INFO  com.aspect.LogAspect                              :92   [32m125266404130820097[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:03:58.194 INFO  com.aspect.LogAspect                              :93   [32m125266404130820097[0;39m ------------- 结束 耗时：112 ms -------------
2021-12-13 00:03:58.194 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:03:58.195 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:03:58.196 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:03:58.197 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:03:58.197 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:03:58.198 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:03:58.199 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:03:58.199 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:03:58.200 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:03:58.201 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:03:58.202 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:03:58.202 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:03:58.203 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266404147597312[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:03:58.203 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266404147597312[0;39m <==      Total: 19
2021-12-13 00:03:58.207 INFO  com.aspect.LogAspect                              :92   [32m125266404147597312[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:03:58.207 INFO  com.aspect.LogAspect                              :93   [32m125266404147597312[0;39m ------------- 结束 耗时：121 ms -------------
2021-12-13 00:04:00.002 INFO  com.job.EbookSnapshotJob                          :32   [32m125266412183883776[0;39m 生成今日电子书快照开始
2021-12-13 00:04:00.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266412183883776[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:00.046 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266412183883776[0;39m ==> Parameters: 
2021-12-13 00:04:00.132 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266412183883776[0;39m <==    Updates: 0
2021-12-13 00:04:00.132 INFO  com.job.EbookSnapshotJob                          :35   [32m125266412183883776[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:04:00.447 INFO  com.aspect.LogAspect                              :54   [32m125266414050349056[0;39m ------------- 开始 -------------
2021-12-13 00:04:00.448 INFO  com.aspect.LogAspect                              :55   [32m125266414050349056[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-13 00:04:00.448 INFO  com.aspect.LogAspect                              :56   [32m125266414050349056[0;39m 类名方法: com.controller.EbookController.list
2021-12-13 00:04:00.448 INFO  com.aspect.LogAspect                              :57   [32m125266414050349056[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:00.449 INFO  com.aspect.LogAspect                              :80   [32m125266414050349056[0;39m 请求参数: [{"categoryId2":401,"page":1,"size":1000}]
2021-12-13 00:04:00.456 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266414050349056[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-13 00:04:00.457 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266414050349056[0;39m ==> Parameters: 401(Long)
2021-12-13 00:04:00.501 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266414050349056[0;39m <==    Columns: count(0)
2021-12-13 00:04:00.501 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266414050349056[0;39m <==        Row: 1
2021-12-13 00:04:00.501 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266414050349056[0;39m <==      Total: 1
2021-12-13 00:04:00.502 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266414050349056[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-13 00:04:00.502 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266414050349056[0;39m ==> Parameters: 401(Long), 1000(Integer)
2021-12-13 00:04:00.548 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266414050349056[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-13 00:04:00.548 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266414050349056[0;39m <==        Row: 4, Mysql入门教程, 400, 401, 零基础入门Mysql开发，企业级应用开发最佳首选框架, /image/cover2.png, 20, 56, 23
2021-12-13 00:04:00.548 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266414050349056[0;39m <==      Total: 1
2021-12-13 00:04:00.548 INFO  com.servicess.EbookService                        :48   [32m125266414050349056[0;39m 总行数：1
2021-12-13 00:04:00.548 INFO  com.servicess.EbookService                        :49   [32m125266414050349056[0;39m 总页数：1
2021-12-13 00:04:00.549 INFO  com.aspect.LogAspect                              :92   [32m125266414050349056[0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"cover":"/image/cover2.png","description":"零基础入门Mysql开发，企业级应用开发最佳首选框架","docCount":20,"id":4,"name":"Mysql入门教程","viewCount":56,"voteCount":23}],"total":1},"success":true}
2021-12-13 00:04:00.549 INFO  com.aspect.LogAspect                              :93   [32m125266414050349056[0;39m ------------- 结束 耗时：102 ms -------------
2021-12-13 00:04:01.870 INFO  com.aspect.LogAspect                              :54   [32m125266420018843648[0;39m ------------- 开始 -------------
2021-12-13 00:04:01.870 INFO  com.aspect.LogAspect                              :55   [32m125266420018843648[0;39m 请求地址: http://localhost:8081/doc/all/4 GET
2021-12-13 00:04:01.871 INFO  com.aspect.LogAspect                              :56   [32m125266420018843648[0;39m 类名方法: com.controller.DocController.all
2021-12-13 00:04:01.871 INFO  com.aspect.LogAspect                              :57   [32m125266420018843648[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:01.871 INFO  com.aspect.LogAspect                              :80   [32m125266420018843648[0;39m 请求参数: [4]
2021-12-13 00:04:01.921 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266420018843648[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-13 00:04:01.921 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266420018843648[0;39m ==> Parameters: 4(Long)
2021-12-13 00:04:01.968 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266420018843648[0;39m <==      Total: 0
2021-12-13 00:04:01.971 INFO  com.aspect.LogAspect                              :92   [32m125266420018843648[0;39m 返回结果: {"content":[],"success":true}
2021-12-13 00:04:01.972 INFO  com.aspect.LogAspect                              :93   [32m125266420018843648[0;39m ------------- 结束 耗时：102 ms -------------
2021-12-13 00:04:03.013 ERROR com.controller.ControllerExceptionHandler         :61   [32m125266380298784768[0;39m 系统异常：
org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:121)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1067)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:540)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1726)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:832)
Caused by: java.lang.NumberFormatException: For input string: "undefined"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:68)
	at java.base/java.lang.Long.parseLong(Long.java:707)
	at java.base/java.lang.Long.valueOf(Long.java:1159)
	at org.springframework.util.NumberUtils.parseNumber(NumberUtils.java:214)
	at org.springframework.beans.propertyeditors.CustomNumberEditor.setAsText(CustomNumberEditor.java:115)
	at org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:429)
	at org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:402)
	at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:155)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:73)
	at org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)
	at org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:696)
	at org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)
	... 47 common frames omitted
2021-12-13 00:04:03.016 WARN  o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver   :207  [32m125266380298784768[0;39m Resolved [org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; nested exception is java.lang.NumberFormatException: For input string: "undefined"]
2021-12-13 00:04:04.757 INFO  com.aspect.LogAspect                              :54   [32m125266432127799296[0;39m ------------- 开始 -------------
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :55   [32m125266432127799296[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :54   [32m125266432131993600[0;39m ------------- 开始 -------------
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :56   [32m125266432127799296[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :55   [32m125266432131993600[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :57   [32m125266432127799296[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :56   [32m125266432131993600[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :80   [32m125266432127799296[0;39m 请求参数: []
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :57   [32m125266432131993600[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:04.758 INFO  com.aspect.LogAspect                              :80   [32m125266432131993600[0;39m 请求参数: []
2021-12-13 00:04:04.760 INFO  com.aspect.LogAspect                              :54   [32m125266432140382208[0;39m ------------- 开始 -------------
2021-12-13 00:04:04.761 INFO  com.aspect.LogAspect                              :55   [32m125266432140382208[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:04:04.761 INFO  com.aspect.LogAspect                              :56   [32m125266432140382208[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:04:04.761 INFO  com.aspect.LogAspect                              :57   [32m125266432140382208[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:04.761 INFO  com.aspect.LogAspect                              :80   [32m125266432140382208[0;39m 请求参数: []
2021-12-13 00:04:04.803 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266432127799296[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:04:04.804 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266432127799296[0;39m ==> Parameters: 
2021-12-13 00:04:04.813 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266432131993600[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:04:04.813 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266432140382208[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:04:04.814 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266432140382208[0;39m ==> Parameters: 
2021-12-13 00:04:04.813 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266432131993600[0;39m ==> Parameters: 
2021-12-13 00:04:04.871 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266432131993600[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:04:04.871 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:04:04.871 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266432127799296[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:04:04.871 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:04:04.871 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266432131993600[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:04:04.871 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266432127799296[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:04:04.871 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:04:04.872 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:04:04.872 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266432127799296[0;39m <==        Row: 2021-12-13, 525, 189, 0, 0
2021-12-13 00:04:04.872 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266432131993600[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:04:04.872 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:04:04.872 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266432127799296[0;39m <==      Total: 2
2021-12-13 00:04:04.872 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266432131993600[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:04:04.872 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:04:04.872 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266432131993600[0;39m <==      Total: 3
2021-12-13 00:04:04.872 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:04:04.873 INFO  com.aspect.LogAspect                              :92   [32m125266432127799296[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":525,"viewIncrease":0,"voteCount":189,"voteIncrease":0}],"success":true}
2021-12-13 00:04:04.873 INFO  com.aspect.LogAspect                              :93   [32m125266432127799296[0;39m ------------- 结束 耗时：116 ms -------------
2021-12-13 00:04:04.873 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:04:04.873 INFO  com.aspect.LogAspect                              :92   [32m125266432131993600[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:04:04.873 INFO  com.aspect.LogAspect                              :93   [32m125266432131993600[0;39m ------------- 结束 耗时：116 ms -------------
2021-12-13 00:04:04.873 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:04:04.873 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:04:04.874 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:04:04.874 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:04:04.874 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:04:04.875 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:04:04.876 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:04:04.876 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:04:04.876 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:04:04.877 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:04:04.878 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:04:04.878 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266432140382208[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:04:04.879 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266432140382208[0;39m <==      Total: 19
2021-12-13 00:04:04.881 INFO  com.aspect.LogAspect                              :92   [32m125266432140382208[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:04:04.881 INFO  com.aspect.LogAspect                              :93   [32m125266432140382208[0;39m ------------- 结束 耗时：121 ms -------------
2021-12-13 00:04:05.015 INFO  com.job.DocJob                                    :32   [32m125266433209929728[0;39m 更新电子书下的文档数据开始
2021-12-13 00:04:05.016 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266433209929728[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:04:05.016 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266433209929728[0;39m ==> Parameters: 
2021-12-13 00:04:05.113 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266433209929728[0;39m <==    Updates: 2
2021-12-13 00:04:05.114 INFO  com.job.DocJob                                    :35   [32m125266433209929728[0;39m 更新电子书下的文档数据结束，耗时：99毫秒
2021-12-13 00:04:05.115 INFO  com.job.EbookSnapshotJob                          :32   [32m125266433629360128[0;39m 生成今日电子书快照开始
2021-12-13 00:04:05.116 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266433629360128[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:05.117 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266433629360128[0;39m ==> Parameters: 
2021-12-13 00:04:05.214 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266433629360128[0;39m <==    Updates: 0
2021-12-13 00:04:05.215 INFO  com.job.EbookSnapshotJob                          :35   [32m125266433629360128[0;39m 生成今日电子书快照结束，耗时：100毫秒
2021-12-13 00:04:08.089 INFO  com.aspect.LogAspect                              :54   [32m125266446103220224[0;39m ------------- 开始 -------------
2021-12-13 00:04:08.090 INFO  com.aspect.LogAspect                              :55   [32m125266446103220224[0;39m 请求地址: http://localhost:8081/ebook/list GET
2021-12-13 00:04:08.090 INFO  com.aspect.LogAspect                              :56   [32m125266446103220224[0;39m 类名方法: com.controller.EbookController.list
2021-12-13 00:04:08.090 INFO  com.aspect.LogAspect                              :57   [32m125266446103220224[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:08.090 INFO  com.aspect.LogAspect                              :80   [32m125266446103220224[0;39m 请求参数: [{"categoryId2":301,"page":1,"size":1000}]
2021-12-13 00:04:08.138 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266446103220224[0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-12-13 00:04:08.139 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266446103220224[0;39m ==> Parameters: 301(Long)
2021-12-13 00:04:08.184 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266446103220224[0;39m <==    Columns: count(0)
2021-12-13 00:04:08.185 TRACE com.mapper.EbookMapper.selectByExample_COUNT      :143  [32m125266446103220224[0;39m <==        Row: 1
2021-12-13 00:04:08.186 DEBUG com.mapper.EbookMapper.selectByExample_COUNT      :137  [32m125266446103220224[0;39m <==      Total: 1
2021-12-13 00:04:08.189 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266446103220224[0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-12-13 00:04:08.192 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266446103220224[0;39m ==> Parameters: 301(Long), 1000(Integer)
2021-12-13 00:04:08.248 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266446103220224[0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-12-13 00:04:08.249 TRACE com.mapper.EbookMapper.selectByExample            :143  [32m125266446103220224[0;39m <==        Row: 3, Python入门教程, 300, 301, 零基础入门Python开发，企业级应用开发最佳首选框架, /image/cover1.png, 20, 45, 32
2021-12-13 00:04:08.250 DEBUG com.mapper.EbookMapper.selectByExample            :137  [32m125266446103220224[0;39m <==      Total: 1
2021-12-13 00:04:08.251 INFO  com.servicess.EbookService                        :48   [32m125266446103220224[0;39m 总行数：1
2021-12-13 00:04:08.251 INFO  com.servicess.EbookService                        :49   [32m125266446103220224[0;39m 总页数：1
2021-12-13 00:04:08.253 INFO  com.aspect.LogAspect                              :92   [32m125266446103220224[0;39m 返回结果: {"content":{"list":[{"category1Id":300,"category2Id":301,"cover":"/image/cover1.png","description":"零基础入门Python开发，企业级应用开发最佳首选框架","docCount":20,"id":3,"name":"Python入门教程","viewCount":45,"voteCount":32}],"total":1},"success":true}
2021-12-13 00:04:08.253 INFO  com.aspect.LogAspect                              :93   [32m125266446103220224[0;39m ------------- 结束 耗时：164 ms -------------
2021-12-13 00:04:10.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125266454168866816[0;39m 生成今日电子书快照开始
2021-12-13 00:04:10.072 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266454168866816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:10.073 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266454168866816[0;39m ==> Parameters: 
2021-12-13 00:04:10.240 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266454168866816[0;39m <==    Updates: 0
2021-12-13 00:04:10.240 INFO  com.job.EbookSnapshotJob                          :35   [32m125266454168866816[0;39m 生成今日电子书快照结束，耗时：228毫秒
2021-12-13 00:04:10.623 INFO  com.aspect.LogAspect                              :54   [32m125266456731586560[0;39m ------------- 开始 -------------
2021-12-13 00:04:10.623 INFO  com.aspect.LogAspect                              :55   [32m125266456731586560[0;39m 请求地址: http://localhost:8081/doc/all/3 GET
2021-12-13 00:04:10.623 INFO  com.aspect.LogAspect                              :56   [32m125266456731586560[0;39m 类名方法: com.controller.DocController.all
2021-12-13 00:04:10.623 INFO  com.aspect.LogAspect                              :57   [32m125266456731586560[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:10.623 INFO  com.aspect.LogAspect                              :80   [32m125266456731586560[0;39m 请求参数: [3]
2021-12-13 00:04:10.723 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266456731586560[0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-12-13 00:04:10.724 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266456731586560[0;39m ==> Parameters: 3(Long)
2021-12-13 00:04:10.782 DEBUG com.mapper.DocMapper.selectByExample              :137  [32m125266456731586560[0;39m <==      Total: 0
2021-12-13 00:04:10.782 INFO  com.aspect.LogAspect                              :92   [32m125266456731586560[0;39m 返回结果: {"content":[],"success":true}
2021-12-13 00:04:10.782 INFO  com.aspect.LogAspect                              :93   [32m125266456731586560[0;39m ------------- 结束 耗时：159 ms -------------
2021-12-13 00:04:12.016 INFO  com.aspect.LogAspect                              :54   [32m125266462574252032[0;39m ------------- 开始 -------------
2021-12-13 00:04:12.016 INFO  com.aspect.LogAspect                              :54   [32m125266462574252033[0;39m ------------- 开始 -------------
2021-12-13 00:04:12.016 INFO  com.aspect.LogAspect                              :55   [32m125266462574252032[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:04:12.016 INFO  com.aspect.LogAspect                              :55   [32m125266462574252033[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:04:12.016 INFO  com.aspect.LogAspect                              :56   [32m125266462574252032[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:04:12.017 INFO  com.aspect.LogAspect                              :56   [32m125266462574252033[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:04:12.017 INFO  com.aspect.LogAspect                              :57   [32m125266462574252032[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:12.017 INFO  com.aspect.LogAspect                              :57   [32m125266462574252033[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:12.017 INFO  com.aspect.LogAspect                              :80   [32m125266462574252033[0;39m 请求参数: []
2021-12-13 00:04:12.017 INFO  com.aspect.LogAspect                              :80   [32m125266462574252032[0;39m 请求参数: []
2021-12-13 00:04:12.019 INFO  com.aspect.LogAspect                              :54   [32m125266462586834944[0;39m ------------- 开始 -------------
2021-12-13 00:04:12.019 INFO  com.aspect.LogAspect                              :55   [32m125266462586834944[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:04:12.019 INFO  com.aspect.LogAspect                              :56   [32m125266462586834944[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:04:12.019 INFO  com.aspect.LogAspect                              :57   [32m125266462586834944[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:04:12.019 INFO  com.aspect.LogAspect                              :80   [32m125266462586834944[0;39m 请求参数: []
2021-12-13 00:04:12.061 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266462574252033[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:04:12.062 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266462574252033[0;39m ==> Parameters: 
2021-12-13 00:04:12.066 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266462574252032[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:04:12.066 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266462586834944[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:04:12.067 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266462574252032[0;39m ==> Parameters: 
2021-12-13 00:04:12.067 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266462586834944[0;39m ==> Parameters: 
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266462574252033[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266462574252032[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266462574252033[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266462574252032[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266462574252033[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125266462574252032[0;39m <==        Row: 2021-12-13, 527, 191, 2, 2
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:04:12.112 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125266462574252032[0;39m <==      Total: 2
2021-12-13 00:04:12.112 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125266462574252033[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:04:12.112 INFO  com.aspect.LogAspect                              :92   [32m125266462574252032[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":527,"viewIncrease":2,"voteCount":191,"voteIncrease":2}],"success":true}
2021-12-13 00:04:12.112 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:04:12.112 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125266462574252033[0;39m <==      Total: 3
2021-12-13 00:04:12.112 INFO  com.aspect.LogAspect                              :93   [32m125266462574252032[0;39m ------------- 结束 耗时：96 ms -------------
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:04:12.122 INFO  com.aspect.LogAspect                              :92   [32m125266462574252033[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:04:12.122 INFO  com.aspect.LogAspect                              :93   [32m125266462574252033[0;39m ------------- 结束 耗时：106 ms -------------
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:04:12.122 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125266462586834944[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:04:12.122 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125266462586834944[0;39m <==      Total: 19
2021-12-13 00:04:12.132 INFO  com.aspect.LogAspect                              :92   [32m125266462586834944[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:04:12.132 INFO  com.aspect.LogAspect                              :93   [32m125266462586834944[0;39m ------------- 结束 耗时：113 ms -------------
2021-12-13 00:04:15.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125266475094249472[0;39m 生成今日电子书快照开始
2021-12-13 00:04:15.048 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266475094249472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:15.049 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266475094249472[0;39m ==> Parameters: 
2021-12-13 00:04:15.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266475094249472[0;39m <==    Updates: 0
2021-12-13 00:04:15.144 INFO  com.job.EbookSnapshotJob                          :35   [32m125266475094249472[0;39m 生成今日电子书快照结束，耗时：143毫秒
2021-12-13 00:04:20.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125266496124489728[0;39m 生成今日电子书快照开始
2021-12-13 00:04:20.063 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266496124489728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:20.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266496124489728[0;39m ==> Parameters: 
2021-12-13 00:04:20.158 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266496124489728[0;39m <==    Updates: 0
2021-12-13 00:04:20.158 INFO  com.job.EbookSnapshotJob                          :35   [32m125266496124489728[0;39m 生成今日电子书快照结束，耗时：143毫秒
2021-12-13 00:04:25.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125266517079232512[0;39m 生成今日电子书快照开始
2021-12-13 00:04:25.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266517079232512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:25.055 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266517079232512[0;39m ==> Parameters: 
2021-12-13 00:04:25.152 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266517079232512[0;39m <==    Updates: 0
2021-12-13 00:04:25.152 INFO  com.job.EbookSnapshotJob                          :35   [32m125266517079232512[0;39m 生成今日电子书快照结束，耗时：141毫秒
2021-12-13 00:04:30.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125266538008809472[0;39m 生成今日电子书快照开始
2021-12-13 00:04:30.041 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266538008809472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:30.041 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266538008809472[0;39m ==> Parameters: 
2021-12-13 00:04:30.131 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266538008809472[0;39m <==    Updates: 0
2021-12-13 00:04:30.131 INFO  com.job.EbookSnapshotJob                          :35   [32m125266538008809472[0;39m 生成今日电子书快照结束，耗时：130毫秒
2021-12-13 00:04:35.010 INFO  com.job.DocJob                                    :32   [32m125266559018078208[0;39m 更新电子书下的文档数据开始
2021-12-13 00:04:35.055 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266559018078208[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:04:35.055 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266559018078208[0;39m ==> Parameters: 
2021-12-13 00:04:35.149 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125266559018078208[0;39m <==    Updates: 2
2021-12-13 00:04:35.150 INFO  com.job.DocJob                                    :35   [32m125266559018078208[0;39m 更新电子书下的文档数据结束，耗时：139毫秒
2021-12-13 00:04:35.151 INFO  com.job.EbookSnapshotJob                          :32   [32m125266559609475072[0;39m 生成今日电子书快照开始
2021-12-13 00:04:35.151 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266559609475072[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:35.153 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266559609475072[0;39m ==> Parameters: 
2021-12-13 00:04:35.241 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266559609475072[0;39m <==    Updates: 0
2021-12-13 00:04:35.241 INFO  com.job.EbookSnapshotJob                          :35   [32m125266559609475072[0;39m 生成今日电子书快照结束，耗时：90毫秒
2021-12-13 00:04:40.006 INFO  com.job.EbookSnapshotJob                          :32   [32m125266579972820992[0;39m 生成今日电子书快照开始
2021-12-13 00:04:40.049 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266579972820992[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:04:40.050 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266579972820992[0;39m ==> Parameters: 
2021-12-13 00:04:40.145 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125266579972820992[0;39m <==    Updates: 0
2021-12-13 00:04:40.145 INFO  com.job.EbookSnapshotJob                          :35   [32m125266579972820992[0;39m 生成今日电子书快照结束，耗时：139毫秒
2021-12-13 00:04:41.143 INFO  com.websocket.WebSocketServer                     :41   [32m125266420018843648[0;39m 连接关闭，token：cjD4FbbG66，session id：0！当前连接数：0
2021-12-13 00:10:48.258 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-13 00:10:48.266 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 8944 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-13 00:10:48.266 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-13 00:10:48.330 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-13 00:10:48.330 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-13 00:10:49.674 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-13 00:10:49.674 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-13 00:10:50.141 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 457 ms. Found 0 Redis repository interfaces.
2021-12-13 00:10:50.771 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-13 00:10:50.771 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-13 00:10:50.771 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-13 00:10:50.781 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-13 00:10:50.831 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-13 00:10:50.831 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 2501 ms
2021-12-13 00:10:52.230 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-13 00:10:52.260 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-13 00:10:52.280 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-13 00:10:52.290 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 4.727 seconds (JVM running for 6.0)
2021-12-13 00:10:55.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125268152857792512[0;39m 生成今日电子书快照开始
2021-12-13 00:10:55.040 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125268152857792512[0;39m HikariPool-1 - Starting...
2021-12-13 00:10:55.750 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125268152857792512[0;39m HikariPool-1 - Start completed.
2021-12-13 00:10:55.770 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268152857792512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:10:55.790 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268152857792512[0;39m ==> Parameters: 
2021-12-13 00:10:55.882 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268152857792512[0;39m <==    Updates: 0
2021-12-13 00:10:55.882 INFO  com.job.EbookSnapshotJob                          :35   [32m125268152857792512[0;39m 生成今日电子书快照结束，耗时：871毫秒
2021-12-13 00:10:59.709 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-13 00:10:59.710 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-13 00:10:59.711 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-13 00:10:59.754 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：TqFKo14EiD，session id：0，当前连接数：1
2021-12-13 00:10:59.824 INFO  com.aspect.LogAspect                              :54   [32m125268173036589056[0;39m ------------- 开始 -------------
2021-12-13 00:10:59.824 INFO  com.aspect.LogAspect                              :54   [32m125268173036589058[0;39m ------------- 开始 -------------
2021-12-13 00:10:59.824 INFO  com.aspect.LogAspect                              :54   [32m125268173036589057[0;39m ------------- 开始 -------------
2021-12-13 00:10:59.825 INFO  com.aspect.LogAspect                              :55   [32m125268173036589056[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:10:59.825 INFO  com.aspect.LogAspect                              :55   [32m125268173036589057[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:10:59.825 INFO  com.aspect.LogAspect                              :55   [32m125268173036589058[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:10:59.825 INFO  com.aspect.LogAspect                              :56   [32m125268173036589058[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:10:59.826 INFO  com.aspect.LogAspect                              :56   [32m125268173036589056[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:10:59.826 INFO  com.aspect.LogAspect                              :57   [32m125268173036589056[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:10:59.826 INFO  com.aspect.LogAspect                              :57   [32m125268173036589058[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:10:59.825 INFO  com.aspect.LogAspect                              :56   [32m125268173036589057[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:10:59.826 INFO  com.aspect.LogAspect                              :57   [32m125268173036589057[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:10:59.870 INFO  com.aspect.LogAspect                              :80   [32m125268173036589056[0;39m 请求参数: []
2021-12-13 00:10:59.870 INFO  com.aspect.LogAspect                              :80   [32m125268173036589058[0;39m 请求参数: []
2021-12-13 00:10:59.870 INFO  com.aspect.LogAspect                              :80   [32m125268173036589057[0;39m 请求参数: []
2021-12-13 00:10:59.936 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125268173036589057[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:10:59.936 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125268173036589058[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:10:59.937 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125268173036589057[0;39m ==> Parameters: 
2021-12-13 00:10:59.937 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125268173036589058[0;39m ==> Parameters: 
2021-12-13 00:10:59.969 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125268173036589056[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:10:59.970 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125268173036589056[0;39m ==> Parameters: 
2021-12-13 00:11:00.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125268173833506816[0;39m 生成今日电子书快照开始
2021-12-13 00:11:00.023 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125268173036589057[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:11:00.023 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125268173036589058[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:11:00.024 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125268173036589058[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:11:00.024 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125268173036589057[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:11:00.030 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:11:00.031 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125268173036589057[0;39m <==        Row: 2021-12-13, 527, 191, 2, 2
2021-12-13 00:11:00.031 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:11:00.032 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125268173036589057[0;39m <==      Total: 2
2021-12-13 00:11:00.032 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:11:00.033 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:11:00.034 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:11:00.035 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:11:00.036 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:11:00.036 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:11:00.037 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125268173036589058[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:11:00.039 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:11:00.039 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125268173036589058[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:11:00.040 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125268173036589058[0;39m <==      Total: 3
2021-12-13 00:11:00.040 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:11:00.041 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:11:00.042 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:11:00.043 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:11:00.044 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:11:00.045 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:11:00.046 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:11:00.047 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:11:00.049 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:11:00.050 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:11:00.051 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125268173036589056[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:11:00.052 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125268173036589056[0;39m <==      Total: 19
2021-12-13 00:11:00.068 INFO  com.aspect.LogAspect                              :92   [32m125268173036589056[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:11:00.068 INFO  com.aspect.LogAspect                              :93   [32m125268173036589056[0;39m ------------- 结束 耗时：246 ms -------------
2021-12-13 00:11:00.070 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268173833506816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:11:00.070 INFO  com.aspect.LogAspect                              :92   [32m125268173036589057[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":527,"viewIncrease":2,"voteCount":191,"voteIncrease":2}],"success":true}
2021-12-13 00:11:00.070 INFO  com.aspect.LogAspect                              :93   [32m125268173036589057[0;39m ------------- 结束 耗时：248 ms -------------
2021-12-13 00:11:00.071 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268173833506816[0;39m ==> Parameters: 
2021-12-13 00:11:00.071 INFO  com.aspect.LogAspect                              :92   [32m125268173036589058[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:11:00.071 INFO  com.aspect.LogAspect                              :93   [32m125268173036589058[0;39m ------------- 结束 耗时：249 ms -------------
2021-12-13 00:11:00.171 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268173833506816[0;39m <==    Updates: 0
2021-12-13 00:11:00.171 INFO  com.job.EbookSnapshotJob                          :35   [32m125268173833506816[0;39m 生成今日电子书快照结束，耗时：158毫秒
2021-12-13 00:11:05.001 INFO  com.job.EbookSnapshotJob                          :32   [32m125268194758889472[0;39m 生成今日电子书快照开始
2021-12-13 00:11:05.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268194758889472[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:11:05.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268194758889472[0;39m ==> Parameters: 
2021-12-13 00:11:05.150 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268194758889472[0;39m <==    Updates: 0
2021-12-13 00:11:05.150 INFO  com.job.EbookSnapshotJob                          :35   [32m125268194758889472[0;39m 生成今日电子书快照结束，耗时：149毫秒
2021-12-13 00:11:05.150 INFO  com.job.DocJob                                    :32   [32m125268195383840768[0;39m 更新电子书下的文档数据开始
2021-12-13 00:11:05.160 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125268195383840768[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:11:05.160 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125268195383840768[0;39m ==> Parameters: 
2021-12-13 00:11:05.257 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125268195383840768[0;39m <==    Updates: 2
2021-12-13 00:11:05.257 INFO  com.job.DocJob                                    :35   [32m125268195383840768[0;39m 更新电子书下的文档数据结束，耗时：107毫秒
2021-12-13 00:11:10.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125268215772352512[0;39m 生成今日电子书快照开始
2021-12-13 00:11:10.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268215772352512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:11:10.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268215772352512[0;39m ==> Parameters: 
2021-12-13 00:11:10.161 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268215772352512[0;39m <==    Updates: 0
2021-12-13 00:11:10.161 INFO  com.job.EbookSnapshotJob                          :35   [32m125268215772352512[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:11:15.011 INFO  com.job.EbookSnapshotJob                          :32   [32m125268236743872512[0;39m 生成今日电子书快照开始
2021-12-13 00:11:15.051 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268236743872512[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:11:15.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268236743872512[0;39m ==> Parameters: 
2021-12-13 00:11:15.246 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125268236743872512[0;39m <==    Updates: 0
2021-12-13 00:11:15.248 INFO  com.job.EbookSnapshotJob                          :35   [32m125268236743872512[0;39m 生成今日电子书快照结束，耗时：237毫秒
2021-12-13 00:11:17.100 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：TqFKo14EiD，session id：0！当前连接数：0
2021-12-13 00:17:01.227 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.2.0.Final
2021-12-13 00:17:01.257 INFO  com.SpringbootInitApplication                     :55   [32m                  [0;39m Starting SpringbootInitApplication using Java 15 on PC-20210710SYOZ with PID 10892 (E:\market\market\springboot-init\target\classes started by Administrator in E:\market\market)
2021-12-13 00:17:01.257 INFO  com.SpringbootInitApplication                     :659  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-12-13 00:17:01.340 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-12-13 00:17:01.340 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-12-13 00:17:02.981 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :262  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-12-13 00:17:02.981 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :132  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-12-13 00:17:03.620 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :201  [32m                  [0;39m Finished Spring Data repository scanning in 620 ms. Found 0 Redis repository interfaces.
2021-12-13 00:17:04.417 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8081 (http)
2021-12-13 00:17:04.427 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8081"]
2021-12-13 00:17:04.427 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-12-13 00:17:04.427 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.53]
2021-12-13 00:17:04.487 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-12-13 00:17:04.487 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :290  [32m                  [0;39m Root WebApplicationContext: initialization completed in 3147 ms
2021-12-13 00:17:06.126 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-12-13 00:17:06.156 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8081"]
2021-12-13 00:17:06.176 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8081 (http) with context path ''
2021-12-13 00:17:06.196 INFO  com.SpringbootInitApplication                     :61   [32m                  [0;39m Started SpringbootInitApplication in 5.755 seconds (JVM running for 6.814)
2021-12-13 00:17:10.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125269725696626688[0;39m 生成今日电子书快照开始
2021-12-13 00:17:10.015 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m125269725696626688[0;39m HikariPool-1 - Starting...
2021-12-13 00:17:10.814 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m125269725696626688[0;39m HikariPool-1 - Start completed.
2021-12-13 00:17:10.824 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269725696626688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:10.854 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269725696626688[0;39m ==> Parameters: 
2021-12-13 00:17:10.964 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269725696626688[0;39m <==    Updates: 0
2021-12-13 00:17:10.964 INFO  com.job.EbookSnapshotJob                          :35   [32m125269725696626688[0;39m 生成今日电子书快照结束，耗时：959毫秒
2021-12-13 00:17:15.016 INFO  com.job.EbookSnapshotJob                          :32   [32m125269746714284032[0;39m 生成今日电子书快照开始
2021-12-13 00:17:15.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269746714284032[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:15.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269746714284032[0;39m ==> Parameters: 
2021-12-13 00:17:15.176 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269746714284032[0;39m <==    Updates: 0
2021-12-13 00:17:15.176 INFO  com.job.EbookSnapshotJob                          :35   [32m125269746714284032[0;39m 生成今日电子书快照结束，耗时：160毫秒
2021-12-13 00:17:20.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125269767631278080[0;39m 生成今日电子书快照开始
2021-12-13 00:17:20.043 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269767631278080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:20.043 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269767631278080[0;39m ==> Parameters: 
2021-12-13 00:17:20.143 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269767631278080[0;39m <==    Updates: 0
2021-12-13 00:17:20.143 INFO  com.job.EbookSnapshotJob                          :35   [32m125269767631278080[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:17:25.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125269788653129728[0;39m 生成今日电子书快照开始
2021-12-13 00:17:25.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269788653129728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:25.065 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269788653129728[0;39m ==> Parameters: 
2021-12-13 00:17:25.167 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269788653129728[0;39m <==    Updates: 0
2021-12-13 00:17:25.167 INFO  com.job.EbookSnapshotJob                          :35   [32m125269788653129728[0;39m 生成今日电子书快照结束，耗时：152毫秒
2021-12-13 00:17:30.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125269809624649728[0;39m 生成今日电子书快照开始
2021-12-13 00:17:30.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269809624649728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:30.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269809624649728[0;39m ==> Parameters: 
2021-12-13 00:17:30.164 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269809624649728[0;39m <==    Updates: 0
2021-12-13 00:17:30.164 INFO  com.job.EbookSnapshotJob                          :35   [32m125269809624649728[0;39m 生成今日电子书快照结束，耗时：149毫秒
2021-12-13 00:17:35.005 INFO  com.job.DocJob                                    :32   [32m125269830554226688[0;39m 更新电子书下的文档数据开始
2021-12-13 00:17:35.064 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269830554226688[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:17:35.064 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269830554226688[0;39m ==> Parameters: 
2021-12-13 00:17:35.164 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269830554226688[0;39m <==    Updates: 2
2021-12-13 00:17:35.164 INFO  com.job.DocJob                                    :35   [32m125269830554226688[0;39m 更新电子书下的文档数据结束，耗时：159毫秒
2021-12-13 00:17:35.164 INFO  com.job.EbookSnapshotJob                          :32   [32m125269831221121024[0;39m 生成今日电子书快照开始
2021-12-13 00:17:35.174 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269831221121024[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:35.174 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269831221121024[0;39m ==> Parameters: 
2021-12-13 00:17:35.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269831221121024[0;39m <==    Updates: 0
2021-12-13 00:17:35.274 INFO  com.job.EbookSnapshotJob                          :35   [32m125269831221121024[0;39m 生成今日电子书快照结束，耗时：100毫秒
2021-12-13 00:17:40.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125269851525746688[0;39m 生成今日电子书快照开始
2021-12-13 00:17:40.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269851525746688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:40.045 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269851525746688[0;39m ==> Parameters: 
2021-12-13 00:17:40.155 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269851525746688[0;39m <==    Updates: 0
2021-12-13 00:17:40.155 INFO  com.job.EbookSnapshotJob                          :35   [32m125269851525746688[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:17:45.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125269872493072384[0;39m 生成今日电子书快照开始
2021-12-13 00:17:45.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269872493072384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:45.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269872493072384[0;39m ==> Parameters: 
2021-12-13 00:17:45.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269872493072384[0;39m <==    Updates: 0
2021-12-13 00:17:45.154 INFO  com.job.EbookSnapshotJob                          :35   [32m125269872493072384[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:17:50.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125269893506535424[0;39m 生成今日电子书快照开始
2021-12-13 00:17:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269893506535424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:50.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269893506535424[0;39m ==> Parameters: 
2021-12-13 00:17:50.165 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269893506535424[0;39m <==    Updates: 0
2021-12-13 00:17:50.165 INFO  com.job.EbookSnapshotJob                          :35   [32m125269893506535424[0;39m 生成今日电子书快照结束，耗时：151毫秒
2021-12-13 00:17:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125269914436112384[0;39m 生成今日电子书快照开始
2021-12-13 00:17:55.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269914436112384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:17:55.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269914436112384[0;39m ==> Parameters: 
2021-12-13 00:17:55.144 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269914436112384[0;39m <==    Updates: 0
2021-12-13 00:17:55.153 INFO  com.job.EbookSnapshotJob                          :35   [32m125269914436112384[0;39m 生成今日电子书快照结束，耗时：149毫秒
2021-12-13 00:18:00.003 INFO  com.job.EbookSnapshotJob                          :32   [32m125269935403438080[0;39m 生成今日电子书快照开始
2021-12-13 00:18:00.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269935403438080[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:00.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269935403438080[0;39m ==> Parameters: 
2021-12-13 00:18:00.153 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269935403438080[0;39m <==    Updates: 0
2021-12-13 00:18:00.153 INFO  com.job.EbookSnapshotJob                          :35   [32m125269935403438080[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:18:05.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125269956421095424[0;39m 生成今日电子书快照开始
2021-12-13 00:18:05.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269956421095424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:05.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269956421095424[0;39m ==> Parameters: 
2021-12-13 00:18:05.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269956421095424[0;39m <==    Updates: 0
2021-12-13 00:18:05.154 INFO  com.job.EbookSnapshotJob                          :35   [32m125269956421095424[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:18:05.154 INFO  com.job.DocJob                                    :32   [32m125269957008297984[0;39m 更新电子书下的文档数据开始
2021-12-13 00:18:05.154 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269957008297984[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:18:05.164 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269957008297984[0;39m ==> Parameters: 
2021-12-13 00:18:05.254 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125269957008297984[0;39m <==    Updates: 2
2021-12-13 00:18:05.254 INFO  com.job.DocJob                                    :35   [32m125269957008297984[0;39m 更新电子书下的文档数据结束，耗时：100毫秒
2021-12-13 00:18:10.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125269977388421120[0;39m 生成今日电子书快照开始
2021-12-13 00:18:10.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269977388421120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:10.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269977388421120[0;39m ==> Parameters: 
2021-12-13 00:18:10.153 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269977388421120[0;39m <==    Updates: 0
2021-12-13 00:18:10.153 INFO  com.job.EbookSnapshotJob                          :35   [32m125269977388421120[0;39m 生成今日电子书快照结束，耗时：140毫秒
2021-12-13 00:18:15.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125269998368329728[0;39m 生成今日电子书快照开始
2021-12-13 00:18:15.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269998368329728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:15.074 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269998368329728[0;39m ==> Parameters: 
2021-12-13 00:18:15.174 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125269998368329728[0;39m <==    Updates: 0
2021-12-13 00:18:15.174 INFO  com.job.EbookSnapshotJob                          :35   [32m125269998368329728[0;39m 生成今日电子书快照结束，耗时：159毫秒
2021-12-13 00:18:20.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125270019293712384[0;39m 生成今日电子书快照开始
2021-12-13 00:18:20.044 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270019293712384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:20.053 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270019293712384[0;39m ==> Parameters: 
2021-12-13 00:18:20.163 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270019293712384[0;39m <==    Updates: 0
2021-12-13 00:18:20.163 INFO  com.job.EbookSnapshotJob                          :35   [32m125270019293712384[0;39m 生成今日电子书快照结束，耗时：159毫秒
2021-12-13 00:18:25.005 INFO  com.job.EbookSnapshotJob                          :32   [32m125270040269426688[0;39m 生成今日电子书快照开始
2021-12-13 00:18:25.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270040269426688[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:25.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270040269426688[0;39m ==> Parameters: 
2021-12-13 00:18:25.145 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270040269426688[0;39m <==    Updates: 0
2021-12-13 00:18:25.154 INFO  com.job.EbookSnapshotJob                          :35   [32m125270040269426688[0;39m 生成今日电子书快照结束，耗时：149毫秒
2021-12-13 00:18:30.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125270061236752384[0;39m 生成今日电子书快照开始
2021-12-13 00:18:30.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270061236752384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:30.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270061236752384[0;39m ==> Parameters: 
2021-12-13 00:18:30.164 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270061236752384[0;39m <==    Updates: 0
2021-12-13 00:18:30.164 INFO  com.job.EbookSnapshotJob                          :35   [32m125270061236752384[0;39m 生成今日电子书快照结束，耗时：160毫秒
2021-12-13 00:18:35.014 INFO  com.job.DocJob                                    :32   [32m125270082250215424[0;39m 更新电子书下的文档数据开始
2021-12-13 00:18:35.064 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125270082250215424[0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-12-13 00:18:35.064 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125270082250215424[0;39m ==> Parameters: 
2021-12-13 00:18:35.154 DEBUG com.mapper.DocMapperCust.updateEbookInfo          :137  [32m125270082250215424[0;39m <==    Updates: 2
2021-12-13 00:18:35.154 INFO  com.job.DocJob                                    :35   [32m125270082250215424[0;39m 更新电子书下的文档数据结束，耗时：140毫秒
2021-12-13 00:18:35.154 INFO  com.job.EbookSnapshotJob                          :32   [32m125270082837417984[0;39m 生成今日电子书快照开始
2021-12-13 00:18:35.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270082837417984[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:35.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270082837417984[0;39m ==> Parameters: 
2021-12-13 00:18:35.264 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270082837417984[0;39m <==    Updates: 0
2021-12-13 00:18:35.264 INFO  com.job.EbookSnapshotJob                          :35   [32m125270082837417984[0;39m 生成今日电子书快照结束，耗时：110毫秒
2021-12-13 00:18:40.015 INFO  com.job.EbookSnapshotJob                          :32   [32m125270103225929728[0;39m 生成今日电子书快照开始
2021-12-13 00:18:40.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270103225929728[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:40.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270103225929728[0;39m ==> Parameters: 
2021-12-13 00:18:40.323 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270103225929728[0;39m <==    Updates: 0
2021-12-13 00:18:40.323 INFO  com.job.EbookSnapshotJob                          :35   [32m125270103225929728[0;39m 生成今日电子书快照结束，耗时：308毫秒
2021-12-13 00:18:45.012 INFO  com.job.EbookSnapshotJob                          :32   [32m125270124184866816[0;39m 生成今日电子书快照开始
2021-12-13 00:18:45.061 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270124184866816[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:45.062 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270124184866816[0;39m ==> Parameters: 
2021-12-13 00:18:45.194 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270124184866816[0;39m <==    Updates: 0
2021-12-13 00:18:45.194 INFO  com.job.EbookSnapshotJob                          :35   [32m125270124184866816[0;39m 生成今日电子书快照结束，耗时：182毫秒
2021-12-13 00:18:46.861 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-13 00:18:46.861 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-12-13 00:18:46.862 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-12-13 00:18:46.900 INFO  com.websocket.WebSocketServer                     :32   [32m                  [0;39m 有新连接：token：ci3Rg0Ea1p，session id：0，当前连接数：1
2021-12-13 00:18:47.035 INFO  com.aspect.LogAspect                              :54   [32m125270132661555200[0;39m ------------- 开始 -------------
2021-12-13 00:18:47.035 INFO  com.aspect.LogAspect                              :54   [32m125270132661555201[0;39m ------------- 开始 -------------
2021-12-13 00:18:47.035 INFO  com.aspect.LogAspect                              :54   [32m125270132661555202[0;39m ------------- 开始 -------------
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :55   [32m125270132661555202[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-statistic GET
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :55   [32m125270132661555200[0;39m 请求地址: http://localhost:8081/ebook-snapshot/get-30-statistic GET
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :55   [32m125270132661555201[0;39m 请求地址: http://localhost:8081/category/all GET
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :56   [32m125270132661555200[0;39m 类名方法: com.controller.EbookSnapshotController.get30Statistic
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :56   [32m125270132661555201[0;39m 类名方法: com.controller.CategoryController.all
2021-12-13 00:18:47.036 INFO  com.aspect.LogAspect                              :56   [32m125270132661555202[0;39m 类名方法: com.controller.EbookSnapshotController.getStatistic
2021-12-13 00:18:47.037 INFO  com.aspect.LogAspect                              :57   [32m125270132661555202[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:18:47.037 INFO  com.aspect.LogAspect                              :57   [32m125270132661555201[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:18:47.037 INFO  com.aspect.LogAspect                              :57   [32m125270132661555200[0;39m 远程地址: 0:0:0:0:0:0:0:1
2021-12-13 00:18:47.079 INFO  com.aspect.LogAspect                              :80   [32m125270132661555200[0;39m 请求参数: []
2021-12-13 00:18:47.079 INFO  com.aspect.LogAspect                              :80   [32m125270132661555202[0;39m 请求参数: []
2021-12-13 00:18:47.086 INFO  com.aspect.LogAspect                              :80   [32m125270132661555201[0;39m 请求参数: []
2021-12-13 00:18:47.141 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125270132661555202[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:18:47.142 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125270132661555200[0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-12-13 00:18:47.144 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125270132661555200[0;39m ==> Parameters: 
2021-12-13 00:18:47.144 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125270132661555202[0;39m ==> Parameters: 
2021-12-13 00:18:47.170 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125270132661555201[0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-12-13 00:18:47.171 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125270132661555201[0;39m ==> Parameters: 
2021-12-13 00:18:47.244 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==    Columns: id, parent, name, sort
2021-12-13 00:18:47.244 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125270132661555200[0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-12-13 00:18:47.244 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125270132661555202[0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-12-13 00:18:47.245 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 115484701694758912, 0, test, 1
2021-12-13 00:18:47.246 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125270132661555202[0;39m <==        Row: 2021-12-12, 525, 189, 4, 4
2021-12-13 00:18:47.246 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125270132661555200[0;39m <==        Row: 2021-12-10, 0, 0
2021-12-13 00:18:47.247 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 115484763686572032, 115484701694758910, test1, 2
2021-12-13 00:18:47.248 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 115149044279545856, 123, 23, 21
2021-12-13 00:18:47.249 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 100, 0, 前端开发, 100
2021-12-13 00:18:47.249 TRACE com.mapper.EbookSnapshotMapperCust.getStatistic   :143  [32m125270132661555202[0;39m <==        Row: 2021-12-13, 527, 191, 2, 2
2021-12-13 00:18:47.249 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125270132661555200[0;39m <==        Row: 2021-12-11, 64, 50
2021-12-13 00:18:47.249 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 101, 100, Vue, 101
2021-12-13 00:18:47.250 DEBUG com.mapper.EbookSnapshotMapperCust.getStatistic   :137  [32m125270132661555202[0;39m <==      Total: 2
2021-12-13 00:18:47.250 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-12-13 00:18:47.251 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 200, 0, Java, 200
2021-12-13 00:18:47.251 TRACE com.mapper.EbookSnapshotMapperCust.get30Statistic :143  [32m125270132661555200[0;39m <==        Row: 2021-12-12, 4, 4
2021-12-13 00:18:47.252 DEBUG com.mapper.EbookSnapshotMapperCust.get30Statistic :137  [32m125270132661555200[0;39m <==      Total: 3
2021-12-13 00:18:47.252 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 201, 200, 基础应用, 201
2021-12-13 00:18:47.253 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 202, 200, 框架应用, 202
2021-12-13 00:18:47.255 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 300, 0, Python, 300
2021-12-13 00:18:47.256 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 301, 300, 基础应用, 301
2021-12-13 00:18:47.257 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-12-13 00:18:47.258 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 400, 0, 数据库, 400
2021-12-13 00:18:47.259 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 401, 400, MySQL, 401
2021-12-13 00:18:47.259 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 117509419725623296, 400, Oracle, 402
2021-12-13 00:18:47.260 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 500, 0, 其他, 500
2021-12-13 00:18:47.262 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 501, 500, 服务器, 501
2021-12-13 00:18:47.262 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 502, 500, 开发工具, 502
2021-12-13 00:18:47.263 TRACE com.mapper.CategoryMapper.selectByExample         :143  [32m125270132661555201[0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-12-13 00:18:47.263 DEBUG com.mapper.CategoryMapper.selectByExample         :137  [32m125270132661555201[0;39m <==      Total: 19
2021-12-13 00:18:47.281 INFO  com.aspect.LogAspect                              :92   [32m125270132661555201[0;39m 返回结果: {"content":[{"id":115484701694758912,"name":"test","parent":0,"sort":1},{"id":115484763686572032,"name":"test1","parent":115484701694758910,"sort":2},{"id":115149044279545856,"name":"23","parent":123,"sort":21},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":117509419725623296,"name":"Oracle","parent":400,"sort":402},{"id":500,"name":"其他","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-12-13 00:18:47.282 INFO  com.aspect.LogAspect                              :93   [32m125270132661555201[0;39m ------------- 结束 耗时：249 ms -------------
2021-12-13 00:18:47.282 INFO  com.aspect.LogAspect                              :92   [32m125270132661555202[0;39m 返回结果: {"content":[{"date":1639238400000,"viewCount":525,"viewIncrease":4,"voteCount":189,"voteIncrease":4},{"date":1639324800000,"viewCount":527,"viewIncrease":2,"voteCount":191,"voteIncrease":2}],"success":true}
2021-12-13 00:18:47.282 INFO  com.aspect.LogAspect                              :92   [32m125270132661555200[0;39m 返回结果: {"content":[{"date":1639065600000,"viewCount":0,"viewIncrease":0,"voteCount":0,"voteIncrease":0},{"date":1639152000000,"viewCount":0,"viewIncrease":64,"voteCount":0,"voteIncrease":50},{"date":1639238400000,"viewCount":0,"viewIncrease":4,"voteCount":0,"voteIncrease":4}],"success":true}
2021-12-13 00:18:47.283 INFO  com.aspect.LogAspect                              :93   [32m125270132661555202[0;39m ------------- 结束 耗时：250 ms -------------
2021-12-13 00:18:47.283 INFO  com.aspect.LogAspect                              :93   [32m125270132661555200[0;39m ------------- 结束 耗时：250 ms -------------
2021-12-13 00:18:50.013 INFO  com.job.EbookSnapshotJob                          :32   [32m125270145160581120[0;39m 生成今日电子书快照开始
2021-12-13 00:18:50.066 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270145160581120[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:50.067 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270145160581120[0;39m ==> Parameters: 
2021-12-13 00:18:50.167 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270145160581120[0;39m <==    Updates: 0
2021-12-13 00:18:50.168 INFO  com.job.EbookSnapshotJob                          :35   [32m125270145160581120[0;39m 生成今日电子书快照结束，耗时：155毫秒
2021-12-13 00:18:55.004 INFO  com.job.EbookSnapshotJob                          :32   [32m125270166094352384[0;39m 生成今日电子书快照开始
2021-12-13 00:18:55.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270166094352384[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:18:55.054 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270166094352384[0;39m ==> Parameters: 
2021-12-13 00:18:55.154 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270166094352384[0;39m <==    Updates: 0
2021-12-13 00:18:55.154 INFO  com.job.EbookSnapshotJob                          :35   [32m125270166094352384[0;39m 生成今日电子书快照结束，耗时：150毫秒
2021-12-13 00:18:57.319 INFO  com.websocket.WebSocketServer                     :41   [32m                  [0;39m 连接关闭，token：ci3Rg0Ea1p，session id：0！当前连接数：0
2021-12-13 00:19:00.014 INFO  com.job.EbookSnapshotJob                          :32   [32m125270187107815424[0;39m 生成今日电子书快照开始
2021-12-13 00:19:00.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270187107815424[0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-12-13 00:19:00.064 DEBUG com.mapper.EbookSnapshotMapperCust.genSnapshot    :137  [32m125270187107815424[0;39m ==> Parameters: 
